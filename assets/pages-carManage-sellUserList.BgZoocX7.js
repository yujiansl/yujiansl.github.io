import{d as e,r as a,B as l,Z as s,$ as u,a2 as t,c as i,w as r,i as d,I as n,M as o,K as v,b8 as m,o as c,a as f,y as p,u as h,aL as y,g as _,t as k,R as g,z as b,b as C,F as I,e as x,n as B,k as N,P as D,h as U,W as w,ar as L,a1 as M,_ as S}from"./index-CK4DGatK.js";import{N as j}from"./NavBar.DSs5OGCU.js";import{a as q}from"./user.CTa_O_oz.js";import{u as A}from"./useQuery.3dd8K18V.js";const F=S(e({__name:"sellUserList",setup(e){const S=a([]),F=A(),P=a(""),z=a(!1),V=a(),Q=a(),T=a([]),H=a([]);l((e=>{var a;e.keyword&&(P.value=e.keyword),z.value="发起人"==e.title||"定价师"==e.title||"1"==e.Multiple,e.id&&!z.value&&(V.value=e.id),e.id&&z.value&&(T.value=(null==(a=F.value.id)?void 0:a.split(","))||[]),K()}));const K=async()=>{var e,a;s({title:"加载中"});const l=await u().get(F.value.highSeasId?"/crm/task/getUserByHighSeas":F.value.sureBtn?"/admin/user/getUserListByPermission?permission=crmManage:sales:info":F.value.isPurchase?"/product/member/getALLUserByAuth":F.value.isCustomer?"/product/member/getAllUser":"product/order/car/custom/findAll",{params:F.value.highSeasId?{highSeasId:F.value.highSeasId,nameOrPhone:P.value}:{search:P.value,userType:F.value.userType}});S.value=l.data.map((e=>({...e,id:e.id||e.userId})));try{if(H.value.length<1){const l=(null==(a=null==(e=F.value)?void 0:e.id)?void 0:a.split(","))||[];H.value=S.value.filter((e=>l.includes(e.id)))}}catch(i){}if(F.value.sureBtn){const e=S.value.filter((e=>e.id==V.value))[0]||{};Q.value={id:V.value||"",name:null==e?void 0:e.name,phone:null==e?void 0:e.phone}}t()},O=e=>{var a;if(z.value)T.value.includes(e.id)?(T.value.splice(T.value.findIndex((a=>a==e.id)),1),H.value.splice(H.value.findIndex((a=>a.id==e.id)),1)):(T.value.push(e.id),H.value.push(e));else{if(V.value=F.value.isCustomer?e.userId:e.id,Q.value=e,"1"===(null==(a=F.value)?void 0:a.sureBtn))return;L("sellData",{...e,name:e.name,id:F.value.isCustomer?e.userId:e.id,queryData:F.value.queryData,phone:e.phone,idNumber:e.idNumber,member:e.member}),M()}},R=()=>{L("fixUserData",H.value),M()},W=()=>{L("sellData",{...Q.value,name:Q.value.name,id:Q.value.id,queryData:F.value.queryData}),M()},Z=e=>{e.detail.value||K()};return(e,a)=>{const l=d,s=n(v("up-icon"),o),u=g,t=D,L=U,M=n(v("up-empty"),m),A=w;return c(),i(l,{class:"page f-c-s"},{default:r((()=>{var e;return[f(j,{title:h(F).title},y({_:2},[h(z)||h(F).isFilter?{name:"right",fn:r((()=>[h(z)&&h(S).length>0?(c(),i(l,{key:0,class:"nav-right",onClick:R},{default:r((()=>[_("确认("+k(h(T).length)+")",1)])),_:1})):p("",!0),h(F).isFilter?(c(),i(l,{key:1,class:"nav-right",onClick:a[0]||(a[0]=e=>O({name:"",id:""}))},{default:r((()=>[_("清空")])),_:1})):p("",!0)])),key:"0"}:{name:"right",fn:r((()=>[f(l,{class:"nav-right",onClick:W},{default:r((()=>[_("确认")])),_:1})])),key:"1"}]),1032,["title"]),f(l,{class:"inner-boxs"},{default:r((()=>[f(l,{class:"search-box"},{default:r((()=>[f(l,null,{default:r((()=>[f(s,{name:"search",size:"20"}),f(u,{modelValue:h(P),"onUpdate:modelValue":a[1]||(a[1]=e=>b(P)?P.value=e:null),type:"text",placeholder:"搜索","confirm-type":"search",onInput:Z,onConfirm:K},null,8,["modelValue"])])),_:1})])),_:1}),f(l,{class:"f-list"},{default:r((()=>[h(S).length?(c(!0),C(I,{key:0},x(h(S),((e,a)=>(c(),i(l,{key:a,class:B(["user-list",{active:h(V)==(h(F).isCustomer?e.userId:e.id)||h(T).includes(e.id)}]),onClick:a=>O(e)},{default:r((()=>[f(l,{class:"item-box"},{default:r((()=>[f(t,{class:"avatar",src:e.avatar||h(q)},null,8,["src"]),N("div",{class:"up-box"},[f(l,null,{default:r((()=>[f(L,{class:"name"},{default:r((()=>[_(k(e.name),1)])),_:2},1024),e.phone?(c(),i(L,{key:0},{default:r((()=>[_("("+k(e.phone)+")",1)])),_:2},1024)):p("",!0),e.deptName&&!h(F).isCustomer?(c(),i(L,{key:1},{default:r((()=>[_("("+k(e.deptName)+")",1)])),_:2},1024)):p("",!0),e.member&&h(F).isCustomer?(c(),i(L,{key:2,class:"tag"},{default:r((()=>[_("会员")])),_:1})):p("",!0)])),_:2},1024),e.idNumber?(c(),C("div",{key:0,class:"id-number"},"身份证号: "+k(e.idNumber),1)):p("",!0)])])),_:2},1024),h(V)==(h(F).isCustomer?e.userId:e.id)||h(T).includes(e.id)?(c(),i(s,{key:0,name:"checkbox-mark",color:"#F6531B",size:"20"})):p("",!0)])),_:2},1032,["class","onClick"])))),128)):(c(),i(M,{key:1,mode:"data",icon:"http://cdn.uviewui.com/uview/empty/data.png"}))])),_:1})])),_:1}),h(F).sureBtn&&(null==(e=h(Q))?void 0:e.name)?(c(),i(l,{key:0,class:"sure-btn"},{default:r((()=>[f(l,null,{default:r((()=>[f(l,null,{default:r((()=>[_("已选择：")])),_:1}),f(l,null,{default:r((()=>[_(k(h(Q).name),1),h(Q).phone?(c(),i(L,{key:0},{default:r((()=>[_("（"+k(h(Q).phone)+"）",1)])),_:1})):p("",!0)])),_:1})])),_:1}),f(A,{onClick:W},{default:r((()=>[_("确定")])),_:1})])),_:1})):p("",!0)]})),_:1})}}}),[["__scopeId","data-v-cf4f1335"]]);export{F as default};
