import{d as a,r as e,E as l,Z as s,a2 as t,$ as d,c as u,w as r,i as n,I as c,M as o,K as i,o as m,a as f,g as v,t as _,u as p,h as g,n as y,Q as b,b as h,F as M,e as k,aj as C,W as I,a0 as N,a1 as S,_ as $}from"./index-CK4DGatK.js";import{N as j}from"./NavBar.DSs5OGCU.js";import{m as x,a as B,c as F}from"./state.B0y7zlHh.js";import{c as P}from"./carSelect-emit.CejlvgP5.js";import{u as w}from"./useQuery.3dd8K18V.js";import"./event.CJk5hinv.js";const Q=$(a({__name:"addPurchase",setup(a){const $=w(),Q=e({carBrandId:"",carBrand:"",carModelId:"",carModel:"",carSeriesId:"",carSeries:"",carModelFullName:"",mileage:1,carCondition:1,notes:""});P.onEvent((({data:a})=>{const{brandId:e,brandName:l,seriesId:s,seriesName:t,id:d,name:u}=a;Q.value.carBrandId=e,Q.value.carModelId=d,Q.value.carSeriesId=s,Q.value.carBrand=l,Q.value.carModel=u,Q.value.carSeries=t,Q.value.carModelFullName=`${l} ${t} ${u}`})),l((async()=>{s({title:"加载中",mask:!0});try{!async function(){var a,e,l;if(!$.value.id)return;const s={id:$.value.id},t=await d().get(x.selectById,{params:s});Q.value=null==t?void 0:t.data,Q.value.carModelFullName=`${null==(a=null==t?void 0:t.data)?void 0:a.carBrand} ${null==(e=null==t?void 0:t.data)?void 0:e.carSeries} ${null==(l=null==t?void 0:t.data)?void 0:l.carModel}`}()}finally{t()}}));const V=()=>{if(!Q.value.carModelFullName)return N({title:"请选择求购车型",icon:"none"});s({title:"提交中",mask:!0});const a="edit"==$.value.type?"updateSeekingPurchase":"addSeekingPurchase";uni.$u.http.post(x[a],{...Q.value,id:"edit"==$.value.type?$.value.id:null}).then((a=>{N({title:"操作成功",icon:"none"}),"edit"==$.value.type?S():b("/pagesC/myPurchase/searchList?type=1"),t()}))},E=(a,e)=>{Q.value[a]=e.value};return(a,e)=>{const l=n,s=g,t=c(i("up-icon"),o),d=C,N=I;return m(),u(l,{class:"page f-c-s"},{default:r((()=>[f(j,null,{title:r((()=>[f(l,null,{default:r((()=>{var a;return[v(_("edit"===(null==(a=p($))?void 0:a.type)?"编辑求购":"新增求购"),1)]})),_:1})])),_:1}),f(l,{class:"content"},{default:r((()=>[f(l,{class:"form-box"},{default:r((()=>[f(l,{class:"form-item"},{default:r((()=>[f(l,null,{default:r((()=>[f(s,null,{default:r((()=>[v("*")])),_:1}),v("求购车型")])),_:1}),f(l,{class:y({placeholder:!p(Q).carModelFullName}),onClick:e[0]||(e[0]=e=>("toPage"in a?a.toPage:p(b))("/pages/assess/carSelect?selectType=model"))},{default:r((()=>[v(_(p(Q).carModelFullName||"请选择"),1)])),_:1},8,["class"]),f(t,{name:"arrow-right"})])),_:1}),f(l,{class:"form-textarea"},{default:r((()=>[f(l,{class:"area-title"},{default:r((()=>[f(s,null,{default:r((()=>[v("*")])),_:1}),v("里程")])),_:1}),f(l,{class:"sub-content"},{default:r((()=>[(m(!0),h(M,null,k(p(B),(a=>(m(),u(l,{onClick:e=>E("mileage",a),class:y({active:p(Q).mileage==a.value}),key:a.label},{default:r((()=>[v(_(a.label),1)])),_:2},1032,["onClick","class"])))),128))])),_:1})])),_:1}),f(l,{class:"form-textarea"},{default:r((()=>[f(l,{class:"area-title"},{default:r((()=>[f(s,null,{default:r((()=>[v("*")])),_:1}),v("车况")])),_:1}),f(l,{class:"sub-content"},{default:r((()=>[(m(!0),h(M,null,k(p(F),(a=>(m(),u(l,{onClick:e=>E("carCondition",a),class:y({active:p(Q).carCondition==a.value}),key:a.label},{default:r((()=>[v(_(a.label),1)])),_:2},1032,["onClick","class"])))),128))])),_:1})])),_:1}),f(l,{class:"form-textarea"},{default:r((()=>[f(l,{class:"area-title"},{default:r((()=>[v("备注")])),_:1}),f(d,{modelValue:p(Q).notes,"onUpdate:modelValue":e[1]||(e[1]=a=>p(Q).notes=a),placeholder:"请输入",maxlength:"200"},null,8,["modelValue"]),f(l,{class:"limit"},{default:r((()=>{var a;return[v(_((null==(a=p(Q).notes)?void 0:a.length)||0)+"/200",1)]})),_:1})])),_:1})])),_:1})])),_:1}),f(l,{class:"bottom-btn"},{default:r((()=>[f(N,{class:"save-btn",onClick:V},{default:r((()=>[v("确定")])),_:1})])),_:1})])),_:1})}}}),[["__scopeId","data-v-c5fd03e7"]]);export{Q as default};
