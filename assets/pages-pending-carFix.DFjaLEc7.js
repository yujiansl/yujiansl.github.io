import{d as e,A as a,r as l,a9 as t,B as s,E as i,X as r,Y as o,D as u,a2 as n,x as d,c,w as m,i as p,I as f,M as h,K as P,o as _,y,a as g,u as w,g as b,t as k,h as v,R as V,n as x,W as I,Q as S,s as D,an as j,_ as F}from"./index-CK4DGatK.js";import{N as M}from"./NavBar.DSs5OGCU.js";import{L as K}from"./listItem.De6Dqo0z.js";import{a as U}from"./fixPrice.CFXyKkhm.js";import{T as $}from"./task.Cx6XxNwo.js";import{u as T}from"./useQuery.3dd8K18V.js";import{a as O,p as Q}from"./index.HDA2F_3Q.js";import"./time._VqwKl0d.js";import"./car_default.CyENNAub.js";import"./purchase.B8DNaFGL.js";import"./base.6l0JEBJr.js";const L=F(e({__name:"carFix",setup(e){const F=T(),L=a(),N=l({}),B=t({networkPrice:"",membershipPrice:"",exhibitionPrice:"",salesPrice:"",managerPrice:"",wholesalePrice:"",microStoreDeposit:"",salesMethod:null}),C=l([]);s((()=>{E(),J()})),i((()=>{r("pickData"),o("pickData",(e=>{const{key:a,subKey:l}=e;B[l]=a}))}));const E=()=>{(new u).showLoading("加载中"),uni.$u.http.get("/product/purchaseOrder/getSellingPriceInfo",{params:{primaryKey:F.value.purchaseId,taskId:F.value.taskId}}).then((e=>{var a;N.value=e.data,B.salesPrice=null==(a=e.data)?void 0:a.salesPrice,n()}))},J=()=>{uni.$u.http.get("product/common/getInitSelect",{params:{}}).then((e=>{const a=e.data;C.value=a.SalesMethodEnum}))},W=d((()=>X(C.value,B.salesMethod))),X=(e,a)=>{const l=null==e?void 0:e.filter((e=>e.key==a));return(null==l?void 0:l.length)?l[0].value:"请选择"},Z=(e,a,l)=>{D((()=>{B[a]=O(e,l)}))},A=()=>{const e=(()=>{const{networkPrice:e,membershipPrice:a,salesPrice:l,exhibitionPrice:t,managerPrice:s}=B;return l?e?t?a&&parseFloat(a)>parseFloat(e)?"会员价需小于等于网络标价":l&&e&&parseFloat(l)>parseFloat(e)?"销售底价金额需小于等于网络标价":l&&t&&parseFloat(l)>parseFloat(t)?"销售底价金额需小于等于展厅标价":s&&l&&parseFloat(s)>parseFloat(l)?"经理底价金额需小于等于销售底价金额":"":"请输入展厅标价":"请输入网络标价":"请输入销售底价"})();if(e)return void(new u).showToast(e);(new u).showLoading("提交中");const a={primaryKey:F.value.primaryKey,taskDefinitionKey:$["确定销售价"],auditOpinion:1,fixSellingPriceDTO:B};uni.$u.http.post("/product/carPricingFlowable/taskTurnover",a).then((()=>{j("/pages/pending/carFix","",{type:"completedSell"})})).catch((e=>{Q(e.message)}))};return(e,a)=>{const l=p,t=v,s=V,i=f(P("up-icon"),h),r=I;return _(),c(l,{class:"page pend-page"},{default:m((()=>[w(L).needShowQw()?y("",!0):(_(),c(M,{key:0,title:"详情"})),g(l,{class:"content"},{default:m((()=>[g(K,{item:w(N),isDetail:!0,itemType:"5",isToPage:!0},null,8,["item"]),g(l,{class:"section-title"},{default:m((()=>[b("价格信息")])),_:1}),w(F).type===w(U)["销售定价-已定价"]?(_(),c(l,{key:0,class:"form-box"},{default:m((()=>[g(l,{class:"form-item"},{default:m((()=>[g(l,null,{default:m((()=>[b("销售底价")])),_:1}),b(" "+k(w(N).salesPrice?w(N).salesPrice+"万元":"-"),1)])),_:1}),g(l,{class:"form-item"},{default:m((()=>[g(l,null,{default:m((()=>[b("网络标价")])),_:1}),b(" "+k(w(N).networkPrice?w(N).networkPrice+"万元":"-"),1)])),_:1}),g(l,{class:"form-item"},{default:m((()=>[g(l,null,{default:m((()=>[b("会员价")])),_:1}),b(" "+k(w(N).membershipPrice?w(N).membershipPrice+"万元":"-"),1)])),_:1}),g(l,{class:"form-item"},{default:m((()=>[g(l,null,{default:m((()=>[b("展厅标价")])),_:1}),b(" "+k(w(N).exhibitionPrice?w(N).exhibitionPrice+"万元":"-"),1)])),_:1}),g(l,{class:"form-item"},{default:m((()=>[g(l,null,{default:m((()=>[b("经理底价")])),_:1}),b(" "+k(w(N).managerPrice?w(N).managerPrice+"万元":"-"),1)])),_:1}),g(l,{class:"form-item"},{default:m((()=>[g(l,null,{default:m((()=>[b("批发价")])),_:1}),b(" "+k(w(N).wholesalePrice?w(N).wholesalePrice+"万元":"-"),1)])),_:1}),g(l,{class:"form-item"},{default:m((()=>[g(l,null,{default:m((()=>[b("微店订金")])),_:1}),b(" "+k(w(N).microStoreDeposit?w(N).microStoreDeposit+"元":"-"),1)])),_:1}),g(l,{class:"form-item"},{default:m((()=>[g(l,null,{default:m((()=>[b("销售方式")])),_:1}),b(" "+k(w(N).salesMethodStr||"-"),1)])),_:1})])),_:1})):(_(),c(l,{key:1,class:"form-box write"},{default:m((()=>[g(l,{class:"form-item"},{default:m((()=>[g(l,null,{default:m((()=>[g(t,null,{default:m((()=>[b("*")])),_:1}),b("销售底价")])),_:1}),g(s,{modelValue:w(B).salesPrice,"onUpdate:modelValue":a[0]||(a[0]=e=>w(B).salesPrice=e),type:"digit",placeholder:"请输入",onInput:a[1]||(a[1]=e=>Z(e.detail.value,"salesPrice","wanyuan"))},null,8,["modelValue"]),b(" 万元 ")])),_:1}),g(l,{class:"form-item"},{default:m((()=>[g(l,null,{default:m((()=>[g(t,null,{default:m((()=>[b("*")])),_:1}),b("网络标价")])),_:1}),g(s,{modelValue:w(B).networkPrice,"onUpdate:modelValue":a[2]||(a[2]=e=>w(B).networkPrice=e),modelModifiers:{trim:!0},type:"digit",placeholder:"请输入",onInput:a[3]||(a[3]=e=>(e=>{Z(e.detail.value,"networkPrice","wanyuan"),B.exhibitionPrice=O(B.networkPrice,"wanyuan")})(e))},null,8,["modelValue"]),b(" 万元 ")])),_:1}),g(l,{class:"form-item"},{default:m((()=>[g(l,null,{default:m((()=>[b("会员价")])),_:1}),g(s,{modelValue:w(B).membershipPrice,"onUpdate:modelValue":a[4]||(a[4]=e=>w(B).membershipPrice=e),tyep:"digit",placeholder:"请输入",onInput:a[5]||(a[5]=e=>Z(e.detail.value,"membershipPrice","wanyuan"))},null,8,["modelValue"]),b(" 万元 ")])),_:1}),g(l,{class:"form-item"},{default:m((()=>[g(l,null,{default:m((()=>[g(t,null,{default:m((()=>[b("*")])),_:1}),b("展厅标价")])),_:1}),g(s,{modelValue:w(B).exhibitionPrice,"onUpdate:modelValue":a[6]||(a[6]=e=>w(B).exhibitionPrice=e),type:"digit",placeholder:"请输入",onInput:a[7]||(a[7]=e=>Z(e.detail.value,"exhibitionPrice","wanyuan"))},null,8,["modelValue"]),b(" 万元 ")])),_:1}),g(l,{class:"form-item"},{default:m((()=>[g(l,null,{default:m((()=>[b("经理底价")])),_:1}),g(s,{modelValue:w(B).managerPrice,"onUpdate:modelValue":a[8]||(a[8]=e=>w(B).managerPrice=e),type:"digit",placeholder:"请输入",onInput:a[9]||(a[9]=e=>Z(e.detail.value,"managerPrice","wanyuan"))},null,8,["modelValue"]),b(" 万元 ")])),_:1}),g(l,{class:"form-item"},{default:m((()=>[g(l,null,{default:m((()=>[b("批发价")])),_:1}),g(s,{modelValue:w(B).wholesalePrice,"onUpdate:modelValue":a[10]||(a[10]=e=>w(B).wholesalePrice=e),type:"digit",placeholder:"请输入",onInput:a[11]||(a[11]=e=>Z(e.detail.value,"wholesalePrice","wanyuan"))},null,8,["modelValue"]),b(" 万元 ")])),_:1}),g(l,{class:"form-item"},{default:m((()=>[g(l,null,{default:m((()=>[b("微店订金")])),_:1}),g(s,{modelValue:w(B).microStoreDeposit,"onUpdate:modelValue":a[12]||(a[12]=e=>w(B).microStoreDeposit=e),type:"number",placeholder:"请输入",maxlength:"7",onInput:a[13]||(a[13]=e=>Z(e.detail.value,"microStoreDeposit","yuan"))},null,8,["modelValue"]),b(" 元 ")])),_:1}),g(l,{class:"form-item"},{default:m((()=>[g(l,null,{default:m((()=>[b("销售方式")])),_:1}),g(l,{class:"f-b-c",onClick:a[14]||(a[14]=e=>{return a="销售方式",l=w(C),t=w(B).salesMethod,s="salesMethod",void S(`/pages/carManage/pagePicker?title=${a}&list=${JSON.stringify(l)}&key=${t}&subKey=${s}`);var a,l,t,s})},{default:m((()=>[g(t,{class:x({placeholder:"请选择"==w(W)})},{default:m((()=>[b(k(w(W)),1)])),_:1},8,["class"]),g(i,{name:"arrow-right"})])),_:1})])),_:1})])),_:1}))])),_:1}),w(F).type===w(U)["销售定价-待定价"]?(_(),c(l,{key:1,class:"bottom-btn"},{default:m((()=>[g(r,{class:"save-btn",onClick:A},{default:m((()=>[b("确定")])),_:1})])),_:1})):y("",!0)])),_:1})}}}),[["__scopeId","data-v-0a6bdefa"]]);export{L as default};
