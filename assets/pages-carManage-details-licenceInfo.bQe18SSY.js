import{d as a,a9 as e,r as l,B as t,E as n,X as u,Y as s,x as r,c,w as o,i as m,I as i,M as f,K as d,at as p,o as _,a as y,y as I,u as k,g as v,t as h,h as x,n as g,R as D,aj as b,W as T,au as w,z as E,Q as V,D as C,a1 as $,s as S,_ as N}from"./index-CK4DGatK.js";import{u as O}from"./useQuery.3dd8K18V.js";import{a as L}from"./index.HDA2F_3Q.js";const M=N(a({__name:"licenceInfo",setup(a){const N=O(),M=e({}),j=l([{key:1,value:"有"},{key:0,value:"无"}]),A=l(!1),P=l(""),Y=l(""),B=l(""),J=new Map([["year","年"],["month","月"],["day","日"]]),U=l();function K(a,e){return`${e}${J.get(a)}`}t((()=>{Q(),z()})),n((()=>{u("pickData"),s("pickData",(a=>{const{key:e,subKey:l}=a;M[l]=e}))}));const Q=()=>{uni.$u.http.get(`/product/merchant/car/product/License/information/${N.value.carProductId}`).then((a=>{Object.assign(M,a.data);const{insuranceExpireDate:e,commercialInsuranceData:l}=a.data;M.compulsoryTrafficInsurance=e?1:0,M.commercialInsurance=l?1:0}))},z=()=>{["SoldOut","Locked","ToBeSigned","PaymentIng"].includes(N.value.status)||uni.$u.http.get("admin/dict/type/transferTime").then((a=>{U.value=a.data.map((a=>({value:a.label,key:a.value})))}))},R=r((()=>q(j.value,M.compulsoryTrafficInsurance))),W=r((()=>q(j.value,M.commercialInsurance))),X=r((()=>q(U.value,M.transferTime))),q=(a,e)=>{const l=null==a?void 0:a.filter((a=>a.key==e));return(null==l?void 0:l.length)?l[0].value:"请选择"},F=(a,e,l,t)=>{V(`/pages/carManage/pagePicker?title=${a}&list=${JSON.stringify(e)}&key=${l}&subKey=${t}`)},G=()=>{(new C).showLoading("提交中");const a=JSON.parse(JSON.stringify(M));a.compulsoryTrafficInsurance||(a.insuranceExpireDate=""),a.commercialInsurance||(a.commercialInsuranceData=""),uni.$u.http.put("/product/merchant/car/product/License/information",a).then((()=>{(new C).showToast("保存成功"),setTimeout((()=>{$()}),1500)}))},H=(a,e,l)=>{A.value=!0,P.value=a,Y.value=e,B.value=l},Z=a=>{S((()=>{M[P.value]=w(a.value).format("YYYY-MM-DD"),A.value=!1}))};return(a,e)=>{const l=m,t=x,n=i(d("up-icon"),f),u=D,s=b,r=T,V=i(d("u-datetime-picker"),p);return _(),c(l,{class:"page pend-page f-c-s"},{default:o((()=>[y(l,{class:"content"},{default:o((()=>["SoldOut"==k(N).status||"Locked"==k(N).status||"ToBeSigned"==k(N).status||"PaymentIng"==k(N).status?(_(),c(l,{key:0,class:"form-box"},{default:o((()=>[y(l,{class:"form-item"},{default:o((()=>[y(l,null,{default:o((()=>[v("过户次数")])),_:1}),v(" "+h(k(M).transferTimeName||"-"),1)])),_:1}),y(l,{class:"form-item"},{default:o((()=>[y(l,null,{default:o((()=>[v("钥匙数量")])),_:1}),v(" "+h(k(M).keyNum||0)+"把 ",1)])),_:1}),y(l,{class:"form-item"},{default:o((()=>[y(l,null,{default:o((()=>[v("年检到期日")])),_:1}),v(" "+h(k(M).examinationExpireDate||"-"),1)])),_:1}),y(l,{class:"form-item"},{default:o((()=>[y(l,null,{default:o((()=>[v("交强险")])),_:1}),v(" "+h(k(R)),1)])),_:1}),1==k(M).compulsoryTrafficInsurance?(_(),c(l,{key:0,class:"form-item"},{default:o((()=>[y(l,null,{default:o((()=>[v("交强险到期")])),_:1}),v(" "+h(k(M).insuranceExpireDate||"-"),1)])),_:1})):I("",!0),y(l,{class:"form-item"},{default:o((()=>[y(l,null,{default:o((()=>[v("商业险")])),_:1}),v(" "+h(k(W)),1)])),_:1}),1==k(M).commercialInsurance?(_(),c(l,{key:1,class:"form-item"},{default:o((()=>[y(l,null,{default:o((()=>[v("商业险到期")])),_:1}),v(" "+h(k(M).commercialInsuranceData||"-"),1)])),_:1})):I("",!0),y(l,{class:"form-item"},{default:o((()=>[y(l,null,{default:o((()=>[v("商业险金额")])),_:1}),v(" "+h(k(M).commercialInsuranceAmount?k(M).commercialInsuranceAmount+"元":"-"),1)])),_:1}),y(l,{class:"form-textarea"},{default:o((()=>[y(l,{class:"area-title"},{default:o((()=>[v("备注")])),_:1}),v(" "+h(k(M).remarkInfo||"-"),1)])),_:1})])),_:1})):(_(),c(l,{key:1,class:"form-box write"},{default:o((()=>[y(l,{class:"form-item"},{default:o((()=>[y(l,null,{default:o((()=>[v("过户次数")])),_:1}),y(l,{class:"f-b-c",onClick:e[0]||(e[0]=a=>F("过户次数",k(U),k(M).transferTime,"transferTime"))},{default:o((()=>[y(t,{class:g({placeholder:"请选择"==k(X)})},{default:o((()=>[v(h(k(X)),1)])),_:1},8,["class"]),y(n,{name:"arrow-right"})])),_:1})])),_:1}),y(l,{class:"form-item"},{default:o((()=>[y(l,null,{default:o((()=>[v("钥匙数量")])),_:1}),y(u,{modelValue:k(M).keyNum,"onUpdate:modelValue":e[1]||(e[1]=a=>k(M).keyNum=a),type:"number",placeholder:"请输入",maxlength:"2",onInput:e[2]||(e[2]=a=>{return e=a.detail.value,l="keyNum",t=10,void S((()=>{M[l]=e>t?t:e}));var e,l,t})},null,8,["modelValue"]),v(" 把 ")])),_:1}),y(l,{class:"form-item"},{default:o((()=>[y(l,null,{default:o((()=>[v("年检到期日")])),_:1}),y(l,{class:g({placeholder:!k(M).examinationExpireDate}),onClick:e[3]||(e[3]=a=>H("examinationExpireDate",k(M).examinationExpireDate,"年检到期日"))},{default:o((()=>[v(h(k(M).examinationExpireDate||"请选择"),1)])),_:1},8,["class"]),k(M).examinationExpireDate?(_(),c(n,{key:0,name:"close-circle-fill",onClick:e[4]||(e[4]=a=>k(M).examinationExpireDate=""),color:"rgb(153, 153, 153)"})):(_(),c(n,{key:1,name:"arrow-right"}))])),_:1}),y(l,{class:"form-item"},{default:o((()=>[y(l,null,{default:o((()=>[v("交强险")])),_:1}),y(l,{class:"f-b-c",onClick:e[5]||(e[5]=a=>F("交强险",k(j),k(M).compulsoryTrafficInsurance,"compulsoryTrafficInsurance"))},{default:o((()=>[y(t,null,{default:o((()=>[v(h(k(R)),1)])),_:1}),y(n,{name:"arrow-right"})])),_:1})])),_:1}),1==k(M).compulsoryTrafficInsurance?(_(),c(l,{key:0,class:"form-item"},{default:o((()=>[y(l,null,{default:o((()=>[v("交强险到期")])),_:1}),y(l,{class:g({placeholder:!k(M).insuranceExpireDate}),onClick:e[6]||(e[6]=a=>H("insuranceExpireDate",k(M).insuranceExpireDate,"交强险到期"))},{default:o((()=>[v(h(k(M).insuranceExpireDate||"请选择"),1)])),_:1},8,["class"]),y(n,{name:"arrow-right"})])),_:1})):I("",!0),y(l,{class:"form-item"},{default:o((()=>[y(l,null,{default:o((()=>[v("商业险")])),_:1}),y(l,{class:"f-b-c",onClick:e[7]||(e[7]=a=>F("商业险",k(j),k(M).commercialInsurance,"commercialInsurance"))},{default:o((()=>[y(t,null,{default:o((()=>[v(h(k(W)),1)])),_:1}),y(n,{name:"arrow-right"})])),_:1})])),_:1}),1==k(M).commercialInsurance?(_(),c(l,{key:1,class:"form-item"},{default:o((()=>[y(l,null,{default:o((()=>[v("商业险到期")])),_:1}),y(l,{class:g({placeholder:!k(M).commercialInsuranceData}),onClick:e[8]||(e[8]=a=>H("commercialInsuranceData",k(M).commercialInsuranceData,"交强险到期"))},{default:o((()=>[v(h(k(M).commercialInsuranceData||"请选择"),1)])),_:1},8,["class"]),y(n,{name:"arrow-right"})])),_:1})):I("",!0),y(l,{class:"form-item"},{default:o((()=>[y(l,null,{default:o((()=>[v("商业险金额")])),_:1}),y(u,{modelValue:k(M).commercialInsuranceAmount,"onUpdate:modelValue":e[9]||(e[9]=a=>k(M).commercialInsuranceAmount=a),type:"number",placeholder:"请输入",maxlength:"7",onInput:e[10]||(e[10]=a=>{return e=a.detail.value,l="commercialInsuranceAmount",void S((()=>{M[l]=L(e,"yuan")}));var e,l})},null,8,["modelValue"]),v(" 元 ")])),_:1}),y(l,{class:"form-textarea"},{default:o((()=>[y(l,{class:"area-title"},{default:o((()=>[v("备注")])),_:1}),y(s,{modelValue:k(M).remarkInfo,"onUpdate:modelValue":e[11]||(e[11]=a=>k(M).remarkInfo=a),placeholder:"请输入",maxlength:"1000"},null,8,["modelValue"]),y(l,{class:"limit"},{default:o((()=>{var a;return[v(h((null==(a=k(M).remarkInfo)?void 0:a.length)||0)+"/1000",1)]})),_:1})])),_:1})])),_:1}))])),_:1}),"SoldOut"!=k(N).status&&"Locked"!=k(N).status&&"ToBeSigned"!=k(N).status&&"PaymentIng"!=k(N).status?(_(),c(l,{key:0,class:"bottom-btn"},{default:o((()=>[y(r,{class:"save-btn w_100",onClick:G},{default:o((()=>[v("保存")])),_:1})])),_:1})):I("",!0),y(V,{show:k(A),modelValue:k(Y),"onUpdate:modelValue":e[12]||(e[12]=a=>E(Y)?Y.value=a:null),title:k(B),mode:"date",confirmColor:"#ff5719",minDate:k(w)().valueOf(),formatter:K,onCancel:e[13]||(e[13]=a=>A.value=!1),onConfirm:Z},null,8,["show","modelValue","title","minDate"])])),_:1})}}}),[["__scopeId","data-v-821ba5be"]]);export{M as default};
