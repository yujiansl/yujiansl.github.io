import{d as e,c as s,o as a,i as t,w as o,a as l,g as r,t as u,_ as i,r as n,B as d,E as c,X as p,Y as m,D as f,$ as v,a2 as _,y,ad as j,u as g,b as L,F as b,e as h,W as w,a1 as k}from"./index-CK4DGatK.js";import{L as C}from"./ListLoadRefreshView.CnNC2lkG.js";import{R as I}from"./refuse.BD_7bSsj.js";import{u as R}from"./useQuery.3dd8K18V.js";import{o as T}from"./omit.DzeQdT5l.js";import"./close.Dhgi5Ijg.js";import"./_baseGet.CmhOSbYr.js";import"./_getTag.DG-N9UUn.js";import"./isObject.C8HfsiHw.js";import"./isSymbol.Bym6OQCA.js";import"./_Uint8Array.B4mhORiM.js";import"./_baseClone.Cc-Y92km.js";const A=i(e({__name:"auditListItem",props:{item:{type:Object,default:{}}},setup:e=>(i,n)=>{const d=t;return a(),s(d,{class:"list-item"},{default:o((()=>[l(d,{class:"content"},{default:o((()=>[l(d,null,{default:o((()=>{var s;return[r("设备号： "+u((null==(s=e.item)?void 0:s.deviceCode)??"--"),1)]})),_:1}),l(d,{class:"pt-10"},{default:o((()=>{var s;return[r("设备信息： "+u((null==(s=e.item)?void 0:s.deviceInfo)??"--"),1)]})),_:1}),l(d,{class:"pt-10"},{default:o((()=>{var s;return[r(" 最后登录时间："+u((null==(s=e.item)?void 0:s.latestLoginTime)??"--"),1)]})),_:1})])),_:1})])),_:1})}}),[["__scopeId","data-v-259040a5"]]),B=i(e({__name:"audit",emits:["confirm"],setup(e,{emit:u}){const i=u,B=R(),x=n([]),D=n(),F=n({current:1,size:15,total:0});d((e=>{F.value.status=e.type,F.value.processApproval=e.processApproval,M()})),c((()=>{p("refreshList"),m("refreshList",(()=>{O()}))}));const M=async()=>{var e,s;console.log(B.value.id),(new f).showLoading("加载中");try{const e={...T(F.value,"total"),userId:B.value.userId},s=await v().get("product/applyBind/getUserLoginDevicePage",{params:e});F.value.total=+s.data.count;const a=s.data.results;x.value=1===F.value.current?a:[...x.value,...a]}finally{1==F.value.current&&(null==(e=D.value)||e.initTop()),null==(s=D.value)||s.loadFinish(),_()}},O=()=>{F.value.current=1,M()},S=()=>{F.value.current++,M()},U=n(),V=(e,s="")=>{var a;(new f).showLoading("提交中");const t={id:null==(a=B.value)?void 0:a.id,dealStatus:e,dealRemark:s};uni.$u.http.put("product/applyBind/dealApply",t).then((()=>{(new f).showToast("提交成功"),U.value.close(),setTimeout((()=>{k()}),1e3),i("confirm")}))};return(e,u)=>{const i=w,n=t;return a(),s(n,{class:"page f-c-s"},{default:o((()=>[l(C,j({ref_key:"listLoadRef",ref:D,class:"scroll-view-box",style:{marginBottom:"processed"==g(B).type?"0":"15%"}},g(F),{onLoadMore:S,onLoadRefresh:O}),{"list-cont":o((()=>[(a(!0),L(b,null,h(g(x),((e,t)=>(a(),s(A,{key:t,item:e,status:g(F).status,onConfirm:O},null,8,["item","status"])))),128))])),_:1},16,["style"]),"processed"!=g(B).type?(a(),s(n,{key:0,class:"bottom-btn"},{default:o((()=>[l(i,{onClick:u[0]||(u[0]=e=>g(U).open())},{default:o((()=>[r("拒绝")])),_:1}),l(i,{class:"save-btn",onClick:u[1]||(u[1]=e=>V(1))},{default:o((()=>[r("同意")])),_:1})])),_:1})):y("",!0),l(I,{ref_key:"refuseRef",ref:U,onConfirm:u[2]||(u[2]=e=>V(0,e))},null,512)])),_:1})}}}),[["__scopeId","data-v-b966bd35"]]);export{B as default};
