import{d as e,A as a,E as t,r as s,x as l,Z as i,a2 as n,c,w as o,i as u,I as r,aP as m,K as d,aQ as f,o as p,y as _,a as y,u as h,g,f as v,P as k,h as I,t as b,n as x,b as L,F as T,e as P,W as C,a8 as A,Q as D,D as w,a1 as N,_ as S}from"./index-CK4DGatK.js";import{_ as $}from"./camera.DDOxr1zP.js";import{_ as B}from"./card.DgxD9h_f.js";import{N as R}from"./NavBar.DSs5OGCU.js";import{M as O}from"./moreImage.BBFgcmqk.js";import{u as j}from"./useQuery.3dd8K18V.js";import"./image.DobRSNlT.js";import"./purchase.B8DNaFGL.js";import"./index.BP9c-u7r.js";const M=S(e({__name:"replyDetail",setup(e){const S=j(),M=a();t((()=>{Y(),K(),V()}));const U=s({}),E=s(),F=s([]),Q=l((()=>"noPayment"==U.value.paymentStatus)),G=l((()=>1===U.value.isReapply&&["cancel","revocation"].includes(U.value.paymentStatus))),K=()=>{uni.$u.http.post(`/product/purchase/paymentTrack/${S.value.paymentId}`).then((e=>{F.value=e.data||[]}))},V=()=>{uni.$u.http.get(`/product/carPricing/queryPurchaseImage/${S.value.purchaseId}`).then((e=>{const{violationPhotos:a,vehicleLicenseFrontPhoto:t,vehicleLicenseBackPhoto:s,registerCertificatePhotos:l,nameplatePhoto:i,idCardFrontPhoto:n,idCardBackPhoto:c,payAttachmentInfo:o,purchaseOther:u,repaymentList:r,maintenanceList:m,insuranceList:d,purchaseImageList:f,purchasseImageTagList:p,enterpriseBusinessLicenseImageList:_}=e.data,y=(e,a)=>{if(!e)return[];return(Array.isArray(e)?e:[e]).map((e=>({id:e.id,videoCover:e.videoCover,attachmentUrl:e.attachmentUrl,carAttachmentType:a,attachmentId:e.attachmentId})))};E.value=[...y(a,"VIOLATION"),...y(t,"VehicleLicense"),...y(s,"VehicleLicenseBack"),...y(l,"RegisterCertificate"),...y(i,"Nameplate"),...y(n,"ID_CARD_FRONT"),...y(c,"ID_CARD_BACK"),...y(o,"PRICING_PAYMENT_APPLY"),...y(u,"purchaseOther"),...y(r,"repayment"),...y(m,"maintenance"),...y(d,"insurance"),...y(_,"purchaseEnterpriseBusinessLicense"),{carAttachmentType:"carImage",imageList:[{tagName:"车辆照片",imageList:f},...p||[]]}]}))},Y=async()=>{i({title:"加载中",mask:!0});const e=await uni.$u.http.get(`/product/paymentOrder/paymentRecord/${S.value.paymentId}`);U.value=e.data||{},n()},q=e=>{A("carAttachments",JSON.stringify(E.value)),D(`/pages/carManage/photoManage?type=${e}&detail=1&isPurchase=1&purchaseId=${S.value.purchaseId}&itemType=${S.value.itemType}`)},J=l((()=>{var e,a,t,s;return(null==(s=null==(t=null==(a=null==(e=E.value)?void 0:e.filter((e=>["carImage"].includes(e.carAttachmentType)))[0])?void 0:a.imageList[0])?void 0:t.imageList[0])?void 0:s.attachmentUrl)||""})),W=l((()=>{var e,a;return(null==(a=null==(e=E.value)?void 0:e.filter((e=>["RegisterCertificate"].includes(e.carAttachmentType)))[0])?void 0:a.attachmentUrl)||""})),Z=l((()=>{var e,a;return(null==(a=null==(e=E.value)?void 0:e.filter((e=>["ID_CARD_FRONT","ID_CARD_BACK"].includes(e.carAttachmentType)))[0])?void 0:a.attachmentUrl)||""})),z=()=>{uni.$u.http.post(`/product/paymentOrder/revocationPayment/${S.value.paymentId}`).then((()=>{(new w).showToast("撤销成功"),N()}))},H=()=>{uni.$u.http,D(`/pages/purchaseOrder/addPayment?oldPaymentId=${U.value.paymentId}&editStatus=retry`)};return(e,a)=>{const t=u,s=k,l=I,i=r(d("up-steps-item"),m),n=r(d("up-steps"),f),A=C;return p(),c(t,{class:"purchase-detail detail"},{default:o((()=>[h(M).needShowQw()?_("",!0):(p(),c(R,{key:0,title:"付款单详情"})),y(t,{class:"content"},{default:o((()=>[y(t,{class:"photo-box"},{default:o((()=>[y(t,{class:"title"},{default:o((()=>[g("照片资料")])),_:1}),y(t,{class:"photo-item"},{default:o((()=>[y(t,{onClick:a[0]||(a[0]=e=>q(0)),style:v(`background-image:url(${h(J)})`)},{default:o((()=>[y(s,{src:$}),y(l,null,{default:o((()=>[g("车辆照片")])),_:1})])),_:1},8,["style"]),y(t,{onClick:a[1]||(a[1]=e=>q(1)),style:v(`background-image:url(${h(W)})`)},{default:o((()=>[y(s,{src:B}),y(l,null,{default:o((()=>[g("车辆登记证")])),_:1})])),_:1},8,["style"]),y(t,{onClick:a[2]||(a[2]=e=>q(2)),style:v(`background-image:url(${h(Z)})`)},{default:o((()=>[y(s,{src:B}),y(l,null,{default:o((()=>[g("车主身份证")])),_:1})])),_:1},8,["style"])])),_:1}),y(t,{class:"info-item"},{default:o((()=>[y(t,{class:"info-title"},{default:o((()=>[g("申请付款金额")])),_:1}),y(t,{class:"info-box"},{default:o((()=>[g(b(h(U).paymentPrice||"-"),1),h(U).paymentPrice?(p(),c(l,{key:0},{default:o((()=>[g("元")])),_:1})):_("",!0)])),_:1})])),_:1}),y(t,{class:"info-item"},{default:o((()=>[y(t,{class:"info-title"},{default:o((()=>[g("款项")])),_:1}),y(t,{class:"info-box"},{default:o((()=>[g(b(h(U).paymentTypeName||"-"),1)])),_:1})])),_:1}),y(t,{class:"info-item"},{default:o((()=>[y(t,{class:"info-title"},{default:o((()=>[g("收款对象")])),_:1}),y(t,{class:"info-box"},{default:o((()=>[g(b(1==h(U).recipient?"公司":2==h(U).recipient?"个人":"-"),1)])),_:1})])),_:1}),y(t,{class:"info-item"},{default:o((()=>[y(t,{class:"info-title"},{default:o((()=>[g("付款方式")])),_:1}),y(t,{class:"info-box"},{default:o((()=>[g(b(h(U).paymentMethodName||"-"),1)])),_:1})])),_:1}),y(t,{class:"info-item"},{default:o((()=>[y(t,{class:"info-title"},{default:o((()=>[g("是否本人")])),_:1}),y(t,{class:"info-box"},{default:o((()=>[g(b(1==h(U).isSelf?"是":"否"),1)])),_:1})])),_:1}),y(t,{class:"info-item"},{default:o((()=>[y(t,{class:"info-title"},{default:o((()=>[g("备注")])),_:1}),y(t,{class:"info-box"},{default:o((()=>[g(b(h(U).remark||"-"),1)])),_:1})])),_:1}),y(t,{class:"info-item"},{default:o((()=>[y(t,{class:"info-title"},{default:o((()=>[g("附件")])),_:1}),y(t,{class:"info-box imageBox"},{default:o((()=>[y(O,{imageData:h(U).attachmentList||[],tagName:"附件","show-tab":!1},null,8,["imageData"])])),_:1})])),_:1}),2==h(U).recipient&&0==h(U).isSelf?(p(),c(t,{key:0,class:"info-item"},{default:o((()=>[y(t,{class:x(["info-title",{wid120:h(U).consignmentCollectionImageList&&h(U).consignmentCollectionImageList.length>3}])},{default:o((()=>[g("委托收款证明")])),_:1},8,["class"]),y(t,{class:"info-box imageBox"},{default:o((()=>[y(O,{imageData:h(U).consignmentCollectionImageList||[],tagName:"委托收款证明","show-tab":!1},null,8,["imageData"])])),_:1})])),_:1})):_("",!0),"MORTGAGE_PAYMENT"==h(U).paymentType&&2==h(U).recipient&&0==h(U).isSelf?(p(),c(t,{key:1,class:"info-item"},{default:o((()=>[y(t,{class:x(["info-title",{wid120:h(U).settlementEepaymentImageList&&h(U).settlementEepaymentImageList.length>3}])},{default:o((()=>[g("还款结清证明")])),_:1},8,["class"]),y(t,{class:"info-box imageBox"},{default:o((()=>[y(O,{imageData:h(U).settlementEepaymentImageList||[],tagName:"还款结清证明","show-tab":!1},null,8,["imageData"])])),_:1})])),_:1})):_("",!0)])),_:1}),1==h(U).paymentMethod?(p(),c(t,{key:0,class:"wrap-box"},{default:o((()=>[y(t,{class:"wrap-title"},{default:o((()=>[g("银行卡信息")])),_:1}),y(t,{class:"info-item"},{default:o((()=>[y(t,{class:"info-title"},{default:o((()=>[g("户名")])),_:1}),y(t,{class:"info-box"},{default:o((()=>[g(b(h(U).payee||"-"),1)])),_:1})])),_:1}),y(t,{class:"info-item"},{default:o((()=>[y(t,{class:"info-title"},{default:o((()=>[g("银行卡号")])),_:1}),y(t,{class:"info-box"},{default:o((()=>[g(b(h(U).bankCardNumber||"-"),1)])),_:1})])),_:1}),y(t,{class:"info-item"},{default:o((()=>[y(t,{class:"info-title"},{default:o((()=>[g("银行")])),_:1}),y(t,{class:"info-box"},{default:o((()=>[g(b(h(U).openBank||"-"),1)])),_:1})])),_:1})])),_:1})):_("",!0),h(U).certificateList&&h(U).certificateList.length?(p(),c(t,{key:1,class:"wrap-box"},{default:o((()=>[y(t,{class:"wrap-title"},{default:o((()=>[g("审核信息")])),_:1}),y(t,{class:"info-item"},{default:o((()=>[y(t,{class:"info-title"},{default:o((()=>[g("付款凭证")])),_:1}),y(t,{class:"info-box imageBox"},{default:o((()=>[y(O,{imageData:h(U).certificateList||[],tagName:"付款凭证","show-tab":!1},null,8,["imageData"])])),_:1})])),_:1}),y(t,{class:"info-item"},{default:o((()=>[y(t,{class:"info-title"},{default:o((()=>[g("备注")])),_:1}),y(t,{class:"info-box"},{default:o((()=>[g(b(h(U).auditReason||"-"),1)])),_:1})])),_:1})])),_:1})):_("",!0),y(t,{class:"wrap-box"},{default:o((()=>[y(t,{class:"wrap-title"},{default:o((()=>[g("审核流程")])),_:1}),y(t,{class:"tracks"},{default:o((()=>[h(F).length>0?(p(),c(n,{key:0,class:"steps",activeColor:"#4177ff",direction:"column",current:h(F).length-1,dot:""},{default:o((()=>[(p(!0),L(T,null,P(h(F),((e,a)=>(p(),c(i,{key:a,class:x({"is-flex-col-center":!e.operateUser})},{icon:o((()=>{var a;return[y(s,{class:"avatar",src:(null==(a=null==e?void 0:e.operateUser)?void 0:a.avatar)||"/static/mine/avatar.png",mode:"scaleToFill"},null,8,["src"])]})),desc:o((()=>[y(t,{class:"descs"},{default:o((()=>{var a;return[y(t,{class:"d-title"},{default:o((()=>[y(l,null,{default:o((()=>[g(b(1==+e.operateType?"发起人":"revocation"===e.paymentStatus?"撤销审核":"财务审核"),1)])),_:2},1024),"cancel"===e.paymentStatus&&2==+e.operateType?(p(),c(l,{key:0,class:"cancel"},{default:o((()=>[g("已拒绝")])),_:1})):_("",!0),"paymentSuccess"!=e.paymentStatus&&"paymentAll"!=e.paymentStatus||2!=+e.operateType?_("",!0):(p(),c(l,{key:1,class:"agree"},{default:o((()=>[g("同意")])),_:1}))])),_:2},1024),"cancel"!=e.paymentStatus&&"paymentSuccess"!=e.paymentStatus&&"paymentAll"!=e.paymentStatus||2!=+e.operateType?_("",!0):(p(),c(t,{key:0,class:"comment"},{default:o((()=>["cancel"==e.paymentStatus?(p(),c(l,{key:0},{default:o((()=>[g("拒绝原因：")])),_:1})):_("",!0),g(b(e.comment||"-"),1)])),_:2},1024)),(null==(a=e.operateUser)?void 0:a.userId)?(p(),c(t,{key:1},{default:o((()=>[y(l,{class:"username"},{default:o((()=>[g(b(e.operateUser.name),1)])),_:2},1024),e.operateTime?(p(),c(l,{key:0},{default:o((()=>[g(b(e.operateTime),1)])),_:2},1024)):_("",!0)])),_:2},1024)):(p(),c(t,{key:2,style:{"min-height":"20px"}}))]})),_:2},1024)])),_:2},1032,["class"])))),128))])),_:1},8,["current"])):(p(),c(t,{key:1,class:"no-content"},{default:o((()=>[y(t,null,{default:o((()=>[g("暂无数据")])),_:1})])),_:1}))])),_:1})])),_:1})])),_:1}),h(U).canPayment&&(h(G)||h(Q))?(p(),c(t,{key:1,class:"bottom"},{default:o((()=>[h(Q)?(p(),c(A,{key:0,class:"revocation-btn",onClick:z},{default:o((()=>[y(s,{class:"btn-icon",src:"./static/index/icon_close_1.png",mode:"scaleToFill"}),g(" 撤销 ")])),_:1})):h(G)?(p(),c(A,{key:1,class:"restart-btn",onClick:H},{default:o((()=>[y(s,{class:"btn-icon",src:"./static/index/icon_restart_1.png",mode:"scaleToFill"}),g(" 重新发起 ")])),_:1})):_("",!0)])),_:1})):_("",!0)])),_:1})}}}),[["__scopeId","data-v-90a29a3e"]]);export{M as default};
