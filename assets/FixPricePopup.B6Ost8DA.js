import{j as e,a}from"./index.HDA2F_3Q.js";import{d as i,aY as l,m as s,r as t,p as r,I as n,a6 as o,K as u,ac as c,c as d,o as f,w as g,a as p,y as m,i as M,g as v,t as _,P,u as x,h as y,R as b,b as k,e as h,n as w,F as V,aj as j,W as F,s as B,D as S,_ as A}from"./index-CK4DGatK.js";import{_ as C}from"./close.Dhgi5Ijg.js";import{i as R}from"./isNil.aV-w2MPu.js";import{c as T}from"./cloneDeep.D7E8_JON.js";const U=A(i({__name:"FixPricePopup",props:l({title:{},info:{},state:{},showPricingPrice:{type:Boolean,default:!0},showBossAudit:{type:Boolean,default:!0}},{visible:{type:Boolean,required:!0},visibleModifiers:{}}),emits:l(["submit"],["update:visible"]),setup(i,{emit:l}){const A=i,U=l,I=s(i,"visible"),q=t({}),D=t({});r((()=>{q.value=I.value?T(A.state):{},D.value=I.value?T(A.state):{}}));const N=t([{key:!0,value:"是"},{key:!1,value:"否"}]),O=e=>R(e)||""===e;r((()=>{const{estimateSalePrice:e,pricingPriceMax:a,pricingPriceMin:i}=q.value;let l,s;if(0==e)return q.value.grossMarginMin=void 0,void(q.value.grossMarginMax=void 0);O(e)||(l=O(i)?void 0:(+e-+i)/+e*100,s=O(a)?void 0:(+e-+a)/+e*100),l&&(l=l.toFixed(2)),s&&(s=s.toFixed(2)),R(l)?(q.value.grossMarginMin=void 0,R(s)?q.value.grossMarginMax=void 0:q.value.grossMarginMax=s):R(s)?(q.value.grossMarginMin=void 0,q.value.grossMarginMax=void 0):(q.value.grossMarginMin=Math.min(l,s),q.value.grossMarginMax=Math.max(l,s))}));const W=(e,i,l)=>{B((()=>{e&&e.startsWith(".")?q.value[i]="":q.value[i]=a(e,l)}))},Y=e=>{const a=q.value.pricingPriceMin,i=q.value.pricingPriceMax;if(a&&i&&parseFloat(a)>parseFloat(i))return(new S).showToast("最高价必须大于最低价"),void B((()=>{"pricingPriceMin"==e?q.value.pricingPriceMin="":q.value.pricingPriceMax=""}))};function J(){O(q.value.pricingPriceMax)?(new S).showToast("请输入最高价"):parseFloat(q.value.pricingPriceMin||0)>parseFloat(q.value.pricingPriceMax)?(new S).showToast("最高价必须大于最低价"):O(q.value.estimateSalePrice)?(new S).showToast("请输入预估销售价"):U("submit",q.value)}return(a,i)=>{const l=M,s=P,t=y,r=n(u("up-input"),o),B=b,S=j,T=F,U=n(u("u-popup"),c);return f(),d(U,{mode:"bottom",round:20,closeOnClickOverlay:!0,show:I.value},{default:g((()=>[p(l,{class:"edit-box"},{default:g((()=>[p(l,{class:"head"},{default:g((()=>[p(l,null,{default:g((()=>[v(_(A.title),1)])),_:1}),p(s,{onClick:i[0]||(i[0]=e=>I.value=!1),class:"close-btn",src:C,mode:"aspectFill"})])),_:1}),p(l,{class:"form-item disabled"},{default:g((()=>[p(l,null,{default:g((()=>[v("预估金额")])),_:1}),A.info.forecastPriceMin||A.info.forecastPriceMax?(f(),d(l,{key:0},{default:g((()=>[v(_(("joinStr"in a?a.joinStr:x(e))([A.info.forecastPriceMin,A.info.forecastPriceMax],"-"))+"万元",1)])),_:1})):(f(),d(l,{key:1},{default:g((()=>[v("-")])),_:1}))])),_:1}),p(l,{class:"form-item disabled"},{default:g((()=>[p(l,null,{default:g((()=>[v("车主预期")])),_:1}),p(l,null,{default:g((()=>[v(_(A.info.budgetaryPrice?A.info.budgetaryPrice+"万元":"-"),1)])),_:1})])),_:1}),a.showPricingPrice?(f(),d(l,{key:0,class:"form-item disabled"},{default:g((()=>[p(l,null,{default:g((()=>[v("定价金额")])),_:1}),p(l,null,{default:g((()=>[v(_(("joinStr"in a?a.joinStr:x(e))([x(D).pricingPriceMin,x(D).pricingPriceMax],"-"))+"万元",1)])),_:1})])),_:1})):m("",!0),p(l,{class:"form-item"},{default:g((()=>[p(l,null,{default:g((()=>[p(t,null,{default:g((()=>[v("*")])),_:1}),v("定价金额")])),_:1}),p(l,{class:"customs"},{default:g((()=>[p(r,{type:"digit",inputAlign:"center",placeholder:"最低价",border:"bottom",modelValue:x(q).pricingPriceMin,"onUpdate:modelValue":[i[1]||(i[1]=e=>x(q).pricingPriceMin=e),i[2]||(i[2]=e=>W(e,"pricingPriceMin","wanyuan"))],onBlur:i[3]||(i[3]=e=>Y("pricingPriceMin"))},null,8,["modelValue"]),p(t,null,{default:g((()=>[v("-")])),_:1}),p(r,{type:"digit",inputAlign:"center",placeholder:"最高价",border:"bottom",modelValue:x(q).pricingPriceMax,"onUpdate:modelValue":[i[4]||(i[4]=e=>x(q).pricingPriceMax=e),i[5]||(i[5]=e=>W(e,"pricingPriceMax","wanyuan"))],onBlur:i[6]||(i[6]=e=>Y("pricingPriceMax"))},null,8,["modelValue"])])),_:1}),v(" 万元 ")])),_:1}),p(l,{class:"form-item"},{default:g((()=>[p(l,null,{default:g((()=>[p(t,null,{default:g((()=>[v("*")])),_:1}),v("预估销售价")])),_:1}),p(B,{modelValue:x(q).estimateSalePrice,"onUpdate:modelValue":i[7]||(i[7]=e=>x(q).estimateSalePrice=e),type:"digit",placeholder:"请输入",onInput:i[8]||(i[8]=e=>W(e.detail.value,"estimateSalePrice","wanyuan"))},null,8,["modelValue"]),v("万元 ")])),_:1}),p(l,{class:"form-item disabled"},{default:g((()=>[p(l,null,{default:g((()=>[v("毛利率")])),_:1}),x(R)(x(q).grossMarginMin)&&x(R)(x(q).grossMarginMax)?(f(),d(l,{key:0,style:{flex:"1"}},{default:g((()=>[v("%")])),_:1})):(f(),d(l,{key:1,style:{flex:"1"}},{default:g((()=>[x(R)(x(q).grossMarginMin)?m("",!0):(f(),d(t,{key:0},{default:g((()=>[v(_(x(q).grossMarginMin)+"%",1)])),_:1})),x(R)(x(q).grossMarginMax)||x(R)(x(q).grossMarginMin)?m("",!0):(f(),d(t,{key:1},{default:g((()=>[v(" ~ ")])),_:1})),x(R)(x(q).grossMarginMax)?m("",!0):(f(),d(t,{key:2},{default:g((()=>[v(_(x(q).grossMarginMax)+"%",1)])),_:1}))])),_:1}))])),_:1}),A.showBossAudit?(f(),d(l,{key:1,class:"form-item"},{default:g((()=>[p(l,null,{default:g((()=>[v("是否上级审核")])),_:1}),p(l,{class:"tab-box"},{default:g((()=>[(f(!0),k(V,null,h(x(N),((e,a)=>(f(),d(t,{key:a,class:w({active:x(q).needBossAudit==e.key}),onClick:a=>x(q).needBossAudit=e.key},{default:g((()=>[v(_(e.value),1)])),_:2},1032,["class","onClick"])))),128))])),_:1})])),_:1})):m("",!0),p(l,{class:"form-textarea"},{default:g((()=>[p(l,{class:"area-title"},{default:g((()=>[v("备注")])),_:1}),p(S,{modelValue:x(q).pricingRemark,"onUpdate:modelValue":i[9]||(i[9]=e=>x(q).pricingRemark=e),placeholder:"请输入",maxlength:"1000"},null,8,["modelValue"]),p(l,{class:"limit"},{default:g((()=>{var e;return[v(_((null==(e=x(q).pricingRemark)?void 0:e.length)||0)+"/1000",1)]})),_:1})])),_:1}),p(T,{onClick:J},{default:g((()=>[v("提交")])),_:1})])),_:1})])),_:1},8,["show"])}}}),[["__scopeId","data-v-aa95e50b"]]);export{U as F};
