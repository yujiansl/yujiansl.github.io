import{g as e}from"./time._VqwKl0d.js";import{d as a,c as t,o as l,w as s,a as u,i as r,P as d,g as i,t as n,y as o,h as c,u as v,Q as m,_ as f,A as _,x as p,r as b,E as y,Z as g,a2 as x,$ as h,b as k,F as B,I as C,ah as S,K as T,W as I,a0 as w}from"./index-CK4DGatK.js";import{_ as j}from"./car_default.CyENNAub.js";import{m as F,d as $,e as P}from"./state.B0y7zlHh.js";import{u as M}from"./useQuery.3dd8K18V.js";const N=f(a({__name:"purchaseCard",props:{item:{type:Object,default:{}}},setup(a){const f=a,_=()=>{var e;m(`/pages/carManage/details/index?id=${null==(e=f.item)?void 0:e.carProductId}`)};return(a,m)=>{const p=d,b=r,y=c;return l(),t(b,{class:"list-item",onClick:_},{default:s((()=>[u(b,{class:"content"},{default:s((()=>{var e,a;return[(null==(e=f.item)?void 0:e.coverUrl)?(l(),t(p,{key:0,src:null==(a=f.item)?void 0:a.coverUrl,mode:"aspectFill"},null,8,["src"])):(l(),t(p,{key:1,src:j,mode:"aspectFill"})),u(b,null,{default:s((()=>[u(b,{class:"name"},{default:s((()=>{var e;return[i(n(null==(e=f.item)?void 0:e.carModelFullName),1)]})),_:1}),u(b,{class:"tags"},{default:s((()=>{var e,a;return[(null==(e=f.item)?void 0:e.uetoDate)?(l(),t(y,{key:0},{default:s((()=>{var e,a;return[i(n(null==(a=null==(e=f.item)?void 0:e.uetoDate)?void 0:a.substring(0,7)),1)]})),_:1})):o("",!0),u(y,null,{default:s((()=>{var e;return[i(n((null==(e=f.item)?void 0:e.mileage)||0)+"万公里",1)]})),_:1}),(null==(a=f.item)?void 0:a.bodyColor)?(l(),t(y,{key:1},{default:s((()=>{var e;return[i(n(null==(e=f.item)?void 0:e.bodyColor),1)]})),_:1})):o("",!0)]})),_:1}),u(b,{class:"vin"},{default:s((()=>{var e;return[i(n(null==(e=f.item)?void 0:e.vinNo),1)]})),_:1})])),_:1})]})),_:1}),u(b,{class:"fix-info"},{default:s((()=>[u(b,null,{default:s((()=>{var t;return[i("采购时间: "+n(("getTimeBySplitSecond"in a?a.getTimeBySplitSecond:v(e))(null==(t=f.item)?void 0:t.purchaseTime)),1)]})),_:1}),u(b,null,{default:s((()=>{var e;return[i("采购员: "+n((null==(e=f.item)?void 0:e.createByName)??"--"),1)]})),_:1})])),_:1})])),_:1})}}}),[["__scopeId","data-v-cfe6f25a"]]),D=f(a({__name:"details",setup(a){const d=_(),c=p((()=>d.userInfo)),f=M(),j=b(),D=b();async function O(){if(!f.value.id)return;const e={id:f.value.id},a=await h().get(F.selectById,{params:e});j.value=null==a?void 0:a.data,async function(){if(!j.value.orderId)return;const e=await h().get(`/product/purchaseOrder/${j.value.orderId}`);D.value=null==e?void 0:e.data}()}y((async()=>{g({title:"加载中",mask:!0});try{O()}finally{x()}}));const Q=()=>{var e,a;m(`/pagesC/myPurchase/addPurchase?type=${1===(null==(e=j.value)?void 0:e.status)?"edit":"again"}&id=${null==(a=j.value)?void 0:a.id}`)},U=b(!1),Z=()=>{g({title:"取消中",mask:!0});const e={id:f.value.id};uni.$u.http.get(F.cancelThePurchase,{params:e}).then((()=>{w({title:"操作成功",icon:"none"}),U.value=!1,O(),x()}))};return(a,d)=>{const m=r,_=I,p=C(T("up-modal"),S);return l(),k(B,null,[u(m,{class:"page f-c-s"},{default:s((()=>{var r,p,b;return[u(m,{class:"content"},{default:s((()=>{var r,d;return[u(m,{class:"card-box"},{default:s((()=>[u(m,{class:"card-title"},{default:s((()=>{var e;return[i(n((null==(e=v(j))?void 0:e.carBrand)??"--"),1)]})),_:1}),u(m,{class:"basic-text pt-16"},{default:s((()=>{var e;return[i(n((null==(e=v(j))?void 0:e.carModel)??"--"),1)]})),_:1})])),_:1}),u(m,{class:"card-box"},{default:s((()=>[u(m,{class:"box-item"},{default:s((()=>[u(m,{class:"item-label"},{default:s((()=>[i("里程")])),_:1}),u(m,{class:"item-tag"},{default:s((()=>{var e;return[i(n(v($)[+(null==(e=v(j))?void 0:e.mileage)]),1)]})),_:1})])),_:1}),u(m,{class:"box-item"},{default:s((()=>[u(m,{class:"item-label"},{default:s((()=>[i("车况")])),_:1}),u(m,{class:"item-tag"},{default:s((()=>{var e;return[i(n(v(P)[+(null==(e=v(j))?void 0:e.carCondition)]),1)]})),_:1})])),_:1}),u(m,{class:"item-label pt-26"},{default:s((()=>[i("备注")])),_:1}),u(m,{class:"basic-text pt-16"},{default:s((()=>{var e;return[i(n((null==(e=v(j))?void 0:e.notes)||"--"),1)]})),_:1})])),_:1}),u(m,{class:"card-box"},{default:s((()=>{var r;return[u(m,{class:"card-title",style:{"padding-bottom":"14rpx"}},{default:s((()=>[i("其他信息")])),_:1}),3===(null==(r=v(j))?void 0:r.status)?(l(),t(m,{key:0,class:"box-item no-border-bottom"},{default:s((()=>[u(m,{class:"item-label"},{default:s((()=>[i("取消时间")])),_:1}),u(m,{class:"item-value"},{default:s((()=>{var t;return[i(n(("getTimeBySplitSecond"in a?a.getTimeBySplitSecond:v(e))(null==(t=v(j))?void 0:t.updateTime)),1)]})),_:1})])),_:1})):o("",!0),u(m,{class:"box-item no-border-bottom"},{default:s((()=>[u(m,{class:"item-label"},{default:s((()=>[i("创建时间")])),_:1}),u(m,{class:"item-value"},{default:s((()=>{var t;return[i(n(("getTimeBySplitSecond"in a?a.getTimeBySplitSecond:v(e))(null==(t=v(j))?void 0:t.createTime)),1)]})),_:1})])),_:1}),u(m,{class:"box-item no-border-bottom"},{default:s((()=>[u(m,{class:"item-label"},{default:s((()=>[i("创建人")])),_:1}),u(m,{class:"item-value"},{default:s((()=>{var e;return[i(n((null==(e=v(j))?void 0:e.createByName)??"--"),1)]})),_:1})])),_:1})]})),_:1}),2===(null==(r=v(j))?void 0:r.status)&&(null==(d=v(j))?void 0:d.orderId)?(l(),t(m,{key:0,class:"card-box"},{default:s((()=>[u(m,{class:"card-title"},{default:s((()=>[i("采购信息")])),_:1}),u(N,{item:v(D)},null,8,["item"])])),_:1})):o("",!0)]})),_:1}),(null==(r=v(c))?void 0:r.userId)===(null==(p=v(j))?void 0:p.createBy)&&"vehicleDemand"!==(null==(b=v(f))?void 0:b.page)?(l(),t(m,{key:0,class:"bottom-btn"},{default:s((()=>{var e;return[1===(null==(e=v(j))?void 0:e.status)?(l(),t(_,{key:0,onClick:d[0]||(d[0]=e=>U.value=!0)},{default:s((()=>[i("取消求购")])),_:1})):o("",!0),u(_,{class:"save-btn",onClick:Q},{default:s((()=>{var e;return[i(n(1===(null==(e=v(j))?void 0:e.status)?"编辑":"重新求购"),1)]})),_:1})]})),_:1})):o("",!0)]})),_:1}),u(p,{title:"取消求购",width:"540rpx",show:v(U),showCancelButton:!0,onConfirm:Z,onCancel:d[1]||(d[1]=e=>U.value=!1),confirmColor:"#FF4500",cancelText:"返回",confirmText:"取消求购",content:"是否确认取消求购此车型?"},null,8,["show"])],64)}}}),[["__scopeId","data-v-2880b135"]]);export{D as default};
