import{d as e,a9 as a,r as l,B as s,b2 as t,E as o,X as d,Y as n,x as r,c,w as m,i as u,I as i,M as p,K as f,o as _,a as g,g as N,h as k,R as h,u as y,Q as I,n as U,t as b,S as x,y as C,b as v,F as w,e as V,W as F,a0 as D,$ as P,a1 as $,_ as j}from"./index-CK4DGatK.js";import{u as M}from"./useQuery.3dd8K18V.js";const S=j(e({__name:"addUser",setup(e){const j=M(),S=a({username:"",password:"",name:"",phone:"",role:[],roleName:"",post:[],postName:"",deptId:"",deptName:"",leaderUserId:"",leaderUserName:"",email:"",nickname:"",lockFlag:"0"}),B=()=>{setTimeout((()=>{S.phone=S.phone.replace(/[^0-9]/g,"")}))};l(!0);const O=()=>{S.role=[],S.roleName=""},J=()=>{S.post=[],S.postName=""},R=()=>{S.deptId="",S.deptName=""},L=()=>{S.leaderUserName="",S.leaderUserId=""},Q=l([{key:"0",value:"启用"},{key:"9",value:"禁用"}]);s((e=>{e.id&&(T(e.id),t({title:"修改员工"}))})),o((()=>{d("fixRoleData"),n("fixRoleData",(e=>{const{name:a,id:l}=e;S.roleName=a,S.role=l})),d("postData"),n("postData",(e=>{const{name:a,id:l}=e;S.postName=a,S.post=[l]})),d("deptData"),n("deptData",(e=>{const{name:a,id:l}=e;S.deptName=a,S.deptId=l,console.log(l,"jianting")})),d("leaderData"),n("leaderData",(e=>{const{name:a,id:l}=e;S.leaderUserName=a,S.leaderUserId=l}))}));const T=e=>{uni.$u.http.get(`admin/user/details/${e}`).then((e=>{const{username:a,name:l,realPhone:s,roleList:t,postList:o,deptId:d,deptName:n,leaderUserId:r,leaderUserName:c,email:m,nickname:u,lockFlag:i,userId:p}=e.data;S.username=a,S.password="******",S.name=l,S.phone=s,S.role=t.map((e=>e.roleId)),S.roleName=t.map((e=>e.roleName)).join(","),S.post=o.map((e=>e.postId)),S.postName=o.map((e=>e.postName)).join(","),S.deptId=d,S.deptName=n,S.leaderUserId=r,S.leaderUserName=c,S.email=m,S.nickname=u,S.lockFlag=i,S.userId=p}))};r((()=>E(CustomerSource.value,S.orderCarCustomerDetailDTO.customerSource)));const E=(e,a,l="")=>{const s=null==e?void 0:e.filter((e=>e.key==a));return(null==s?void 0:s.length)?s[0].value+l:"请选择"},K=async()=>{const{username:e,password:a,name:l,phone:s,role:t,post:o,deptId:d,leaderUserId:n,lockFlag:r}=S;if(!(l&&s&&d&&n&&r&&t.length&&o.length))return void D({title:"请完善必填字段",icon:"none"});delete S.username,delete S.password;const c=JSON.parse(JSON.stringify(S));j.value.id?await P().put("/admin/user",c):await P().post("/admin/user",c),D({title:j.value.id?"修改成功":"新增成功",mask:!0}),$()};return(e,a)=>{const l=u,s=k,t=h,o=i(f("up-icon"),p),d=F;return _(),c(l,{class:"page f-c-s"},{default:m((()=>[g(l,{class:"content"},{default:m((()=>[g(l,{class:"section-title"},{default:m((()=>[N("账号信息")])),_:1}),g(l,{class:"form-box"},{default:m((()=>[g(l,{class:"form-item"},{default:m((()=>[g(l,null,{default:m((()=>[g(s,null,{default:m((()=>[N("*")])),_:1}),N("姓名")])),_:1}),g(t,{modelValue:y(S).name,"onUpdate:modelValue":a[0]||(a[0]=e=>y(S).name=e),type:"text",placeholder:"请输入"},null,8,["modelValue"])])),_:1}),g(l,{class:"form-item"},{default:m((()=>[g(l,null,{default:m((()=>[g(s,null,{default:m((()=>[N("*")])),_:1}),N("手机号")])),_:1}),g(t,{modelValue:y(S).phone,"onUpdate:modelValue":a[1]||(a[1]=e=>y(S).phone=e),type:"number",placeholder:"请输入",onInput:B},null,8,["modelValue"])])),_:1}),g(l,{class:"form-item"},{default:m((()=>[g(l,null,{default:m((()=>[g(s,null,{default:m((()=>[N("*")])),_:1}),N("角色")])),_:1}),g(l,{class:"f-b-c elis-box",onClick:a[2]||(a[2]=a=>("toPage"in e?e.toPage:y(I))(`/pagesB/employeeManage/employeeFilter?title=角色&id=${y(S).role.join(",")}&name=${y(S).roleName}`))},{default:m((()=>[g(s,{class:U(["elis",{placeholder:!y(S).roleName}])},{default:m((()=>[N(b(y(S).roleName||"请选择"),1)])),_:1},8,["class"]),g(l,{class:"has-close"},{default:m((()=>[g(s,{class:"close",onClick:x(O,["stop"])},{default:m((()=>[y(S).roleName?(_(),c(o,{key:0,name:"close-circle-fill",color:"#999"})):C("",!0)])),_:1}),g(o,{name:"arrow-right"})])),_:1})])),_:1})])),_:1}),g(l,{class:"form-item"},{default:m((()=>[g(l,null,{default:m((()=>[g(s,null,{default:m((()=>[N("*")])),_:1}),N("岗位")])),_:1}),g(l,{class:"f-b-c elis-box",onClick:a[3]||(a[3]=a=>("toPage"in e?e.toPage:y(I))(`/pagesB/employeeManage/employeeFilter?title=岗位&id=${y(S).post.join(",")}`))},{default:m((()=>[g(s,{class:U(["elis",{placeholder:!y(S).postName}])},{default:m((()=>[N(b(y(S).postName||"请选择"),1)])),_:1},8,["class"]),g(l,{class:"has-close"},{default:m((()=>[g(s,{class:"close",onClick:x(J,["stop"])},{default:m((()=>[y(S).postName?(_(),c(o,{key:0,name:"close-circle-fill",color:"#999"})):C("",!0)])),_:1}),g(o,{name:"arrow-right"})])),_:1})])),_:1})])),_:1}),g(l,{class:"form-item"},{default:m((()=>[g(l,null,{default:m((()=>[g(s,null,{default:m((()=>[N("*")])),_:1}),N("部门")])),_:1}),g(l,{class:"f-b-c elis-box",onClick:a[4]||(a[4]=a=>("toPage"in e?e.toPage:y(I))(`/pagesB/employeeManage/deptFilter?checkId=${JSON.stringify([{name:y(S).deptName,id:y(S).deptId}])}`))},{default:m((()=>[g(s,{class:U(["elis",{placeholder:!y(S).deptName}])},{default:m((()=>[N(b(y(S).deptName||"请选择"),1)])),_:1},8,["class"]),g(l,{class:"has-close"},{default:m((()=>[g(s,{class:"close",onClick:x(R,["stop"])},{default:m((()=>[y(S).deptName?(_(),c(o,{key:0,name:"close-circle-fill",color:"#999"})):C("",!0)])),_:1}),g(o,{name:"arrow-right"})])),_:1})])),_:1})])),_:1}),g(l,{class:"form-item"},{default:m((()=>[g(l,null,{default:m((()=>[g(s,null,{default:m((()=>[N("*")])),_:1}),N("上级领导")])),_:1}),g(l,{class:"f-b-c elis-box",onClick:a[5]||(a[5]=a=>("toPage"in e?e.toPage:y(I))(`/pagesB/employeeManage/employeeFilter?title=上级领导&id=${y(S).leaderUserId}`))},{default:m((()=>[g(s,{class:U(["elis",{placeholder:!y(S).leaderUserName}])},{default:m((()=>[N(b(y(S).leaderUserName||"请选择"),1)])),_:1},8,["class"]),g(l,{class:"has-close"},{default:m((()=>[g(s,{class:"close",onClick:x(L,["stop"])},{default:m((()=>[y(S).leaderUserName?(_(),c(o,{key:0,name:"close-circle-fill",color:"#999"})):C("",!0)])),_:1}),g(o,{name:"arrow-right"})])),_:1})])),_:1})])),_:1}),g(l,{class:"form-item"},{default:m((()=>[g(l,null,{default:m((()=>[N("邮箱")])),_:1}),g(t,{modelValue:y(S).email,"onUpdate:modelValue":a[6]||(a[6]=e=>y(S).email=e),type:"text",placeholder:"请输入"},null,8,["modelValue"])])),_:1}),g(l,{class:"form-item"},{default:m((()=>[g(l,null,{default:m((()=>[N("昵称")])),_:1}),g(t,{modelValue:y(S).nickname,"onUpdate:modelValue":a[7]||(a[7]=e=>y(S).nickname=e),type:"text",placeholder:"请输入"},null,8,["modelValue"])])),_:1}),g(l,{class:"form-item"},{default:m((()=>[g(l,null,{default:m((()=>[g(s,null,{default:m((()=>[N("*")])),_:1}),N("启用")])),_:1}),g(l,{class:"tab-box"},{default:m((()=>[(_(!0),v(w,null,V(y(Q),((e,a)=>(_(),c(s,{key:a,class:U({active:y(S).lockFlag==e.key}),onClick:a=>y(S).lockFlag=e.key},{default:m((()=>[N(b(e.value),1)])),_:2},1032,["class","onClick"])))),128))])),_:1})])),_:1})])),_:1})])),_:1}),g(l,{class:"bottom-btn"},{default:m((()=>[g(d,{class:"save-btn w_100",onClick:K},{default:m((()=>[N("保存")])),_:1})])),_:1})])),_:1})}}}),[["__scopeId","data-v-94f5339a"]]);export{S as default};
