import{d as e,a9 as a,r as l,x as t,E as s,X as r,Y as o,B as n,b2 as u,c as d,w as c,i,I as m,M as f,K as _,ac as p,o as v,a as g,a5 as R,y as b,b as y,u as h,k,g as N,h as D,R as w,Q as S,n as T,t as x,aj as $,W as I,F as C,e as M,a1 as B,D as F,_ as V}from"./index-CK4DGatK.js";import{c as K}from"./carSelect-emit.CejlvgP5.js";import"./event.CJk5hinv.js";const U=V(e({__name:"addReception",setup(e){const V=a({userName:"",carBrandId:"",carSeriesId:"",arriveStoreTime:"",budgetRange:"",noDealReason:"",noDealReasonRemark:""}),U=l(!1),j=l("noDealReason"),L=a({arriveList:[],range:[],reason:[]}),P=t((()=>L[j.value])),E=e=>{j.value=e,U.value=!0},O=a({carModelFullName:""});s((()=>{r("pickData"),o("pickData",(e=>{const{key:a,subKey:l,tKey:t}=e;t?V[l][t]=a:V[l]=a}))}));const Y=()=>{B()},q=async()=>{const e=V.userName?O.carModelFullName?V.arriveStoreTime?V.budgetRange?V.noDealReason?V.noDealReasonRemark?void 0:"请输入未成交详细原因":"请选择未成交原因":"请选择预算区间":"请选择客户到店次数":"请选择车型":"请输入客户姓名";if(e)return void(new F).showToast(e);const a={...V};try{await uni.$u.http.post("/product/car/customer/reception",a),(new F).showToast("新增成功"),setTimeout((()=>{B()}),500)}catch(l){console.error(l,"error----")}},z=(e,a,l="")=>{const t=null==e?void 0:e.filter((e=>e.value==a));return(null==t?void 0:t.length)?t[0].label+l:(a&&l?a+l:"")||"请选择"},J=t((()=>z(L.arriveList,V.arriveStoreTime))),Q=t((()=>z(L.budgetRange,V.budgetRange))),W=t((()=>z(L.noDealReason,V.noDealReason)));K.onEvent((({data:e})=>{X(e)}));const X=e=>{const{brandId:a,brandName:l,seriesId:t,seriesName:s,modelId:r,modelName:o,carYear:n}=e;V.carBrandId=a,V.carSeriesId=t,V.carModelId=r,O.carModelFullName=`${l} ${s} ${o}`},A=l({}),G=l(!0),H=l(!0);return n((e=>{e.id?(H.value=e.id,G.value=!1,u({title:G.value?"新增客户接待":"客户接待情况"}),(async()=>{try{const e=await uni.$u.http.get(`/product//car/customer/reception/${H.value}`);A.value=e.data}catch(e){A.value={userName:"昝癸霖",carBrandId:"1864998207317090305",carSeriesId:"1864998499995627521",arriveStoreTime:1,budgetRange:1,noDealReason:1,arriveStoreTimeName:"第1次",budgetRangeName:"10万以下",noDealReasonName:"价格",sellUserId:"1836223101408333825",sellUserName:"小胡姓名",noDealReasonRemark:"aliquip dolor",carSeriesName:"212 T01",carBrandName:"212",createTime:"2025-05-07 13:52:46"},console.error(e,"error----")}})()):(async()=>{try{const e=await Promise.all([uni.$u.http.get("/admin/dict/type/customer_reception_arrive_store_time"),uni.$u.http.get("/admin/dict/type/customer_reception_budget_range"),uni.$u.http.get("/admin/dict/type/customer_reception_no_deal_reason")]);L.arriveList=e[0].data.filter((e=>"11"!=e.value)),L.budgetRange=e[1].data,L.noDealReason=e[2].data}catch(e){console.error(e,"error----")}})()})),(e,a)=>{const l=D,t=i,s=w,r=m(_("up-icon"),f),o=$,n=I,u=R,B=m(_("up-popup"),p);return v(),d(t,{class:"page f-c-s"},{default:c((()=>[g(u,{"scroll-y":"",class:"scroll-view-box","enable-flex":"",style:{height:"100%"}},{default:c((()=>[g(t,{class:"content scroll-view-box"},{default:c((()=>[h(G)?(v(),d(t,{key:0,class:"form-box"},{default:c((()=>[k("div",{class:"form-item input-complete"},[g(t,null,{default:c((()=>[N("客户姓名 "),g(l,null,{default:c((()=>[N("*")])),_:1})])),_:1}),g(s,{modelValue:h(V).userName,"onUpdate:modelValue":a[0]||(a[0]=e=>h(V).userName=e),placeholder:"请输入"},null,8,["modelValue"])]),g(t,{class:"form-item"},{default:c((()=>[g(t,null,{default:c((()=>[N(" 客户需求车型 "),g(l,null,{default:c((()=>[N("*")])),_:1})])),_:1}),g(t,{class:"f-b-c",onClick:a[1]||(a[1]=a=>("toPage"in e?e.toPage:h(S))("/pages/assess/carSelect?selectType=model"))},{default:c((()=>[g(t,{class:T({placeholder:!h(O).carModelFullName})},{default:c((()=>[N(x(h(O).carModelFullName||"请选择"),1)])),_:1},8,["class"]),g(r,{name:"arrow-right"})])),_:1})])),_:1}),g(t,{class:"form-item"},{default:c((()=>[g(t,null,{default:c((()=>[N(" 客户到店次数 "),g(l,null,{default:c((()=>[N("*")])),_:1})])),_:1}),g(t,{class:"f-b-c",onClick:a[2]||(a[2]=e=>{return a="客户到店次数",l=h(L).arriveList,t=h(V).arriveStoreTime,s="arriveStoreTime",r="",void S(`/pages/customerReception/pagePicker?title=${a}&list=${JSON.stringify(l)}&key=${t}&subKey=${s}&tKey=${r}`);var a,l,t,s,r})},{default:c((()=>[g(t,{class:T({placeholder:"请选择"==h(J)})},{default:c((()=>[N(x(h(J)),1)])),_:1},8,["class"]),g(r,{name:"arrow-right"})])),_:1})])),_:1}),g(t,{class:"form-item"},{default:c((()=>[g(t,null,{default:c((()=>[N(" 客户预算区间 "),g(l,null,{default:c((()=>[N("*")])),_:1})])),_:1}),g(t,{class:"f-b-c",onClick:a[3]||(a[3]=e=>E("budgetRange"))},{default:c((()=>[g(t,{class:T({placeholder:"请选择"==h(Q)})},{default:c((()=>[N(x(h(Q)),1)])),_:1},8,["class"]),g(r,{name:"arrow-right"})])),_:1})])),_:1}),g(t,{class:"form-item"},{default:c((()=>[g(t,null,{default:c((()=>[N(" 未成交原因 "),g(l,null,{default:c((()=>[N("*")])),_:1})])),_:1}),g(t,{class:"f-b-c",onClick:a[4]||(a[4]=e=>E("noDealReason"))},{default:c((()=>[g(t,{class:T({placeholder:"请选择"==h(W)})},{default:c((()=>[N(x(h(W)),1)])),_:1},8,["class"]),g(r,{name:"arrow-right"})])),_:1})])),_:1}),g(t,{class:"form-item flex-col"},{default:c((()=>[g(t,{class:"inventory-title"},{default:c((()=>[N("未成交详细原因 "),g(l,null,{default:c((()=>[N("*")])),_:1})])),_:1}),g(o,{modelValue:h(V).noDealReasonRemark,"onUpdate:modelValue":a[5]||(a[5]=e=>h(V).noDealReasonRemark=e),modelModifiers:{trim:!0},placeholder:"请输入",maxlength:"300"},null,8,["modelValue"]),g(t,{class:"limit"},{default:c((()=>{var e;return[N(x((null==(e=h(V).noDealReasonRemark)?void 0:e.length)||0)+"/300",1)]})),_:1})])),_:1})])),_:1})):(v(),d(t,{key:1,class:"form-box"},{default:c((()=>[k("div",{class:"form-item input-complete"},[g(t,null,{default:c((()=>[N("客户姓名")])),_:1}),g(t,null,{default:c((()=>[N(x(h(A).userName||"-"),1)])),_:1})]),g(t,{class:"form-item"},{default:c((()=>[g(t,null,{default:c((()=>[N(" 客户需求车型")])),_:1}),g(t,null,{default:c((()=>[N(x(h(A).carBrandName+h(A).carSeriesName||"-"),1)])),_:1})])),_:1}),g(t,{class:"form-item"},{default:c((()=>[g(t,null,{default:c((()=>[N(" 客户到店次数")])),_:1}),g(t,null,{default:c((()=>[N(x(h(A).arriveStoreTimeName||"-"),1)])),_:1})])),_:1}),g(t,{class:"form-item"},{default:c((()=>[g(t,null,{default:c((()=>[N(" 客户预算区间")])),_:1}),g(t,null,{default:c((()=>[N(x(h(A).budgetRangeName||"-"),1)])),_:1})])),_:1}),g(t,{class:"form-item"},{default:c((()=>[g(t,null,{default:c((()=>[N(" 未成交原因")])),_:1}),g(t,null,{default:c((()=>[N(x(h(A).noDealReasonName||"-"),1)])),_:1})])),_:1}),g(t,{class:"form-item flex-col"},{default:c((()=>[g(t,{class:"inventory-title"},{default:c((()=>[N("未成交详细原因")])),_:1}),g(t,{style:{"padding-left":"40rpx"}},{default:c((()=>[N(x(h(A).noDealReasonRemark||"-"),1)])),_:1})])),_:1})])),_:1})),h(G)?b("",!0):(v(),y("div",{key:2,class:"line"})),h(G)?b("",!0):(v(),y("div",{key:3,class:"form-box"},[g(t,{class:"form-item"},{default:c((()=>[g(t,null,{default:c((()=>[N(" 提交时间")])),_:1}),g(t,null,{default:c((()=>[N(x(h(A).createTime||"-"),1)])),_:1})])),_:1}),g(t,{class:"form-item"},{default:c((()=>[g(t,null,{default:c((()=>[N(" 提交人")])),_:1}),g(t,null,{default:c((()=>[N(x(h(A).sellUserName||"-"),1)])),_:1})])),_:1})]))])),_:1}),h(G)?(v(),d(t,{key:0,class:"bottom-btn"},{default:c((()=>[g(n,{onClick:Y},{default:c((()=>[N("取消")])),_:1}),g(n,{class:"save-btn",onClick:a[6]||(a[6]=e=>q())},{default:c((()=>[N("确定")])),_:1})])),_:1})):b("",!0)])),_:1}),g(B,{show:h(U),mode:"bottom",round:"10",onClose:a[7]||(a[7]=e=>U.value=!1),onOpen:a[8]||(a[8]=e=>U.value=!0)},{default:c((()=>[g(t,{class:"range-box"},{default:c((()=>[(v(!0),y(C,null,M(h(P),(e=>(v(),d(t,{class:"range-item",key:e.value,onClick:a=>(e=>{V[j.value]=e.value,U.value=!1})(e)},{default:c((()=>[N(x(e.label),1)])),_:2},1032,["onClick"])))),128))])),_:1})])),_:1},8,["show"])])),_:1})}}}),[["__scopeId","data-v-4a309bba"]]);export{U as default};
