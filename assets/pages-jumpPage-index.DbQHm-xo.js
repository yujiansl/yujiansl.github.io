import{d as t,A as e,q as n,bN as s,D as r,aE as a,b3 as o,bz as i,c,bG as u,o as l,i as d}from"./index-CK4DGatK.js";import{u as p}from"./useQuery.3dd8K18V.js";const g=t({__name:"index",setup(t){const g=e().loginInfo.user_id,f=p(),h=async()=>{let t={};try{t=JSON.parse(JSON.stringify(f.value))}catch(n){t={}}t.currentUserId=g;const e=await uni.$u.http.get(`/product/process/skip/url?${m(t)}`);u(y(e.data))},y=t=>{if(console.log("url",t),t.startsWith("pages"))return"/"+t;if(t.startsWith("/pages"))return t;const e=t.indexOf("/#/");return-1===e?"":t.substring(e+2)},m=t=>{const e=[];return Object.entries(t).forEach((([t,n])=>{const s=encodeURIComponent(t);null===n||"object"!=typeof n||Array.isArray(n)?null!=n&&e.push(`${s}=${encodeURIComponent(String(n))}`):e.push(`${s}=${encodeURIComponent(JSON.stringify(n))}`)})),e.join("&")};return n((async()=>{const t=new r;if(g){t.showLoading("跳转中");try{await((t,e=3)=>{let n=0;const s=async()=>{try{return await t()}catch(r){if(n++,n>=e)throw r;return s()}};return s()})(h)}catch(e){console.log("e",e),a({title:"提示",content:"网络错误",showCancel:!1,success:()=>{o().length<2?s("/pages/index/index"):i()}})}finally{t.hideLoading()}}else s("/pages/index/index")})),(t,e)=>{const n=d;return l(),c(n)}}});export{g as default};
