import{A as e,x as l,r as t,q as a,a9 as o,B as d,s,ak as u,E as r,X as c,Y as n,Z as i,a2 as m,p,au as f,a0 as D,a1 as v,ar as h,D as A,Q as y,d as _,bZ as g,c as C,w as k,i as b,I,am as w,K as V,b_ as T,M as x,at as S,o as M,a as P,y as N,u as F,k as $,g as B,h as L,R as U,n as j,t as Y,b as K,F as R,e as O,aU as E,aj as q,f as J,W as z,z as G,C as H,_ as Q}from"./index-CK4DGatK.js";import{s as W,a as X}from"./addState.BIkq4e66.js";import{N as Z}from"./NavBar.DSs5OGCU.js";import{C as ee}from"./cityPicker.CpzGRyNT.js";import{C as le}from"./colorPop.BYxZ8ilX.js";import{u as te}from"./useDict.DwAUsZFY.js";import{c as ae}from"./crm.-ZWUD7KR.js";import{o as oe}from"./utils.KWGjglqg.js";import{a as de,b as se,d as ue,c as re,e as ce}from"./validator.D4swjSxv.js";import{c as ne}from"./carSelect-emit.CejlvgP5.js";import{u as ie}from"./useQuery.3dd8K18V.js";import{g as me,s as pe,a as fe}from"./data.8ftChL3A.js";import{a as De}from"./index.HDA2F_3Q.js";import{i as ve}from"./carVerify.BfKp_ULT.js";import"./event.CJk5hinv.js";const he=()=>{const _=e(),g=l((()=>_.userInfo.name)),C=l((()=>_.userInfo.userId)),k=ie(),b=l((()=>!!k.value.customerId)),I=t([{name:"客户信息",key:"customerAddDto",top:0},{name:"销售机会",title:"机会",key:"sellAddDto",top:0},{name:"评估机会",title:"意向",key:"purchaseAddDto",top:0}]),w=l((()=>k.value.type)),V=l((()=>!w.value||"customerAddDto"==w.value)),T=l((()=>!w.value)),x=l((()=>I.value.some((e=>"customerAddDto"===e.key)))),S=l((()=>I.value.some((e=>"purchaseAddDto"===e.key)))),M=l((()=>I.value.some((e=>"sellAddDto"===e.key)))),P=l((()=>{if(k.value.title)return k.value.title;return`${b.value?"编辑":"新增"}客户`})),N=l((()=>k.value.isChange)),F=t(!1),$=t(!1),B=t(""),L=t(""),U=t("");a((()=>{w.value&&(I.value=I.value.filter((e=>w.value===e.key))),b.value&&async function(){const{customerId:e,clueId:l}=k.value||{};if(!e&&!l)return;if(i({title:"加载中",mask:!0}),V.value){!function(e){const l=Object.assign({},e||{}),t=l.customerPurchase||{},a=l.customerSell;Reflect.deleteProperty(l,"customerPurchase"),Reflect.deleteProperty(l,"customerSell"),K({customerAddDto:l,purchaseAddDto:t,sellAddDto:a})}({...(await uni.$u.http.get(ae.getCustomerByPrimaryId,{params:{primaryId:k.value.customerId}})).data||{}})}else if(M.value){let t={paymentType:0};if(!N.value){t=(await uni.$u.http.get(ae.getCustomSellByClueId,{params:{customerId:e,clueId:l}})).data||{}}K({sellAddDto:{...t}})}else if(S.value){let t={};if(!N.value){t=(await uni.$u.http.get(ae.getCustomPurchase,{params:{customerId:e,clueId:l}})).data||{}}K({customerAddDto:{purchaseDemand:1},purchaseAddDto:{...t,intentionCode:"H"}})}m()}()}));const j=o({customerAddDto:{name:"",phone:"",source:"",gender:2,age:"",addressProvinceId:"",addressCityId:"",addressCountryId:"",addressCode:"",address:"",wechat:"",idCard:"",sellDemand:1,purchaseDemand:0,sellFollowName:g.value,sellFollow:C.value,purchaseFollowName:g.value,purchaseFollow:C.value},sellAddDto:{intentionCode:"H",budgetMin:"",budgetMax:"",predictBuyCarTime:"",vehicleAge:"",brandId:"",seriesId:"",modelId:"",modelName:"",carModelGuidePrice:"",paymentType:0,carLayout:"",carFocus:"",description:"",inventorySource:[]},purchaseAddDto:{intentionCode:"H",brandId:"",seriesId:"",modelId:"",modelName:"",carModelGuidePrice:"",vin:"",kilometres:"",colorSourceValue:"",colorSource:"",factoryDate:"",registrationTime:"",priceMin:"",priceMax:"",description:""}});d((()=>{O(),H(),G(),s((()=>{for(let e=0;e<=2;e++)u().select(`#section-${e}`).boundingClientRect((l=>{I.value[e].top=parseInt(l.top)-100})).exec()}))})),ne.onEvent((({data:e})=>{const{brandId:l,brandName:t,seriesId:a,seriesName:o,id:d,name:s,price:u}=e;j.purchaseAddDto.brandId=l,j.purchaseAddDto.brandName=t,j.purchaseAddDto.seriesId=a,j.purchaseAddDto.seriesName=o,j.purchaseAddDto.modelId=d,j.purchaseAddDto.modelName=s,j.purchaseAddDto.carModelGuidePrice=u})),r((()=>{oe((e=>{const l=e.data||[];j.sellAddDto.inventorySource=l})),c("sellData"),n("sellData",(e=>{const{name:l,id:t,queryData:a}=e,{key:o,subKey:d}=JSON.parse(a);j[o][d]=t,j[o][d+"Name"]=l})),c("pickData"),n("pickData",(e=>{const{key:l,subKey:t,tKey:a}=e;a?j[t][a]=l:j[t]=l})),c("mulPickData"),n("mulPickData",(e=>{const{checkList:l,subKey:t,tKey:a}=e;a?j[t][a]=l:j[t]=l}))}));const Y=t(0);function K(e){var l,t,a;const{customerAddDto:o,purchaseAddDto:d,sellAddDto:s}=e||{};!function(e){var l;if(e){j.customerAddDto=e;const t=null==(l=j.customerAddDto.addressCode)?void 0:l.split(",");j.customerAddDto.addressProvinceId=null==t?void 0:t[0],j.customerAddDto.addressCityId=null==t?void 0:t[1],j.customerAddDto.addressCountryId=null==t?void 0:t[2]}}(o);d&&(j.purchaseAddDto=(d&&Array.isArray(d)?null==d?void 0:d.filter((e=>e.crmClueId==k.value.clueId))[0]:d)||me(d)||{}),s&&(j.sellAddDto=me(s));const u=pe((null==(l=j.sellAddDto)?void 0:l.carFocus)||""),r=pe((null==(t=j.sellAddDto)?void 0:t.carLayout)||"");j.sellAddDto={...j.sellAddDto,carLayout:r,carFocus:u,paymentType:(null==(a=j.sellAddDto)?void 0:a.paymentType)||0}}const R=t({}),O=()=>{uni.$u.http.get("/product/carProductApp/getArea").then((e=>{R.value=e.data||{}}))},E=t([]),q=t(),J=t(),z=t(),G=()=>{uni.$u.http.get(ae.intentionInfolist,{data:{current:1,size:-1,type:"0"}}).then((e=>{var l;X.value=((null==(l=e.data)?void 0:l.results)||[]).map((e=>({key:e.code,value:e.code})))}))},H=()=>{uni.$u.http.get("product/common/model/color",{}).then((e=>{const l=e.data;E.value=[...l.bodyColors,{name:"其他颜色",value:""}]}))},Q=t([]),W=l((()=>ge(Q.value,j.customerAddDto.source))),X=t([]),Z=l((()=>{var e;return ge(X.value,null==(e=j.sellAddDto)?void 0:e.intentionCode)})),ee=l((()=>{var e;return ge(X.value,null==(e=j.purchaseAddDto)?void 0:e.intentionCode)})),le=t([]),ve=l((()=>ge(le.value,j.sellAddDto.vehicleAge))),he=t([]),Ae=l((()=>ge(he.value,j.sellAddDto.carLayout))),ye=t([]),_e=l((()=>ge(ye.value,j.sellAddDto.carFocus)));function ge(e,l){if(e||(e=[]),Array.isArray(l)){const t=e.filter((e=>l.includes(e.key))).map((e=>e.value));return(null==t?void 0:t.length)?t.join(","):"请选择"}{const t=e.filter((e=>e.key==l));return(null==t?void 0:t.length)?t[0].value:"请选择"}}const{customer_source:Ce,vehicle_age_type:ke,car_layout:be,car_focus_type:Ie}=te("customer_source","vehicle_age_type","car_layout","car_focus_type");function we(e){return null==e?void 0:e.map((e=>({key:e.value,value:e.label})))}p((()=>{Ce.value&&(Q.value=we(Ce.value)),ke.value&&(le.value=we(ke.value)),be.value&&(he.value=we(be.value)),Ie.value&&(ye.value=we(Ie.value))}));const Ve=t(),Te=new Map([["year","年"],["month","月"],["day","日"]]);return{form:j,title:P,tabVisible:T,tabActive:Y,tabsList:I,isCustomerType:x,isSellType:M,isEdit:b,isChange:N,showDate:F,showDate2:$,dateValue:L,dateTitle:U,intentionCodeList:X,intentionCodeXsText:Z,intentionCodepgText:ee,vehicleAgeList:le,vehicleAgeText:ve,carLayoutList:he,carLayoutText:Ae,carFocusList:ye,carFocusText:_e,sourceList:Q,sourceText:W,isPurchaseType:S,isAllType:V,colorSources:E,colorValue:J,colorName:z,contentRef:Ve,colorPopRef:q,areaData:R,tabClick:async e=>{var l;await s();const t=document.getElementById("section-"+e.index),a=document.getElementById("page-box");t&&a&&(null==(l=Ve.value)||l.$el.scrollTo({top:t.offsetTop-100,behavior:"smooth"}))},handleClear:e=>{"sell"===e?(j.customerAddDto.sellFollowName="",j.customerAddDto.sellFollow=""):(j.customerAddDto.purchaseFollowName="",j.customerAddDto.purchaseFollow="")},toPagePicker:(e,l,t,a,o)=>{y(`/pages/carManage/pagePicker?title=${e}&list=${JSON.stringify(l)}&key=${t}&subKey=${a}&tKey=${o}`)},checkInput:(e,l,t,a)=>{"string"==typeof e?e=e.trim():"number"==typeof e&&(e=String(e)),s((()=>{j[l][t]=De(e,a)}))},inputAge:e=>{const l=e.detail.value;l&&!se(l)&&(new A).showToast("请输入年龄区间18-60")},inputWechat:e=>{const l=e.detail.value;l&&!ue(l)&&(new A).showToast("微信号格式不正确")},inputIdCard:e=>{const l=e.detail.value;l&&!re(l)&&(new A).showToast("身份证号格式不正确")},blurInput1:(e,l)=>{const t=j.sellAddDto.budgetMin,a=j.sellAddDto.budgetMax;if(t&&a&&parseFloat(t)>=parseFloat(a))return D({title:"最高价必须大于最低价",icon:"none"}),void(j.sellAddDto[l]="")},blurInput2:(e,l)=>{const t=j.purchaseAddDto.priceMin,a=j.purchaseAddDto.priceMax;if(t&&a&&parseFloat(t)>=parseFloat(a))return D({title:"最高价必须大于最低价",icon:"none"}),void(j.purchaseAddDto[l]="")},bindPickerChange:(e,l,t)=>{t?j[l][t]=e.detail.value:j[l]=e.detail.value},formatDate:function(e){return e?f(e).format("YYYY-MM-DD"):""},changeColor:(e,l)=>{J.value=e,z.value=l,q.value.open()},handleSubmit:async e=>{var l,t,a,o,d,s;if(!e)return void v();const{phone:u,idCard:r,name:c,source:n,age:p,wechat:f,sellDemand:A,purchaseDemand:y}=j.customerAddDto,{vin:_}=j.purchaseAddDto,{budgetMin:g,budgetMax:C,predictBuyCarTime:I}=j.sellAddDto;if(x.value){if(!c)return D({title:"请输入客户名称",icon:"none"});if(!u)return D({title:"请输入联系电话",icon:"none"});if(!n)return D({title:"请选择来源",icon:"none"});if(u&&!de(u))return D({title:"联系电话格式错误",icon:"none"});if(p&&!se(p))return D({title:"年龄格式错误",icon:"none"});if(f&&!ue(f))return D({title:"微信号格式错误",icon:"none"});if(r&&!re(r))return D({title:"身份证号格式错误",icon:"none"});if(_&&!ce(_))return D({title:"VIN码格式错误",icon:"none"})}if(!b.value&&!A&&!y)return D({title:"销售或评估机会必须选择一个",icon:"none"});if(!b.value&&1==A&&(g&&!C||!g&&C))return D({title:"客户预算请填写完整",icon:"none"});if(b.value&&M.value){if(!g||!C)return D({title:"请输入客户预算",icon:"none"});if(!I)return D({title:"请选择买车日期",icon:"none"})}if(b.value&&!N.value&&S.value){const{modelName:e,vin:l,kilometres:t,colorSource:a,priceMin:o,description:d}=j.purchaseAddDto;if(!e)return D({title:"请选择车型",icon:"none"});if(!l)return D({title:"请输入VIN码",icon:"none"});if(!t)return D({title:"请输入公里数",icon:"none"});if(!a)return D({title:"请选择车身颜色",icon:"none"});if(!o)return D({title:"请输入客户预估价格",icon:"none"});if(!d)return D({title:"请输入详细车况",icon:"none"})}i({title:"提交中",mask:!0});const w={...j};if((null==(l=w.purchaseAddDto)?void 0:l.vin)&&(w.purchaseAddDto.vin=w.purchaseAddDto.vin.toUpperCase()),w.customerAddDto=x.value?w.customerAddDto:null,w.sellAddDto&&(w.sellAddDto.paymentType=1===(null==(t=w.customerAddDto)?void 0:t.sellDemand)?w.sellAddDto.paymentType:null),M.value){const e=(null==(a=j.sellAddDto)?void 0:a.inventorySource)||[],l=fe((null==(o=j.sellAddDto)?void 0:o.carFocus)||[]),t=fe((null==(d=j.sellAddDto)?void 0:d.carLayout)||[]),s={...j.sellAddDto,inventorySource:e,carLayout:t,carFocus:l};w.sellAddDto=s}else w.sellAddDto=null;if(S.value){const e=Object.values(j.purchaseAddDto).every((e=>!e))?[]:[j.purchaseAddDto];w.purchaseAddDto=e}else w.purchaseAddDto=null;if(b.value){if(V.value){const e={id:k.value.customerId,customerUpdateDto:w.customerAddDto,sellUpdateDto:w.sellAddDto,purchaseUpdateDto:w.purchaseAddDto};await uni.$u.http.put(ae.editCustomerById,e)}else if(M.value){const e={...w.sellAddDto};N.value?await uni.$u.http.post("/crm/customer/changeSell",{clueId:k.value.clueId,addSellClueByCustomerIdDto:{...e,customerId:k.value.customerId}}):await uni.$u.http.put(ae.editCustomerSellById,e)}else if(S.value){const e={...null==(s=w.purchaseAddDto)?void 0:s[0]};N.value?N.value&&k.value.isAdd?await uni.$u.http.post("/crm/customer/addPurchaseClueByCustomerId",{...e,customerId:k.value.customerId}):await uni.$u.http.post("/crm/customer/changePurchase",{clueId:k.value.clueId,addPurchaseClueByCustomerIdDto:{...e,customerId:k.value.customerId}}):await uni.$u.http.put(ae.editCustomerPurchase,e)}}else V.value&&await uni.$u.http.post(ae.addCustomer,w);m(),D({title:"提交成功",icon:"none"}),setTimeout((()=>{v({delta:N.value?2:1}),N.value||h("refreshDetail")}),1500)},sureColor:e=>{j.purchaseAddDto.colorSource=e.bodyColor,j.purchaseAddDto.colorSourceValue=e.bodyColorValue},onFormatter:function(e,l){return`${l}${Te.get(e)}`},getDetailByPhone:()=>{if(j.customerAddDto.phone)return j.customerAddDto.phone&&!de(j.customerAddDto.phone)?D({title:"联系电话格式错误",icon:"none"}):void uni.$u.http.post(ae.getcustomByphone,{phone:j.customerAddDto.phone}).then((e=>{e.data&&(e.data.purchaseAddDto=null),K(e.data||{})}))},sureAddressCity:e=>{const{provinceId:l,cityId:t,countryId:a,provinceName:o,cityName:d,countyName:s}=e;j.customerAddDto.addressCode=`${l},${t},${a}`,j.customerAddDto.address=`${o} ${d} ${s}`},openDate:(e,l,t)=>{["predictBuyCarTime"].includes(e)?$.value=!0:F.value=!0,B.value=e,L.value=l||f().format("YYYY-MM-DD"),U.value=t},dateConfirm:e=>{s((()=>{j.purchaseAddDto[B.value]=f(e.value).format("YYYY-MM-DD"),F.value=!1,function(e,l){var t,a;if(["factoryDate","registrationTime"].includes(l)){const o=null==(t=j.purchaseAddDto)?void 0:t.factoryDate,d=null==(a=j.purchaseAddDto)?void 0:a.registrationTime;o&&d&&!f(d).isAfter(o)&&(uni.$u.toast("上牌日期不能早于出厂日期"),j[e][l]="")}}("purchaseAddDto",B.value)}))},dateConfirm2:e=>{s((()=>{j.sellAddDto[B.value]=f(e.value).format("YYYY-MM-DD"),$.value=!1}))}}},Ae=Q(_({__name:"addCustom",setup(e){const{form:l,title:a,tabVisible:o,tabActive:d,tabsList:u,isCustomerType:r,isSellType:c,isEdit:n,isChange:i,showDate:m,showDate2:D,dateValue:v,dateTitle:h,intentionCodeList:A,intentionCodeXsText:_,intentionCodepgText:Q,vehicleAgeList:te,vehicleAgeText:ae,carLayoutList:oe,carLayoutText:de,carFocusList:se,carFocusText:ue,sourceList:re,sourceText:ce,isPurchaseType:ne,isAllType:ie,colorSources:me,colorValue:pe,colorName:fe,contentRef:De,colorPopRef:Ae,areaData:ye,tabClick:_e,handleClear:ge,toPagePicker:Ce,checkInput:ke,inputAge:be,inputWechat:Ie,inputIdCard:we,blurInput1:Ve,formatDate:Te,changeColor:xe,handleSubmit:Se,sureColor:Me,getDetailByPhone:Pe,onFormatter:Ne,sureAddressCity:Fe,openDate:$e,dateConfirm:Be,dateConfirm2:Le}=he(),Ue=e=>{d.value=e.index,H({scrollTop:e.top,duration:100})};g((e=>{const l=e.scrollTop;let t=-1;u.value.forEach(((e,a)=>{l>=(0===a?0:u.value[a-1].top)&&l<e.top?t=a-1:l>=e.top&&(t=a)})),-1===t&&-1!==d.value?t=d.value:d.value=t}));const je=e=>{s((()=>{l.purchaseAddDto.vin=e.detail.value.replace(/[^a-zA-Z0-9]/g,"")}))},Ye=t(!1);return p((()=>{l.purchaseAddDto.vin,0!==l.purchaseAddDto.vin.length?Ye.value=!ve(l.purchaseAddDto.vin):Ye.value=!1})),(e,t)=>{const s=I(V("up-tabs"),w),p=I(V("up-sticky"),T),g=b,H=L,ve=U,he=I(V("up-icon"),x),Ke=q,Re=z,Oe=I(V("u-datetime-picker"),S);return M(),C(g,{class:"page f-c-s"},{default:k((()=>[P(Z,{title:F(a)},null,8,["title"]),F(o)?(M(),C(p,{key:0,bgColor:"#fff"},{default:k((()=>[P(s,{current:F(d),onChange:Ue,list:F(u),onClick:F(_e),lineColor:"#ff5719"},null,8,["current","list","onClick"])])),_:1})):N("",!0),P(g,{class:"content",id:"page-box",ref_key:"contentRef",ref:De},{default:k((()=>[$("div",{class:"warp"},[F(r)?(M(),C(g,{key:0,id:"section-0",class:"section"},{default:k((()=>[P(g,{class:"form-box"},{default:k((()=>[F(o)?(M(),C(g,{key:0,class:"classy-title"},{default:k((()=>[B("客户信息")])),_:1})):N("",!0),P(g,{class:"form-item"},{default:k((()=>[P(g,null,{default:k((()=>[P(H,null,{default:k((()=>[B("*")])),_:1}),B("客户名称")])),_:1}),P(ve,{modelValue:F(l).customerAddDto.name,"onUpdate:modelValue":t[0]||(t[0]=e=>F(l).customerAddDto.name=e),modelModifiers:{trim:!0},placeholder:"请输入"},null,8,["modelValue"])])),_:1}),P(g,{class:"form-item"},{default:k((()=>[P(g,null,{default:k((()=>[P(H,null,{default:k((()=>[B("*")])),_:1}),B("联系电话")])),_:1}),P(ve,{modelValue:F(l).customerAddDto.phone,"onUpdate:modelValue":t[1]||(t[1]=e=>F(l).customerAddDto.phone=e),modelModifiers:{trim:!0},placeholder:"请输入",maxlength:"11",onBlur:F(Pe)},null,8,["modelValue","onBlur"])])),_:1}),P(g,{class:"form-item"},{default:k((()=>[P(g,null,{default:k((()=>[P(H,null,{default:k((()=>[B("*")])),_:1}),B("来源")])),_:1}),P(g,{class:"f-b-c",onClick:t[2]||(t[2]=e=>F(Ce)("来源",F(re),F(l).customerAddDto.source||"","customerAddDto","source"))},{default:k((()=>[P(H,{class:j({placeholder:"请选择"==F(ce)})},{default:k((()=>[B(Y(F(ce)),1)])),_:1},8,["class"]),P(he,{name:"arrow-right"})])),_:1})])),_:1}),P(g,{class:"form-item"},{default:k((()=>[P(g,null,{default:k((()=>[P(H,null,{default:k((()=>[B("*")])),_:1}),B("性别")])),_:1}),P(g,{class:"tab-box"},{default:k((()=>[(M(!0),K(R,null,O(F(W),((e,t)=>(M(),C(H,{key:t,class:j({active:F(l).customerAddDto.gender==e.value}),onClick:t=>F(l).customerAddDto.gender=e.value},{default:k((()=>[B(Y(e.label),1)])),_:2},1032,["class","onClick"])))),128))])),_:1})])),_:1}),P(g,{class:"form-item"},{default:k((()=>[P(g,null,{default:k((()=>[B("年龄")])),_:1}),P(ve,{modelValue:F(l).customerAddDto.age,"onUpdate:modelValue":t[3]||(t[3]=e=>F(l).customerAddDto.age=e),type:"number",placeholder:"请输入",onBlur:F(be)},null,8,["modelValue","onBlur"]),B(" 岁 ")])),_:1}),P(g,{class:"form-item"},{default:k((()=>{var e,a,o,d,s,u;return[P(g,null,{default:k((()=>[B("地址")])),_:1}),P(ee,{areaData:F(ye),onSureCity:F(Fe),modelValue:F(l).customerAddDto.addressCode,"onUpdate:modelValue":t[4]||(t[4]=e=>F(l).customerAddDto.addressCode=e),cityInfo:{provinceId:null==(a=null==(e=F(l).customerAddDto.addressCode)?void 0:e.split(","))?void 0:a[0],cityId:null==(d=null==(o=F(l).customerAddDto.addressCode)?void 0:o.split(","))?void 0:d[1],countryId:null==(u=null==(s=F(l).customerAddDto.addressCode)?void 0:s.split(","))?void 0:u[2],fullCityName:F(l).customerAddDto.address}},null,8,["areaData","onSureCity","modelValue","cityInfo"]),P(he,{name:"arrow-right"})]})),_:1}),P(g,{class:"form-item"},{default:k((()=>[P(g,null,{default:k((()=>[B("微信")])),_:1}),P(ve,{modelValue:F(l).customerAddDto.wechat,"onUpdate:modelValue":t[5]||(t[5]=e=>F(l).customerAddDto.wechat=e),modelModifiers:{trim:!0},placeholder:"请输入",maxlength:"64",onBlur:F(Ie)},null,8,["modelValue","onBlur"])])),_:1}),P(g,{class:"form-item"},{default:k((()=>[P(g,null,{default:k((()=>[B("身份证号")])),_:1}),P(ve,{maxlength:"18",modelValue:F(l).customerAddDto.idCard,"onUpdate:modelValue":t[6]||(t[6]=e=>F(l).customerAddDto.idCard=e),modelModifiers:{trim:!0},placeholder:"请输入",onBlur:F(we)},null,8,["modelValue","onBlur"])])),_:1})])),_:1})])),_:1})):N("",!0),F(c)?(M(),C(g,{key:1,id:"section-1",class:"section"},{default:k((()=>[P(g,{class:"form-box"},{default:k((()=>[F(o)?(M(),C(g,{key:0,class:"classy-title"},{default:k((()=>[B("销售机会")])),_:1})):N("",!0),F(n)&&F(c)?N("",!0):(M(),C(g,{key:1,class:"form-item"},{default:k((()=>[P(g,null,{default:k((()=>[P(H,null,{default:k((()=>[B("*")])),_:1}),B("是否买车")])),_:1}),P(g,{class:"tab-box"},{default:k((()=>[(M(!0),K(R,null,O(F(X),((e,t)=>(M(),C(H,{key:t,class:j({active:F(l).customerAddDto.sellDemand==e.value}),onClick:t=>F(l).customerAddDto.sellDemand=e.value},{default:k((()=>[B(Y(e.label),1)])),_:2},1032,["class","onClick"])))),128))])),_:1})])),_:1})),1===F(l).customerAddDto.sellDemand?(M(),K(R,{key:2},[P(g,{class:"form-item"},{default:k((()=>[P(g,null,{default:k((()=>[P(H,null,{default:k((()=>[B("*")])),_:1}),B("购车方式")])),_:1}),P(g,{class:"tab-box"},{default:k((()=>[P(H,{class:j({active:0===F(l).sellAddDto.paymentType}),onClick:t[7]||(t[7]=e=>F(l).sellAddDto.paymentType=0)},{default:k((()=>[B(" 分期 ")])),_:1},8,["class"]),P(H,{class:j({active:1===F(l).sellAddDto.paymentType}),onClick:t[8]||(t[8]=e=>F(l).sellAddDto.paymentType=1)},{default:k((()=>[B(" 全款 ")])),_:1},8,["class"])])),_:1})])),_:1}),F(n)&&F(c)?N("",!0):(M(),C(g,{key:0,class:"form-item"},{default:k((()=>[P(g,null,{default:k((()=>[B("销售")])),_:1}),P(g,{class:"f-b-c"},{default:k((()=>[P(g,{class:j(["clear-box",{placeholder:!F(l).customerAddDto.sellFollowName}]),onClick:t[9]||(t[9]=t=>("toPage"in e?e.toPage:F(y))(`/pages/carManage/sellUserList?title=销售&id=${F(l).customerAddDto.sellFollow}&queryData=${JSON.stringify({key:"customerAddDto",subKey:"sellFollow"})}`))},{default:k((()=>[B(Y(F(l).customerAddDto.sellFollowName||"请选择"),1)])),_:1},8,["class"]),P(g,{class:"f-b-c"},{default:k((()=>[F(l).customerAddDto.sellFollow?(M(),C(he,{key:0,name:"close-circle-fill",class:"mr20",onClick:t[10]||(t[10]=e=>F(ge)("sell"))})):N("",!0),P(he,{name:"arrow-right"})])),_:1})])),_:1})])),_:1})),P(g,{class:"form-item"},{default:k((()=>[P(g,null,{default:k((()=>[F(n)?(M(),C(H,{key:0},{default:k((()=>[B("*")])),_:1})):N("",!0),B("意向程度")])),_:1}),P(g,{class:"f-b-c",onClick:t[11]||(t[11]=e=>F(Ce)("意向程度",F(A),F(l).sellAddDto.intentionCode||"","sellAddDto","intentionCode"))},{default:k((()=>[P(H,{class:j({placeholder:"请选择"==F(_)})},{default:k((()=>[B(Y(F(_)),1)])),_:1},8,["class"]),P(he,{name:"arrow-right"})])),_:1})])),_:1}),P(g,{class:"form-item"},{default:k((()=>[P(g,null,{default:k((()=>[F(n)?(M(),C(H,{key:0},{default:k((()=>[B("*")])),_:1})):N("",!0),B("客户预算")])),_:1}),P(ve,{class:"number-input",type:"digit",placeholder:"最低价",clearable:"",modelValue:F(l).sellAddDto.budgetMin,"onUpdate:modelValue":t[12]||(t[12]=e=>F(l).sellAddDto.budgetMin=e),onInput:t[13]||(t[13]=e=>F(ke)(e.detail.value,"sellAddDto","budgetMin","wanyuan")),onBlur:t[14]||(t[14]=e=>F(Ve)(e,"budgetMin"))},null,8,["modelValue"]),P(H,{class:"p-10"},{default:k((()=>[B("-")])),_:1}),P(ve,{class:"number-input",type:"digit",placeholder:"最高价",modelValue:F(l).sellAddDto.budgetMax,"onUpdate:modelValue":t[15]||(t[15]=e=>F(l).sellAddDto.budgetMax=e),clearable:"",onInput:t[16]||(t[16]=e=>F(ke)(e.detail.value,"sellAddDto","budgetMax","wanyuan")),onBlur:t[17]||(t[17]=e=>F(Ve)(e,"budgetMax"))},null,8,["modelValue"]),P(H,{class:"p-10"},{default:k((()=>[B("万元")])),_:1})])),_:1}),P(g,{class:"form-item"},{default:k((()=>[P(g,null,{default:k((()=>[F(n)?(M(),C(H,{key:0},{default:k((()=>[B("*")])),_:1})):N("",!0),B("预计买车日期")])),_:1}),P(g,{class:j({placeholder:!F(l).sellAddDto.predictBuyCarTime}),onClick:t[18]||(t[18]=e=>F($e)("predictBuyCarTime",F(l).sellAddDto.predictBuyCarTime,"预计买车日期"))},{default:k((()=>[B(Y(F(Te)(F(l).sellAddDto.predictBuyCarTime)||"请选择"),1)])),_:1},8,["class"]),P(he,{name:"arrow-right"})])),_:1}),P(g,{class:"form-item"},{default:k((()=>[P(g,null,{default:k((()=>[B("车龄")])),_:1}),P(g,{class:"f-b-c",onClick:t[19]||(t[19]=e=>F(Ce)("车龄",F(te),F(l).sellAddDto.vehicleAge||"","sellAddDto","vehicleAge"))},{default:k((()=>[P(H,{class:j({placeholder:"请选择"==F(ae)})},{default:k((()=>[B(Y(F(ae)),1)])),_:1},8,["class"]),P(he,{name:"arrow-right"})])),_:1})])),_:1}),P(g,{class:"form-item"},{default:k((()=>[P(g,null,{default:k((()=>[B("意向车系")])),_:1}),P(g,{class:"f-b-c",onClick:t[20]||(t[20]=t=>("toPage"in e?e.toPage:F(y))(`/pagesB/comp/carSeries?${("qsStr"in e?e.qsStr:F(E))({data:JSON.stringify({check:F(l).sellAddDto.inventorySource})})}`))},{default:k((()=>{var e,t;return[P(H,{class:j({placeholder:!(null==(t=null==(e=F(l).sellAddDto)?void 0:e.inventorySource)?void 0:t.length)})},{default:k((()=>[B(Y((F(l).sellAddDto.inventorySource||[]).map((e=>e.carSeriesName)).join(",")||"请选择"),1)])),_:1},8,["class"]),P(he,{name:"arrow-right"})]})),_:1})])),_:1}),P(g,{class:"form-item"},{default:k((()=>[P(g,null,{default:k((()=>[B("车体形式")])),_:1}),P(g,{class:"f-b-c",onClick:t[21]||(t[21]=e=>F(Ce)("车体形式",F(oe),F(l).sellAddDto.carLayout||"","sellAddDto","carLayout"))},{default:k((()=>[P(H,{class:j({placeholder:"请选择"==F(de)})},{default:k((()=>[B(Y(F(de)),1)])),_:1},8,["class"]),P(he,{name:"arrow-right"})])),_:1})])),_:1}),P(g,{class:"form-item"},{default:k((()=>[P(g,null,{default:k((()=>[B("关注点")])),_:1}),P(g,{class:"f-b-c",onClick:t[22]||(t[22]=e=>F(Ce)("关注点",F(se),F(l).sellAddDto.carFocus||"","sellAddDto","carFocus"))},{default:k((()=>[P(H,{class:j({placeholder:"请选择"==F(ue)})},{default:k((()=>[B(Y(F(ue)),1)])),_:1},8,["class"]),P(he,{name:"arrow-right"})])),_:1})])),_:1}),P(g,{class:"form-textarea"},{default:k((()=>[P(g,{class:"area-title"},{default:k((()=>[B("描述")])),_:1}),P(Ke,{modelValue:F(l).sellAddDto.description,"onUpdate:modelValue":t[23]||(t[23]=e=>F(l).sellAddDto.description=e),placeholder:"请输入",maxlength:"1000"},null,8,["modelValue"]),P(g,{class:"limit"},{default:k((()=>{var e;return[B(Y((null==(e=F(l).sellAddDto.description)?void 0:e.length)||0)+"/1000",1)]})),_:1})])),_:1})],64)):N("",!0)])),_:1})])),_:1})):N("",!0),F(ne)?(M(),C(g,{key:2,id:"section-2",class:"section"},{default:k((()=>[P(g,{class:"form-box"},{default:k((()=>[F(o)?(M(),C(g,{key:0,class:"classy-title"},{default:k((()=>[B("评估机会")])),_:1})):N("",!0),F(ie)?(M(),C(g,{key:1,class:"form-item"},{default:k((()=>[P(g,null,{default:k((()=>[P(H,null,{default:k((()=>[B("*")])),_:1}),B("是否卖车")])),_:1}),P(g,{class:"tab-box"},{default:k((()=>[(M(!0),K(R,null,O(F(X),((e,t)=>(M(),C(H,{key:t,class:j({active:F(l).customerAddDto.purchaseDemand==e.value}),onClick:()=>{F(l).customerAddDto.purchaseDemand=e.value,F(_e)({index:3})}},{default:k((()=>[B(Y(e.label),1)])),_:2},1032,["class","onClick"])))),128))])),_:1})])),_:1})):N("",!0),1===F(l).customerAddDto.purchaseDemand?(M(),K(R,{key:2},[F(ie)?(M(),C(g,{key:0,class:"form-item"},{default:k((()=>[P(g,null,{default:k((()=>[B("评估师")])),_:1}),P(g,{class:"f-b-c"},{default:k((()=>[P(g,{class:j(["clear-box",{placeholder:!F(l).customerAddDto.purchaseFollowName}]),onClick:t[24]||(t[24]=t=>("toPage"in e?e.toPage:F(y))(`/pages/carManage/sellUserList?title=评估师&id=${F(l).customerAddDto.purchaseFollow}&queryData=${JSON.stringify({key:"customerAddDto",subKey:"purchaseFollow"})}`))},{default:k((()=>[B(Y(F(l).customerAddDto.purchaseFollowName||"请选择"),1)])),_:1},8,["class"]),P(g,{class:"f-b-c"},{default:k((()=>[F(l).customerAddDto.purchaseFollow?(M(),C(he,{key:0,name:"close-circle-fill",class:"mr20",onClick:t[25]||(t[25]=e=>F(ge)("purchase"))})):N("",!0),P(he,{name:"arrow-right"})])),_:1})])),_:1})])),_:1})):N("",!0),P(g,{class:"form-item"},{default:k((()=>[P(g,null,{default:k((()=>[F(n)?(M(),C(H,{key:0},{default:k((()=>[B("*")])),_:1})):N("",!0),B("意向程度")])),_:1}),P(g,{class:"f-b-c",onClick:t[26]||(t[26]=e=>F(Ce)("意向程度",F(A),F(l).purchaseAddDto.intentionCode||"","purchaseAddDto","intentionCode"))},{default:k((()=>[P(H,{class:j({placeholder:"请选择"==F(Q)})},{default:k((()=>[B(Y(F(Q)),1)])),_:1},8,["class"]),P(he,{name:"arrow-right"})])),_:1})])),_:1}),P(g,{class:"form-item"},{default:k((()=>[P(g,null,{default:k((()=>[F(n)&&!F(i)?(M(),C(H,{key:0},{default:k((()=>[B("*")])),_:1})):N("",!0),B("评估车型")])),_:1}),P(g,{class:"f-b-c",onClick:t[27]||(t[27]=l=>("toPage"in e?e.toPage:F(y))("/pages/assess/carSelect?selectType=model"))},{default:k((()=>[P(H,{class:j({placeholder:!F(l).purchaseAddDto.modelName})},{default:k((()=>[B(Y(F(l).purchaseAddDto.modelName||"请选择"),1)])),_:1},8,["class"]),P(he,{name:"arrow-right"})])),_:1})])),_:1}),P(g,{class:"form-item error-item","data-error-msg":F(Ye)?"VIN码不正确":""},{default:k((()=>[P(g,null,{default:k((()=>[F(n)&&!F(i)?(M(),C(H,{key:0},{default:k((()=>[B("*")])),_:1})):N("",!0),B("VIN码")])),_:1}),P(ve,{modelValue:F(l).purchaseAddDto.vin,"onUpdate:modelValue":t[28]||(t[28]=e=>F(l).purchaseAddDto.vin=e),modelModifiers:{trim:!0},placeholder:"请输入",style:{"text-transform":"uppercase"},maxlength:"17",onInput:je},null,8,["modelValue"])])),_:1},8,["data-error-msg"]),P(g,{class:"form-item"},{default:k((()=>[P(g,null,{default:k((()=>[F(n)&&!F(i)?(M(),C(H,{key:0},{default:k((()=>[B("*")])),_:1})):N("",!0),B("公里数")])),_:1}),P(ve,{type:"digit",modelValue:F(l).purchaseAddDto.kilometres,"onUpdate:modelValue":t[29]||(t[29]=e=>F(l).purchaseAddDto.kilometres=e),modelModifiers:{trim:!0},placeholder:"请输入",onInput:t[30]||(t[30]=e=>F(ke)(e.detail.value,"purchaseAddDto","kilometres","float"))},null,8,["modelValue"]),B(" 万公里 ")])),_:1}),P(g,{class:"form-item"},{default:k((()=>[P(g,null,{default:k((()=>[F(n)&&!F(i)?(M(),C(H,{key:0},{default:k((()=>[B("*")])),_:1})):N("",!0),B("车身颜色")])),_:1}),P(g,{class:"f-b-c",onClick:t[31]||(t[31]=e=>F(xe)(F(l).purchaseAddDto.colorSourceValue,F(l).purchaseAddDto.colorSource))},{default:k((()=>[P(g,{class:j([{none:!F(l).purchaseAddDto.colorSource},"f-r-a"])},{default:k((()=>[F(l).purchaseAddDto.colorSourceValue?(M(),C(H,{key:0,class:"color-box",style:J(`background:${F(l).purchaseAddDto.colorSourceValue}`)},null,8,["style"])):N("",!0),B(" "+Y(F(l).purchaseAddDto.colorSourceValue?F(l).purchaseAddDto.colorSource:F(l).purchaseAddDto.colorSource?"其他颜色":"请选择"),1)])),_:1},8,["class"]),P(he,{name:"arrow-right"})])),_:1})])),_:1}),P(g,{class:"form-item"},{default:k((()=>[P(g,null,{default:k((()=>[B("出厂日期")])),_:1}),P(g,{class:j({placeholder:!F(l).purchaseAddDto.factoryDate}),onClick:t[32]||(t[32]=e=>F($e)("factoryDate",F(l).purchaseAddDto.factoryDate,"出厂日期"))},{default:k((()=>[B(Y(F(Te)(F(l).purchaseAddDto.factoryDate)||"请选择"),1)])),_:1},8,["class"]),P(he,{name:"arrow-right"})])),_:1}),P(g,{class:"form-item"},{default:k((()=>[P(g,null,{default:k((()=>[B("上牌日期")])),_:1}),P(g,{class:j({placeholder:!F(l).purchaseAddDto.registrationTime}),onClick:t[33]||(t[33]=e=>F($e)("registrationTime",F(l).purchaseAddDto.registrationTime,"出厂日期"))},{default:k((()=>[B(Y(F(Te)(F(l).purchaseAddDto.registrationTime)||"请选择"),1)])),_:1},8,["class"]),P(he,{name:"arrow-right"})])),_:1}),P(g,{class:"form-item"},{default:k((()=>[P(g,null,{default:k((()=>[F(n)&&!F(i)?(M(),C(H,{key:0},{default:k((()=>[B("*")])),_:1})):N("",!0),B("客户预估价格")])),_:1}),P(ve,{modelValue:F(l).purchaseAddDto.priceMin,"onUpdate:modelValue":t[34]||(t[34]=e=>F(l).purchaseAddDto.priceMin=e),type:"digit",placeholder:"请输入",onInput:t[35]||(t[35]=e=>F(ke)(e.detail.value,"purchaseAddDto","priceMin","wanyuan"))},null,8,["modelValue"]),P(H,{class:"p-10"},{default:k((()=>[B("万元")])),_:1})])),_:1}),P(g,{class:"form-textarea"},{default:k((()=>[P(g,{class:"area-title"},{default:k((()=>[F(n)&&!F(i)?(M(),C(H,{key:0},{default:k((()=>[B("*")])),_:1})):N("",!0),B("详细车况")])),_:1}),P(Ke,{modelValue:F(l).purchaseAddDto.description,"onUpdate:modelValue":t[36]||(t[36]=e=>F(l).purchaseAddDto.description=e),placeholder:"请输入",maxlength:"1000"},null,8,["modelValue"]),P(g,{class:"limit"},{default:k((()=>{var e;return[B(Y((null==(e=F(l).purchaseAddDto.description)?void 0:e.length)||0)+"/1000",1)]})),_:1})])),_:1})],64)):N("",!0)])),_:1})])),_:1})):N("",!0)])])),_:1},512),P(g,{class:"bottom-btn"},{default:k((()=>[P(Re,{onClick:t[37]||(t[37]=e=>F(Se)(!1))},{default:k((()=>[B("取消")])),_:1}),P(Re,{class:"save-btn",onClick:t[38]||(t[38]=e=>F(Se)(!0))},{default:k((()=>[B("确定")])),_:1})])),_:1}),P(le,{ref_key:"colorPopRef",ref:Ae,colorData:F(me),colorValue:F(pe),colorName:F(fe),onSureColor:F(Me),title:"车身颜色"},null,8,["colorData","colorValue","colorName","onSureColor"]),P(Oe,{show:F(m),modelValue:F(v),"onUpdate:modelValue":t[39]||(t[39]=e=>G(v)?v.value=e:null),title:F(h),mode:"date",confirmColor:"#ff5719",maxDate:F(f)().valueOf(),formatter:F(Ne),onCancel:t[40]||(t[40]=e=>m.value=!1),onConfirm:F(Be)},null,8,["show","modelValue","title","maxDate","formatter","onConfirm"]),P(Oe,{show:F(D),modelValue:F(v),"onUpdate:modelValue":t[41]||(t[41]=e=>G(v)?v.value=e:null),title:F(h),mode:"date",confirmColor:"#ff5719",minDate:F(f)().valueOf(),formatter:F(Ne),onCancel:t[42]||(t[42]=e=>D.value=!1),onConfirm:F(Le)},null,8,["show","modelValue","title","minDate","formatter","onConfirm"])])),_:1})}}}),[["__scopeId","data-v-1d2820cd"]]);export{Ae as default};
