import{d as e,r as a,a9 as l,B as s,s as t,$ as i,c as r,w as o,i as d,I as u,M as n,K as c,b8 as m,o as p,a as f,b,F as y,e as _,u as h,n as v,y as k,g,t as I,ad as j,O as L,T as C,_ as T}from"./index-CK4DGatK.js";import{L as x}from"./ListLoadRefreshView.CnNC2lkG.js";import{L as O}from"./listItem.De6Dqo0z.js";import{U as A,a as w}from"./u-dropdown-item.B66HFyYv.js";import{u as S}from"./useQuery.3dd8K18V.js";import{o as N}from"./omit.DzeQdT5l.js";import"./index.HDA2F_3Q.js";import"./time._VqwKl0d.js";import"./car_default.CyENNAub.js";import"./purchase.B8DNaFGL.js";import"./fixPrice.CFXyKkhm.js";import"./base.6l0JEBJr.js";import"./_baseGet.CmhOSbYr.js";import"./_getTag.DG-N9UUn.js";import"./isObject.C8HfsiHw.js";import"./isSymbol.Bym6OQCA.js";import"./_Uint8Array.B4mhORiM.js";import"./_baseClone.Cc-Y92km.js";const P=T(e({__name:"carList",setup(e){const T=S(),P=a([{label:"采购时间降序",id:1},{label:"采购时间升序",id:2},{label:"定价金额降序",id:3},{label:"定价金额升序",id:4},{label:"公里数降序",id:5},{label:"公里数升序",id:6}]),R=a([]),z=a([]),E=a([{label:"同品牌",id:"1"},{label:"同款车系",id:"2"},{label:"同款车型",id:"3"}]),J=a([{label:"在售",id:"ON_SALE_ALL"},{label:"已售",id:"SOLD_OUT"}]),M=a(),U=a([]),q=a(),D=l({current:1,size:5,total:0,status:"ON_SALE_ALL",orders:1,brandId:"",seriesId:"",bodyColor:[],sameType:""});async function F(){var e;try{const e={...N(D,["total","sameType"]),brandId:D.brandId?[D.brandId]:[],seriesId:D.seriesId?[D.seriesId]:[]},a=await i().post("/product/carProductApp/vehiclePage/new",e);D.total=a.data.count;const l=a.data.results;U.value=1===D.current?l:[...U.value,...l]}finally{null==(e=q.value)||e.loadFinish()}}s((()=>{$(),F(),B(),t((()=>{M.value.highlight(0,1),M.value.highlight(2,1),M.value.highlight(3,"ON_SALE_ALL")}))}));const V=()=>{var e;D.current=1,F(),null==(e=q.value)||e.initTop()},Z=()=>{D.current++,F()},$=(e="")=>{const{sameType:a,brandId:l,seriesId:s,modelId:t}=T.value;D.sameType=e||a||1,D.brandId=l,D.seriesId=["2","3"].includes(D.sameType)?s:"",D.modelId=3==D.sameType?t:""},B=()=>{uni.$u.http.post("/product/carProductApp/getCarProductAttribute",{status:D.status,brandId:D.brandId,modelId:D.modelId,seriesId:D.seriesId}).then((e=>{var a;R.value=null==(a=e.data)?void 0:a.filter((e=>e.name))}))},G=(e,a,l,s)=>{M.value.highlight(l,a.id),Q(),D[e]=a.id,"sameType"==e&&$(a.id),s&&(D.bodyColor=[],z.value=[],M.value.highlight(1,D.bodyColor.length),B()),V()},K=()=>{D.bodyColor=JSON.parse(JSON.stringify(z.value)),M.value.highlight(1,D.bodyColor.length),Q(),V()},Q=()=>{var e;null==(e=M.value)||e.close()};return(e,a)=>{const l=d,s=u(c("up-icon"),n),t=u(c("up-empty"),m);return p(),r(l,{class:"page f-c-s"},{default:o((()=>[f(A,{ref_key:"uDropdownRef",ref:M,class:"drop",borderRadius:"20rpx",onOpen:e.open},{default:o((()=>[f(w,{title:"排序"},{default:o((()=>[f(l,{class:"item-list"},{default:o((()=>[(p(!0),b(y,null,_(h(P),((e,a)=>(p(),r(l,{key:a,class:v({active:h(D).orders==e.id}),onClick:a=>G("orders",e,0)},{default:o((()=>[f(l,null,{default:o((()=>[g(I(e.label),1)])),_:2},1024),h(D).orders==e.id?(p(),r(s,{key:0,name:"checkbox-mark",color:"#ff5719",size:"20"})):k("",!0)])),_:2},1032,["class","onClick"])))),128))])),_:1})])),_:1}),f(w,{title:"颜色"},{default:o((()=>{var e;return[(null==(e=h(R))?void 0:e.length)?(p(),b(y,{key:0},[f(l,{class:"color-item"},{default:o((()=>[(p(!0),b(y,null,_(h(R),((e,a)=>(p(),r(l,{class:v(["item-view",{active:h(z).includes(e.name)}]),key:a,onClick:a=>(e=>{z.value.includes(e.name)?z.value.splice(z.value.findIndex((a=>a==e.name)),1):z.value.push(e.name)})(e)},{default:o((()=>[g(I(e.name),1)])),_:2},1032,["class","onClick"])))),128))])),_:1}),f(l,{onClick:K,class:"btns"},{default:o((()=>[g("确认")])),_:1})],64)):(p(),r(t,{key:1,text:"暂无颜色数据",style:{"padding-bottom":"20rpx"}}))]})),_:1}),f(w,{title:h(E).filter((e=>e.id==h(D).sameType))[0].label},{default:o((()=>[f(l,{class:"item-list"},{default:o((()=>[(p(!0),b(y,null,_(h(E),((e,a)=>(p(),r(l,{key:a,class:v({active:h(D).sameType==e.id}),onClick:a=>G("sameType",e,2,"refresh")},{default:o((()=>[f(l,null,{default:o((()=>[g(I(e.label),1)])),_:2},1024),h(D).sameType==e.id?(p(),r(s,{key:0,name:"checkbox-mark",color:"#ff5719",size:"20"})):k("",!0)])),_:2},1032,["class","onClick"])))),128))])),_:1})])),_:1},8,["title"]),f(w,{title:h(J).filter((e=>e.id==h(D).status))[0].label},{default:o((()=>[f(l,{class:"item-list"},{default:o((()=>[(p(!0),b(y,null,_(h(J),((e,a)=>(p(),r(l,{key:a,class:v({active:h(D).status==e.id}),onClick:a=>G("status",e,3,"refresh")},{default:o((()=>[f(l,null,{default:o((()=>[g(I(e.label),1)])),_:2},1024),h(D).status==e.id?(p(),r(s,{key:0,name:"checkbox-mark",color:"#ff5719",size:"20"})):k("",!0)])),_:2},1032,["class","onClick"])))),128))])),_:1})])),_:1},8,["title"])])),_:1},8,["onOpen"]),f(l,{class:"total"},{default:o((()=>[f(l,null,{default:o((()=>[g("共找到"+I(h(D).total)+"个",1)])),_:1})])),_:1}),f(x,j({ref_key:"listLoadRef",ref:q,class:"scroll-view-box"},h(D),{istop:!1,onLoadMore:Z,onLoadRefresh:V}),{default:o((()=>[L(f(l,{class:"list-box"},{default:o((()=>[(p(!0),b(y,null,_(h(U),((e,a)=>(p(),r(O,{key:a,item:e,itemType:"inventory",query:h(T)},null,8,["item","query"])))),128))])),_:1},512),[[C,h(U).length]])])),_:1},16)])),_:1})}}}),[["__scopeId","data-v-9cd08552"]]);export{P as default};
