import{g as e}from"./highlight.BhMHDnLY.js";import{d as a,B as l,b2 as n,r as s,x as t,c as i,w as u,i as d,I as r,M as o,K as c,o as v,a as f,R as m,u as p,z as g,b as _,F as h,e as k,n as C,g as y,t as x,O as b,y as N,T,W as j,ar as H,a1 as I,_ as R}from"./index-CK4DGatK.js";import{u as M}from"./useQuery.3dd8K18V.js";import{c as L}from"./cloneDeep.D7E8_JON.js";import"./_baseClone.Cc-Y92km.js";import"./_Uint8Array.B4mhORiM.js";import"./_getTag.DG-N9UUn.js";import"./isObject.C8HfsiHw.js";const $=R(a({__name:"address",setup(a){const R=M();l((async e=>{if(n({title:e.title||"地址"}),await w(),A.value="","undefined"!==e.info){const a=JSON.parse(e.info);O.value=a.active[0],V.value=a.active[1],z.value=a.active[2]}}));const $=s([]),w=()=>{uni.$u.http.get("/product/carProductApp/getArea").then((e=>{$.value=e.data.areaList}))},A=s(),D=e=>{if(e){const e=E.value[O.value],a=U.value[V.value],l=B.value[z.value],n=[null==e?void 0:e.name,null==a?void 0:a.name,null==l?void 0:l.name].filter((e=>e)),s=[null==e?void 0:e.id,null==a?void 0:a.id,null==l?void 0:l.id].filter((e=>e));H("addressData",{name:n,code:s,index:R.value.index||0,active:[O.value,V.value,z.value]}),I()}},O=s(0),V=s(0),z=s(0),E=t((()=>$.value||[])),U=t((()=>{var e;return(null==(e=$.value[O.value])?void 0:e.subRegions)||[]})),B=t((()=>{var e;return(null==(e=U.value[V.value])?void 0:e.subRegions)||[]})),F=t((()=>{if(!A.value)return;const e=L($.value),a={},l=[],n=e=>{e.forEach((e=>{var s;a[e.id]=e,(null==(s=e.subRegions)?void 0:s.length)?n(e.subRegions):l.push(e)}))};function s(e,l=[]){return e.parentId&&(l.unshift(a[e.parentId]),s(a[e.parentId],l)),l}n(e),console.log("leafNodes",l);const t=[];return l.forEach((e=>{var a,l;const[n,i]=s(e);((null==(a=e.name)?void 0:a.includes(A.value))||(null==(l=null==i?void 0:i.name)?void 0:l.includes(A.value)))&&(e.grandCode=null==n?void 0:n.id,e.grandName=null==n?void 0:n.name,e.parentCode=null==i?void 0:i.id,e.parentName=null==i?void 0:i.name,t.push(e))})),t}));return(a,l)=>{const n=r(c("up-icon"),o),s=m,t=d,M=j;return v(),i(t,{class:"page f-c-s"},{default:u((()=>[f(t,{class:"content"},{default:u((()=>[f(t,{class:"search-box"},{default:u((()=>[f(n,{name:"search",size:"20"}),f(s,{modelValue:p(A),"onUpdate:modelValue":l[0]||(l[0]=e=>g(A)?A.value=e:null),placeholder:"支持按区县、城市名称搜索",style:{width:"100%"}},null,8,["modelValue"])])),_:1}),p(A)?(v(),i(t,{key:1,class:"section-search"},{default:u((()=>{var l;return[(v(!0),_(h,null,k(p(F),(l=>{var n;return b((v(),i(t,{key:l.id},{default:u((()=>[f(t,{class:"search-item",onClick:e=>(e=>{O.value=E.value.findIndex((a=>a.id===e.grandCode)),V.value=U.value.findIndex((a=>a.id===e.parentCode)),z.value=B.value.findIndex((a=>a.id===e.id));const a=[e.grandName,e.parentName,e.name].filter((e=>e)),l=[e.grandCode,e.parentCode,e.id].filter((e=>e));H("addressData",{name:a,code:l,index:R.value.index||0,active:[O.value,V.value,z.value]}),I()})(l)},{default:u((()=>[l.grandName?(v(),_("span",{key:0},x(`${l.grandName}-`),1)):N("",!0),l.parentName?(v(),_("span",{key:1,innerHTML:("getHighlightText"in a?a.getHighlightText:p(e))(`${l.parentName}-`,p(A))},null,8,["innerHTML"])):N("",!0),l.name?(v(),_("span",{key:2,innerHTML:("getHighlightText"in a?a.getHighlightText:p(e))(`${l.name}`,p(A))},null,8,["innerHTML"])):N("",!0)])),_:2},1032,["onClick"])])),_:2},1024)),[[T,null==(n=p(F))?void 0:n.length]])})),128)),b(f(t,{class:"no-data"},{default:u((()=>[y("暂无搜索结果")])),_:1},512),[[T,!(null==(l=p(F))?void 0:l.length)]])]})),_:1})):(v(),i(t,{key:0,class:"section"},{default:u((()=>[f(t,{class:"province"},{default:u((()=>[(v(!0),_(h,null,k(p(E),((e,a)=>(v(),i(t,{ref_for:!0,ref:"provinceRefs",key:e.id,data:e.id,class:C(["province-item",[p(O)===a?"active":""]]),onClick:e=>(e=>{O.value=e,V.value=0,z.value=0})(a)},{default:u((()=>[y(x(e.name),1)])),_:2},1032,["data","class","onClick"])))),128))])),_:1}),f(t,{class:"city"},{default:u((()=>[(v(!0),_(h,null,k(p(U),((e,a)=>(v(),i(t,{ref_for:!0,ref:"cityRefs",key:e.id,data:e.id,class:C(["province-item",[p(V)===a?"active":""]]),onClick:e=>(e=>{V.value=e,z.value=0})(a)},{default:u((()=>[y(x(e.name),1)])),_:2},1032,["data","class","onClick"])))),128))])),_:1}),f(t,{class:"area"},{default:u((()=>[(v(!0),_(h,null,k(p(B),((e,a)=>(v(),i(t,{ref_for:!0,ref:"areaRefs",key:e.id,data:e.id,class:C(["province-item",[p(z)===a?"active":""]]),onClick:e=>(e=>{z.value=e})(a)},{default:u((()=>[y(x(e.name),1)])),_:2},1032,["data","class","onClick"])))),128))])),_:1})])),_:1}))])),_:1}),f(t,{class:"bottom-btn"},{default:u((()=>[f(M,{onClick:l[1]||(l[1]=e=>D(!1))},{default:u((()=>[y("取消")])),_:1}),f(M,{class:"save-btn",onClick:l[2]||(l[2]=e=>D(!0))},{default:u((()=>[y("确定")])),_:1})])),_:1})])),_:1})}}}),[["__scopeId","data-v-5f0f9c3f"]]);export{$ as default};
