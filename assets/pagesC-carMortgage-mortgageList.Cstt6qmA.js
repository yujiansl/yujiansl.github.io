import{d as e,r as a,q as l,b as s,o as t,a as r,a5 as u,w as o,i as n,g as c,F as i,e as d,c as m,n as v,u as p,t as f,z as _,R as h,h as g,f as b,_ as y,a9 as k,I as j,M as C,K as A,ae as I,af as U,ag as S,S as x,y as V,a0 as D,B as N,E as T,X as w,Y as L,Z as R,$ as O,a2 as P,ad as z,s as B}from"./index-CK4DGatK.js";import{N as M}from"./NavBar.DSs5OGCU.js";import{U as $,a as E}from"./u-dropdown-item.B66HFyYv.js";import{B as F}from"./brandDrop.WDU7kvw8.js";import{D as K}from"./datePicker.DPajrKz9.js";import{P as Q}from"./pricePicker.gxcGlZwI.js";import{u as Y}from"./useQuery.3dd8K18V.js";import{L as Z}from"./ListLoadRefreshView.CnNC2lkG.js";import{m as q,L as G}from"./state.B277O7ET.js";import{o as H}from"./omit.DzeQdT5l.js";import"./index.HDA2F_3Q.js";import"./time._VqwKl0d.js";import"./car_default.CyENNAub.js";import"./_baseGet.CmhOSbYr.js";import"./_getTag.DG-N9UUn.js";import"./isObject.C8HfsiHw.js";import"./isSymbol.Bym6OQCA.js";import"./_Uint8Array.B4mhORiM.js";import"./_baseClone.Cc-Y92km.js";const J=y(e({__name:"allDrop",props:{obj:{type:Object,default:()=>{}}},emits:["search"],setup(e,{expose:y,emit:k}){const j=k,C=e,A=a({customerName:"",productNo:"",vinNo:"",salesType:"",bodyColors:[]}),I=a([]),U=a([]),S=a([]),x=a([]),V=a([]),D=a([{name:"批量",value:"Wholesale"},{name:"零售",value:"Retail"},{name:"寄售",value:"Consignment"}]);l((async()=>{N()}));const N=()=>{uni.$u.http.get("/product/merchant/car/product/conditionListToMerchantPage").then((e=>{V.value=e.data.bodyColors}))},T=(e,a,l)=>{Array.isArray(A.value[e])?A.value[e].includes(a[l])?A.value[e]=A.value[e].filter((e=>e!==a[l])):A.value[e].push(a[l]):A.value[e]=A.value[e]==a.value?"":a.value},w=()=>{for(const e in A.value)A.value[e]=Array.isArray(A.value[e])?[]:null;I.value=[],U.value=[],S.value=[],x.value=[],j("search",A.value,!1,"clear")},L=()=>{const e=(e,a)=>{const l="start"==a?"00:00:00":"23:59:59";return e&&e.indexOf(l)<0?`${e} ${l}`:e||null};I.value.length>1&&(A.value.salesDateTimeStart=e(I.value[0],"start"),A.value.salesDateTimeEnd=e(I.value[1],"end")),U.value.length>1&&(A.value.priceLow=U.value[0],A.value.priceHigh=U.value[1]),S.value.length>1&&(A.value.registerDateStart=e(S.value[0],"start"),A.value.registerDateEnd=e(S.value[1],"end")),x.value.length>1&&(A.value.startMileage=x.value[0],A.value.endMileage=x.value[1]);const a=Object.values(A.value).every((e=>Array.isArray(e)?!(null==e?void 0:e.length):!(null==e?void 0:e.trim())));j("search",A.value,!a)};return y({open:()=>{const e=C.obj;Object.keys(A.value).forEach((a=>{A.value[a]=e[a]})),A.value.bodyColors=e.bodyColors||[]}}),(e,a)=>{const l=n,y=h,k=g,j=u;return t(),s(i,null,[r(j,{class:"u-menu-wrap","scroll-y":""},{default:o((()=>[r(l,{class:"models"},{default:o((()=>[r(l,{class:"sub-title"},{default:o((()=>[c("销售方式")])),_:1}),r(l,{class:"sub-content"},{default:o((()=>[(t(!0),s(i,null,d(p(D),(e=>(t(),m(l,{onClick:a=>T("salesType",e,"name"),class:v({active:p(A).salesType==e.value}),key:e.name},{default:o((()=>[c(f(e.name),1)])),_:2},1032,["onClick","class"])))),128))])),_:1})])),_:1}),r(l,{class:"models"},{default:o((()=>[r(l,{class:"sub-title"},{default:o((()=>[c("销售日期")])),_:1}),r(K,{creatAt:p(I),"onUpdate:creatAt":a[0]||(a[0]=e=>_(I)?I.value=e:null)},null,8,["creatAt"])])),_:1}),r(l,{class:"models"},{default:o((()=>[r(l,{class:"sub-title"},{default:o((()=>[c("成交价")])),_:1}),r(Q,{priceArr:p(U),"onUpdate:priceArr":a[1]||(a[1]=e=>_(U)?U.value=e:null)},null,8,["priceArr"])])),_:1}),r(l,{class:"models"},{default:o((()=>[r(l,{class:"sub-title"},{default:o((()=>[c("客户名称")])),_:1}),r(y,{modelValue:p(A).customerName,"onUpdate:modelValue":a[2]||(a[2]=e=>p(A).customerName=e),placeholder:"请输入"},null,8,["modelValue"])])),_:1}),r(l,{class:"models"},{default:o((()=>[r(l,{class:"sub-title"},{default:o((()=>[c("编号")])),_:1}),r(y,{modelValue:p(A).productNo,"onUpdate:modelValue":a[3]||(a[3]=e=>p(A).productNo=e),placeholder:"请输入"},null,8,["modelValue"])])),_:1}),r(l,{class:"models"},{default:o((()=>[r(l,{class:"sub-title"},{default:o((()=>[c("VIN")])),_:1}),r(y,{modelValue:p(A).vinNo,"onUpdate:modelValue":a[4]||(a[4]=e=>p(A).vinNo=e),placeholder:"请输入"},null,8,["modelValue"])])),_:1}),r(l,{class:"models"},{default:o((()=>[r(l,{class:"sub-title"},{default:o((()=>[c("首次上牌")])),_:1}),r(K,{creatAt:p(S),"onUpdate:creatAt":a[5]||(a[5]=e=>_(S)?S.value=e:null),fields:"month"},null,8,["creatAt"])])),_:1}),r(l,{class:"models"},{default:o((()=>[r(l,{class:"sub-title"},{default:o((()=>[c("真实公里")])),_:1}),r(Q,{priceArr:p(x),"onUpdate:priceArr":a[6]||(a[6]=e=>_(x)?x.value=e:null),inputType:"float",unit:"万公里"},null,8,["priceArr"])])),_:1}),r(l,{class:"models"},{default:o((()=>[r(l,{class:"sub-title"},{default:o((()=>[c("车身颜色")])),_:1}),r(l,{class:"sub-content"},{default:o((()=>[(t(!0),s(i,null,d(p(V),(e=>{var a;return t(),m(l,{onClick:a=>T("bodyColors",e,"name"),class:v({active:null==(a=p(A).bodyColors)?void 0:a.includes(e.name)}),key:e.name},{default:o((()=>[r(k,{style:b(`background-color: ${e.value}`),class:"color-val"},null,8,["style"]),c(" "+f(e.name),1)])),_:2},1032,["onClick","class"])})),128))])),_:1})])),_:1})])),_:1}),r(l,{class:"brand-btn"},{default:o((()=>[r(l,{class:"clear",onClick:w},{default:o((()=>[c("重置")])),_:1}),r(l,{class:"sure",onClick:L},{default:o((()=>[c("查询")])),_:1})])),_:1})],64)}}}),[["__scopeId","data-v-d62e69e3"]]),W=y(e({__name:"filter",props:{status:{type:Number,default:null}},emits:["search"],setup(e,{expose:_,emit:b}){Y();const y=b,N=a(),T=a(),w=a(),L=a(""),R=a(!1),O=a(!1),P=k({orders:"createTime",brandId:"",seriesId:"",salesUserId:""}),z=a([{label:"最近创建",id:"createTime"},{label:"成交价最高",id:"dealPriceDesc"},{label:"成交价最低",id:"dealPriceAsc"}]),B=a([]);l((()=>{W(),N.value.highlight(0,P.orders)}));const M=e=>{1==e&&T.value.open(),3==e&&w.value.open()},K=()=>{var e;null==(e=N.value)||e.close()},Q=()=>{y("search",P),K()},Z=(e,a,l)=>{N.value.highlight(l,a.id.toString()),P[e]=a.id,"orders"==e&&Q()},q=(e,a)=>{P.brandId=e,P.seriesId=a,N.value.highlight(1,a||e),Q()},G=(e,a,l)=>{Object.assign(P,e),N.value.highlight(3,a),"clear"==l&&(N.value.highlight(1,""),N.value.highlight(2,""),P.brandId="",P.seriesId="",P.salesUserId=""),Q()},H=e=>{L.value=e.detail.value,e.detail.value.length>0?R.value=!0:R.value=!1},W=()=>{O.value=!0;try{uni.$u.http.get("product/order/car/custom/findAll",{params:{search:L.value}}).then((e=>{B.value=e.data,O.value=!1}))}catch(e){O.value=!1}finally{O.value=!1}},X=()=>{L.value="",R.value=!1,P.salesUserId=null,W()},ee=a(0),ae=()=>{X(),N.value.highlight(2,null),Q()},le=()=>{if(!P.salesUserId)return D({title:"请先选择销售",icon:"none"});N.value.highlight(2,P.salesUserId),Q()};return _({close:K}),(e,a)=>{const l=n,_=j(A("up-icon"),C),b=h,y=g,k=j(A("up-radio"),I),D=j(A("up-radio-group"),U),K=u,Q=j(A("up-loading-icon"),S);return t(),m($,{ref_key:"uDropdownRef",ref:N,class:"drop",borderRadius:"20rpx",onOpen:M},{default:o((()=>[r(E,{title:"排序"},{default:o((()=>[r(l,{class:"item-list"},{default:o((()=>[(t(!0),s(i,null,d(p(z),((e,a)=>(t(),m(l,{key:a,class:v({active:p(P).orders==e.id}),onClick:x((a=>Z("orders",e,0)),["stop"])},{default:o((()=>[r(l,null,{default:o((()=>[c(f(e.label),1)])),_:2},1024),p(P).orders==e.id?(t(),m(_,{key:0,name:"checkbox-mark",color:"#ff5719",size:"20"})):V("",!0)])),_:2},1032,["class","onClick"])))),128))])),_:1})])),_:1}),r(E,{title:"品牌车系"},{default:o((()=>[r(F,{ref_key:"brandDropRef",ref:T,onSearch:q,pBrand:p(P).brandId,pSeries:p(P).seriesId},null,8,["pBrand","pSeries"])])),_:1}),r(E,{title:"销售"},{default:o((()=>[r(l,{class:"u-menu-wrap",style:{height:"calc(100vh - 316rpx)"}},{default:o((()=>[r(l,{class:"flexs"},{default:o((()=>[r(l,{class:"flexs"},{default:o((()=>[r(b,{onInput:H,clearable:!0,onConfirm:W,onKeyboardheightchange:W,value:p(L),placeholder:"输入销售名字"},null,8,["value"]),p(R)?(t(),m(y,{key:0,class:"uni-icon",onClick:X},{default:o((()=>[r(_,{name:"close-circle"})])),_:1})):V("",!0)])),_:1}),r(l,{onClick:W,class:"searchs"},{default:o((()=>[c("搜索")])),_:1})])),_:1}),p(B).length>0?(t(),m(K,{key:0,"scroll-y":"","scroll-with-animation":"",class:"sellUser u-tab-view menu-scroll-view","scroll-top":p(ee)},{default:o((()=>[r(D,{modelValue:p(P).salesUserId,"onUpdate:modelValue":a[0]||(a[0]=e=>p(P).salesUserId=e),placement:"column"},{default:o((()=>[(t(!0),s(i,null,d(p(B),((e,a)=>(t(),m(l,{class:v(["user-item",{active:p(P).salesUserId==e.id}]),key:a,onClick:x((a=>Z("salesUserId",e,2)),["stop"])},{default:o((()=>[(t(),m(k,{activeColor:"rgb(221, 79, 51)",customStyle:{marginBottom:"8px",marginTop:0},key:a,label:e.name+"("+e.phone+")",name:e.id},null,8,["label","name"])),r(l,{class:"dept"},{default:o((()=>[c(f(e.deptName||""),1)])),_:2},1024)])),_:2},1032,["class","onClick"])))),128))])),_:1},8,["modelValue"])])),_:1},8,["scroll-top"])):(t(),m(l,{key:1,class:"no-content"},{default:o((()=>[c("暂无数据")])),_:1})),p(O)?(t(),m(Q,{key:2,class:"loading-icon",size:"32"})):V("",!0)])),_:1}),r(l,{class:"brand-btn"},{default:o((()=>[r(l,{class:"clear",onClick:ae},{default:o((()=>[c("清空")])),_:1}),r(l,{class:"sure",onClick:le},{default:o((()=>[c("确定")])),_:1})])),_:1})])),_:1}),r(E,{title:"筛选"},{default:o((()=>[r(J,{ref_key:"allDropRef",ref:w,onSearch:G,obj:p(P)},null,8,["obj"])])),_:1})])),_:1},512)}}}),[["__scopeId","data-v-5261a8a9"]]),X=y(e({__name:"mortgageList",setup(e){Y();const l=a(),u=a(),_=a([]),h=a(),g=k({current:1,size:10,total:0,mortgageStatus:"",orders:"createTime"}),b=a("");async function y(){var e,a;R({title:"加载中",mask:!0});try{const e={...H(g,"total")},a=await O().post("/product/mortgagePayment/page",{...e});g.total=+a.data.count;const l=a.data.results;_.value=1===g.current?l:[..._.value,...l]}finally{1==g.current&&(null==(e=h.value)||e.initTop()),null==(a=h.value)||a.loadFinish(),P()}}N((e=>{g.mortgageStatus=e.type||"",b.value=e.type||"",y()})),T((()=>{w("refreshList"),L("refreshList",(()=>{I()})),y()}));const I=()=>{g.current=1,y()},U=()=>{g.current++,y()},S=e=>{Object.assign(g,e),g.current=1,y()};return(e,a)=>{const x=n,D=j(A("up-icon"),C);return t(),m(x,{class:"page f-c-s"},{default:o((()=>[r(M,null,{title:o((()=>[r(x,{class:"head-drop f-r-a f-r-c"},{default:o((()=>[r($,{ref_key:"uDropdownRef",ref:l,class:"drop",borderRadius:"20rpx"},{default:o((()=>[r(E,{title:p(q).filter((e=>e.val==p(b)))[0].label},{default:o((()=>[r(x,{class:"item-list"},{default:o((()=>[(t(!0),s(i,null,d(p(q),((e,a)=>(t(),m(x,{key:a,class:v({active:p(b)==e.val}),onClick:a=>(e=>{for(const a in g)g[a]=Array.isArray(g[a])?[]:null;B((()=>{var a;Object.assign(g,k({current:1,size:10,total:0,mortgageStatus:"",orders:"createTime"})),g.mortgageStatus=e.val,b.value=e.val,l.value.close(),null==(a=u.value)||a.close(),y()}))})(e)},{default:o((()=>[r(x,null,{default:o((()=>[c(f(e.label),1)])),_:2},1024),p(b)==e.val?(t(),m(D,{key:0,name:"checkbox-mark",color:"#DD4F33",size:"20"})):V("",!0)])),_:2},1032,["class","onClick"])))),128))])),_:1})])),_:1},8,["title"])])),_:1},512)])),_:1})])),_:1}),p(g).mortgageStatus?(t(),m(W,{key:0,ref_key:"filterRef",ref:u,onSearch:S},null,512)):V("",!0),r(x,{class:"total"},{default:o((()=>{var e;return[c("共有 "+f(p(g).total)+" 个"+f(null==(e=p(q).filter((e=>e.val==p(g).mortgageStatus))[0])?void 0:e.label),1)]})),_:1}),r(Z,z({ref_key:"listLoadRef",ref:h,class:"scroll-view-box"},p(g),{istop:!1,onLoadMore:U,onLoadRefresh:I}),{"list-cont":o((()=>[(t(!0),s(i,null,d(p(_),((e,a)=>(t(),m(G,{key:a,item:e,page:"list"},null,8,["item"])))),128))])),_:1},16)])),_:1})}}}),[["__scopeId","data-v-d1f0e217"]]);export{X as default};
