import{d as a,r as e,a9 as t,B as s,E as l,X as o,Y as n,Z as i,$ as r,a2 as c,c as u,w as d,i as p,I as m,M as f,K as y,ah as _,o as v,a as h,b as k,u as g,F as C,Q as w,ad as j,O as b,e as T,y as L,g as x,t as z,T as B,ar as D,a1 as F,D as M,_ as Q}from"./index-CK4DGatK.js";import{N as R}from"./NavBar.DSs5OGCU.js";import{L as $}from"./ListLoadRefreshView.CnNC2lkG.js";import{u as I}from"./useQuery.3dd8K18V.js";import{o as N}from"./omit.DzeQdT5l.js";import"./_baseGet.CmhOSbYr.js";import"./_getTag.DG-N9UUn.js";import"./isObject.C8HfsiHw.js";import"./isSymbol.Bym6OQCA.js";import"./_Uint8Array.B4mhORiM.js";import"./_baseClone.Cc-Y92km.js";const O=Q(a({__name:"index",setup(a){const Q=I(),O=e("ready"),P=e(!1),U=e(),V=t({current:1,size:5,total:0}),Y=e([]),q=e("");s((()=>{var a;V.current=1,null==(a=U.value)||a.initTop(),E()}));const A=e();async function E(){var a;try{i({title:"加载中"});const a={...N(V,"total"),templateType:"generic",templateFrom:"app",name:q.value},e=await r().post("/product/convenientTemplate/listByCurrentUser",a);V.total=+e.data.count;const t=e.data.results;Y.value=1===V.current?t:[...Y.value,...t],0===Y.value.length&&(O.value="ready")}finally{c(),null==(a=U.value)||a.loadFinish()}}l((()=>{o("refresh"),n("refresh",(()=>{G()}))}));const G=()=>{V.current=1,E()},K=()=>{V.current++,E()};async function S(){(new M).showLoading("提交中"),uni.$u.http.delete(`/product/convenientTemplate?idList=${[A.value.id]}`).then((()=>{(new M).showToast("删除成功"),P.value=!1,G()}))}return(a,e)=>{const t=m(y("up-icon"),f),s=p,l=m(y("u-modal"),_);return v(),u(s,{class:"page f-c-s"},{default:d((()=>[h(R,{title:"我的模板"},{right:d((()=>[h(s,{class:"nav-right"},{default:d((()=>["edit"===g(O)?(v(),u(t,{key:0,name:"checkmark",size:"25",color:"#DD4F33",onClick:e[0]||(e[0]=a=>O.value="ready")})):(v(),k(C,{key:1},[h(t,{name:"edit-pen",size:"25",color:"#000",onClick:e[1]||(e[1]=a=>O.value="edit")}),h(t,{onClick:e[2]||(e[2]=e=>("toPage"in a?a.toPage:g(w))("/pages/myTemplate/add")),name:"plus-circle",size:"25",color:"#000"})],64))])),_:1})])),_:1}),h($,j({ref_key:"listLoadRef",ref:U,class:"scroll-view-box"},g(V),{istop:!1,onLoadMore:K,onLoadRefresh:G}),{default:d((()=>[b(h(s,{class:"list-box"},{default:d((()=>[(v(!0),k(C,null,T(g(Y),(a=>(v(),u(s,{class:"list-item",key:a.id},{default:d((()=>[h(s,{class:"left"},{default:d((()=>[h(s,{class:"title one-line"},{default:d((()=>[x(z(a.name),1)])),_:2},1024),h(s,{class:"content two-line pre"},{default:d((()=>[x(z(a.content),1)])),_:2},1024)])),_:2},1024),"ready"===g(O)?(v(),u(s,{key:0,class:"right"},{default:d((()=>[h(s,{class:"use-btn",onClick:e=>function(a){D("useTemplate",{data:a,queryData:{type:Q.value.type}}),F()}(a)},{default:d((()=>[x("使用此模版")])),_:2},1032,["onClick"])])),_:2},1024)):L("",!0),"edit"===g(O)?(v(),u(s,{key:1,class:"right"},{default:d((()=>[h(s,{class:"edit-btn",onClick:e=>function(a){w("/pages/myTemplate/add?id="+a.id)}(a)},{default:d((()=>[x("编辑")])),_:2},1032,["onClick"]),h(s,{class:"del-btn",onClick:e=>(a=>{A.value=a,P.value=!0})(a)},{default:d((()=>[x("删除")])),_:2},1032,["onClick"])])),_:2},1024)):L("",!0)])),_:2},1024)))),128))])),_:1},512),[[B,g(Y).length]])])),_:1},16),h(l,{show:g(P),showCancelButton:!0,width:"500rpx",title:"提示",content:"确定执行删除操作？",confirmColor:"#ff5719",onCancel:e[3]||(e[3]=a=>P.value=!1),onConfirm:S},null,8,["show"])])),_:1})}}}),[["__scopeId","data-v-0ecd0978"]]);export{O as default};
