import{b as a,a as e,p as l}from"./index.HDA2F_3Q.js";import{d as t,A as s,r as u,B as r,D as i,a2 as o,c as d,w as n,i as f,o as m,y as c,a as _,u as p,b as y,g as h,t as k,R as v,F as g,e as b,P as j,W as N,s as P,an as w,_ as K}from"./index-CK4DGatK.js";import{_ as O}from"./avatar.Buy0-vr1.js";import{N as x}from"./NavBar.DSs5OGCU.js";import{D}from"./listItem.CnogksUc.js";import{U as I}from"./UploadFile.BBuXxkzB.js";import{R as C}from"./refuse.BEcO0WCW.js";import{u as S}from"./useQuery.3dd8K18V.js";import"./car_default.CyENNAub.js";import"./task.Cx6XxNwo.js";import"./isNil.aV-w2MPu.js";import"./dev.3CSglq9A.js";import"./index.BP9c-u7r.js";import"./image.DobRSNlT.js";import"./play.dJbs8fP_.js";import"./vuedraggable.umd.DwpyKIuh.js";import"./close.Dhgi5Ijg.js";const L=K(t({__name:"purchaseConfirm",setup(t){const K=S(),L=s(),M=u({purchasePrice:""}),R=u([]),T=u();r((()=>{A(),U()}));const A=()=>{(new i).showLoading("加载中");const{primaryKey:a,taskId:e}=K.value;uni.$u.http.get("/product/purchaseOrder/queryPurchaseAuditingDetails",{params:{primaryKey:a,taskId:e}}).then((a=>{M.value=a.data,M.value.photos=a.data.photos.map((a=>({attachmentUrl:a}))),o()}))},U=()=>{uni.$u.http.get("/product/purchaseOrder/getProcessLog",{params:{primaryKey:K.value.primaryKey}}).then((a=>{R.value=a.data}))},V=(a,e="")=>{(new i).showLoading("提交中");const t={taskId:K.value.taskId,primaryKey:K.value.primaryKey,taskDefinitionKey:K.value.taskDefinitionKey,auditOpinion:a?0:1};a&&(t.comment=a),e&&Object.assign(t,M.value),uni.$u.http.post("/product/purchaseOrder/purchaseAuditing",t).then((()=>{var a;null==(a=T.value)||a.close(),w()})).catch((a=>{l(a.message)}))};return(l,t)=>{const s=f,u=v,r=j,i=N;return m(),d(s,{class:"page pend-page"},{default:n((()=>[p(L).needShowQw()?c("",!0):(m(),d(x,{key:0,title:"详情"})),_(s,{class:"content"},{default:n((()=>{var i;return[_(D,{item:p(M),isDetail:!0},null,8,["item"]),_(s,{class:"section-title"},{default:n((()=>[h("销售信息")])),_:1}),_(s,{class:"form-box"},{default:n((()=>["confirm"==p(K).task||1==p(K).status?(m(),d(s,{key:0,class:"form-item"},{default:n((()=>[_(s,null,{default:n((()=>[h("采购价")])),_:1}),_(s,null,{default:n((()=>[h(k(p(M).purchasePrice)+"万元",1)])),_:1})])),_:1})):(m(),d(s,{key:1,class:"form-item write"},{default:n((()=>[_(s,{class:"color3"},{default:n((()=>[h("采购价")])),_:1}),_(u,{modelValue:p(M).purchasePrice,"onUpdate:modelValue":t[0]||(t[0]=a=>p(M).purchasePrice=a),type:"digit",placeholder:"请输入",onInput:t[1]||(t[1]=a=>{return l=a.detail.value,t="purchasePrice",s="wanyuan",void P((()=>{M[t]=e(l,s)}));var l,t,s})},null,8,["modelValue"]),h(" 万元 ")])),_:1})),_(s,{class:"form-item"},{default:n((()=>[_(s,null,{default:n((()=>[h("定金")])),_:1}),_(s,null,{default:n((()=>[h(k(("formatShowPrice"in l?l.formatShowPrice:p(a))(p(M).deposit,"元")),1)])),_:1})])),_:1}),_(s,{class:"form-item"},{default:n((()=>[_(s,null,{default:n((()=>[h("付款方式")])),_:1}),_(s,null,{default:n((()=>[h(k(p(M).paymentMethodName),1)])),_:1})])),_:1}),_(s,{class:"form-item"},{default:n((()=>[_(s,null,{default:n((()=>[h("采购类型")])),_:1}),_(s,null,{default:n((()=>[h(k(p(M).purchaseTypeName),1)])),_:1})])),_:1}),_(s,{class:"form-item"},{default:n((()=>[_(s,null,{default:n((()=>[h("采购日期")])),_:1}),_(s,null,{default:n((()=>[h(k(p(M).purchaseTime),1)])),_:1})])),_:1}),_(s,{class:"form-item"},{default:n((()=>[_(s,null,{default:n((()=>[h("评估师")])),_:1}),_(s,null,{default:n((()=>[h(k(p(M).appraiser),1)])),_:1})])),_:1})])),_:1}),_(s,{class:"section-title"},{default:n((()=>[h("车辆信息")])),_:1}),_(s,{class:"form-box"},{default:n((()=>[_(s,{class:"form-item"},{default:n((()=>[_(s,null,{default:n((()=>[h("VIN码")])),_:1}),_(s,null,{default:n((()=>[h(k(p(M).vinNo),1)])),_:1})])),_:1}),_(s,{class:"form-item"},{default:n((()=>[_(s,null,{default:n((()=>[h("车牌号")])),_:1}),_(s,null,{default:n((()=>[h(k(p(M).plateNo||"-"),1)])),_:1})])),_:1})])),_:1}),_(s,{class:"section-title"},{default:n((()=>[h("客户信息")])),_:1}),_(s,{class:"form-box"},{default:n((()=>[_(s,{class:"form-item"},{default:n((()=>[_(s,null,{default:n((()=>[h("手机号")])),_:1}),_(s,null,{default:n((()=>[h(k(p(M).customerMobile),1)])),_:1})])),_:1}),_(s,{class:"form-item"},{default:n((()=>[_(s,null,{default:n((()=>[h("姓名")])),_:1}),_(s,null,{default:n((()=>[h(k(p(M).customerName),1)])),_:1})])),_:1}),_(s,{class:"form-item"},{default:n((()=>[_(s,null,{default:n((()=>[h("身份证号")])),_:1}),_(s,null,{default:n((()=>[h(k(p(M).idNumber),1)])),_:1})])),_:1}),_(s,{class:"form-item"},{default:n((()=>[_(s,null,{default:n((()=>[h("收款人")])),_:1}),_(s,null,{default:n((()=>[h(k(p(M).payee||"-"),1)])),_:1})])),_:1}),_(s,{class:"form-item"},{default:n((()=>[_(s,null,{default:n((()=>[h("开户行")])),_:1}),_(s,null,{default:n((()=>[h(k(p(M).openBank||"-"),1)])),_:1})])),_:1}),_(s,{class:"form-item"},{default:n((()=>[_(s,null,{default:n((()=>[h("银行卡号")])),_:1}),_(s,null,{default:n((()=>[h(k(p(M).bankCardNumber||"-"),1)])),_:1})])),_:1})])),_:1}),_(s,{class:"section-title"},{default:n((()=>[h("合同信息")])),_:1}),_(s,{class:"form-box"},{default:n((()=>[_(s,{class:"form-item"},{default:n((()=>[_(s,null,{default:n((()=>[h("签约方式")])),_:1}),_(s,null,{default:n((()=>[h(k(p(M).signMethodName),1)])),_:1})])),_:1}),"Offline"==p(M).signMethod?(m(),d(s,{key:0,class:"form-item"},{default:n((()=>{var a;return[_(s,null,{default:n((()=>[h("合同照片")])),_:1}),(null==(a=p(M).photos)?void 0:a.length)?(m(),d(s,{key:0,class:"img-list"},{default:n((()=>[_(I,{accept:"all",uploadList:p(M).photos},null,8,["uploadList"])])),_:1})):(m(),d(s,{key:1},{default:n((()=>[h("-")])),_:1}))]})),_:1})):c("",!0)])),_:1}),(null==(i=p(R))?void 0:i.length)?(m(),y(g,{key:0},[_(s,{class:"section-title"},{default:n((()=>[h("审批流程")])),_:1}),_(s,{class:"pend-list"},{default:n((()=>[(m(!0),y(g,null,b(p(R),((a,e)=>(m(),d(s,{class:"pend-item",key:e},{default:n((()=>[a.avatar?(m(),d(r,{key:0,src:a.avatar},null,8,["src"])):(m(),d(r,{key:1,src:O})),_(s,{class:"item-info"},{default:n((()=>[_(s,null,{default:n((()=>[_(s,null,{default:n((()=>[h(k(a.name),1)])),_:2},1024),_(s,null,{default:n((()=>[h(k(a.createTime),1)])),_:2},1024)])),_:2},1024),_(s,{class:"tip"},{default:n((()=>[h(k("START_PROCESS"===a.taskDefinitionKey?"发起审批":1==a.status?"已同意":2==a.status?"已拒绝":"已处理"),1)])),_:2},1024),a.auditOpinion?(m(),d(s,{key:0,class:"tip"},{default:n((()=>[h("拒绝原因："+k(a.auditOpinion),1)])),_:2},1024)):c("",!0)])),_:2},1024)])),_:2},1024)))),128))])),_:1})],64)):c("",!0)]})),_:1}),"confirm"==p(K).task&&1!=p(K).status?(m(),d(s,{key:1,class:"bottom-btn"},{default:n((()=>[_(i,{onClick:t[2]||(t[2]=a=>p(T).open())},{default:n((()=>[h("拒绝")])),_:1}),_(i,{class:"save-btn",onClick:t[3]||(t[3]=a=>V(""))},{default:n((()=>[h("同意")])),_:1})])),_:1})):c("",!0),"pend"==p(K).task&&1!=p(K).status?(m(),d(s,{key:2,class:"bottom-btn"},{default:n((()=>[_(i,{class:"save-btn",onClick:t[4]||(t[4]=a=>V("","confirm"))},{default:n((()=>[h("确定")])),_:1})])),_:1})):c("",!0),_(C,{ref_key:"refuseRef",ref:T,onConfirm:V},null,512)])),_:1})}}}),[["__scopeId","data-v-7be4eebc"]]);export{L as default};
