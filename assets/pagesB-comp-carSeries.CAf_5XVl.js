import{d as e,r as a,v as l,I as t,a6 as s,K as r,c as i,o as n,i as o,w as u,a as d,a5 as c,y as g,g as v,b as p,e as m,n as h,u as f,t as S,F as b,a7 as y,h as _,f as D,a0 as I,s as k,_ as A,a9 as w,q as M,M as C,aY as O,m as L,ag as V,ac as x,S as T,P as H,ak as B,bV as N,x as E,B as $,E as R,G as j,$ as F,bW as U,k as P,ad as z,O as J,T as W,W as q,z as G,a1 as Y}from"./index-CK4DGatK.js";import{U as K,a as Q}from"./u-dropdown-item.B66HFyYv.js";import{a as Z}from"./index.HDA2F_3Q.js";import{B as X}from"./brandDrop.WDU7kvw8.js";import{L as ee}from"./ListLoadRefreshView.CnNC2lkG.js";import{c as ae}from"./carListItem.hYH6YShY.js";import{e as le}from"./utils.KWGjglqg.js";import{u as te}from"./useQuery.3dd8K18V.js";import{s as se,a as re,l as ie,b as ne,o as oe}from"./omit.DzeQdT5l.js";import{s as ue,S as de,c as ce,b as ge}from"./_baseIteratee.DvY8IqJy.js";import{i as ve}from"./_baseGet.CmhOSbYr.js";import{c as pe,S as me}from"./_getTag.DG-N9UUn.js";import{i as he}from"./isObject.C8HfsiHw.js";import"./time._VqwKl0d.js";import"./image.DobRSNlT.js";import"./_baseClone.Cc-Y92km.js";import"./_Uint8Array.B4mhORiM.js";import"./isSymbol.Bym6OQCA.js";function fe(e){return e!=e}function Se(e,a){return!!(null==e?0:e.length)&&function(e,a,l){return a==a?function(e,a,l){for(var t=l-1,s=e.length;++t<s;)if(e[t]===a)return t;return-1}(e,a,l):function(e,a,l,t){for(var s=e.length,r=l+-1;++r<s;)if(a(e[r],r,e))return r;return-1}(e,fe,l)}(e,a,0)>-1}function be(e){return he(e)&&pe(e)}var ye=me&&1/ue(new me([,-0]))[1]==1/0?function(e){return new me(e)}:function(){};var _e,De,Ie=se(re(_e=function(e){var a=ie(e);return be(a)&&(a=void 0),function(e,a,l){var t=-1,s=Se,r=e.length,i=!0,n=[],o=n;if(r>=200){var u=a?null:ye(e);if(u)return ue(u);i=!1,s=ce,o=new de}else o=a?[]:n;e:for(;++t<r;){var d=e[t],c=a?a(d):d;if(d=0!==d?d:0,i&&c==c){for(var g=o.length;g--;)if(o[g]===c)continue e;a&&o.push(c),n.push(d)}else s(o,c,l)||(o!==n&&o.push(c),n.push(d))}return n}(ne(e,1,be,!0),ge(a))},De,ve),_e+"");const ke=e({__name:"allFilter",props:{colorData:{type:Array,default:()=>[]},methodTypes:{type:Array,default:()=>[]},initData:{type:Object,default:()=>{}},typeVal:{type:String,default:""}},emits:["filterList","saveStatusVal","clearOut"],setup(e,{expose:A,emit:w}){const M=e,C=a({stockStatus:"",registerDateStart:"",registerDateEnd:"",mileageArrs:"",startMileage:null,endMileage:null,startStorageAge:null,endStorageAge:null,startOnSaleDays:null,endOnSaleDays:null,salesMethod:"",bodyColor:[],dischargeStandard:"",microStoreShelfStatus:""}),O=(e,a)=>{const l=C.value[a]?JSON.parse(JSON.stringify(C.value[a])):"";if(C.value[a]=e.detail.value,C.value.registerDateStart&&C.value.registerDateEnd){if(new Date(C.value.registerDateStart).getTime()>new Date(C.value.registerDateEnd).getTime())return I({title:"结束日期不能小于开始日期",icon:"none"}),void(C.value[a]=l)}},L=(e,a,l)=>{k((()=>{C.value[a]=Z(e,l),"startMileage"==a&&(C.value.mileageArrs=e?`${C.value[a]},${C.value.endMileage}`:""),"endMileage"==a&&(C.value.mileageArrs=e?`${C.value.startMileage},${C.value[a]}`:"")}))},V=(e,a,l,t)=>{C.value[a]=e;const s=C.value[a],r=C.value[l];if(s&&r&&("start"==t&&parseFloat(s)>parseFloat(r)||"end"==t&&parseFloat(s)<parseFloat(r)))return I({title:"结束必须大于开始",icon:"none"}),void(C.value[a]="")},x=(e,a)=>{C.value[a]=""},T=a([{label:"在途",val:"Intransit"},{label:"在厅",val:"BeReady"},{label:"整备",val:"Readiness "},{label:"整备中",val:"UNDER_PREPARATION"},{label:"整备完成",val:"COMPLETE_REPAIR"},{label:"转场",val:"Transition"},{label:"外借",val:"LendOut"},{label:"外出",val:"GoOut"},{label:"已出库",val:"Outbound"}]),H=a([{label:"1万公里内",value:"0,1"},{label:"3万公里内",value:"0,3"},{label:"5万公里内",value:"0,5"},{label:"8万公里内",value:"0,8"}]),B=a([{label:"国四",value:"国IV"},{label:"国五",value:"国V"},{label:"国六",value:"国VI"},{label:"欧二",value:"欧II"},{label:"欧三",value:"欧III"},{label:"欧四",value:"欧IV"},{label:"欧五",value:"欧V"},{label:"欧六",value:"欧VI"}]),N=a([{label:"未上架",val:"NoOnSale"},{label:"已上架",val:"OnSale"}]),E=(e,a,l)=>{if(Array.isArray(C.value[e]))C.value[e].includes(a[l])?(C.value[e]=C.value[e].filter((e=>e!==a[l])),console.log(C.value[e],"init")):C.value[e].push(a[l]);else if(console.log(a[l],C.value[e]),a[l]==C.value[e])C.value[e]="","mileageArrs"==e&&(C.value.startMileage="",C.value.endMileage="");else if(C.value[e]=a[l],"mileageArrs"==e){const a=C.value[e];C.value.startMileage=a.split(",")[0],C.value.endMileage=a.split(",")[1]}},$=w,R=()=>{C.value={stockStatus:"",registerDateStart:"",registerDateEnd:"",mileageArrs:"",startMileage:null,endMileage:null,startStorageAge:null,endStorageAge:null,startOnSaleDays:null,endOnSaleDays:null,salesMethod:"",bodyColor:[],dischargeStandard:"",microStoreShelfStatus:""},$("clearOut"),$("filterList",C.value)};A({resetFilter:R});const j=async()=>{$("saveStatusVal",C.value),$("filterList",C.value,"close")};return l((()=>M.initData),(()=>{const e=JSON.parse(JSON.stringify(M.initData));for(const a in e)C.value[a]=e[a]}),{deep:!0,immediate:!0}),(a,l)=>{const I=o,k=y,A=_,w=t(r("up-input"),s),M=c;return n(),i(I,{class:"all-filter"},{default:u((()=>[d(M,{class:"scrolls","scroll-y":""},{default:u((()=>[d(I,{class:"content"},{default:u((()=>[d(I,{class:"models"},{default:u((()=>[d(I,{class:"sub-title"},{default:u((()=>[v("库存状态")])),_:1}),d(I,{class:"carbody-inner"},{default:u((()=>[(n(!0),p(b,null,m(f(T),(e=>(n(),i(I,{onClick:a=>E("stockStatus",e,"val"),class:h([{active:f(C).stockStatus==e.val},"body-item"]),key:e.label},{default:u((()=>[d(I,{class:"text"},{default:u((()=>[v(S(e.label),1)])),_:2},1024)])),_:2},1032,["onClick","class"])))),128))])),_:1})])),_:1}),d(I,{class:"models"},{default:u((()=>[d(I,{class:"sub-title"},{default:u((()=>[v("首次上牌")])),_:1}),d(I,{class:"month-inner"},{default:u((()=>[d(I,{class:"time"},{default:u((()=>[d(k,{mode:"date",fields:"month",value:f(C).registerDateStart,onCancel:l[0]||(l[0]=e=>x(0,"registerDateStart")),onChange:l[1]||(l[1]=e=>O(e,"registerDateStart"))},{default:u((()=>[d(I,null,{default:u((()=>[v(S(f(C).registerDateStart||"请选择"),1)])),_:1})])),_:1},8,["value"])])),_:1}),d(A,{class:"symbol"},{default:u((()=>[v("-")])),_:1}),d(I,{class:"time"},{default:u((()=>[d(k,{mode:"date",fields:"month",value:f(C).registerDateEnd,onCancel:l[2]||(l[2]=e=>x(0,"registerDateEnd")),onChange:l[3]||(l[3]=e=>O(e,"registerDateEnd"))},{default:u((()=>[d(I,null,{default:u((()=>[v(S(f(C).registerDateEnd||"请选择"),1)])),_:1})])),_:1},8,["value"])])),_:1})])),_:1})])),_:1}),d(I,{class:"models"},{default:u((()=>[d(I,{class:"sub-title"},{default:u((()=>[v("车身颜色")])),_:1}),d(I,{class:"color-inner"},{default:u((()=>[(n(!0),p(b,null,m(e.colorData,(e=>(n(),i(I,{onClick:a=>E("bodyColor",e,"name"),class:h([{active:f(C).bodyColor.includes(e.name)},"color-item"]),key:e.name},{default:u((()=>[d(I,{style:D(`background-color: ${e.value}`),class:"color-val"},null,8,["style"]),d(I,{class:"text"},{default:u((()=>[v(S(e.name),1)])),_:2},1024)])),_:2},1032,["onClick","class"])))),128))])),_:1})])),_:1}),d(I,{class:"models"},{default:u((()=>[d(I,{class:"sub-title"},{default:u((()=>[v("表显里程")])),_:1}),d(I,{class:"mileage-inner"},{default:u((()=>[(n(!0),p(b,null,m(f(H),(e=>(n(),i(I,{onClick:a=>E("mileageArrs",e,"value"),class:h([{active:f(C).mileageArrs==e.value},"mileage-item"]),key:e.label},{default:u((()=>[d(I,{class:"text"},{default:u((()=>[v(S(e.label),1)])),_:2},1024)])),_:2},1032,["onClick","class"])))),128)),d(I,{class:"custom"},{default:u((()=>[d(w,{clearable:"",type:"number",placeholder:"请输入",modelValue:f(C).startMileage,"onUpdate:modelValue":l[4]||(l[4]=e=>f(C).startMileage=e),onChange:l[5]||(l[5]=e=>L(e,"startMileage","float")),onBlur:l[6]||(l[6]=e=>V(e,"startMileage","endMileage","start"))},null,8,["modelValue"]),d(A,{style:{padding:"0 8rpx"}},{default:u((()=>[v("-")])),_:1}),d(w,{clearable:"",type:"number",placeholder:"请输入",modelValue:f(C).endMileage,"onUpdate:modelValue":l[7]||(l[7]=e=>f(C).endMileage=e),onChange:l[8]||(l[8]=e=>L(e,"endMileage","float")),onBlur:l[9]||(l[9]=e=>V(e,"endMileage","startMileage","end"))},null,8,["modelValue"]),d(A,{style:{"padding-left":"8rpx"}},{default:u((()=>[v("万公里")])),_:1})])),_:1})])),_:1})])),_:1}),d(I,{class:"models"},{default:u((()=>[d(I,{class:"sub-title"},{default:u((()=>[v("排放标准")])),_:1}),d(I,{class:"emission-inner"},{default:u((()=>[(n(!0),p(b,null,m(f(B),(e=>(n(),i(I,{onClick:a=>E("dischargeStandard",e,"value"),class:h([{active:f(C).dischargeStandard==e.value},"emission-item"]),key:e.label},{default:u((()=>[d(I,{class:"text"},{default:u((()=>[v(S(e.label),1)])),_:2},1024)])),_:2},1032,["onClick","class"])))),128))])),_:1})])),_:1}),d(I,{class:"models"},{default:u((()=>[d(I,{class:"sub-title"},{default:u((()=>[v("库龄")])),_:1}),d(I,{class:"month-inner"},{default:u((()=>[d(w,{clearable:"",type:"number",placeholder:"请输入",onChange:l[10]||(l[10]=e=>L(e,"startStorageAge","int")),onBlur:l[11]||(l[11]=e=>V(e,"startStorageAge","endStorageAge","start")),modelValue:f(C).startStorageAge,"onUpdate:modelValue":l[12]||(l[12]=e=>f(C).startStorageAge=e)},null,8,["modelValue"]),d(A,{class:"symbol"},{default:u((()=>[v("-")])),_:1}),d(w,{clearable:"",type:"number",placeholder:"请输入",onChange:l[13]||(l[13]=e=>L(e,"endStorageAge","int")),onBlur:l[14]||(l[14]=e=>V(e,"endStorageAge","startStorageAge","end")),modelValue:f(C).endStorageAge,"onUpdate:modelValue":l[15]||(l[15]=e=>f(C).endStorageAge=e)},null,8,["modelValue"]),d(A,{style:{"padding-left":"8rpx"}},{default:u((()=>[v("天")])),_:1})])),_:1})])),_:1}),d(I,{class:"models"},{default:u((()=>[d(I,{class:"sub-title"},{default:u((()=>[v("销售方式")])),_:1}),d(I,{class:"carbody-inner"},{default:u((()=>[(n(!0),p(b,null,m(e.methodTypes,(e=>(n(),i(I,{onClick:a=>E("salesMethod",e,"key"),class:h([{active:f(C).salesMethod==e.key},"body-item"]),key:e.key},{default:u((()=>[d(I,{class:"text"},{default:u((()=>[v(S(e.value),1)])),_:2},1024)])),_:2},1032,["onClick","class"])))),128))])),_:1})])),_:1}),d(I,{class:"models"},{default:u((()=>[d(I,{class:"sub-title"},{default:u((()=>[v("小程序上架")])),_:1}),d(I,{class:"carbody-inner"},{default:u((()=>[(n(!0),p(b,null,m(f(N),(e=>(n(),i(I,{onClick:a=>E("microStoreShelfStatus",e,"val"),class:h([{active:f(C).microStoreShelfStatus==e.val},"body-item"]),key:e.label},{default:u((()=>[d(I,{class:"text"},{default:u((()=>[v(S(e.label),1)])),_:2},1024)])),_:2},1032,["onClick","class"])))),128))])),_:1})])),_:1}),["ON_SALE","ON_SALE_ALL","SOLD_OUT"].includes(e.typeVal)?(n(),i(I,{key:0,class:"models"},{default:u((()=>[d(I,{class:"sub-title"},{default:u((()=>[v("上架天数")])),_:1}),d(I,{class:"month-inner"},{default:u((()=>[d(w,{clearable:"",type:"number",placeholder:"请输入",onChange:l[16]||(l[16]=e=>L(e,"startOnSaleDays","int")),onBlur:l[17]||(l[17]=e=>V(e,"startOnSaleDays","endOnSaleDays","start")),modelValue:f(C).startOnSaleDays,"onUpdate:modelValue":l[18]||(l[18]=e=>f(C).startOnSaleDays=e)},null,8,["modelValue"]),d(A,{class:"symbol"},{default:u((()=>[v("-")])),_:1}),d(w,{clearable:"",type:"number",placeholder:"请输入",onChange:l[19]||(l[19]=e=>L(e,"endOnSaleDays","int")),onBlur:l[20]||(l[20]=e=>V(e,"endOnSaleDays","startOnSaleDays","end")),modelValue:f(C).endOnSaleDays,"onUpdate:modelValue":l[21]||(l[21]=e=>f(C).endOnSaleDays=e)},null,8,["modelValue"]),d(A,{style:{"padding-left":"8rpx"}},{default:u((()=>[v("天")])),_:1})])),_:1})])),_:1})):g("",!0)])),_:1}),d(I,{class:"btns"},{default:u((()=>[d(I,{class:"btn-box"},{default:u((()=>[d(I,{onClick:R,class:"reset-btn"},{default:u((()=>[v("重置")])),_:1}),d(I,{onClick:j,class:"confirm-car"},{default:u((()=>[v("查询")])),_:1})])),_:1})])),_:1})])),_:1})])),_:1})}}}),Ae=A(ke,[["__scopeId","data-v-87d602cb"]]),we=e({__name:"filter",props:{methodTypes:{type:Array,default:()=>[]},typeVal:{type:String,default:""}},emits:["search","filter"],setup(e,{expose:c,emit:y}){const D=y,k=a(),A=w({orders:"latestRelease",rentalWay:"day_rental",brandId:"",seriesId:"",powerType:"",priceHigh:"",priceLow:"",stockStatus:"",registerDateStart:"",registerDateEnd:"",mileageArrs:"",salesMethod:"",startMileage:"",endMileage:"",startStorageAge:"",endStorageAge:"",startOnSaleDays:"",endOnSaleDays:"",salesType:"",bodyColor:[],colorDataArrs:"",dischargeStandard:""}),O=a(""),L=a(""),V=a([{label:"最新上架",val:"latestRelease"},{label:"报价最高",val:"highestBid"},{label:"报价最低",val:"lowestBid"},{label:"车龄最短",val:"shortestVehicleAge"},{label:"里程最少",val:"leastMileage"},{label:"库龄最短",val:"minimumStorageAge"},{label:"库龄最长",val:"longestStorageAge"}]),x=a([{label:"不限",val:"0,0"},{label:"3万以下",val:"0,3"},{label:"3-5万",val:"3,5"},{label:"5-8万",val:"5,8"},{label:"8-10万",val:"8,10"},{label:"10-15万",val:"10,15"},{label:"15-20万",val:"15,20"},{label:"20-30万",val:"20,30"},{label:"30-50万",val:"30,50"},{label:"50-100万",val:"50,100"},{label:"100万以上",val:"100"}]),T=a([]);a([]);const H=a(0),B=a(0);a(0),a(0);const N=a(),E=e=>{1==e&&N.value.open();for(const a in A)te.value.hasOwnProperty(a)&&(A[a]=te.value[a],F.value[a]=te.value[a])},$=()=>{F.value.hasOwnProperty("priceLow")||(A.prices="")},R=()=>{A.brandId="",A.seriesId="",O.value="",L.value="",H.value=0,F.value.brandId="",F.value.seriesId="",A.priceLow="不限",A.priceHigh="不限",F.value.priceLow="",F.value.priceHigh="",k.value.highlight(1,null),k.value.highlight(2,null),B.value=0,Z(T.value[0].id)},j=a([]),F=a({stockStatus:"",registerDateStart:"",registerDateEnd:"",mileageArrs:"",startMileage:null,endMileage:null,startStorageAge:null,endStorageAge:null,startOnSaleDays:null,endOnSaleDays:null,salesMethod:"",bodyColor:[],dischargeStandard:"",microStoreShelfStatus:""}),U=e=>{F.value=e};M((async()=>{W(),uni.$u.http.get("/product/merchant/car/product/conditionListToMerchantPage").then((e=>{j.value=e.data.bodyColors})),k.value.highlight(0,"latestRelease")}));const P=a(null),z=(e,a="")=>{a&&k.value.close();const l=[];["stockStatus","registerDateStart","registerDateEnd","mileageArrs","salesMethod","startMileage","endMileage","startStorageAge","endStorageAge","startOnSaleDays","endOnSaleDays","salesType","bodyColor","colorDataArrs","dischargeStandard","microStoreShelfStatus"].map((a=>{Array.isArray(e[a])?e[a]&&e[a].length>0?l.push(1):l.push(2):e[a]?l.push(1):l.push(2)})),l.includes(1)?k.value.highlight(3,e):k.value.highlight(3,""),(A.brandId||A.seriesId)&&k.value.highlight(1,A.brandId),A.prices&&"0,0"!==A.prices?k.value.highlight(2,A.prices):A.prices="",e.orders=A.orders,P.value=e,F.value=e,D("search",e)},J=e=>{switch(e){case"latestRelease":return"最新上架";case"highestBid":return"报价最高";case"lowestBid":return"报价最低";case"shortestVehicleAge":return"车龄最短";case"leastMileage":return"里程最少";case"minimumStorageAge":return"库龄最短";case"longestStorageAge":return"库龄最长";default:return""}},W=()=>{uni.$u.http.get("/product/common/getSearchBrand",{params:{type:0}}).then((e=>{T.value=e.data,Z(T.value[0].id)}))},q=(e,a,l)=>{if(A[e]=a.val,k.value.highlight(l,a.val),"prices"==e){const a=A[e].split(",");a.length>1?"0,0"==A[e]?(A.priceLow="",A.priceHigh="",k.value.highlight(2,"")):(A.priceLow=a[0],A.priceHigh=a[1]):(A.priceLow=a[0],A.priceHigh="")}else F.value.brandId=A.brandId,F.value.seriesId=A.seriesId,F.value.orders=A.orders,se()},G=()=>{F.value.priceLow=A.priceLow,F.value.priceHigh=A.priceHigh,ee()};l((()=>[A.priceHigh,A.priceLow]),(()=>{if("不限"==A.priceHigh&&"不限"==A.priceLow)return A.priceHigh="",A.priceLow="",A.prices="",void k.value.highlight(2,"");A.priceHigh||A.priceLow?A.priceHigh&&!A.priceLow?(k.value.highlight(2,`${A.priceHigh}`),A.prices=`${A.priceHigh}`):A.priceLow&&!A.priceHigh?(k.value.highlight(2,`${A.priceLow}`),A.prices=`${A.priceLow}`):A.priceLow&&A.priceHigh&&(k.value.highlight(2,`${A.priceLow},${A.priceHigh}`),A.prices=`${A.priceLow},${A.priceHigh}`):(A.priceHigh="",A.priceLow="",A.prices="0,0",k.value.highlight(2,""))}));const Y=a([]),Z=e=>{uni.$u.http.get("/product/common/getSearchSeries",{params:{type:0,brandId:e}}).then((a=>{Y.value=a.data,O.value=e}))},ee=async()=>{P.value&&(A.brandId=P.value.brandId,A.seriesId=P.value.seriesId,A.orders=P.value.orders||"latestRelease",await le()),se()},ae=async(e,a)=>{e.value&&(A.brandId=e),a.value&&(A.seriesId=a),k.value.highlight(1,a||e),F.value.brandId=e,F.value.seriesId=a,P.value&&await le(),se()},le=()=>{A.powerType=P.value.powerType,A.stockStatus=P.value.stockStatus,A.registerDateStart=P.value.registerDateStart,A.registerDateEnd=P.value.registerDateEnd,A.mileageArrs=P.value.mileageArrs,A.salesMethod=P.value.salesMethod,A.startMileage=P.value.startMileage,A.endMileage=P.value.endMileage,A.startStorageAge=P.value.startStorageAge,A.endStorageAge=P.value.endStorageAge,A.startOnSaleDays=P.value.startOnSaleDays,A.endOnSaleDays=P.value.endOnSaleDays,A.salesType=P.value.salesType,A.bodyColor=P.value.bodyColor,A.colorDataArrs=P.value.colorDataArrs,A.dischargeStandard=P.value.dischargeStandar},te=a({}),se=()=>{const e={...A,...F.value};te.value=e,D("search",e),k.value.close()},re=(e,a)=>{const l=A.priceLow,t=A.priceHigh;if(l&&t&&parseFloat(l)>parseFloat(t))return I({title:"最高价必须大于最低价",icon:"none"}),void(A[a]="")},ie=a();return c({clearTabStatus:()=>{ie.value.resetFilter()}}),(a,l)=>{const c=o,y=t(r("up-icon"),C),D=t(r("up-input"),s),I=_;return n(),i(K,{ref_key:"uDropdownRef",ref:k,class:"drop",borderRadius:"20rpx",onOpen:E,onClose:$},{default:u((()=>[d(Q,{title:J(f(A).orders)},{default:u((()=>[d(c,{class:"item-list"},{default:u((()=>[(n(!0),p(b,null,m(f(V),((e,a)=>(n(),i(c,{key:a,class:h({active:f(A).orders==e.val}),onClick:a=>q("orders",e,0)},{default:u((()=>[d(c,null,{default:u((()=>[v(S(e.label),1)])),_:2},1024),f(A).orders==e.val?(n(),i(y,{key:0,name:"checkbox-mark",color:"#DD4F33",size:"20"})):g("",!0)])),_:2},1032,["class","onClick"])))),128))])),_:1})])),_:1},8,["title"]),d(Q,{title:"品牌车型"},{default:u((()=>[d(X,{ref_key:"brandDropRef",ref:N,onSearch:ae,pBrand:f(A).brandId,pSeries:f(A).seriesId},null,8,["pBrand","pSeries"])])),_:1}),d(Q,{title:"价格"},{default:u((()=>[d(c,{class:"price-list"},{default:u((()=>[d(c,{class:"price-item"},{default:u((()=>[(n(!0),p(b,null,m(f(x),((e,a)=>(n(),i(c,{key:a,class:h({active:f(A).prices==e.val}),onClick:a=>q("prices",e,2)},{default:u((()=>[v(S(e.label),1)])),_:2},1032,["class","onClick"])))),128))])),_:1}),d(c,{class:"customs"},{default:u((()=>[d(D,{type:"number",inputAlign:"center",placeholder:"最低价",border:"bottom",modelValue:f(A).priceLow,"onUpdate:modelValue":l[0]||(l[0]=e=>f(A).priceLow=e),clearable:"",onBlur:l[1]||(l[1]=e=>re(0,"priceLow"))},null,8,["modelValue"]),d(I,null,{default:u((()=>[v("-")])),_:1}),d(D,{type:"number",inputAlign:"center",placeholder:"最高价",border:"bottom",modelValue:f(A).priceHigh,"onUpdate:modelValue":l[2]||(l[2]=e=>f(A).priceHigh=e),clearable:"",onBlur:l[3]||(l[3]=e=>re(0,"priceHigh"))},null,8,["modelValue"])])),_:1}),d(c,{onClick:G,class:"btns"},{default:u((()=>[v("确认")])),_:1})])),_:1})])),_:1}),d(Q,{title:"筛选"},{default:u((()=>[d(c,{class:"all-list"},{default:u((()=>[(n(),i(Ae,{key:Math.random(),ref_key:"allFilterRef",ref:ie,initData:f(F),methodTypes:e.methodTypes,colorData:f(j),typeVal:e.typeVal,onClearOut:R,onSaveStatusVal:U,onFilterList:z},null,8,["initData","methodTypes","colorData","typeVal"]))])),_:1})])),_:1})])),_:1},512)}}}),Me=A(we,[["__scopeId","data-v-b6ad4944"]]),Ce=A(e({__name:"SelectCarSeriesPicker",props:O({title:{},maxSelect:{}},{visible:{type:Boolean,required:!0},visibleModifiers:{}}),emits:O(["confirm","cancel"],["update:visible"]),setup(e,{emit:l}){const s=e,y=l,D=L(e,"visible"),I=a([]),A=a([]),w=a(0),O=a(0),E=a(0),$=a(0),R=()=>{},j=async e=>{if(!e)return;const a=await uni.$u.http.get("/product/common/simpleListBySeries",{params:{type:0,brandId:e}}),l=A.value.find((a=>a.brandId==e));l.children=(a.data||[]).map((a=>({...a,brandId:e,brandName:l.name,seriesId:a.id,seriesName:a.name,type:"series"})))},F=N(),U=async(e,a)=>{await k();B().in(F).select("."+e).fields({size:!0},(l=>{if(!l)return void setTimeout((()=>{U(e)}),10);const t=l.height;"menuHeight"==a?E.value=t:$.value=t})).exec()},P=()=>{D.value=!1,y("cancel"),z()};function z(){I.value=[],O.value=0}const J=()=>{D.value=!1,y("confirm",[...I.value]),z()};return M((async()=>{var e;await(async()=>{const e=await uni.$u.http.get("/product/common/simpleListByBrand",{params:{type:0}});A.value=(e.data||[]).map((e=>({...e,brandName:e.name,brandId:e.id,type:"brand"})))})(),A.value.length&&j(null==(e=A.value[0])?void 0:e.brandId)})),(e,a)=>{const l=H,y=_,k=o,M=c,L=t(r("up-icon"),C),B=t(r("up-loading-icon"),V),N=t(r("up-popup"),x);return n(),p("div",{class:"select-car-series-picker"},[d(N,{title:s.title,show:D.value,onOpen:R},{default:u((()=>[d(k,{class:"u-menu-wrap"},{default:u((()=>[f(A).length?(n(),p(b,{key:0},[d(M,{"scroll-y":"","scroll-with-animation":"",class:"u-tab-view menu-scroll-view","scroll-top":f(w)},{default:u((()=>[(n(!0),p(b,null,m(f(A),((e,a)=>(n(),i(k,{key:a,class:h(["u-tab-item",[f(O)==a?"u-tab-item-active":""]]),"data-current":a,onClick:T((e=>(async e=>{if(e==O.value)return;O.value=e,0!=E.value&&0!=$.value||(await U("menu-scroll-view","menuHeight"),await U("u-tab-item","menuItemHeight")),w.value=e*$.value+$.value/2-E.value/2;const a=A.value[e];a.children||j(a.brandId)})(a)),["stop"])},{default:u((()=>[d(l,{src:e.icon,mode:"widthFix"},null,8,["src"]),d(y,{class:"u-line-1"},{default:u((()=>[v(S(e.name),1)])),_:2},1024)])),_:2},1032,["class","data-current","onClick"])))),128))])),_:1},8,["scroll-top"]),(n(!0),p(b,null,m(f(A),((e,a)=>(n(),p(b,{key:a},[f(O)==a?(n(),i(M,{key:0,"scroll-y":"",class:"right-box"},{default:u((()=>[(n(!0),p(b,null,m(e.children,(e=>(n(),i(k,{class:"page-view",key:e.id,onClick:a=>(e=>{const a=I.value.findIndex((a=>a.id===e.id));a<0&&s.maxSelect&&I.value.length>=s.maxSelect?uni.$u.toast(`最多选择 ${s.maxSelect} 个`):a>-1?I.value.splice(a,1):I.value.push(e)})(e)},{default:u((()=>[d(y,{class:"u-line-1"},{default:u((()=>[v(S(e.name),1)])),_:2},1024),f(I).includes(e)?(n(),i(L,{key:0,name:"checkbox-mark",color:"#DD4F33",size:"20"})):g("",!0)])),_:2},1032,["onClick"])))),128))])),_:2},1024)):g("",!0)],64)))),128))],64)):(n(),i(B,{key:1,class:"loading-icon",size:"32"}))])),_:1}),d(k,{class:"brand-btn"},{default:u((()=>[d(k,{class:"clear",onClick:P},{default:u((()=>[v("取消")])),_:1}),d(k,{class:"sure",onClick:J},{default:u((()=>[v("确定")])),_:1})])),_:1})])),_:1},8,["title","show"])])}}}),[["__scopeId","data-v-7b6cdf94"]]),Oe=A(e({__name:"carSeries",setup(e){const l=te(),s=E((()=>l.value.data?JSON.parse(l.value.data):{})),c=E((()=>{var e;return(null==(e=s.value)?void 0:e.check)||[]})),g=a([]),h=a(),y=a([]),_=E((()=>Ie(y.value,(e=>e.seriesId||e.carSeriesId)))),D=a(!1),I=w({current:1,size:5,total:0,status:"ON_SALE",orders:"latestRelease",priceHigh:"",priceLow:"",brandId:"",seriesId:"",stockStatus:"",registerDateStart:"",registerDateEnd:"",mileageArrs:"",startMileage:"",endMileage:"",startStorageAge:"",endStorageAge:"",startOnSaleDays:"",endOnSaleDays:"",salesType:"",colorDataArrs:"",dischargeStandard:"",microStoreShelfStatus:""});$((e=>{I.brandId=e.brandId,I.seriesId=e.seriesId,I.modelId=e.modelId,c.value.length&&(y.value=[...c.value]),O()}));const k=a([]),A=a([]),M=a(!0);function C(){const e=_.value.length>=5;return e&&uni.$u.toast("最多选择 5 个"),e}R((()=>{var e;A.value=JSON.parse(j("userBtnPermission")).map((e=>e)),A.value.includes("product:info")||A.value.includes("inventory:info")?M.value=!0:M.value=!1,I.current=1,null==(e=h.value)||e.initTop(),O(),uni.$u.http.get("product/common/getInitSelect").then((e=>{const a=e.data;k.value=a.SalesMethodEnum}))}));async function O(){var e;try{const e={...oe(I,"total")},a=await F().post("/product/carProductApp/vehiclePage",e);I.total=a.data.count;const l=a.data.results.map((e=>({...e,type:"model"})));g.value=1===I.current?l:[...g.value,...l]}finally{null==(e=h.value)||e.loadFinish()}}const L=()=>{I.current=1,O()},V=()=>{I.current++,O()},x=e=>{var a;I.current=1,I.brandId=e.brandId?[e.brandId]:[],I.seriesId=e.seriesId?[e.seriesId]:[],I.priceHigh=e.priceHigh||"",I.priceLow=e.priceLow||"",I.orders=e.orders||"latestRelease",I.stockStatus=e.stockStatus,I.registerDateStart=e.registerDateStart,I.registerDateEnd=e.registerDateEnd,I.mileageArrs=e.mileageArrs,I.startMileage=e.startMileage,I.endMileage=e.endMileage,I.startStorageAge=e.startStorageAge,I.endStorageAge=e.endStorageAge,I.startOnSaleDays=e.startOnSaleDays,I.endOnSaleDays=e.endOnSaleDays,I.salesType=e.salesType,I.colorDataArrs=e.colorDataArrs,I.dischargeStandard=e.dischargeStandard,I.microStoreShelfStatus=e.microStoreShelfStatus,I.bodyColor=e.bodyColor,I.salesMethod=e.salesMethod,O(),null==(a=h.value)||a.initTop()},T=a();function H(){C()||(D.value=!0)}function B(e){const a=e.map((e=>({carBrandId:e.brandId,carBrandName:e.brandName,carSeriesId:e.id,carSeriesName:e.name}))).filter((e=>!y.value.some((a=>N(a)===N(e)))));y.value.push(...a)}function N(e){return e.carSeriesId||e.seriesId}function K(e){var a;e&&le({queryData:null==(a=l.value)?void 0:a.data,data:[..._.value].map((e=>({sellInventorySourceId:e.sellInventorySourceId,carSourceId:"model"==e.type||e.carSourceId?e.id||e.carSourceId:"",carBrandId:e.carBrandId,carSeriesId:e.carSeriesId,carModelId:e.carModelId,carBrandName:e.carBrandName,carSeriesName:e.carSeriesName,carModelName:e.carModelName,carSourceName:e.carModelFullName||e.carSourceName})))}),Y()}return(e,a)=>{const l=t(r("up-tag"),U),s=o,c=q;return n(),i(s,{class:"page f-c-s car-lists"},{default:u((()=>[P("div",{class:"check-list-box"},[(n(!0),p(b,null,m(f(_),(e=>(n(),i(l,{key:e.carSeriesId||e.seriesId,text:e.carSeriesName||e.seriesName,size:"mini",type:"error",closable:"",onClose:a=>{return l=e,void(y.value=y.value.filter((e=>N(e)!==N(l))));var l}},null,8,["text","onClose"])))),128)),d(l,{onClick:H,text:"+自选车系",plain:"",size:"mini",type:"error"})]),d(Me,{ref_key:"filterRef",ref:T,methodTypes:f(k),typeVal:f(I).status,onSearch:x},null,8,["methodTypes","typeVal"]),d(s,{class:"total"},{default:u((()=>[d(s,null,{default:u((()=>[v("共找到 "+S(f(I).total)+" 个",1)])),_:1}),P("div",{class:"yellow-text"},"最多选择 "+S(5)+" 个")])),_:1}),d(ee,z({ref_key:"listLoadRef",ref:h,class:"scroll-view-box"},f(I),{istop:!1,onLoadMore:V,onLoadRefresh:L}),{default:u((()=>[J(d(s,{class:"list-box"},{default:u((()=>[(n(!0),p(b,null,m(f(g),(e=>(n(),i(ae,{key:e.id,hasCheck:"",item:e,maxSelect:5,hasCarAuth:f(M),onSelect:a=>(e=>{const a=y.value.findIndex((a=>(a.id||a.carSourceId)===e.id)),l=a<0;l&&C()||(l?y.value.push(e):y.value.splice(a,1))})(e),isChecked:f(y).some((a=>(a.id||a.carSourceId)==e.id)),isSold:"SOLD_OUT"==f(I).status},null,8,["item","hasCarAuth","onSelect","isChecked","isSold"])))),128))])),_:1},512),[[W,f(g).length]])])),_:1},16),d(s,{class:"bottom-btn"},{default:u((()=>[d(c,{onClick:a[0]||(a[0]=e=>K(!1))},{default:u((()=>[v("取消")])),_:1}),d(c,{class:"save-btn",onClick:a[1]||(a[1]=e=>K(!0))},{default:u((()=>[v("确定")])),_:1})])),_:1}),d(Ce,{"max-select":5-f(_).length,visible:f(D),"onUpdate:visible":a[2]||(a[2]=e=>G(D)?D.value=e:null),onConfirm:B},null,8,["max-select","visible"])])),_:1})}}}),[["__scopeId","data-v-2e0d095d"]]);export{Oe as default};
