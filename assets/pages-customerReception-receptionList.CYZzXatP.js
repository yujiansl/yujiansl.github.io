import{d as e,r as a,E as l,X as t,Y as s,v as r,I as i,M as u,K as n,c as d,o,i as c,w as v,a as p,a5 as g,k as h,u as m,b as f,y,t as b,S as _,P as I,g as S,R as k,Q as T,e as C,n as D,F as M,_ as R,q as w,s as L,b9 as O,z as x,h as A,ak as U,a9 as j,G as P,B,Z as N,$ as F,a2 as V,ad as $,O as z,T as E}from"./index-CK4DGatK.js";import{_ as J}from"./add.BenfLO0n.js";import{N as H}from"./NavBar.DSs5OGCU.js";import{U as G,a as Q}from"./u-dropdown-item.B66HFyYv.js";import{_ as Y,a as q,C as K}from"./carType.25_hgCxl.js";import{D as W}from"./datePicker.DPajrKz9.js";import{L as X}from"./ListLoadRefreshView.CnNC2lkG.js";import{o as Z}from"./omit.DzeQdT5l.js";import"./_baseGet.CmhOSbYr.js";import"./_getTag.DG-N9UUn.js";import"./isObject.C8HfsiHw.js";import"./isSymbol.Bym6OQCA.js";import"./_Uint8Array.B4mhORiM.js";import"./_baseClone.Cc-Y92km.js";const ee=R(e({__name:"allFilter",props:{dictData:{type:Object,default:()=>{}},initData:{type:Object,default:()=>{}}},emits:["filterList","saveStatusVal","clearOut"],setup(e,{expose:R,emit:w}){const L=e,O=()=>{var e;const a=[x.value.dept];T("/pagesB/employeeManage/deptFilter"+((null==(e=x.value.dept)?void 0:e.id)?`?checkId=${JSON.stringify(a)}`:""))},x=a({dept:null,budgetRange:[],purchaseOrderDate:[],noDealReason:[],pricingCreateUser:"",pricingCreateUserId:""}),A=(e,a,l)=>{Array.isArray(x.value[e])?x.value[e].includes(a[l])?x.value[e]=x.value[e].filter((e=>e!==a[l])):x.value[e].push(a[l]):a[l]==x.value[e]?x.value[e]="":x.value[e]=a[l]};l((()=>{t("sellData"),s("sellData",(e=>{const{name:a,id:l}=e;x.value.pricingCreateUser=a,x.value.pricingCreateUserId=l})),t("deptData"),s("deptData",(e=>{x.value.dept=e}))}));const U=w,j=()=>{x.value={dept:null,budgetRange:[],purchaseOrderDate:[],noDealReason:[],pricingCreateUser:"",pricingCreateUserId:""},U("clearOut",{...x.value})};R({resetFilter:j});const P=async()=>{U("saveStatusVal",x.value),U("filterList",x.value,"close")};return r((()=>L.initData),(()=>{const e=JSON.parse(JSON.stringify(L.initData||"{}"));if("{}"==JSON.stringify(e))x.value={dept:{id:"",name:""},budgetRange:[],purchaseOrderDate:[],noDealReason:[],pricingCreateUser:"",pricingCreateUserId:""};else for(const a in e)Object.prototype.hasOwnProperty.call(x.value,a)&&(x.value[a]=e[a])}),{deep:!0,immediate:!0}),(a,l)=>{const t=i(n("up-icon"),u),s=c,r=I,R=k,w=g;return o(),d(s,{class:"all-filter"},{default:v((()=>[p(w,{class:"scrolls","scroll-y":""},{default:v((()=>[p(s,{class:"content"},{default:v((()=>[p(s,{class:"models"},{default:v((()=>[p(s,{class:"sub-title",style:{display:"flex","justify-content":"space-between","align-items":"center"}},{default:v((()=>[h("div",null,"部门"),h("div",null,[p(t,{name:"trash",size:"32rpx",onClick:l[0]||(l[0]=e=>m(x).dept=null)})])])),_:1}),p(s,{class:"user-inner"},{default:v((()=>{var e,a,t;return[h("div",{class:"inner-box"},[(null==(e=m(x).dept)?void 0:e.id)?(o(),f("div",{key:0,class:"inner-item",onClick:O,style:{position:"relative"}},[h("div",{class:"inner-item-text"},b(null==(a=m(x).dept)?void 0:a.name),1),h("div",{class:"close-btn",onClick:l[1]||(l[1]=_((e=>m(x).dept={}),["stop"]))},[p(r,{src:Y,mode:"widthFix"})])])):y("",!0),(null==(t=m(x).dept)?void 0:t.id)?y("",!0):(o(),f("div",{key:1,class:"inner-item add-btn",onClick:O},[h("div",null,[p(r,{src:q,mode:"widthFix"})]),h("div",{style:{color:"#3c73ff"}},"添加")]))])]})),_:1})])),_:1}),p(s,{class:"models"},{default:v((()=>[p(s,{class:"sub-title"},{default:v((()=>[S("销售员")])),_:1}),p(s,{style:{position:"relative"}},{default:v((()=>[p(R,{modelValue:m(x).pricingCreateUser,"onUpdate:modelValue":l[2]||(l[2]=e=>m(x).pricingCreateUser=e),placeholder:"请输入",onClick:l[3]||(l[3]=e=>("toPage"in a?a.toPage:m(T))(`/pages/carManage/sellUserList?title=销售员&id=${m(x).pricingCreateUserId}&userType=APPRAISER`))},null,8,["modelValue"]),m(x).pricingCreateUser?(o(),d(t,{key:0,name:"close-circle",size:"20",class:"close",onClick:l[4]||(l[4]=()=>{m(x).pricingCreateUser="",m(x).pricingCreateUserId=[]})})):y("",!0)])),_:1})])),_:1}),p(s,{class:"models"},{default:v((()=>[p(s,{class:"sub-title"},{default:v((()=>[S("预算区间")])),_:1}),p(s,{class:"carbody-inner"},{default:v((()=>[(o(!0),f(M,null,C(e.dictData.receptionList,(e=>(o(),d(s,{onClick:a=>A("budgetRange",e,"value"),class:D([{active:m(x).budgetRange.includes(e.value)},"body-item"]),key:e.key},{default:v((()=>[p(s,{class:"text"},{default:v((()=>[S(b(e.label),1)])),_:2},1024)])),_:2},1032,["onClick","class"])))),128))])),_:1})])),_:1}),p(s,{class:"models"},{default:v((()=>[p(s,{class:"sub-title"},{default:v((()=>[S("未成交原因")])),_:1}),p(s,{class:"carbody-inner"},{default:v((()=>[(o(!0),f(M,null,C(e.dictData.reasonList,(e=>(o(),d(s,{onClick:a=>A("noDealReason",e,"value"),class:D([{active:m(x).noDealReason.includes(e.value)},"body-item"]),key:e.key},{default:v((()=>[p(s,{class:"text"},{default:v((()=>[S(b(e.label),1)])),_:2},1024)])),_:2},1032,["onClick","class"])))),128))])),_:1})])),_:1}),p(s,{class:"models"},{default:v((()=>[p(s,{class:"sub-title"},{default:v((()=>[S("创建日期")])),_:1}),p(W,{creatAt:m(x).purchaseOrderDate,"onUpdate:creatAt":l[5]||(l[5]=e=>m(x).purchaseOrderDate=e)},null,8,["creatAt"])])),_:1})])),_:1})])),_:1}),p(s,{class:"btns"},{default:v((()=>[p(s,{class:"btn-box"},{default:v((()=>[p(s,{onClick:j,class:"reset-btn"},{default:v((()=>[S("重置")])),_:1}),p(s,{onClick:P,class:"confirm-car"},{default:v((()=>[S("查询")])),_:1})])),_:1})])),_:1})])),_:1})}}}),[["__scopeId","data-v-2473b685"]]),ae=R(e({__name:"brandDrop",props:{pBrand:{type:[String||Array]},pSeries:{type:[String||Array]},carType:{type:String},isMultiple:{type:Boolean,default:!1},typeMethod:{type:String,default:"common"},isModelAll:{type:Boolean,default:!1}},emits:["search"],setup(e,{expose:l,emit:t}){const s=a(""),k=t,T=e;r((()=>[T.pBrand,T.pSeries]),(async e=>{T.isMultiple?e[0].length||e[1].length||(E.value=N.value[0].list[0].id,B.value=[]):(j.value=e[0]||"",P.value=e[1]||"",""==j.value&&""==P.value&&(E.value=N.value[0].list[0].id,ee(N.value[0].list[0].id)))}),{deep:!0});const R=a(""),j=a(""),P=a(""),B=a([]),N=a([]),F=a([]),V=a([]),$=a(0),z=a(0),E=a(0),J=a(0),H=a(0);w((async()=>{Z()}));const G=e=>{Z(e)};r((()=>B.value),(async e=>{await Z(s.value,!1)}),{deep:!0});const Q=async e=>{if(!e){const a=await Z(e);q.value=a?N.value[0].title:""}},Y=e=>{K.value.map((a=>{e.detail.scrollTop>=a.offsetTop-K.value[0].offsetTop-4&&(q.value=a.getAttribute("data-title"))}))},q=a(""),K=a([]),W=a(),X=a(!1),Z=(e="",a=!0)=>new Promise((l=>{const t="common"==T.typeMethod?"/product/common/simpleListByBrand":"/product/carProductApp/getBrand",s="common"==T.typeMethod?{params:{type:0,name:e}}:{params:{vehicleStatus:T.carType,name:e}};T.isModelAll&&(s.params.containsAll=!0),uni.$u.http.get(t,s).then((e=>{X.value=!0;const t=e.data.map((e=>e.initial));F.value=Array.from(new Set(t)),N.value=F.value.map((a=>{const l=e.data.filter((e=>e.initial==a)).map((e=>{const a=B.value.filter((a=>a.brandTag==e.id&&a.seriesTag&&"-1"!==a.seriesTag));return{...e,count:T.isMultiple&&a.length||0}}));return{title:a,list:l}})),N.value&&N.value.length&&a&&(E.value=N.value[0].list[0].id,$.value=20,ee(N.value[0].list[0].id),L((async()=>{$.value=0,await new Promise((e=>{K.value=W.value,e(K.value)}))})),l(!0)),a||l(!0)}))})),ee=e=>{const a="common"==T.typeMethod?"/product/common/simpleListBySeries":"/product/carProductApp/getSeries",l="common"==T.typeMethod?{params:{type:0,brandId:e,containsAll:!0}}:{params:{vehicleStatus:T.carType,brandId:e,containsAll:!0}};uni.$u.http.get(a,l).then((e=>{V.value=e.data})),console.log(!T.isMultiple,"!props.isMultiple----"),T.isMultiple||(j.value=e,P.value=V.value.some((e=>e.id==T.pSeries))?T.pSeries:""),z.value=20,L((async()=>{z.value=0}))},ae=(e,a)=>{new Promise(((l,t)=>{U().select("."+e).fields({size:!0},(t=>{if(!t)return void setTimeout((()=>{ae(e)}),10);l();const s=t.height;"menuHeight"==a?J.value=s:H.value=s})).exec()}))},le=async()=>{T.isMultiple?(j.value=[],P.value=[],B.value=[],s.value="",await Z()):(j.value="",P.value="",s.value=""),N.value.length>0&&(T.isMultiple?(E.value=N.value[0].list[0].id,ee(N.value[0].list[0].id),B.value=[],k("search",j.value,P.value,B.value)):k("search",j.value,P.value))},te=()=>{if(N.value.length||(console.log(!N.value.length,"!brandArr.value.length----------"),s.value||(j.value=T.isMultiple?[]:"",P.value=T.isMultiple?[]:"",B.value=[])),T.isMultiple){const e=B.value.map((e=>e.brandTag)),a=B.value.map((e=>e.seriesTag));console.log(B.value,"seriesIdObj.value----------"),B.value.length||B.value.push({brandTag:E.value,seriesTag:""}),k("search",e,a,B.value)}else P.value="-1"==P.value?"":P.value,k("search",j.value||"",P.value||"")};return l({open:()=>{if(T.isMultiple){if(s.value="",j.value=T.pBrand||[],P.value=T.pSeries||[],!j.value.length)return E.value=N.value[0].list[0].id,j.value=[E.value],ee(E.value),$.value=20,L((async()=>{$.value=0})),!1;j.value.length>0&&(j.value.includes(E.value)||(E.value=j.value[0]),ee(E.value))}else j.value=T.pBrand||"",P.value=T.pSeries||"",j.value||(j.value=E.value),j.value&&j.value!=E.value&&(E.value=j.value,ee(j.value));R.value="",L((()=>{R.value=`scroll${j.value}`}))},handleClearSearch:()=>{s.value=""}}),(a,l)=>{const t=i(n("up-search"),O),r=c,k=I,w=A,L=g,U=i(n("up-icon"),u);return o(),d(r,null,{default:v((()=>[p(t,{modelValue:m(s),"onUpdate:modelValue":l[0]||(l[0]=e=>x(s)?s.value=e:null),placeholder:"请输入品牌搜索",onSearch:G,onCustom:G,onChange:Q,"show-action":!0,actionText:"搜索"},null,8,["modelValue"]),p(r,{class:"u-menu-wrap"},{default:v((()=>[m(X)&&m(N).length?(o(),f(M,{key:0},[p(r,{class:"left-box"},{default:v((()=>[p(L,{"scroll-y":"","scroll-with-animation":"",class:"u-tab-view menu-scroll-view","scroll-top":m($),onScroll:Y,"scroll-into-view":m(R)},{default:v((()=>[(o(!0),f(M,null,C(m(N),((e,a)=>(o(),d(r,{key:a},{default:v((()=>[h("div",{"data-title":e.title,ref_for:!0,ref_key:"subTitleRef",ref:W,class:"sub-title"},b(e.title),9,["data-title"]),(o(!0),f(M,null,C(e.list,((e,a)=>(o(),d(r,{key:a,class:D(["u-tab-item",[m(E)==e.id?"u-tab-item-active":""]]),"data-current":e.id,onClick:_((a=>(async e=>{e.id!=E.value&&(E.value=e.id,1==B.value.length&&""==B.value[0].seriesTag&&(B.value=[]),0!=J.value&&0!=H.value||(await ae("menu-scroll-view","menuHeight"),await ae("u-tab-item","menuItemHeight")),ee(e.id))})(e)),["stop"]),id:`scroll${e.id}`},{default:v((()=>[p(r,null,{default:v((()=>[S(b(e.title),1)])),_:2},1024),p(k,{src:e.icon,mode:"widthFix"},null,8,["src"]),p(w,{class:"u-line-1"},{default:v((()=>[S(b(e.name),1)])),_:2},1024),e.count?(o(),d(r,{key:0,class:"brand-count"},{default:v((()=>[S(b(e.count),1)])),_:2},1024)):y("",!0)])),_:2},1032,["class","data-current","onClick","id"])))),128))])),_:2},1024)))),128))])),_:1},8,["scroll-top","scroll-into-view"]),p(L,{"scroll-y":"",class:"index-list"},{default:v((()=>[(o(!0),f(M,null,C(m(F),((e,a)=>(o(),d(r,{onClick:a=>(e=>{if(e==q.value)return;let a=0;q.value=e,K.value.map((l=>{e!=l.getAttribute("data-title")||(a=l.offsetTop)})),$.value=a-K.value[0].offsetTop})(e),key:a,class:D([{active:m(q)==e},"index-item"])},{default:v((()=>[S(b(e),1)])),_:2},1032,["onClick","class"])))),128))])),_:1})])),_:1}),(o(!0),f(M,null,C(m(N),((a,l)=>(o(),f(M,{key:l},[(o(!0),f(M,null,C(a.list,((a,l)=>(o(),f(M,{key:l},[m(E)==a.id?(o(),d(L,{key:0,"scroll-y":"","scroll-top":m(z),class:"right-box"},{default:v((()=>[(o(!0),f(M,null,C(m(V),((l,t)=>(o(),d(r,{class:"page-view",key:t,onClick:e=>(async(e,a)=>{var l,t;if(1!=B.value.length||B.value[0].seriesTag||(B.value=[]),T.isMultiple){if("-1"===a.id){const l=P.value.includes(a.id);return B.value=[],P.value=[],void(l||V.value.forEach((a=>{B.value.push({brandTag:e.id,seriesTag:a.id}),P.value.push(a.id)})))}if(B.value.filter((l=>l.brandTag==e.id&&l.seriesTag==a.id)).length>0){P.value=P.value.filter((e=>e!=a.id));const l=B.value.findIndex((l=>l.seriesTag==a.id&&l.brandTag==e.id));B.value.splice(l,1)}else null==(l=P.value)||l.push(a.id),null==(t=B.value)||t.push({brandTag:e.id,seriesTag:a.id});if(B.value.filter((e=>-1!=+e.seriesTag)).length===V.value.filter((e=>-1!=+e.id)).length)P.value.includes("-1")||(P.value.push("-1"),B.value.push({brandTag:e.id,seriesTag:"-1"}));else if(P.value.includes("-1")){const e=P.value.findIndex((e=>"-1"==e));e>-1&&P.value.splice(e,1);const a=B.value.findIndex((e=>"-1"==e.seriesTag));a>-1&&B.value.splice(a,1)}}else j.value=e.id,P.value=a.id})(a,l)},{default:v((()=>[p(w,{class:"u-line-1"},{default:v((()=>[S(b(l.name),1)])),_:2},1024),e.isMultiple||a.id!=m(j)||l.id!=m(P)?y("",!0):(o(),d(U,{key:0,name:"checkbox-mark",color:"#ff5719",size:"20"})),e.isMultiple&&m(B).filter((e=>e.brandTag==a.id&&e.seriesTag==l.id)).length>0?(o(),d(U,{key:1,name:"checkbox-mark",color:"#ff5719",size:"20"})):y("",!0)])),_:2},1032,["onClick"])))),128))])),_:2},1032,["scroll-top"])):y("",!0)],64)))),128))],64)))),128))],64)):y("",!0),m(X)&&0==m(N).length?(o(),d(r,{key:1,class:"no-brand"},{default:v((()=>[S("暂无数据")])),_:1})):y("",!0)])),_:1}),p(r,{class:"brand-btn"},{default:v((()=>[p(r,{class:"clear",onClick:le},{default:v((()=>[S("清空")])),_:1}),p(r,{class:"sure",onClick:te},{default:v((()=>[S("确定")])),_:1})])),_:1})])),_:1})}}}),[["__scopeId","data-v-2be05454"]]),le=R(e({__name:"filter",props:{typeVal:{default:"ON_SALE"},choicenessFlag:{default:""},dictData:{default:()=>({})}},emits:["search","filter"],setup(e,{expose:l,emit:t}){const s=e,r=t,g=a(),h=j({orders:"recentlyCreate",rentalWay:"day_rental",brandId:[],seriesId:[],arriveStoreTime:"11",powerType:"",priceHigh:"",priceLow:"",stockStatus:"",registerDateStart:"",registerDateEnd:"",mileageArrs:"",salesMethod:"",startMileage:"",endMileage:"",startStorageAge:"",endStorageAge:"",startOnSaleDays:"",endOnSaleDays:"",salesType:"",bodyColor:[],dischargeStandard:"",carSeriesLevel:""}),_=a([]),I=a([]),k=a([{label:"最近创建",val:"recentlyCreate"},{label:"最早创建",val:"earliestCreate"}]),T=a([]),R=a([]),O=a(0),x=a(0),A=a(),U=e=>{1==e&&A.value.open();for(const a in h)Object.prototype.hasOwnProperty.call(Z.value,a)&&(h[a]=Z.value[a],N.value[a]=Z.value[a])},P=e=>{2==e&&(h.orders=N.value.orders)},B=e=>{h.brandId=[],h.seriesId=[],h.arriveStoreTime="11",_.value=[],I.value=[],O.value=0,N.value.brandId=[],N.value.seriesId=[],N.value.brandSeriesMapList=[],N.value={},Z.value={},g.value.highlight(1,null),g.value.highlight(2,null),g.value.highlight(3,null),x.value=0,A.value.handleClearSearch(),q(R.value[0].id),g.value.close(),setTimeout((()=>{z(e)}),200)},N=a({dept:{id:"",name:""},budgetRange:[],purchaseOrderDate:[],noDealReason:[],pricingCreateUser:"",pricingCreateUserId:""}),F=e=>{N.value=e,Z.value=e},V=a(null);w((async()=>{$(),E(),g.value.highlight(0,h.orders)}));const $=()=>{uni.$u.http.get("/admin/dict/type/car_series_level").then((e=>{T.value=e.data.map((e=>({label:e.label,val:e.value})))}))},z=(e,a="")=>{a&&g.value.close();const l=[];["dept","purchaseOrderDate","range","reason","pricingCreateUserId"].map((a=>{Array.isArray(e[a])?e[a]&&e[a].length>0?l.push(1):l.push(2):e[a]?l.push(1):l.push(2)})),l.includes(1)?g.value.highlight(3,e):g.value.highlight(3,""),(h.brandId.length>0||h.seriesId.length>0)&&g.value.highlight(1,h.brandId),h.arriveStoreTime&&11!=h.arriveStoreTime?g.value.highlight(2,h.arriveStoreTime):(h.arriveStoreTime="11",g.value.highlight(2,null)),e.orders=e.orders?e.orders:h.orders,V.value=e,N.value={...e,brandId:h.brandId,seriesId:h.seriesId},Z.value={...e,brandId:h.brandId,seriesId:h.seriesId},r("search",{...e,brandId:h.brandId,seriesId:h.seriesId})},E=()=>{uni.$u.http.get("/product/carProductApp/getBrand",{params:{vehicleStatus:s.typeVal}}).then((e=>{R.value=e.data,q(R.value[0].id)}))},J=(e,a,l)=>{h[e]=a.val||a.value,g.value.highlight(l,a.val||a.value),"arriveStoreTime"!=e&&(N.value.brandId=h.brandId,N.value.seriesId=h.seriesId,N.value.orders=h.orders,le())},H=()=>{N.value.arriveStoreTime=h.arriveStoreTime,11==N.value.arriveStoreTime&&g.value.highlight(2,""),W()},Y=a([]),q=e=>{uni.$u.http.get("/product/carProductApp/getSeries",{params:{vehicleStatus:s.typeVal,brandId:e}}).then((a=>{Y.value=a.data,_.value=e}))},W=async()=>{V.value&&(h.brandId=V.value.brandId,h.seriesId=V.value.seriesId,h.orders=V.value.orders||N.value.orders||K[s.typeVal][0].key),le()},X=async(e,a,l)=>{if(console.log(l,123),l)if(l.length>0){h.brandId=[...new Set(l.map((e=>e.brandTag)))],h.seriesId=l.map((e=>e.seriesTag));const e=((e,a)=>{const l={};return e.forEach((e=>{const t=e[a];l[t]||(l[t]={});for(const[s,r]of Object.entries(e))s!==a&&(l[t][s]||(l[t][s]=[]),l[t][s].push(r),l[t][s]=[...new Set(l[t][s])])})),l})(l=l.map((e=>({brandTag:e.brandTag,seriesTag:e.seriesTag,ids:e.brandTag}))),"ids"),a=Object.values(e).map((e=>({brandId:e.brandTag[0],seriesIdList:e.seriesTag})));h.brandSeriesMapList=a,a.length>0?g.value.highlight(1,h.seriesId||h.brandId):g.value.highlight(1,!1)}else h.brandId=[],h.seriesId=[],h.brandSeriesMapList=[],N.value.brandSeriesMapList=[],g.value.highlight(1,!1);else e.value&&(h.brandId=e),a.value&&(h.seriesId=a),h.seriesId||h.brandId?g.value.highlight(1,h.seriesId||h.brandId):g.value.highlight(1,!1);N.value.brandId=h.brandId,N.value.seriesId=h.seriesId,N.value.brandSeriesMapList=h.brandSeriesMapList,le("brand")},Z=a({}),le=e=>{var a;(null==(a=h.brandSeriesMapList)?void 0:a.length)||(N.value.brandSeriesMapList=[]);const l={...h,...N.value};Z.value=l,e?r("search",l,e):r("search",l),g.value.close()},te=a();return l({clearTabStatus:()=>{te.value.resetFilter(),L((()=>{h.orders="recentlyCreate"}))}}),(e,a)=>{const l=c,t=i(n("up-icon"),u);return o(),d(G,{ref_key:"uDropdownRef",ref:g,class:"drop",borderRadius:"20rpx",onOpen:U,onClose:P,activeColor:"#3C73FF"},{default:v((()=>[p(Q,{title:"排序"},{default:v((()=>[p(l,{class:"item-list"},{default:v((()=>[(o(!0),f(M,null,C(m(k),((e,a)=>(o(),d(l,{key:a,class:D({active:m(h).orders==e.val}),onClick:a=>J("orders",e,0)},{default:v((()=>[p(l,null,{default:v((()=>[S(b(e.label),1)])),_:2},1024),m(h).orders==e.val?(o(),d(t,{key:0,name:"checkbox-mark",color:"#3C73FF",size:"20"})):y("",!0)])),_:2},1032,["class","onClick"])))),128))])),_:1})])),_:1}),p(Q,{title:"需求车型"},{default:v((()=>[p(ae,{ref_key:"brandDropRef",ref:A,onSearch:X,typeMethod:"car",isMultiple:!0,carType:e.typeVal,pBrand:m(h).brandId,pSeries:m(h).seriesId},null,8,["carType","pBrand","pSeries"])])),_:1}),p(Q,{title:"到店次数"},{default:v((()=>[p(l,{class:"price-list"},{default:v((()=>[p(l,{class:"price-item"},{default:v((()=>[(o(!0),f(M,null,C(e.dictData.arriveList,((e,a)=>(o(),d(l,{key:a,class:D({active:m(h).arriveStoreTime==(null==e?void 0:e.value)}),onClick:a=>J("arriveStoreTime",e,2)},{default:v((()=>[S(b(null==e?void 0:e.label),1)])),_:2},1032,["class","onClick"])))),128))])),_:1}),p(l,{onClick:H,class:"btns"},{default:v((()=>[S("确认")])),_:1})])),_:1})])),_:1}),p(Q,{title:"筛选"},{default:v((()=>[p(l,{class:"all-list"},{default:v((()=>[(o(),d(ee,{key:Math.random(),dictData:e.dictData,ref_key:"allFilterRef",ref:te,initData:m(N),onClearOut:B,onSaveStatusVal:F,onFilterList:z},null,8,["dictData","initData"]))])),_:1})])),_:1})])),_:1},512)}}}),[["__scopeId","data-v-12981de0"]]),te=R(e({__name:"receptionList",setup(e){const r=JSON.parse(P("userBtnPermission"))||[],i=a([]),u=a(),n=j({current:1,size:5,total:0,orders:"recentlyCreate"});B((e=>{var a;n.current=1,null==(a=u.value)||a.initTop(),k(),_()}));const g=j({arriveList:[],receptionList:[],reasonList:[]}),_=async()=>{try{const e=await Promise.all([uni.$u.http.get("/admin/dict/type/customer_reception_arrive_store_time"),uni.$u.http.get("/admin/dict/type/customer_reception_budget_range"),uni.$u.http.get("/admin/dict/type/customer_reception_no_deal_reason")]);g.arriveList=e[0].data,g.receptionList=e[1].data,g.reasonList=e[2].data}catch(e){console.log(e,"error----")}};async function k(){var e;try{N({title:"加载中"});const e={...Z(n,"total")},a=await F().post("/product/car/customer/reception/page",e);n.total=a.data.count;const l=a.data.results;i.value=1===n.current?l:[...i.value,...l],V()}finally{V(),null==(e=u.value)||e.loadFinish()}}l((()=>{t("refreshList"),s("refreshList",(()=>{D()})),k()}));const D=()=>{n.current=1,k()},R=()=>{n.current++,k()},w=e=>{var a,l,t;console.log(e,"data----------"),n.current=1,n.carBrandId=e.brandId,n.carSeriesId=(null==(a=e.seriesId)?void 0:a.length)&&e.seriesId[0]?e.seriesId:[],n.orders=e.orders,n.arriveStoreTime="11"!=e.arriveStoreTime?e.arriveStoreTime:"",n.budgetRange=e.budgetRange||[],n.noDealReason=e.noDealReason||[],n.deptId=(null==(l=e.dept)?void 0:l.id)||"",n.sellUserId=e.pricingCreateUserId||"",(null==(t=e.purchaseOrderDate)?void 0:t.length)&&e.purchaseOrderDate[0]&&e.purchaseOrderDate[1]?(n.startDate=e.purchaseOrderDate[0],n.endDate=e.purchaseOrderDate[1]):(n.startDate="",n.endDate=""),console.log(n,"page data------------"),k()};return(e,a)=>{const l=c,t=I,s=A;return o(),d(l,{class:"page f-c-s car-lists"},{default:v((()=>[p(H,null,{title:v((()=>[p(l,{class:"head-drop",style:{display:"flex","align-items":"center","justify-content":"center"}},{default:v((()=>[S(" 客户接待情况 ")])),_:1})])),right:v((()=>[p(l,{class:"nav-right"},{default:v((()=>[m(r).includes("reception:add")?(o(),d(t,{key:0,onClick:a[0]||(a[0]=a=>("toPage"in e?e.toPage:m(T))("/pages/customerReception/addReception")),src:J})):y("",!0)])),_:1})])),_:1}),p(le,{onSearch:w,dictData:m(g)},null,8,["dictData"]),p(X,$({ref_key:"listLoadRef",ref:u,class:"scroll-view-box"},m(n),{istop:!1,onLoadMore:R,onLoadRefresh:D}),{default:v((()=>[z(p(l,{class:"list-box"},{default:v((()=>[(o(!0),f(M,null,C(m(i),(a=>(o(),d(l,{key:a.id,class:"list-item",onClick:l=>("toPage"in e?e.toPage:m(T))(`/pages/customerReception/addReception?id=${a.id}`)},{default:v((()=>[h("div",{class:"list-user"},b(a.userName),1),h("div",{class:"list-tags"},[a.carBrandName?(o(),f("div",{key:0,class:"list-tag"},b(a.carBrandName),1)):y("",!0),a.arriveStoreTimeName?(o(),f("div",{key:1,class:"list-tag"},b(a.arriveStoreTimeName)+"到店 ",1)):y("",!0),a.budgetRangeName?(o(),f("div",{key:2,class:"list-tag"},b(a.budgetRangeName),1)):y("",!0),a.noDealReasonName?(o(),f("div",{key:3,class:"list-tag"},b(a.noDealReasonName),1)):y("",!0)]),h("div",{class:"list-text-overflow"},b(a.noDealReasonRemark||"-"),1),h("div",{class:"list-info"},[p(s,null,{default:v((()=>[S(b(a.createTime),1)])),_:2},1024),p(s,null,{default:v((()=>[S(b(a.sellUserName),1)])),_:2},1024)])])),_:2},1032,["onClick"])))),128))])),_:1},512),[[E,m(i).length]])])),_:1},16)])),_:1})}}}),[["__scopeId","data-v-69f70f0e"]]);export{te as default};
