import{d as a,a9 as s,r as t,B as e,E as l,X as u,Y as c,x as n,c as o,w as r,i,I as d,M as f,K as m,o as p,a as _,g as h,h as v,u as k,n as g,t as y,y as w,aj as b,W as D,Q as V,D as R,a1 as x,_ as T}from"./index-CK4DGatK.js";import{u as $}from"./useQuery.3dd8K18V.js";const j=T(a({__name:"abandon",setup(a){const T=$(),j=s({statusDictValue:"",statusRemark:""}),C=t([]);e((()=>{I()})),l((()=>{u("pickData"),c("pickData",(a=>{const{key:s,subKey:t}=a;j[t]=s}))}));const I=()=>{uni.$u.http.get("/crm/clue/getCrmDict").then((a=>{const{purchaseWaiveReason:s,sellWaiveReason:t}=a.data,e=a=>a.map((a=>({value:a.label,key:a.value})));C.value=1==T.value.clueType?e(s):e(t)}))},K=n((()=>M(C.value,j.statusDictValue))),M=(a,s)=>{const t=null==a?void 0:a.filter((a=>a.key==s));return(null==t?void 0:t.length)?t[0].value:"请选择"},O=()=>{const{statusDictValue:a,statusRemark:s}=j;a?"Other"!=a||s?((new R).showLoading("提交中"),uni.$u.http.put("/crm/clue/batch/update/status",{type:T.value.clueType,ids:[T.value.clueId],status:8,...j}).then((()=>{(new R).showToast("操作成功"),setTimeout((()=>{x({delta:2})}),1500)}))):(new R).showToast("请输入备注"):(new R).showToast("请选择放弃原因")};return(a,s)=>{const t=v,e=i,l=d(m("up-icon"),f),u=b,c=D;return p(),o(e,{class:"page f-c-s"},{default:r((()=>[_(e,{class:"content"},{default:r((()=>[_(e,{class:"form-box"},{default:r((()=>[_(e,{class:"form-item"},{default:r((()=>[_(e,null,{default:r((()=>[_(t,null,{default:r((()=>[h("*")])),_:1}),h("放弃原因")])),_:1}),_(e,{class:"f-b-c",onClick:s[0]||(s[0]=a=>{return s="放弃原因",t=k(C),e=k(j).statusDictValue,l="statusDictValue",void V(`/pages/carManage/pagePicker?title=${s}&list=${JSON.stringify(t)}&key=${e}&subKey=${l}`);var s,t,e,l})},{default:r((()=>[_(t,{class:g({placeholder:"请选择"==k(K)})},{default:r((()=>[h(y(k(K)),1)])),_:1},8,["class"]),_(l,{name:"arrow-right"})])),_:1})])),_:1}),_(e,{class:"form-textarea"},{default:r((()=>[_(e,{class:"area-title"},{default:r((()=>["Other"==k(j).statusDictValue?(p(),o(t,{key:0},{default:r((()=>[h("*")])),_:1})):w("",!0),h("备注")])),_:1}),_(u,{modelValue:k(j).statusRemark,"onUpdate:modelValue":s[1]||(s[1]=a=>k(j).statusRemark=a),placeholder:"请输入",maxlength:"500"},null,8,["modelValue"]),_(e,{class:"limit"},{default:r((()=>{var a;return[h(y((null==(a=k(j).statusRemark)?void 0:a.length)||0)+"/500",1)]})),_:1})])),_:1})])),_:1})])),_:1}),_(e,{class:"bottom-btn"},{default:r((()=>[_(c,{class:"save-btn w_100",onClick:O},{default:r((()=>[h("提交")])),_:1})])),_:1})])),_:1})}}}),[["__scopeId","data-v-5f1446fa"]]);export{j as default};
