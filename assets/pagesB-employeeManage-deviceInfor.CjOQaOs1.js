import{d as a,A as e,B as s,r as t,Z as o,a9 as l,a2 as i,c as n,w as r,i as u,I as d,ah as c,K as f,o as m,a as p,g as _,u as v,ad as g,b as y,F as h,e as j,y as C,P as b,h as k,t as L,S as I,a0 as w,bR as x,aS as B,c3 as F,U as R,Q as S,_ as T}from"./index-CK4DGatK.js";import{_ as $}from"./icon_ios.BWID3z2o.js";import{L as A}from"./ListLoadRefreshView.CnNC2lkG.js";import{u as D}from"./useQuery.3dd8K18V.js";import{o as M}from"./omit.DzeQdT5l.js";import"./_baseGet.CmhOSbYr.js";import"./_getTag.DG-N9UUn.js";import"./isObject.C8HfsiHw.js";import"./isSymbol.Bym6OQCA.js";import"./_Uint8Array.B4mhORiM.js";import"./_baseClone.Cc-Y92km.js";const U=T(a({__name:"deviceInfor",setup(a){const T=D(),U=e();s((a=>{J(a.id)}));const O=t(!1),P=t("确定退出吗？"),Q=t("确定后当前员工账号将立即从该设备登出"),V=()=>{uni.$u.http.post("admin/user/forcedLogout",{userId:T.value.id}).then((()=>{O.value=!1,w({title:"登出成功",icon:"none"}),setTimeout((()=>{T.value.id==U.loginInfo.user_id?(x(),B({url:"/pages/login/index"}),F(),R.updateToken("")):(K.current=1,J(T.value.id))}),1500)}))},z=t([]),G=t(),J=async a=>{var e;try{o({title:"加载中"});const e={...M(K,"total"),userId:a},s=await uni.$u.http.get("product/applyBind/getUserLoginDevicePage",{params:e});K.total=s.data.count;const t=s.data.results;z.value=1===K.current?t:[...z.value,...t]}finally{i(),null==(e=G.value)||e.loadFinish()}},K=l({current:1,size:10,total:0}),N=()=>{K.current=1,J(T.value.id)},Y=()=>{K.current++,J(T.value.id)};return(a,e)=>{const s=u,t=b,o=k,l=d(f("up-modal"),c);return m(),n(s,{class:"device"},{default:r((()=>[p(s,{class:"heads"},{default:r((()=>[p(s,{class:"desc"},{default:r((()=>[_("你的账号在以下设备中登录过，你可以强制登出，强制登出后在该设备登录需要重新输入密码")])),_:1}),p(s,{class:"title"},{default:r((()=>[_("登录过的设备")])),_:1})])),_:1}),v(z).length>0?(m(),n(A,g({key:0,ref_key:"listLoadRef",ref:G,class:"scroll-view-box"},v(K),{istop:!1,onLoadMore:Y,onLoadRefresh:N}),{default:r((()=>[p(s,{class:"device-list"},{default:r((()=>[(m(!0),y(h,null,j(v(z),(a=>(m(),n(s,{onClick:e=>{var s;(s=a).deviceCode&&s.deviceInfo&&S(`/pagesB/employeeManage/deviceDetail?id=${T.value.id}&params=${JSON.stringify(s)}`)},key:a.deviceCode,class:"device-item"},{default:r((()=>[p(t,{src:$,class:"img"}),p(s,{class:"right"},{default:r((()=>[p(s,{class:"top"},{default:r((()=>[p(o,{class:"name"},{default:r((()=>[_(L(a.deviceInfo),1)])),_:2},1024)])),_:2},1024),p(s,{class:"bottom"},{default:r((()=>[p(o,{class:"status pre"},{default:r((()=>[_("上次登录")])),_:1}),p(o,null,{default:r((()=>[_(L(a.latestLoginTime),1)])),_:2},1024)])),_:2},1024)])),_:2},1024),a.bindDevice?(m(),n(s,{key:0,onClick:e[0]||(e[0]=I((a=>O.value=!0),["stop"])),class:"force-out"},{default:r((()=>[_("强制登出")])),_:1})):C("",!0)])),_:2},1032,["onClick"])))),128))])),_:1})])),_:1},16)):(m(),n(s,{key:1,class:"no-content"},{default:r((()=>[_(" 暂无记录 ")])),_:1})),p(l,{show:v(O),confirmColor:"#FF571A",showCancelButton:!0,title:v(P),content:v(Q),onCancel:e[1]||(e[1]=a=>O.value=!1),onConfirm:V},null,8,["show","title","content"])])),_:1})}}}),[["__scopeId","data-v-1d782347"]]);export{U as default};
