import{d as a,r as e,B as s,E as l,G as t,c as d,w as n,i as u,I as o,M as c,K as i,ah as r,N as f,o as _,a as p,y as m,P as g,u as y,n as v,h as b,g as k,t as h,b as w,F as I,e as M,O as N,W as C,T as x,Q as B,$ as F,a0 as O,_ as $}from"./index-CK4DGatK.js";import{u as J}from"./useQuery.3dd8K18V.js";const L=$(a({__name:"detail",setup(a){const $=J(),L=e(!1),P=e("确认使用此账号？"),S=e("停用后账号将无法使用已有权限"),j=e("");s((a=>{console.log(a,77777),a.region&&(j.value=a.region)}));const U=e([]);l((()=>{U.value=JSON.parse(t("userBtnPermission")),K($.value.id),W($.value.id)}));const D=()=>{L.value=!0},Q=()=>{B(`/pagesB/employeeManage/putPassword?objData=${JSON.stringify(G.value)}`)},q=()=>{B(`/pagesB/employeeManage/addUser?id=${G.value.userId}`)},A=async()=>{const a=JSON.parse(JSON.stringify(G.value));a.lockFlag="9";0==(await F().put("/admin/user",a)).code&&(O({title:"禁用成功",mask:!0}),K(a.userId),L.value=!1)},E=async()=>{const a=JSON.parse(JSON.stringify(G.value));a.lockFlag="0";0==(await F().put("/admin/user",a)).code&&(O({title:"启用成功",mask:!0}),K(a.userId),L.value=!1)},G=e({}),K=async a=>{const e=await uni.$u.http.get(`admin/user/details/${a}`);G.value=e.data},T=e(""),W=async a=>{const e=await uni.$u.http.get("product/applyBind/getUserDevice",{params:{userId:a}});e.data&&e.data.deviceInfo?T.value=e.data.deviceInfo:T.value=""},z=()=>{B(`/pagesB/employeeManage/deviceInfor?id=${G.value.userId}`)};return(a,e)=>{const s=g,l=b,t=u,B=o(i("u-icon"),c),F=C,O=o(i("up-modal"),r),$=f("permissionBtn");return _(),d(t,{class:"employee-detail"},{default:n((()=>[p(t,{class:"inner"},{default:n((()=>[p(t,{class:"heads"},{default:n((()=>[p(s,{src:y(G).avatar?y(G).avatar:"/static/mine/avatar.png",class:"avatar"},null,8,["src"]),p(t,{class:"right"},{default:n((()=>[p(t,{class:v(["name",{forbidden:"9"==y(G).lockFlag}])},{default:n((()=>[p(l,null,{default:n((()=>[k(h(y(G).name||"-"),1)])),_:1}),"9"==y(G).lockFlag?(_(),d(l,{key:0,class:"forbidden"},{default:n((()=>[k("已禁用")])),_:1})):m("",!0)])),_:1},8,["class"])])),_:1})])),_:1}),p(t,{class:"infos"},{default:n((()=>[p(t,{class:"card"},{default:n((()=>[p(t,{class:"sub-title"},{default:n((()=>[k("账号信息")])),_:1}),p(t,{class:"flexs"},{default:n((()=>[p(t,{class:"label"},{default:n((()=>[k("用户名")])),_:1}),p(t,{class:"val"},{default:n((()=>[k(h(y(G).username||"-"),1)])),_:1})])),_:1}),p(t,{class:"flexs"},{default:n((()=>[p(t,{class:"label"},{default:n((()=>[k("手机号")])),_:1}),p(t,{class:"val"},{default:n((()=>[k(h(y(G).fullPhone||"-"),1)])),_:1})])),_:1}),p(t,{class:"flexs"},{default:n((()=>[p(t,{class:"label"},{default:n((()=>[k("上级领导")])),_:1}),p(t,{class:"val"},{default:n((()=>[k(h(y(G).leaderUserName||"-"),1)])),_:1})])),_:1})])),_:1}),p(t,{class:"card"},{default:n((()=>[p(t,{class:"sub-title"},{default:n((()=>[k("权限信息")])),_:1}),p(t,{class:"flexs"},{default:n((()=>[p(t,{class:"label"},{default:n((()=>[k("岗位")])),_:1}),y(G).postList&&y(G).postList.length>0?(_(),d(t,{key:0,class:"val"},{default:n((()=>[k(h(y(G).postList.map((a=>a.postName)).join(",")),1)])),_:1})):(_(),d(t,{key:1},{default:n((()=>[k("-")])),_:1}))])),_:1}),p(t,{class:"flexs"},{default:n((()=>[p(t,{class:"label"},{default:n((()=>[k("角色")])),_:1}),y(G).roleList&&y(G).roleList.length>0?(_(),d(t,{key:0,class:"val"},{default:n((()=>[(_(!0),w(I,null,M(y(G).roleList,(a=>(_(),d(t,{class:"role-item",key:a.roleId},{default:n((()=>[k(h(a.roleName),1)])),_:2},1024)))),128))])),_:1})):(_(),d(t,{key:1},{default:n((()=>[k("-")])),_:1}))])),_:1})])),_:1}),y(j)?m("",!0):(_(),d(t,{key:0,class:"card"},{default:n((()=>[p(t,{class:"sub-title single"},{default:n((()=>[p(l,null,{default:n((()=>[k("登录设备")])),_:1}),p(t,{onClick:z,class:"equipment"},{default:n((()=>[p(l,{class:"text"},{default:n((()=>[k(h(y(T)),1)])),_:1}),p(B,{name:"arrow-right"})])),_:1})])),_:1})])),_:1}))])),_:1})])),_:1}),y(U).includes("employeeManage:forbidden")||y(U).includes("employeeManage:forbidden")||y(U).includes("employeeManage:editPassword")||y(U).includes("employeeManage:editInfo")?(_(),d(t,{key:0},{default:n((()=>[N(p(t,{class:"bottom-btn"},{default:n((()=>["0"==y(G).lockFlag?N((_(),d(F,{key:0,class:"forbidden-btn btns",onClick:D},{default:n((()=>[k(" 禁用 ")])),_:1})),[[$,["employeeManage:forbidden"]]]):N((_(),d(F,{key:1,class:"forbidden-btn btns",onClick:E},{default:n((()=>[k(" 启用 ")])),_:1})),[[$,["employeeManage:forbidden"]]]),N((_(),d(F,{class:"password-btn btns",onClick:Q},{default:n((()=>[k(" 修改密码 ")])),_:1})),[[$,["employeeManage:editPassword"]]]),N((_(),d(F,{class:"edit-btn btns",onClick:q},{default:n((()=>[k(" 编辑 ")])),_:1})),[[$,["employeeManage:editInfo"]]])])),_:1},512),[[x,!y(j)]])])),_:1})):m("",!0),p(O,{show:y(L),confirmColor:"#FF571A",showCancelButton:!0,title:y(P),content:y(S),onCancel:e[0]||(e[0]=a=>L.value=!1),onConfirm:A},null,8,["show","title","content"])])),_:1})}}}),[["__scopeId","data-v-cf4a0d38"]]);export{L as default};
