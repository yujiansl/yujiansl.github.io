import{d as e,r as a,q as l,c as t,o as s,i as o,w as r,a as c,a5 as u,b as i,e as n,n as d,u as p,g as m,t as f,F as v,_,a9 as h,v as g,Q as y,E as k,aa as b,aR as j,X as I,Z as F,a2 as R,I as w,M as x,K as C,N as D,h as M,O as S,ad as V}from"./index-CK4DGatK.js";import{U as B,a as L}from"./u-dropdown-item.B66HFyYv.js";import{N as T}from"./NavBar.DSs5OGCU.js";import{L as N}from"./ListLoadRefreshView.CnNC2lkG.js";import{e as O}from"./employItem.B9_dGooL.js";import{o as z}from"./omit.DzeQdT5l.js";import"./_baseGet.CmhOSbYr.js";import"./_getTag.DG-N9UUn.js";import"./isObject.C8HfsiHw.js";import"./isSymbol.Bym6OQCA.js";import"./_Uint8Array.B4mhORiM.js";import"./_baseClone.Cc-Y92km.js";const U=_(e({__name:"roleDrop",emits:["search"],setup(e,{emit:_}){const h=_,g=a([]);l((()=>{y()}));const y=()=>{uni.$u.http.get("admin/role/page",{params:{current:1,size:300,descs:"create_time"}}).then((e=>{g.value=e.data.records.map((e=>({label:e.roleName,value:e.roleId}))),g.value.unshift({label:"全部",value:"全部"})}))},k=a("全部"),b=a("");return(e,a)=>{const l=o,_=u;return s(),t(l,{class:"role-drop"},{default:r((()=>[c(_,{class:"scrolls",ref:"scrollRefs","scroll-y":""},{default:r((()=>[c(l,{class:"role-item"},{default:r((()=>[(s(!0),i(v,null,n(p(g),((e,a)=>(s(),t(l,{class:d(["item-view",{active:p(k)==e.value}]),key:a,onClick:a=>(e=>{k.value=e.value,b.value=e.label,h("search",k.value,b.value)})(e)},{default:r((()=>[m(f(e.label),1)])),_:2},1032,["class","onClick"])))),128))])),_:1})])),_:1},512)])),_:1})}}}),[["__scopeId","data-v-2909d2d0"]]),$=_(e({__name:"statusDrop",props:{obj:{type:Object,default:()=>{}}},emits:["search"],setup(e,{emit:l}){const u=l,_=a([{label:"启用中",value:"0"},{label:"禁用",value:"9"}]),h=a(""),g=a("");return(e,a)=>{const l=o;return s(),t(l,{class:"role-drop"},{default:r((()=>[c(l,{class:"role-item"},{default:r((()=>[(s(!0),i(v,null,n(p(_),((e,a)=>(s(),t(l,{key:a,class:d({active:p(h)==e.value}),onClick:a=>(e=>{h.value=e.value,g.value=e.label,u("search",h.value,g.value)})(e)},{default:r((()=>[m(f(e.label),1)])),_:2},1032,["class","onClick"])))),128))])),_:1})])),_:1})}}}),[["__scopeId","data-v-98d8dea9"]]),A=_(e({__name:"filter",props:{deptTitleVal:{type:String,default:""},checkId:{type:Array,default:()=>[]}},emits:["search"],setup(e,{expose:o,emit:u}){const i=u,n=e,d=a(),m=h({role:"",lockFlag:""}),f=a("全部"),v=a("角色"),_=a("状态");l((()=>{})),g((()=>n.deptTitleVal),(()=>{f.value=n.deptTitleVal}));const k=e=>{0==e&&(n.checkId.length>0?y(`/pagesB/employeeManage/deptFilter?checkId=${JSON.stringify(n.checkId)}`):y("/pagesB/employeeManage/deptFilter"))},b=()=>{var e;null==(e=d.value)||e.close()},j=()=>{i("search",m),b()},I=(e,a)=>{m.role=e,v.value=a,d.value.highlight(1,e),j()},F=(e,a)=>{m.lockFlag=e,_.value=a,d.value.highlight(2,e),j()};return o({close:b,hightDept:()=>{d.value.highlight(0,!0)}}),(e,a)=>(s(),t(B,{ref_key:"uDropdownRef",ref:d,class:"drop",borderRadius:"20rpx",onOpen:k},{default:r((()=>[c(L,{title:p(f)},null,8,["title"]),c(L,{title:p(v)},{default:r((()=>[c(U,{onSearch:I})])),_:1},8,["title"]),c(L,{title:p(_)},{default:r((()=>[c($,{onSearch:F})])),_:1},8,["title"])])),_:1},512))}}),[["__scopeId","data-v-645713db"]]),P=_(e({__name:"index",setup(e){const l=e=>{const{role:a,lockFlag:l}=e;L.role="全部"==a?"":a,L.lockFlag=l,L.current=1,P()};k((()=>{P()}));const u=a(""),d=a(""),_=a(""),g=a(),B=a([]);k((()=>{var e;null==(e=g.value)||e.close(),b("deptData",(e=>{const{name:a,id:l}=e;d.value=a,u.value=l,_.value=d.value,L.deptId=l,g.value.hightDept(),B.value=[e],console.log(u.value,d.value,"打印粗来"),P()}))})),j((()=>{I("deptData")}));const L=h({current:1,size:20,total:0,deptId:null}),U=a([]),$=a(),P=async()=>{var e;try{F({title:"加载中"});const e={...z(L,"total")},a=await uni.$u.http.get("admin/user/page",{params:e});L.total=a.data.total;const l=a.data.records;U.value=1===L.current?l:[...U.value,...l]}finally{R(),null==(e=$.value)||e.loadFinish()}},Q=()=>{L.current=1,P()},q=()=>{console.log(123),L.current++,P()},E=()=>{y("/pagesB/employeeManage/addUser")};return(e,a)=>{const u=M,d=o,h=w(C("up-icon"),x),k=D("permissionBtn");return s(),t(d,{class:"employee"},{default:r((()=>[c(T,null,{title:r((()=>[c(d,{class:"head-drop",style:{display:"flex","align-items":"center","justify-content":"center"}},{default:r((()=>[c(u,{class:"name"},{default:r((()=>[m("员工管理")])),_:1})])),_:1})])),right:r((()=>[c(d,{class:"nav-right"},{default:r((()=>[c(h,{name:"search",size:"30",bold:"",color:"#000",onClick:a[0]||(a[0]=a=>("toPage"in e?e.toPage:p(y))("/pagesB/employeeManage/searchs"))})])),_:1})])),_:1}),c(A,{ref_key:"filterRef",ref:g,deptTitleVal:p(_),checkId:p(B),onSearch:l},null,8,["deptTitleVal","checkId"]),c(d,{class:"contents"},{default:r((()=>[c(d,{class:"inner"},{default:r((()=>[c(N,V({ref_key:"listLoadRef",ref:$,class:"scroll-view-box"},p(L),{istop:!1,onLoadMore:q,onLoadRefresh:Q}),{default:r((()=>[c(d,{class:"employ-list"},{default:r((()=>[c(d,{class:"sub-title"},{default:r((()=>[m("共"+f(p(L).total)+"位在职员工",1)])),_:1}),(s(!0),i(v,null,n(p(U),(e=>(s(),t(O,{key:e.userId,item:e},null,8,["item"])))),128))])),_:1})])),_:1},16)])),_:1}),S((s(),t(d,{class:"btns"},{default:r((()=>[c(d,{onClick:E,class:"add"},{default:r((()=>[m(" 新建员工 ")])),_:1})])),_:1})),[[k,["employeeManage:add"]]])])),_:1})])),_:1})}}}),[["__scopeId","data-v-45ac6725"]]);export{P as default};
