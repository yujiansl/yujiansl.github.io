import{_ as e,c as l,o as t,w as n,a,i as s,h as i,R as c,r as o,x as u,y as r,a5 as f,b as d,F as h,e as v,n as p,g as k,k as y,t as g,c4 as x,O as m,S as b,T as _,W as V,Z as C,a2 as S,s as I,d as q,B as z,u as N,a0 as O,ar as w,a1 as L}from"./index-CK4DGatK.js";const A=e({data:()=>({inputVal:""}),methods:{handleFllter(e){this.$emit("confirm",e.detail.value)},clears(){console.log(this.inputVal),this.inputVal="",console.log("清除了内容")}}},[["render",function(e,o,u,r,f,d){const h=i,v=c,p=s;return t(),l(p,{class:"tmp-box"},{default:n((()=>[a(p,{class:"filterBox"},{default:n((()=>[a(p,{class:"filter-input"},{default:n((()=>[a(h,{style:{color:"#b8b8b8"},class:"iconfont icon-sousuo filterImg"}),a(v,{class:"text",type:"text",modelValue:f.inputVal,"onUpdate:modelValue":o[0]||(o[0]=e=>f.inputVal=e),"confirm-type":"搜索",onConfirm:d.handleFllter,placeholder:"搜索"},null,8,["modelValue","onConfirm"])])),_:1})])),_:1})])),_:1})}],["__scopeId","data-v-c4263bc4"]]),B=e({__name:"tree",props:{treeNone:{type:Array,default:()=>[]},checkList:{type:Array,default:()=>[]},keyValue:{type:String,default:"id"},searchIf:{type:Boolean,default:!0},isCheck:!0,checkList:{type:Array,default:()=>[]},parentList:{type:Array,default:()=>[]},options:{type:Object,default:()=>({label:"name",children:"children",multiple:!1,checkStrictly:!1})}},emits:["sendValue"],setup(e,{emit:c}){const q=e,z=JSON.parse(JSON.stringify(q.treeNone)),N=o(q.treeNone),O=o(q.checkList),w=o([1]),L=o([]),B=o([]),F=o(999),j=o(0),J=o(0),E=o(!1),R=o(null),T=c;function $(e,l){for(let t=0;t<e.length;t++){if(e[t].children){if($(e[t].children,l))return L.value.push(e[t]),!0}if(e[t][q.keyValue]===l)return!0}}(()=>{if(0!==O.value.length)if(q.options.multiple)q.options.checkStrictly&&H();else{$(z,O.value[0][q.keyValue]);let e=L.value.reverse();if(0==e.length)return;w.value=w.value.concat(e),N.value=w.value[w.value.length-1].children}console.log(q.options)})();const D=u((()=>e=>{const l=O.value;return l.length>0&&e[q.keyValue]==l[0][q.keyValue]})),U=u((()=>e=>e===w.value.length-1)),W=u((()=>e=>{const l=O.value;if(0==l.length)return q.options.checkStrictly&&(e.bx=0,e.qx=0),!1;return l.findIndex((l=>e[q.keyValue]==l[q.keyValue]))>-1&&!e.qx}));function Z(e){for(let t=0;t<e.length;t++){var l=e[t];G(l[q.keyValue]),l.user?J.value++:Z(l.children)}}function G(e){for(let l=0;l<O.value.length;l++)if(e==O.value[l][q.keyValue]){j.value++;break}}function H(){let e=!1,l=!0;N.value.forEach(((t,n)=>{t.user||(t.qx=e,t.bx=e,Z(t.children),0!=J.value&&0!=j.value&&(J.value==j.value?(t.qx=l,t.bx=e):(t.qx=e,t.bx=l)),0!=J.value&&0==j.value&&(N.value[n].bx=e,N.value[n].qx=e),J.value=0,j.value=0)}))}function K(){const e=[...w.value].map((e=>{const l=Object.assign({},e);return delete l[q.options.children],l}));return e.slice(1,e.length)||[]}function M(e){e.forEach((e=>{if(e.user){for(var l=0;l<O.value.length;l++)if(e[q.keyValue]==O.value[l][q.keyValue]){O.value.splice(l,1);break}}else M(e.children)}))}function P(e,l,t,n){const a=q.options;if(!a.multiple)return;let s=O.value.findIndex((l=>e[q.keyValue]==l[q.keyValue]));const i=K();if(s>-1)a.checkStrictly?e.user?O.value.splice(s,1):M(e.children):O.value.splice(s,1);else{if(!e.user&&a.checkStrictly){if(n||t)M(e.children),e.qx=0,e.bx=0;else{e.qx=1,e.bx=0;const{id:l,name:t,user:n}=e,a={id:l,name:t,user:n},s=1===w.value.length?[a,...i]:[...i,a];Q(e.children,s)}return}O.value.push({...e,path:i})}}function Q(e,l){const t=[...l];for(var n=0,a=e.length;n<a;n++){let l=e[n];if(l.user)O.value.push({...l,path:t});else{const e={...l};delete e[q.options.children];const n=[...t,e];Q(l.children,n)}}}function X(e){B.value=[],Y(z,e),E.value=!0,w.value.splice(1,1e3),C({title:"正在查找"}),setTimeout((()=>{N.value=B.value,S()}),300)}function Y(e,l){let t=q.options.children,n=q.options.label;for(var a=0,s=e.length;a<s;a++)e[a][n].indexOf(l)>=0&&B.value.push(e[a]),!e[a].user&&e[a][t].length>0&&Y(e[a][t],l)}function ee(e,l){-1===l?(N.value=z,w.value.splice(1,300),console.log(N.value),E.value=!1):-2===l?(N.value=B.value,w.value.splice(1,300)):(w.value.length-l>2?w.value.splice(l+1,300):l!==w.value.length-1&&w.value.splice(w.value.length-1,1),N.value=e[q.options.children]),q.options.checkStrictly&&H()}function le(){T("sendValue",O.value,"back")}const te=(e,l)=>{let t=e[q.options.children];l>-1&&t&&t.length>0?function(e){if(e.user)return;C({title:"加载中"});let l=q.options.children;!e.user&&e[l].length>0&&w.value[0][q.keyValue]!=e[q.keyValue]&&(N.value=e[l],w.value.push(e)),I((()=>{S(),F.value+=200})),q.options.checkStrictly&&H()}(e):q.options.multiple?P(e,0,e.bx,e.qx):function(e,l){const t=K();O.value=[{...e,path:t}]}(e)};return(c,o)=>{const u=i,C=s,S=f,I=x,z=V;return t(),l(C,{class:"tree-filter"},{default:n((()=>[a(C,{class:"header"},{default:n((()=>[e.searchIf?(t(),l(A,{key:0,ref_key:"searchRef",ref:R,onConfirm:X},null,512)):r("",!0),a(C,{class:"title"},{default:n((()=>[a(S,{"scroll-x":"",style:{width:"100%","white-space":"nowrap"},"scroll-left":F.value},{default:n((()=>[(t(!0),d(h,null,v(w.value,((e,s)=>(t(),l(C,{class:"inline-item",key:s},{default:n((()=>[0==s?(t(),l(C,{key:0,class:"inline-item",onClick:l=>ee(e,-1)},{default:n((()=>[a(u,{class:p([U.value(s)&&!E.value?"none":"active"])},{default:n((()=>[k("全部")])),_:2},1032,["class"])])),_:2},1032,["onClick"])):r("",!0),0==s&&E.value?(t(),l(C,{key:1,onClick:l=>ee(e,-2),class:p([s==w.value.length-1&&E.value?"none":"active","inline-item"])},{default:n((()=>[y("i",{class:"iconfont icon-z043 iconclass"}),k(" 搜索结果 ")])),_:2},1032,["onClick","class"])):r("",!0),0!=s?(t(),l(C,{key:2,class:"inline-item",onClick:l=>ee(e,s)},{default:n((()=>[y("i",{class:"iconfont icon-z043 iconclass"}),a(u,{class:p(U.value(s)?"none inline-ite":"active")},{default:n((()=>[k(g(e[q.options.label]),1)])),_:2},1032,["class"])])),_:2},1032,["onClick"])):r("",!0)])),_:2},1024)))),128))])),_:1},8,["scroll-left"])])),_:1})])),_:1}),a(C,{class:"tree-inners"},{default:n((()=>[a(C,{class:"container-list"},{default:n((()=>[(t(!0),d(h,null,v(N.value,((s,i)=>(t(),l(C,{class:"common",onClick:e=>te(s,i),key:i},{default:n((()=>[a(I,{class:"content"},{default:n((()=>[m(a(C,{class:"list-item"},{default:n((()=>[q.options.multiple?(t(),l(C,{key:0,class:"checkbox",onClick:b((e=>te(s,-1)),["stop"])},{default:n((()=>[W.value(s)?(t(),d("span",{key:0},[s.bx&&0!=O.value.length?(t(),d("i",{key:0,class:"iconfont icon-banxuanzhongshousuo1-shi icons"})):(t(),d("i",{key:1,class:"iconfont icon-xuanzhong txt icon-selected"}))])):s.qx?(t(),d("i",{key:1,class:"iconfont icon-xuanzhong txt icon-selected"})):s.bx?(t(),d("i",{key:2,class:"iconfont icon-banxuanzhongshousuo1-shi icons"})):(t(),d("i",{key:3,style:{color:"#b8b8b8"},class:"iconfont icon-weixuanzhong txt"}))])),_:2},1032,["onClick"])):q.options.nodes&&!s.user?r("",!0):(t(),l(C,{key:1,class:"checkbox",onClick:b((e=>te(s,-1)),["stop"])},{default:n((()=>[D.value(s)?(t(),d("i",{key:0,class:"txt iconfont icon-selected"})):(t(),d("i",{key:1,style:{color:"#b8b8b8"},class:"txt iconfont icon-weixuanzhong1"}))])),_:2},1032,["onClick"]))])),_:2},1536),[[_,e.isCheck]]),a(C,{class:"lable-text"},{default:n((()=>[k(g(s[q.options.label]),1)])),_:2},1024),a(C,{class:"right"},{default:n((()=>{var e;return[!s.user&&(null==(e=s.children)?void 0:e.length)>0?(t(),d("i",{key:0,class:"iconfont icon-z043 iconclass"})):r("",!0)]})),_:2},1024)])),_:2},1024)])),_:2},1032,["onClick"])))),128))])),_:1})])),_:1}),a(C,{class:"btn box_sizing"},{default:n((()=>[a(z,{class:"sureBtn",type:"primary",onClick:le},{default:n((()=>[k("确认")])),_:1})])),_:1})])),_:1})}}},[["__scopeId","data-v-e267711c"]]),F=e(q({__name:"deptFilter",setup(e){const a=o({label:"name",children:"children",multiple:!1});z((e=>{u(),console.log(e.checkId,"deng"),e.checkId?c.value=JSON.parse(e.checkId):c.value=[]}));const i=o([]),c=o([]),u=()=>{C({title:"加载中"}),uni.$u.http.get("admin/dept/tree").then((e=>{i.value=e.data,S()}))},f=e=>{if(!e.length)return O({title:"请先选择部门",icon:"none"});c.value=e[0].id,console.log(e[0],"config"),w("deptData",{name:e[0].name,id:c.value}),L()};return(e,o)=>{const u=s;return t(),l(u,{class:"dept-list"},{default:n((()=>[N(i).length>0?(t(),l(B,{key:0,onSendValue:f,isCheck:!0,checkList:N(c),treeNone:N(i),options:N(a),searchIf:!1},null,8,["checkList","treeNone","options"])):r("",!0)])),_:1})}}}),[["__scopeId","data-v-04b8878e"]]);export{F as default};
