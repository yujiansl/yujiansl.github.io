import{bA as e,s as a,d as l,x as s,q as t,bB as i,I as n,bC as r,K as d,bD as o,bE as u,b as c,o as m,a as v,c as b,y as p,w as y,F as f,e as k,u as _,i as g,P as h,g as x,t as I,_ as S,r as C,p as j,n as w,a5 as B,k as N,h as E,bF as F,B as M,Z as q,a2 as D,a1 as A,b9 as O,am as P,Q as T,b2 as z}from"./index-CK4DGatK.js";import{d as $}from"./debounce.BkVTat1y.js";import{a as L,c as Q}from"./carSelect-emit.CejlvgP5.js";import{g as V,S as G}from"./SeriesCard.BXJ3ECJo.js";import{u as K}from"./useQuery.3dd8K18V.js";import{i as R}from"./isEmpty.ma15Dxmc.js";import"./isObject.C8HfsiHw.js";import"./isSymbol.Bym6OQCA.js";import"./event.CJk5hinv.js";import"./_Uint8Array.B4mhORiM.js";import"./_getTag.DG-N9UUn.js";import"./_baseIteratee.DvY8IqJy.js";import"./_baseGet.CmhOSbYr.js";const U="/product/carBrand/getClassifiedBrand",W="/product/carModel/getModelBySeriesId",Y=S(l({__name:"BrandCard",props:{data:{}},emits:["item-click"],setup(e,{emit:a}){const l=e,S=a,C=s((()=>Object.values(l.data).map((e=>e||[])))),j=s((()=>Object.keys(l.data)));return t((()=>{document.querySelector(".u-index-list__scroll-view").style.height=i.safeArea.height-144+"px"})),(e,a)=>{const l=n(d("u-index-anchor"),r),s=h,t=g,i=n(d("u-index-item"),o),w=n(d("u-index-list"),u);return m(),c(f,null,[v(w,{"index-list":_(j),inactiveColor:"#000",activeColor:"#FE391E"},{default:y((()=>[(m(!0),c(f,null,k(_(C),((e,a)=>(m(),b(i,{key:a},{default:y((()=>[v(l,{text:_(j)[a],bgColor:"#F6F7FA",height:38},null,8,["text"]),(m(!0),c(f,null,k(e,((e,a)=>(m(),b(t,{class:"list-cell",key:a,onClick:a=>S("item-click",e)},{default:y((()=>[v(s,{src:e.brandLogo,mode:"aspectFit",class:"img"},null,8,["src"]),v(t,{class:"name"},{default:y((()=>[x(I(e.name),1)])),_:2},1024)])),_:2},1032,["onClick"])))),128))])),_:2},1024)))),128))])),_:1},8,["index-list"]),_(C).length?p("",!0):(m(),b(t,{key:0,class:"no-content"},{default:y((()=>[x("暂无数据")])),_:1}))],64)}}}),[["__scopeId","data-v-2ab57389"]]),Z=S(l({__name:"ModelCard",props:{list:{}},emits:["item-click"],setup(e,{emit:a}){const l=e,t=a,i=C(""),n=s((()=>V(l.list||[],(e=>e.carYear)))),r=s((()=>["全部",...Object.keys(n.value).sort(((e,a)=>Number(a)-Number(e)))]));j((()=>{var e;i.value=null==(e=r.value)?void 0:e[0]}));const d=s((()=>"全部"===i.value?l.list||[]:n.value[i.value]||[]));return(e,a)=>{const l=g,s=E,n=B;return m(),c(f,null,[_(r).length?(m(),b(l,{key:0,class:"tab-list"},{default:y((()=>[(m(!0),c(f,null,k(_(r),(e=>(m(),b(l,{class:w(["tab-item",{active:_(i)==e}]),key:e,onClick:a=>i.value=e},{default:y((()=>[x(I(e),1)])),_:2},1032,["class","onClick"])))),128))])),_:1})):p("",!0),e.list.length?(m(),b(n,{key:1,"scroll-y":"",class:"scroll-view-box","enable-flex":""},{default:y((()=>[N("div",{class:"model-card scroll-view-box"},[N("div",{class:"item"},[N("div",{class:"list-box"},[(m(!0),c(f,null,k(_(d),(e=>(m(),c("div",{class:"list-item",onClick:a=>t("item-click",e),key:e.id},[N("div",{class:"left"},[N("div",{class:"title"},I(e.name),1),N("div",{class:"desc"},I(e.energyType),1)]),N("div",{class:"right"},[x(I(e.price),1),v(s,{class:"unit"},{default:y((()=>[x("万")])),_:1})])],8,["onClick"])))),128))])])])])),_:1})):p("",!0),e.list.length?p("",!0):(m(),b(l,{key:2,class:"no-content"},{default:y((()=>[x("暂无数据")])),_:1}))],64)}}}),[["__scopeId","data-v-b3b66657"]]),H=S(l({__name:"carSelect",setup(l){const t=K(),i=C(0),r=C({}),o=C(0),u=s((()=>{const e=r.value.brand,a=r.value.series,l=r.value.model,s=[{name:(null==e?void 0:e.name)??"选择品牌",value:"brand"}];return e&&s.push({name:(null==a?void 0:a.name)??"选择车系",value:"series"}),a&&s.push({name:(null==l?void 0:l.name)??"选择车型",value:"model"}),s})),k=new Map([[0,"选择品牌"],[1,"选择车系"],[2,"选择车型"]]);F((()=>{z({title:k.get(o.value)||"选择"})}));const h=C({}),x=C([]),I=C([]);function S(e){o.value=e.index;const a=e.value;"brand"===a&&w(),"series"===a&&B(),"model"===a&&N()}M((()=>{w()}));const j=C(!1),w=(l="")=>{q({title:"加载中",mask:!0}),j.value=!1,h.value={},uni.$u.http.get(U,{params:{carBrandName:l}}).then((l=>{h.value=l.data||{},j.value=!0,(async l=>{if(!e)return;await a();const{scrollViewSelector:s,indexBarSelector:t}=l,i=document.querySelector(s),n=document.querySelector(t),r=$((()=>{n&&n.style.setProperty("pointer-events","")}),50);i&&(i.onscroll=()=>{n.style.setProperty("pointer-events","none"),r()})})({scrollViewSelector:".u-index-list .uni-scroll-view > .uni-scroll-view",indexBarSelector:".u-index-list__letter"}),D()}))},B=async()=>{var e;q({title:"加载中",mask:!0}),x.value=[];const a=null==(e=r.value.brand)?void 0:e.id,l=await uni.$u.http.get("/product/carSeries/getSeries",{params:{carBrandId:a,name:"",containsAll:!1}});x.value=(l.data||[]).flatMap((e=>(e.carSeries||[]).map((a=>({...a,brandId:e.brandId}))))),D()},N=async()=>{var e,a;q({title:"加载中",mask:!0}),I.value=[];const l=null==(e=r.value.brand)?void 0:e.id,s=null==(a=r.value.series)?void 0:a.id,t=(await uni.$u.http.get(W,{data:{seriesId:s,carBrandId:l,type:0}})).data||{};I.value=t.carModelList||[],D()},E=(e,a)=>{var l,s,i,n,d,u,c;if("brand"===a)if(r.value.brand={id:e.id,name:e.name},r.value.series=void 0,r.value.model=void 0,"brand"===t.value.selectType){const a={brandId:e.id,brandName:e.name};Q.emitEvent({data:a,queryData:t.value}),A()}else o.value=1,B();else if("series"===a){const a=null==(l=Object.values(h.value).flat().find((a=>a.id===e.brandId)))?void 0:l.name;if(r.value.brand={id:e.brandId,name:a},r.value.series={id:e.id,name:e.name},r.value.model=void 0,"series"===t.value.selectType){const a={brandId:null==(s=r.value.brand)?void 0:s.id,brandName:null==(i=r.value.brand)?void 0:i.name,seriesId:e.id,seriesName:e.name};Q.emitEvent({data:a,queryData:t.value}),A()}else o.value=2,N()}else if("model"===a){r.value.model={id:e.id,name:e.name};const a={...e,brandId:null==(n=r.value.brand)?void 0:n.id,brandName:null==(d=r.value.brand)?void 0:d.name,seriesId:null==(u=r.value.series)?void 0:u.id,seriesName:null==(c=r.value.series)?void 0:c.name,modelId:e.id,modelName:e.name};Q.emitEvent({data:a,queryData:t.value}),A()}};return L.onEvent((({data:e})=>{E(e,"series"),i.value=Math.random()})),(e,a)=>{const l=n(d("up-search"),O),s=g,t=n(d("up-tabs"),P);return m(),b(s,{class:"page"},{default:y((()=>[v(s,{class:"search-box",onClick:a[0]||(a[0]=a=>("toPage"in e?e.toPage:_(T))("/pages/assess/seriesSearch"))},{default:y((()=>[v(l,{placeholder:"请输入车系搜索","show-action":!0,actionText:"搜索"})])),_:1}),(m(),b(t,{current:_(o),list:_(u),lineColor:"#DD4F33",activeStyle:{color:"#333",fontWeight:"bold",fontSize:"32rpx"},inactiveStyle:{color:"#333",fontSize:"32rpx"},onClick:S,key:_(i)},null,8,["current","list"])),0===_(o)?(m(),c(f,{key:0},[_(j)&&!_(R)(_(h))?(m(),b(Y,{key:0,data:_(h),onItemClick:a[1]||(a[1]=e=>E(e,"brand"))},null,8,["data"])):p("",!0)],64)):1===_(o)?(m(),b(G,{key:1,list:_(x),onItemClick:a[2]||(a[2]=e=>E(e,"series"))},null,8,["list"])):2===_(o)?(m(),b(Z,{key:2,list:_(I),onItemClick:a[3]||(a[3]=e=>E(e,"model"))},null,8,["list"])):p("",!0)])),_:1})}}}),[["__scopeId","data-v-7afd390a"]]);export{H as default};
