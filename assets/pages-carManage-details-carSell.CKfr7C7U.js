import{d as e,x as r,A as a,r as t,a9 as l,B as o,b2 as u,C as s,au as d,E as n,X as i,Y as m,D as c,a2 as C,aR as f,c as D,w as p,i as v,I as y,M as T,K as O,at as g,o as h,a as _,a5 as b,y as I,u as k,g as N,h as w,R as S,b as P,F as M,e as x,n as A,t as R,Q as U,k as $,a7 as j,aj as V,S as F,W as q,s as L,b3 as K,ar as Y,a1 as J,$ as B,aS as E,ai as W,a0 as Q,_ as X}from"./index-CK4DGatK.js";import{D as Z}from"./detailItem.D7jJ4BsD.js";import{c as z}from"./carListItem.hYH6YShY.js";import{C as G}from"./cityPicker.CpzGRyNT.js";import{U as H}from"./UploadFile.BBuXxkzB.js";import{u as ee}from"./useSell.c71q6Fal.js";import{I as re,S as ae}from"./scan-upload.q-LlmoOx.js";import{d as te,g as le}from"./customer.BR_0pqR6.js";import{u as oe}from"./useQuery.3dd8K18V.js";import{a as ue}from"./index.HDA2F_3Q.js";import{d as se}from"./debounce.BkVTat1y.js";import"./car_default.CyENNAub.js";import"./time._VqwKl0d.js";import"./image.DobRSNlT.js";import"./dev.3CSglq9A.js";import"./index.BP9c-u7r.js";import"./play.dJbs8fP_.js";import"./vuedraggable.umd.DwpyKIuh.js";import"./index.DEPEwlq9.js";import"./isObject.C8HfsiHw.js";import"./isSymbol.Bym6OQCA.js";const de=X(e({__name:"carSell",setup(e){const X=oe(),de=r((()=>!!X.value.carProductId)),ne=a(),ie=ee();r((()=>"reserveToSale"===X.value.source));const me=t(0),ce=l({orderCarCustomerDTO:{dealPrice:"",deposit:"0",paymentMethod:"Full",downPaymentRatio:null,mortgageNumber:"",mortgageAmount:"",paymentAmount:"",monthlyPaymentAmount:"",transferMethod:"localTransfer",salesType:"Retail",salesUserId:"",salesUserName:"",financialLoanIncome:"",boutiqueIncome:"",insuranceAppreciationIncome:"",otherIncome:"",remark:"",wayOfSigning:1,reserveTime:"",enterpriseId:"",contractId:""},orderCarCustomerDetailDTO:{customerId:"",customer:"",customerMobile:"",customerName:"",idNumber:"",customerSource:null,address:"",provinceId:"",provinceName:"",cityId:"",cityName:"",countyId:"",countyName:"",payer:"",openBank:"",bankCardNumber:"",trafficInsuranceDate:"",commercialInsuranceDate:"",inspectionDate:""},createSignReq:{thirdUser:null,thirdUserId:null,thirdName:null,thirdIdNumber:null,thirdMobile:null,thirdMobileAddress:null,balancePayDate:null,balancePayTime:null,payDate:null,coverCharge:null,otherPrice:null,changeDate:null,bearParty:null,cost1:!1,cost2:!1,cost3:!1,cost4:!1,cost5:!1,cost6:!1,keyNumType:null,insuranceSituation:null,defect:null,special:null,supplement:null,name:null},carAttachments:[],mortgageCarAttachments:[],contractAnnex:[]}),Ce=l({}),fe=t([{key:"Full",value:"全款"},{key:"Mortgage",value:"按揭"}]),De=t([]),pe=t([{key:12,value:"12期"},{key:24,value:"24期"},{key:36,value:"36期"},{key:48,value:"48期"},{key:60,value:"60期"}]),ve=t([]),ye=t([{key:"Retail",value:"零售"},{key:"Wholesale",value:"批发"},{key:"Consignment",value:"寄售"}]),Te=t([]),Oe=t(),ge=t(),he=t([]),_e=t([{key:1,value:"是"},{key:0,value:"否"}]),be=t([{key:1,value:"线下签约"},{key:0,value:"线上签约"}]),Ie=t(),ke=t(!1),Ne=new Map([["year","年"],["month","月"],["day","日"]]);function we(e,r){return`${r}${Ne.get(e)}`}const Se=t(!1);o((()=>{u({title:X.value.type?"车辆预定":"车辆销售"}),me.value=X.value.type?0:1,s({scrollTop:0,duration:0});const e=d().add(3,"day");ce.orderCarCustomerDTO.reserveTime=e.format("YYYY-MM-DD"),ce.orderCarCustomerDTO.wayOfSigning=null;const r=ne.userInfo;ce.orderCarCustomerDTO.salesUserName=null==r?void 0:r.name,ce.orderCarCustomerDTO.salesUserId=null==r?void 0:r.userId,X.value.id||X.value.source?Ge():ze(),er(),He();for(let a=0;a<=95;a+=5)De.value.push({key:a,value:a});Qe(),Xe()})),n((()=>{i("pickData"),m("pickData",(e=>{const{key:r,subKey:a,tKey:t}=e;t?ce[a][t]=r:ce[a]=r,"downPaymentRatio"==t&&Or(),ce.createSignReq={thirdUser:null,thirdUserId:null,thirdName:null,thirdIdNumber:null,thirdMobile:null,thirdMobileAddress:null,balancePayDate:null,balancePayTime:null,payDate:null,coverCharge:null,otherPrice:null,changeDate:null,bearParty:null,cost1:!1,cost2:!1,cost3:!1,cost4:!1,cost5:!1,cost6:!1,keyNumType:null,insuranceSituation:null,defect:null,special:null,supplement:null,name:null}})),i("sellData"),m("sellData",(e=>{const{name:r,id:a}=e;ce.orderCarCustomerDTO.salesUserName=r,ce.orderCarCustomerDTO.salesUserId=a})),i("customerData"),m("customerData",(e=>{const{name:r,realPhone:a,id:t,idNumber:l}=e;ce.orderCarCustomerDetailDTO.customer=a,ce.orderCarCustomerDetailDTO.customerName=r,ce.orderCarCustomerDetailDTO.customerMobile=a,ce.orderCarCustomerDetailDTO.customerId=t,ce.orderCarCustomerDetailDTO.idNumber=l,Re.value=!1,Ue.value=!1,$e.value=!1,je.value=[]})),i("saveContract"),m("saveContract",(e=>{console.log(e,"补充信息"),ce.createSignReq=e}))}));const Pe=t(!1),Me=t(),xe=t(),Ae=t(),Re=t(!1),Ue=t(!1),$e=t(!1),je=t([]),Ve=()=>{setTimeout((()=>{Re.value=!1,Ue.value=!1,$e.value=!1,je.value=[]}),100)},Fe=e=>{ce.orderCarCustomerDetailDTO.customerName=e.name,ce.orderCarCustomerDetailDTO.customer=e.realPhone,ce.orderCarCustomerDetailDTO.customerMobile=e.realPhone,ce.orderCarCustomerDetailDTO.idNumber=e.idNumber,ce.orderCarCustomerDetailDTO.customerId=e.id,Re.value=!1,Ue.value=!1,$e.value=!1,je.value=[]},qe=se((()=>{Ue.value=!1,$e.value=!1,te({value:ce.orderCarCustomerDetailDTO.customerName,elRef:Me,visible:Re,list:je,subKey:"phone",length:1,requestFn:le})}),300),Le=()=>{setTimeout((()=>{console.log("handleCustomerPhoneInput"),ce.orderCarCustomerDetailDTO.customerMobile=ce.orderCarCustomerDetailDTO.customerMobile.replace(/[^0-9]/g,""),console.log("mobile",ce.orderCarCustomerDetailDTO.customerMobile)})),console.log(ce.orderCarCustomerDetailDTO.customerMobile),Re.value=!1,$e.value=!1,te({value:ce.orderCarCustomerDetailDTO.customerMobile,elRef:xe,visible:Ue,list:je,subKey:"phone",length:11,requestFn:le})},Ke=()=>{Re.value=!1,Ue.value=!1,te({value:ce.orderCarCustomerDetailDTO.idNumber,elRef:Ae,visible:$e,list:je,subKey:"idNumber",length:4,searchKey:"idNumber",requestFn:le})},Ye=t([]),Je=t([]),Be=r((()=>ur(Ye.value,ce.orderCarCustomerDTO.enterpriseId))),Ee=r((()=>ur(Je.value,ce.orderCarCustomerDTO.contractId))),We=()=>{"5"==ce.orderCarCustomerDTO.contractId&&(ce.createSignReq.name=Ye.value.filter((e=>e.value==ce.orderCarCustomerDTO.enterpriseId))[0].label),U(`/pages/carManage/replenishInfo?params=${JSON.stringify(Object.assign(ce.createSignReq,{carProductId:X.value.carProductId}))}&type=${ce.orderCarCustomerDTO.contractId}`)},Qe=()=>{uni.$u.http.get("/product/enterprise/getEnterpriseList").then((e=>{Ye.value=e.data.map((e=>({label:e.corpName,value:e.id})))}))},Xe=()=>{uni.$u.http.get("/product/contractTemplate/list",{params:{templateType:2}}).then((e=>{Je.value=e.data.map((e=>({label:e.templateName,value:e.id,remarks:e.remarks})))}))},Ze=t(),ze=()=>{(new c).showLoading("加载中"),uni.$u.http.get("/product/merchant/car/product/detail",{params:{productId:X.value.carProductId}}).then((e=>{var r;Object.assign(Ce,{...e.data,warehouseNum:e.data.warehouseDay}),ce.orderCarCustomerDTO.dealPrice=e.data.price,ce.orderCarCustomerDTO.enterpriseId=null==(r=e.data.purchaseDetail)?void 0:r.purchaseOrderEnterpriseId,Ze.value=e.data.purchaseDetail||{},rr(),C()}))},Ge=()=>{(new c).showLoading("加载中"),uni.$u.http.get("/product/order/car/custom/getDetail",{params:{id:X.value.id||X.value.sourceId}}).then((e=>{var r,a,t,l;e.data.orderCarCustomerDTO.reserveTime=(null==(r=e.data.orderCarCustomerDTO)?void 0:r.reserveTime)||ce.orderCarCustomerDTO.reserveTime,Object.assign(ce,e.data),console.log(ce,"form"),ce.carAttachments=(null==(a=e.data.carAttachments)?void 0:a.length)?[e.data.carAttachments[0]]:[],ce.mortgageCarAttachments=(null==(t=e.data.mortgageCarAttachments)?void 0:t.length)?[e.data.mortgageCarAttachments[0]]:[],ce.contractAnnex=null==(l=e.data.contractAnnex)?void 0:l.map((e=>({attachmentId:e.attachmentId,id:e.attachmentId,attachmentUrl:e.attachmentUrl})));const{customerId:o,customerMobile:u}=ce.orderCarCustomerDetailDTO;o&&(ce.orderCarCustomerDetailDTO.customer=u),Se.value=X.value.source&&null!==ce.orderCarCustomerDTO.wayOfSigning})).finally((()=>{C(),console.log("source",X.value.source,"idNumber",ce.orderCarCustomerDetailDTO.idNumber,"wayOfSigning",ce.orderCarCustomerDTO.wayOfSigning),console.log("reserveToSale"===X.value.source&&!ce.orderCarCustomerDetailDTO.idNumber&&1==ce.orderCarCustomerDTO.wayOfSigning),Pe.value="reserveToSale"===X.value.source&&!ce.orderCarCustomerDetailDTO.idNumber&&1==ce.orderCarCustomerDTO.wayOfSigning}))},He=()=>{uni.$u.http.get("/product/carProductApp/getArea").then((e=>{he.value=e.data}))},er=()=>{uni.$u.http.get("product/common/getInitSelect").then((e=>{const r=e.data;Te.value=r.CustomerSource,ve.value=r.transferMethodType}))},rr=()=>{var e,r;(null==(e=null==ie?void 0:ie.sellParams)?void 0:e.customerId)&&uni.$u.http.get("/crm/customer/crmCustomerId",{params:{crmCustomerId:null==(r=null==ie?void 0:ie.sellParams)?void 0:r.customerId}}).then((e=>{const{name:r,phone:a,id:t,idCard:l,address:o,addressCode:u}=e.data;ce.orderCarCustomerDetailDTO.customer=a,ce.orderCarCustomerDetailDTO.customerName=r,ce.orderCarCustomerDetailDTO.customerMobile=a,ce.orderCarCustomerDetailDTO.customerId=t,ce.orderCarCustomerDetailDTO.idNumber=l;const s=(null==o?void 0:o.split(" "))||[],d=(null==u?void 0:u.split(","))||[];ce.orderCarCustomerDetailDTO.provinceId=d[0]||"",ce.orderCarCustomerDetailDTO.provinceName=s[0]||"",ce.orderCarCustomerDetailDTO.cityId=d[1]||"",ce.orderCarCustomerDetailDTO.cityName=s[1]||"",ce.orderCarCustomerDetailDTO.countyId=d[2]||"",ce.orderCarCustomerDetailDTO.countyName=s[2]||""}))};r((()=>or(De.value,ce.orderCarCustomerDTO.downPaymentRatio,"%"))),r((()=>or(pe.value,ce.orderCarCustomerDTO.mortgageNumber)));const ar=r((()=>or(ve.value,ce.orderCarCustomerDTO.transferMethod))),tr=r((()=>or(ye.value,ce.orderCarCustomerDTO.salesType))),lr=r((()=>or(Te.value,ce.orderCarCustomerDetailDTO.customerSource))),or=(e,r,a="")=>{const t=null==e?void 0:e.filter((e=>e.key==r));return(null==t?void 0:t.length)?t[0].value+a:(r&&a?r+a:"")||"请选择"},ur=(e,r,a="")=>{const t=null==e?void 0:e.filter((e=>e.value==r));return(null==t?void 0:t.length)?t[0].label+a:"请选择"},sr=(e,r,a)=>{a?ce[r][a]=e.detail.value:ce[r]=e.detail.value},dr=e=>{const{provinceId:r,provinceName:a,cityId:t,cityName:l,countryId:o,countyName:u}=e;ce.orderCarCustomerDetailDTO.provinceId=r,ce.orderCarCustomerDetailDTO.provinceName=a,ce.orderCarCustomerDetailDTO.cityId=t,ce.orderCarCustomerDetailDTO.cityName=l,ce.orderCarCustomerDetailDTO.countyId=o,ce.orderCarCustomerDetailDTO.countyName=u},nr=(e,r,a,t,l)=>{U(`/pages/carManage/pagePicker?title=${e}&list=${JSON.stringify(r)}&key=${a}&subKey=${t}&tKey=${l}`)},ir=(e,r,a,t,l)=>{U(`/pages/carManage/pagePicker?title=${e}&list=${JSON.stringify(r)}&key=${a}&subKey=${t}&tKey=${l}&pageKey=purchase`)},mr=e=>{L((()=>{ce.orderCarCustomerDTO.reserveTime=d(e.value).format("YYYY-MM-DD"),ke.value=!1}))},cr=t(),Cr=e=>{var r,a;null==(r=cr.value)||r.close();const t=null==(a=null==e?void 0:e.image)?void 0:a[0].attachmentUrl;t&&((new c).showLoading("识别中"),uni.$u.http.get("/product/ocr/idCard/info",{params:{image:t,side:"front"}}).then((async e=>{const r=e.data,{customerName:a,idNumber:t}=ce.orderCarCustomerDetailDTO;ce.orderCarCustomerDetailDTO.customerName=r.name||a,ce.orderCarCustomerDetailDTO.idNumber=r.number||t,await(async e=>{const r=await uni.$u.http.get("/product/userRealNameInfo/getPhoneByIdCard/"+e);ce.orderCarCustomerDetailDTO.customerMobile=r.data||""})(r.number)})).finally((()=>C())))},fr=()=>{L((()=>{s({scrollTop:2e3,duration:100})}))},Dr=r((()=>X.value.type?"定金凭证":"资料照片")),pr=(e=!0)=>{var r,a,t,l,o,u;const s=(null==(t=null==(a=null==(r=Ie.value)?void 0:r.getFileFields())?void 0:a.all)?void 0:t.map((e=>e.attachmentId)))||[],d=(null==(u=null==(o=null==(l=Oe.value)?void 0:l.getFileFields())?void 0:o.all)?void 0:u.map((e=>e.attachmentId)))||[],{dealPrice:n,transferMethod:i,salesType:m,salesUserId:c,paymentMethod:C,downPaymentRatio:f,mortgageAmount:D,paymentAmount:p,wayOfSigning:v,remark:y}=ce.orderCarCustomerDTO,{customerMobile:T,customerName:O,idNumber:g}=ce.orderCarCustomerDetailDTO;if(!n)return"请输入成交价";if(!i)return"请选择过户方式";if(!m)return"请选择销售类型";if(!c)return"请选择销售";if(!T)return"请输入手机号";if(!d.length&&"资料照片"!==Dr.value)return`请上传${Dr.value}`;if(!O)return"请输入姓名";if(X.value.type&&1==me.value&&0==ce.orderCarCustomerDTO.wayOfSigning&&!g||!X.value.type&&!g)return"请输入身份证号";if(1==me.value&&null===v)return"请选择签约方式";if(1==me.value&&1==v&&!s.length)return"请上传合同照片";if(1==me.value&&0==v&&!ce.orderCarCustomerDTO.enterpriseId)return"请选择主体";if(1==me.value&&0==v&&!ce.orderCarCustomerDTO.contractId)return"请选择合同模板";if(!ce.createSignReq||1==v)return"";const{thirdUser:h,thirdUserId:_,thirdName:b,thirdIdNumber:I,thirdMobile:k,thirdMobileAddress:N,balancePayDate:w,balancePayTime:S,payDate:P,coverCharge:M,otherPrice:x,changeDate:A,bearParty:R,keyNumType:U,name:$}=ce.createSignReq;if("4"==ce.orderCarCustomerDTO.contractId){if(!(h&&_&&b&&I&&k&&N&&w&&S&&P&&M&&x&&A&&R&&U))return"请补充合同信息"}else if("5"==ce.orderCarCustomerDTO.contractId){if(!(w&&x&&S&&$))return"请补充合同信息"}else if(["2","3","6","7"].includes(ce.orderCarCustomerDTO.contractId)&&(!S||!R))return"请补充合同信息";return""},vr=async()=>{var e,r,a,t,l,o,u,s,d,n,i;const m=K(),C=m[m.length-2],f=pr();if(f)return void(new c).showToast(f);if(ce.orderCarCustomerDetailDTO.customerMobile==(null==(e=ce.createSignReq)?void 0:e.thirdMobile))return void(new c).showToast("客户不能与补充合同里面的出售方一致");const D=(null==(t=null==(a=null==(r=Ie.value)?void 0:r.getFileFields())?void 0:a.all)?void 0:t.map((e=>e.attachmentId)))||[],p=JSON.parse(JSON.stringify(ce||"{}"));p.orderCarCustomerDetailDTO.customerId=null,"Full"==ce.orderCarCustomerDTO.paymentMethod&&(p.orderCarCustomerDTO.downPaymentRatio=null,p.orderCarCustomerDTO.mortgageNumber="",p.orderCarCustomerDTO.mortgageAmount="",p.orderCarCustomerDTO.paymentAmount="",p.orderCarCustomerDTO.monthlyPaymentAmount=""),(null==(l=p.createSignReq)?void 0:l.keyNumType)&&(p.createSignReq.keyNumType=Number(p.createSignReq.keyNumType)),p.contractAnnex=1==me.value&&1==ce.orderCarCustomerDTO.wayOfSigning?D:[],(new c).showLoading("提交中");const v={id:X.value.id,carProductId:X.value.carProductId,...p};v.carAttachments=(null==(u=null==(o=Oe.value)?void 0:o.getFileFields())?void 0:u.all)||[],v.mortgageCarAttachments=(null==(d=null==(s=ge.value)?void 0:s.getFileFields())?void 0:d.all)||[],(null==(n=v.createSignReq)?void 0:n.balancePayTime)&&(v.createSignReq.balancePayTime=new Date(v.createSignReq.balancePayTime).getTime()),X.value.source?uni.$u.http.put("/product/order/car/custom/reserve/sold",{...v,id:X.value.sourceId}).then((()=>{(new c).showToast("提交成功"),Y("refreshList"),Y("refreshDetail"),J({delta:2})})):(X.value.type?await B().post("/product/order/car/custom/reserve",v):X.value.id?await B().put("/product/order/car/custom/reserve",v):await B().post("/product/order/car/custom/directSale",v),(null==(i=null==ie?void 0:ie.sellParams)?void 0:i.sellId)&&await B().post("/crm/customer/sell/order",{sellId:ie.sellParams.sellId,productId:X.value.carProductId}),(new c).showToast(X.value.id?"保存成功":"提交成功"),setTimeout((()=>{var e;"pages/carManage/carList"==C.route?"yes"==ie.isSell?E({url:"/pages/sells/index"}):E({url:"/pages/index/index"}):"pages/carManage/details/index"==C.route&&J({delta:2}),(null==(e=null==ie?void 0:ie.sellParams)?void 0:e.sellId)&&Y("refreshDetail"),ie.clear()}),1500))},yr=()=>{const e=pr(!1);if(e)return void(new c).showToast(e);const r=JSON.parse(JSON.stringify(ce||"{}"));r.createSignReq.keyNumType=Number(r.createSignReq.keyNumType);const a={carProductId:X.value.carProductId,...r};uni.$u.http.post("/product/sign/sale/preview",a).then((e=>{U(`/pages/carManage/pdf?url=${e.data}`)}))},Tr=(e,r,a,t)=>{L((()=>{if(ce[r][a]=ue(e,t),"monthlyPaymentAmount"==a){const e=(.2*ce.orderCarCustomerDTO.dealPrice*1e4).toFixed(2);parseFloat(ce[r][a])>e&&((new c).showToast("月供需小于等于车款的20%"),ce[r][a]="")}}))},Or=()=>{const{dealPrice:e,downPaymentRatio:r}=ce.orderCarCustomerDTO;e&&null!==r&&(ce.orderCarCustomerDTO.paymentAmount=1e4*e*(r/100),ce.orderCarCustomerDTO.mortgageAmount=parseInt(1e4*e-ce.orderCarCustomerDTO.paymentAmount))};return f((()=>{ie.clear()})),(e,r)=>{const a=v,t=w,l=S,o=y(O("up-icon"),T),u=j,s=V,n=q,i=b,m=y(O("u-datetime-picker"),g);return h(),D(a,{class:"page f-c-s"},{default:p((()=>[_(i,{"scroll-y":"",class:"scroll-view-box","enable-flex":"",style:{height:"100%"}},{default:p((()=>[_(a,{class:"content scroll-view-box"},{default:p((()=>[k(X).id||k(X).source?(h(),D(Z,{key:0,detailObj:k(ce)},null,8,["detailObj"])):(h(),D(z,{key:1,item:k(Ce),itemType:"detail"},null,8,["item"])),_(a,{class:"section-title"},{default:p((()=>[N("完整信息")])),_:1}),_(a,{class:"form-box"},{default:p((()=>[_(a,{class:"form-item"},{default:p((()=>[_(a,null,{default:p((()=>[_(t,null,{default:p((()=>[N("*")])),_:1}),N("成交价")])),_:1}),_(l,{modelValue:k(ce).orderCarCustomerDTO.dealPrice,"onUpdate:modelValue":r[0]||(r[0]=e=>k(ce).orderCarCustomerDTO.dealPrice=e),type:"digit",placeholder:"请输入",onInput:r[1]||(r[1]=e=>Tr(e.detail.value,"orderCarCustomerDTO","dealPrice","sale")),onBlur:Or},null,8,["modelValue"]),N(" 万元 ")])),_:1}),_(a,{class:"form-item"},{default:p((()=>[_(a,null,{default:p((()=>[N("定金")])),_:1}),_(l,{modelValue:k(ce).orderCarCustomerDTO.deposit,"onUpdate:modelValue":r[2]||(r[2]=e=>k(ce).orderCarCustomerDTO.deposit=e),type:"number",placeholder:"请输入",maxlength:"7",onInput:r[3]||(r[3]=e=>Tr(e.detail.value,"orderCarCustomerDTO","deposit","yuan"))},null,8,["modelValue"]),N(" 元 ")])),_:1}),_(a,{class:"form-item"},{default:p((()=>[_(a,null,{default:p((()=>[_(t,null,{default:p((()=>[N("*")])),_:1}),N("付款方式")])),_:1}),_(a,{class:"tab-box"},{default:p((()=>[(h(!0),P(M,null,x(k(fe),((e,r)=>(h(),D(t,{key:r,class:A({active:k(ce).orderCarCustomerDTO.paymentMethod==e.key}),onClick:r=>k(ce).orderCarCustomerDTO.paymentMethod=e.key},{default:p((()=>[N(R(e.value),1)])),_:2},1032,["class","onClick"])))),128))])),_:1})])),_:1}),"Mortgage"===k(ce).orderCarCustomerDTO.paymentMethod?(h(),D(a,{key:0,class:"form-item photo-item"},{default:p((()=>[_(a,null,{default:p((()=>[N("按揭图片")])),_:1}),_(H,{ref_key:"salesOrderMortgageUploadRef",ref:ge,carAttachmentType:"SalesOrderMortgage",accept:"all","max-count":9,uploadList:k(ce).mortgageCarAttachments},null,8,["uploadList"])])),_:1})):I("",!0),_(a,{class:"form-item"},{default:p((()=>[_(a,null,{default:p((()=>[_(t,null,{default:p((()=>[N("*")])),_:1}),N("过户方式")])),_:1}),_(a,{class:"f-b-c",onClick:r[4]||(r[4]=e=>nr("过户方式",k(ve),k(ce).orderCarCustomerDTO.transferMethod,"orderCarCustomerDTO","transferMethod"))},{default:p((()=>[_(t,null,{default:p((()=>[N(R(k(ar)),1)])),_:1}),_(o,{name:"arrow-right"})])),_:1})])),_:1}),_(a,{class:"form-item"},{default:p((()=>[_(a,null,{default:p((()=>[_(t,null,{default:p((()=>[N("*")])),_:1}),N("销售类型")])),_:1}),_(a,{class:"f-b-c",onClick:r[5]||(r[5]=e=>nr("销售类型",k(ye),k(ce).orderCarCustomerDTO.salesType,"orderCarCustomerDTO","salesType"))},{default:p((()=>[_(t,null,{default:p((()=>[N(R(k(tr)),1)])),_:1}),_(o,{name:"arrow-right"})])),_:1})])),_:1}),_(a,{class:"form-item"},{default:p((()=>[_(a,null,{default:p((()=>[_(t,null,{default:p((()=>[N("*")])),_:1}),N("销售")])),_:1}),_(a,{class:"f-b-c",onClick:r[6]||(r[6]=r=>k(de)?void 0:("toPage"in e?e.toPage:k(U))(`/pages/carManage/sellUserList?title=销售&id=${k(ce).orderCarCustomerDTO.salesUserId}`))},{default:p((()=>[_(t,{class:A({placeholder:!k(ce).orderCarCustomerDTO.salesUserName})},{default:p((()=>[N(R(k(ce).orderCarCustomerDTO.salesUserName||"请选择"),1)])),_:1},8,["class"]),k(de)?I("",!0):(h(),D(o,{key:0,name:"arrow-right"}))])),_:1})])),_:1}),_(a,{class:"form-item"},{default:p((()=>[_(a,null,{default:p((()=>[N("预计交车时间")])),_:1}),_(a,{class:"f-b-c",onClick:r[7]||(r[7]=e=>ke.value=!0)},{default:p((()=>[_(t,null,{default:p((()=>[N(R(k(ce).orderCarCustomerDTO.reserveTime),1)])),_:1}),_(o,{name:"arrow-right"})])),_:1})])),_:1})])),_:1}),_(a,{class:"section-title"},{default:p((()=>[N("客户信息")])),_:1}),_(a,{class:"form-box"},{default:p((()=>[k(Se)?(h(),P(M,{key:0},[_(a,{class:"form-item disable-item"},{default:p((()=>[_(a,null,{default:p((()=>[_(t,null,{default:p((()=>[N("*")])),_:1}),N("客户姓名")])),_:1}),N(" "+R(k(ce).orderCarCustomerDetailDTO.customerName),1)])),_:1}),_(a,{class:"form-item disable-item"},{default:p((()=>[_(a,null,{default:p((()=>[_(t,null,{default:p((()=>[N("*")])),_:1}),N("手机号")])),_:1}),N(" "+R(k(ce).orderCarCustomerDetailDTO.customerMobile),1)])),_:1}),_(a,{class:A(["form-item",k(Pe)?"":"disable-item"])},{default:p((()=>[_(a,null,{default:p((()=>[_(t,null,{default:p((()=>[N("*")])),_:1}),N("身份证号")])),_:1}),k(Pe)?(h(),D(l,{key:1,modelValue:k(ce).orderCarCustomerDetailDTO.idNumber,"onUpdate:modelValue":r[8]||(r[8]=e=>k(ce).orderCarCustomerDetailDTO.idNumber=e)},null,8,["modelValue"])):(h(),D(t,{key:0},{default:p((()=>[N(R(k(ce).orderCarCustomerDetailDTO.idNumber||"-"),1)])),_:1}))])),_:1},8,["class"])],64)):(h(),P(M,{key:1},[$("div",{class:"form-item input-complete",ref_key:"customerNameFormItemRef",ref:Me},[_(a,null,{default:p((()=>[_(t,null,{default:p((()=>[N("*")])),_:1}),N("客户姓名")])),_:1}),_(l,{onInput:k(qe),modelValue:k(ce).orderCarCustomerDetailDTO.customerName,"onUpdate:modelValue":r[9]||(r[9]=e=>k(ce).orderCarCustomerDetailDTO.customerName=e),ignoreCompositionEvent:!1,placeholder:"请输入",onBlur:Ve},null,8,["onInput","modelValue"]),_(o,{onClick:r[10]||(r[10]=r=>("toPage"in e?e.toPage:k(U))(`/pages/carManage/customerList?keyword=${k(ce).orderCarCustomerDetailDTO.customerName}`)),name:"arrow-right"}),k(Re)?(h(),D(re,{key:0,list:k(je),onItemClick:Fe},null,8,["list"])):I("",!0)],512),$("div",{class:"form-item input-complete",ref_key:"customerPhoneFormItemRef",ref:xe},[_(a,null,{default:p((()=>[_(t,null,{default:p((()=>[N("*")])),_:1}),N("手机号")])),_:1}),_(l,{onInput:Le,modelValue:k(ce).orderCarCustomerDetailDTO.customerMobile,"onUpdate:modelValue":r[11]||(r[11]=e=>k(ce).orderCarCustomerDetailDTO.customerMobile=e),placeholder:"请输入",maxlength:"13",onBlur:Ve},null,8,["modelValue"]),k(Ue)?(h(),D(re,{key:0,list:k(je),onItemClick:Fe},null,8,["list"])):I("",!0)],512),$("div",{class:"form-item input-complete",ref_key:"customerIdNumberFormItemRef",ref:Ae},[_(a,null,{default:p((()=>[!k(X).type||k(X).type&&1==k(me)&&0==k(ce).orderCarCustomerDTO.wayOfSigning?(h(),D(t,{key:0},{default:p((()=>[N("*")])),_:1})):I("",!0),N(" 身份证号 ")])),_:1}),_(l,{onInput:Ke,modelValue:k(ce).orderCarCustomerDetailDTO.idNumber,"onUpdate:modelValue":r[12]||(r[12]=e=>k(ce).orderCarCustomerDetailDTO.idNumber=e),placeholder:"请输入",onBlur:Ve},null,8,["modelValue"]),k($e)?(h(),D(re,{key:0,list:k(je),onItemClick:Fe},null,8,["list"])):I("",!0),_(ae,{maxCount:1,cameraType:"idCardPerson",onSuccess:Cr})],512)],64)),_(a,{class:"form-item"},{default:p((()=>[_(a,null,{default:p((()=>[N("客户来源")])),_:1}),_(a,{class:"f-b-c",onClick:r[13]||(r[13]=e=>nr("客户来源",k(Te),k(ce).orderCarCustomerDetailDTO.customerSource,"orderCarCustomerDetailDTO","customerSource"))},{default:p((()=>[_(t,{class:A({placeholder:"请选择"==k(lr)})},{default:p((()=>[N(R(k(lr)),1)])),_:1},8,["class"]),_(o,{name:"arrow-right"})])),_:1})])),_:1}),_(a,{class:"form-item"},{default:p((()=>[_(a,null,{default:p((()=>[N("地址")])),_:1}),_(l,{modelValue:k(ce).orderCarCustomerDetailDTO.address,"onUpdate:modelValue":r[14]||(r[14]=e=>k(ce).orderCarCustomerDetailDTO.address=e),placeholder:"请输入"},null,8,["modelValue"])])),_:1}),_(a,{class:"form-item"},{default:p((()=>[_(a,null,{default:p((()=>[N("所在地")])),_:1}),_(G,{areaData:k(he),onSureCity:dr,cityInfo:{provinceId:k(ce).orderCarCustomerDetailDTO.provinceId,cityId:k(ce).orderCarCustomerDetailDTO.cityId,countryId:k(ce).orderCarCustomerDetailDTO.countyId,fullCityName:k(ce).orderCarCustomerDetailDTO.provinceName+k(ce).orderCarCustomerDetailDTO.cityName+k(ce).orderCarCustomerDetailDTO.countyName}},null,8,["areaData","cityInfo"]),_(o,{name:"arrow-right"})])),_:1}),_(a,{class:"form-item"},{default:p((()=>[_(a,null,{default:p((()=>[N("交强险到期")])),_:1}),_(u,{mode:"date",value:k(ce).orderCarCustomerDetailDTO.trafficInsuranceDate,onChange:r[15]||(r[15]=e=>sr(e,"orderCarCustomerDetailDTO","trafficInsuranceDate"))},{default:p((()=>[_(a,{class:A({placeholder:!k(ce).orderCarCustomerDetailDTO.trafficInsuranceDate})},{default:p((()=>[N(R(k(ce).orderCarCustomerDetailDTO.trafficInsuranceDate||"请选择"),1)])),_:1},8,["class"])])),_:1},8,["value"]),_(o,{name:"arrow-right"})])),_:1}),_(a,{class:"form-item"},{default:p((()=>[_(a,null,{default:p((()=>[N("商业险到期")])),_:1}),_(u,{mode:"date",value:k(ce).orderCarCustomerDetailDTO.commercialInsuranceDate,onChange:r[16]||(r[16]=e=>sr(e,"orderCarCustomerDetailDTO","commercialInsuranceDate"))},{default:p((()=>[_(a,{class:A({placeholder:!k(ce).orderCarCustomerDetailDTO.commercialInsuranceDate})},{default:p((()=>[N(R(k(ce).orderCarCustomerDetailDTO.commercialInsuranceDate||"请选择"),1)])),_:1},8,["class"])])),_:1},8,["value"]),_(o,{name:"arrow-right"})])),_:1}),_(a,{class:"form-item"},{default:p((()=>[_(a,null,{default:p((()=>[N("年检到期日")])),_:1}),_(u,{mode:"date",value:k(ce).orderCarCustomerDetailDTO.inspectionDate,onChange:r[17]||(r[17]=e=>sr(e,"orderCarCustomerDetailDTO","inspectionDate"))},{default:p((()=>[_(a,{class:A({placeholder:!k(ce).orderCarCustomerDetailDTO.inspectionDate})},{default:p((()=>[N(R(k(ce).orderCarCustomerDetailDTO.inspectionDate||"请选择"),1)])),_:1},8,["class"])])),_:1},8,["value"]),_(o,{name:"arrow-right"})])),_:1}),_(a,{class:"form-textarea"},{default:p((()=>[_(a,{class:"area-title"},{default:p((()=>[N("订单备注")])),_:1}),_(s,{modelValue:k(ce).orderCarCustomerDTO.remark,"onUpdate:modelValue":r[18]||(r[18]=e=>k(ce).orderCarCustomerDTO.remark=e),placeholder:"请输入",maxlength:"1000"},null,8,["modelValue"]),_(a,{class:"limit"},{default:p((()=>{var e;return[N(R((null==(e=k(ce).orderCarCustomerDTO.remark)?void 0:e.length)||0)+"/1000",1)]})),_:1})])),_:1}),_(a,{class:"form-item photo-item"},{default:p((()=>[_(a,null,{default:p((()=>["资料照片"!==k(Dr)?(h(),D(t,{key:0},{default:p((()=>[N("*")])),_:1})):I("",!0),N(R(k(Dr)),1)])),_:1}),_(H,{ref_key:"salesUploadRef",ref:Oe,carAttachmentType:"SalesOrder",accept:"all","max-count":k(X).type?1:9,uploadList:k(ce).carAttachments},null,8,["max-count","uploadList"])])),_:1})])),_:1}),_(a,{class:"section-title"},{default:p((()=>[N("合同信息")])),_:1}),_(a,{class:"form-box"},{default:p((()=>[k(X).type?(h(),D(a,{key:0,class:"form-item"},{default:p((()=>[_(a,null,{default:p((()=>[_(t,null,{default:p((()=>[N("*")])),_:1}),N("是否签署")])),_:1}),_(a,{class:"tab-box"},{default:p((()=>[(h(!0),P(M,null,x(k(_e),((e,r)=>(h(),D(t,{key:r,class:A({active:k(me)==e.key}),onClick:()=>{me.value=k(me)==e.key?null:e.key,fr()}},{default:p((()=>[N(R(e.value),1)])),_:2},1032,["class","onClick"])))),128))])),_:1})])),_:1})):I("",!0),1==k(me)?(h(),P(M,{key:1},[k(Se)?(h(),P(M,{key:0},[_(a,{class:"form-item disable-item"},{default:p((()=>{var e;return[_(a,null,{default:p((()=>[_(t,null,{default:p((()=>[N("*")])),_:1}),N("签约方式")])),_:1}),N(" "+R(null==(e=k(be).filter((e=>k(ce).orderCarCustomerDTO.wayOfSigning==e.key))[0])?void 0:e.value),1)]})),_:1}),1==k(ce).orderCarCustomerDTO.wayOfSigning?(h(),D(a,{key:0,class:"form-item photo-item disable-item"},{default:p((()=>[_(a,null,{default:p((()=>[_(t,null,{default:p((()=>[N("*")])),_:1}),N("合同照片")])),_:1}),_(H,{ref_key:"contractUploadRef",ref:Ie,accept:"all","max-count":99,uploadList:k(ce).contractAnnex,detail:"1"},null,8,["uploadList"])])),_:1})):I("",!0),0==k(ce).orderCarCustomerDTO.wayOfSigning?(h(),P(M,{key:1},[_(a,{class:"form-item disable-item"},{default:p((()=>[_(a,null,{default:p((()=>[_(t,null,{default:p((()=>[N("*")])),_:1}),N("主体")])),_:1}),_(a,null,{default:p((()=>[N(R(k(Be)),1)])),_:1})])),_:1}),_(a,{class:"form-item disable-item"},{default:p((()=>[_(a,null,{default:p((()=>[_(t,null,{default:p((()=>[N("*")])),_:1}),N("合同模板")])),_:1}),_(a,{class:"f-b-c"},{default:p((()=>[_(a,{class:"contract-text"},{default:p((()=>{var e,a,l,o;return[N(R(k(Ee))+" ",1),k(ce).orderCarCustomerDTO.contractId?(h(),D(t,{key:0,class:"preview",onClick:F(yr,["stop"])},{default:p((()=>[N("预览>")])),_:1})):I("",!0),["Reserved"].includes(null==(a=null==(e=k(ce))?void 0:e.orderCarCustomerDTO)?void 0:a.orderStatus)&&(null==(o=null==(l=k(ce))?void 0:l.orderCarCustomerDTO)?void 0:o.shortUrl)?(h(),D(t,{key:1,onClick:r[19]||(r[19]=e=>{var r,a,t;return t=null==(a=null==(r=k(ce))?void 0:r.orderCarCustomerDTO)?void 0:a.shortUrl,void W({data:t,success:function(){Q({title:"复制成功",icon:"success"})}})}),class:"preview"},{default:p((()=>[N(" 复制 ")])),_:1})):I("",!0)]})),_:1})])),_:1})])),_:1})],64)):I("",!0)],64)):(h(),P(M,{key:1},[_(a,{class:"form-item"},{default:p((()=>[_(a,null,{default:p((()=>[_(t,null,{default:p((()=>[N("*")])),_:1}),N("签约方式")])),_:1}),_(a,{class:"tab-box"},{default:p((()=>[(h(!0),P(M,null,x(k(be),((e,r)=>(h(),D(t,{key:r,class:A({active:k(ce).orderCarCustomerDTO.wayOfSigning==e.key}),onClick:r=>{return a="wayOfSigning",t=e.key,ce.orderCarCustomerDTO[a]=ce.orderCarCustomerDTO[a]==t?null:t,void fr();var a,t}},{default:p((()=>[N(R(e.value),1)])),_:2},1032,["class","onClick"])))),128))])),_:1})])),_:1}),1==k(ce).orderCarCustomerDTO.wayOfSigning?(h(),D(a,{key:0,class:"form-item photo-item"},{default:p((()=>[_(a,null,{default:p((()=>[_(t,null,{default:p((()=>[N("*")])),_:1}),N("合同照片")])),_:1}),_(H,{ref_key:"contractUploadRef",ref:Ie,accept:"all","max-count":99,uploadList:k(ce).contractAnnex},null,8,["uploadList"])])),_:1})):I("",!0),0==k(ce).orderCarCustomerDTO.wayOfSigning?(h(),P(M,{key:1},[_(a,{class:"form-item"},{default:p((()=>[_(a,null,{default:p((()=>[_(t,null,{default:p((()=>[N("*")])),_:1}),N("主体")])),_:1}),_(a,{class:"f-b-c",onClick:r[20]||(r[20]=e=>ir("主体",k(Ye),k(ce).orderCarCustomerDTO.enterpriseId,"orderCarCustomerDTO","enterpriseId"))},{default:p((()=>[_(t,{class:A({placeholder:"请选择"==k(Be)})},{default:p((()=>[N(R(k(Be)),1)])),_:1},8,["class"]),_(o,{name:"arrow-right"})])),_:1})])),_:1}),_(a,{class:"form-item"},{default:p((()=>[_(a,null,{default:p((()=>[_(t,null,{default:p((()=>[N("*")])),_:1}),N("合同模板")])),_:1}),_(a,{class:"f-b-c",onClick:r[21]||(r[21]=e=>ir("合同模板",k(Je),k(ce).orderCarCustomerDTO.contractId,"orderCarCustomerDTO","contractId"))},{default:p((()=>[_(a,{class:A([{placeholder:"请选择"==k(Ee)},"contract-text"])},{default:p((()=>[N(R(k(Ee))+" ",1),k(ce).orderCarCustomerDTO.contractId?(h(),D(t,{key:0,class:"preview",onClick:F(yr,["stop"])},{default:p((()=>[N("预览>")])),_:1})):I("",!0),k(ce).orderCarCustomerDTO.contractId?(h(),D(t,{key:1,class:"preview",onClick:F(We,["stop"])},{default:p((()=>[N("补充合同信息>")])),_:1})):I("",!0)])),_:1},8,["class"]),_(o,{name:"arrow-right"})])),_:1})])),_:1})],64)):I("",!0)],64))],64)):I("",!0)])),_:1}),I("",!0)])),_:1}),_(a,{class:"bottom-btn"},{default:p((()=>[_(n,{class:"save-btn w_100",onClick:vr},{default:p((()=>[N(R(k(X).source?"预定转售出":k(X).id?"保存":(0!==k(ce).orderCarCustomerDTO.wayOfSigning||k(X).type,"提交")),1)])),_:1})])),_:1})])),_:1}),_(m,{show:k(ke),modelValue:k(ce).orderCarCustomerDTO.reserveTime,"onUpdate:modelValue":r[30]||(r[30]=e=>k(ce).orderCarCustomerDTO.reserveTime=e),title:"预计交车时间",mode:"date",confirmColor:"#ff5719",minDate:k(d)().valueOf(),formatter:we,onCancel:r[31]||(r[31]=e=>ke.value=!1),onConfirm:mr},null,8,["show","modelValue","minDate"])])),_:1})}}}),[["__scopeId","data-v-832afa67"]]);export{de as default};
