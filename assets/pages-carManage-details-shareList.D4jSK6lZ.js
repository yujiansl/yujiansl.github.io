import{c as e}from"./callPhone.KEQUzljZ.js";import{d as t,x as a,c as s,o as l,i,n as r,w as u,y as n,a as o,g as d,t as c,u as m,S as f,P as p,h as _,b as y,F as g,k as h,D as v,a8 as k,_ as S,r as w,v as I,I as b,M as O,K as C,a9 as N,B as P,Z as T,a2 as B,ay as x,$ as D,al as L,ah as A,W as R,e as V,V as j}from"./index-CK4DGatK.js";import{_ as E,a as U,b as $,c as F}from"./card_icon2.F1NNxrY3.js";import{N as q}from"./NavBar.DSs5OGCU.js";import{f as M}from"./time._VqwKl0d.js";import{z}from"./image.DobRSNlT.js";import{i as G}from"./dev.3CSglq9A.js";import{u as J}from"./useQuery.3dd8K18V.js";const Q=S(t({__name:"share-list-car-item",props:{item:{type:Object,default:()=>{}},occasion:{type:String,default:"public"},isOrders:{type:Boolean,default:!1},isCoupon:{type:Boolean,default:!1},itemType:{type:String,default:""},isSold:{type:Boolean,default:!1},hasCheck:{type:Boolean,default:!1},hasCarAuth:{type:Boolean,default:!0},hasOrderAuth:{type:Boolean,default:!0},maxSelect:{type:Number},isChecked:{type:Boolean,default:!1},quick:{type:String,default:""},from:{type:String,default:""},testDrive:{type:String,default:""},userId:{type:String,default:""}},emits:["select"],setup(e,{emit:t}){const S=e,w=t,I=a((()=>{const{orderStatus:e,paymentMethod:t,amountReceived:a,mortgageAmount:s}=S.item;return"FullPaymentReceived"===e&&"Mortgage"===t?s+a:a})),b=e=>{switch(e){case"OnSale":return"在售";case"SoldOut":return"已售";case"ForceCancel":return"退库";case"Locked":return"预定";default:return""}},O=e=>{switch(e){case"Intransit":return"在途";case"BeReady":return"在厅";case"Readiness":return"整备";case"UNDER_PREPARATION":return"整备中";case"COMPLETE_REPAIR":return"整备完成";case"Transition":return"转场";case"LendOut":return"外借";case"GoOut":return"外出";case"Outbound":return"已出库";default:return""}};return(t,a)=>{const C=i,N=p,P=_;return l(),s(C,{onClick:a[1]||(a[1]=t=>(async e=>{console.log(e);const{id:t}=e,a=new v;a.showLoading("加载中");try{const e=await uni.$u.http.get("/admin/wx/getURLLink?path=/pagesA/carDetail/index&env_version="+(G?"trial":"release"));if(e.data)return k("__mini_car_info_page__",e.data),void(window.location.href=e.data+`?cq=${encodeURIComponent(`id=${t}&userId=${S.userId}`)}`);throw new Error("跳转失败")}catch(s){a.showToast("跳转失败")}finally{a.hideLoading()}})(e.item)),class:r(["list-item",{auditing:1==e.item.saleApproving}])},{default:u((()=>[e.isOrders?(l(),s(C,{key:0,class:"status"},{default:u((()=>[o(C,null,{default:u((()=>[d(c(("formatCardTime"in t?t.formatCardTime:m(M))(e.item.createTime))+"创建",1)])),_:1}),o(C,{class:r({gray:"CANCEL_ORDER"==e.item.orderStatus||"CANCEL_RESERVE"==e.item.orderStatus})},{default:u((()=>[d(c(e.item.orderStatusName),1)])),_:1},8,["class"])])),_:1})):n("",!0),o(C,{class:"item-box"},{default:u((()=>[e.hasCheck?(l(),s(C,{key:0,onClick:a[0]||(a[0]=f((e=>w("select")),["stop"]))},{default:u((()=>[o(N,{class:"img",src:S.isChecked?"/static/carManage/select_y.png":"/static/carManage/select_n.png"},null,8,["src"])])),_:1})):n("",!0),o(C,{class:"left"},{default:u((()=>[o(N,{src:("zipImg"in t?t.zipImg:m(z))(e.item.coverUrl,50),mode:"aspectFill"},null,8,["src"]),o(C,{class:"plateno"},{default:u((()=>[d("No."+c(e.item.productNo),1)])),_:1})])),_:1}),o(C,{style:{flex:"1"}},{default:u((()=>[o(C,null,{default:u((()=>[1==e.item.choicenessFlag?(l(),s(P,{key:0,class:"boutiqueCar"})):n("",!0),0===e.item.choicenessFlag?(l(),s(P,{key:1,class:"discountedCar"})):n("",!0),"Consign"==e.item.purchaseType?(l(),s(P,{key:2,class:"consign"})):n("",!0),o(P,{class:"name"},{default:u((()=>{var t;return[(null==(t=e.item.carSeriesName)?void 0:t.indexOf(e.item.carBrandName))<0?(l(),s(P,{key:0},{default:u((()=>[d(c(e.item.carBrandName),1)])),_:1})):n("",!0),d(" "+c(e.item.carSeriesName),1)]})),_:1})])),_:1}),o(C,{class:"model-name"},{default:u((()=>[d(c(e.item.carModelName),1)])),_:1}),o(C,{class:"arguments"},{default:u((()=>[d(c(e.item.registerDate||"-")+" | "+c(e.item.mileage||"-")+"万公里",1)])),_:1}),o(C,{class:"price-box"},{default:u((()=>[o(C,{class:"price"},{default:u((()=>["SoldOut"==e.item.status||"Locked"==e.item.status||"ToBeSigned"==e.item.status||"PaymentIng"==e.item.status?(l(),y(g,{key:0},[1==e.item.priceViewPermission?(l(),s(C,{key:0},{default:u((()=>[e.item.dealPrice?(l(),y(g,{key:0},[o(P,{class:"deal-name"},{default:u((()=>[d("成交价")])),_:1}),o(P,{class:"large"},{default:u((()=>[d(c((e.item.dealPrice+"").split(".")[0])+".",1)])),_:1}),o(P,{class:"large"},{default:u((()=>[d(c((e.item.dealPrice+"").split(".")[1]),1)])),_:1}),o(P,{class:"small"},{default:u((()=>[d("万")])),_:1})],64)):(l(),s(P,{key:1,class:"noAuthView"},{default:u((()=>[d("--")])),_:1}))])),_:1})):(l(),s(C,{key:1},{default:u((()=>[o(P,{class:"noAuthView"},{default:u((()=>[d("无权限查看")])),_:1})])),_:1}))],64)):"SoldOut"!=e.item.status&&"Locked"!=e.item.status&&"ToBeSigned"!=e.item.status&&"PaymentIng"!=e.item.status&&e.item.price?(l(),y(g,{key:1},[o(P,{class:"large"},{default:u((()=>[d(c((e.item.price+"").split(".")[0])+".",1)])),_:1}),o(P,{class:"large"},{default:u((()=>[d(c((e.item.price+"").split(".")[1]||"000"),1)])),_:1}),o(P,{class:"small"},{default:u((()=>[d("万")])),_:1})],64)):(l(),s(C,{key:2,class:"no-price"},{default:u((()=>[d("未定价")])),_:1}))])),_:1}),e.isSold?(l(),s(C,{key:0,class:"text-deco"},{default:u((()=>[d("网络标价： "),e.item.price?(l(),s(P,{key:0},{default:u((()=>[d(c(e.item.price)+"万",1)])),_:1})):(l(),s(P,{key:1},{default:u((()=>[d("未定价")])),_:1}))])),_:1})):n("",!0)])),_:1}),e.isOrders?n("",!0):(l(),s(C,{key:0,class:"tags"},{default:u((()=>{var t;return[e.item.status&&(null==(t=b(e.item.status))?void 0:t.length)?(l(),s(C,{key:0},{default:u((()=>[d(c(b(e.item.status)),1)])),_:1})):n("",!0),e.item.stockStatus&&"FirstInspection"!==e.item.stockStatus?(l(),s(C,{key:1},{default:u((()=>[d(c(O(e.item.stockStatus)),1)])),_:1})):n("",!0),"OnSale"==e.item.status&&e.item.listingNum&&"0"!==e.item.listingNum||"SoldOut"==e.item.status&&e.item.onSaleDays&&"0"!==e.item.onSaleDays||"ToBeSigned"==e.item.status&&e.item.onSaleDays&&"0"!==e.item.onSaleDays||"PaymentIng"==e.item.status&&e.item.onSaleDays&&"0"!==e.item.onSaleDays?(l(),s(C,{key:2},{default:u((()=>[d("上架"+c(e.isSold?e.item.onSaleDays:e.item.listingNum)+"天",1)])),_:1})):n("",!0),e.isSold&&e.item.inventoryDays&&"0"!==e.item.inventoryDays||!e.isSold&&e.item.warehouseNum&&"0"!==e.item.warehouseNum?(l(),s(C,{key:3},{default:u((()=>[d("库龄"+c(e.isSold?e.item.inventoryDays:e.item.warehouseNum)+"天",1)])),_:1})):n("",!0)]})),_:1})),e.isOrders?n("",!0):(l(),s(C,{key:1,style:{display:"flex","justify-content":"space-between"},class:"arguments appraiser"},{default:u((()=>[d(" 评估师："+c(e.item.appraiser||"杨林"),1)])),_:1})),e.item.orderStatus&&e.isOrders?(l(),s(C,{key:2,class:"info"},{default:u((()=>[o(C,null,{default:u((()=>[o(C,{style:{display:"flex","justify-content":"space-between"}},{default:u((()=>[o(P,null,{default:u((()=>[d("客户："+c(e.item.customerName||"-"),1)])),_:1}),"Locked"!=e.item.status&&"ToBeSigned"!=e.item.status||1!=e.item.reservationTimeout?n("",!0):(l(),s(C,{key:0,class:"labels"},{default:u((()=>[o(P,null,{default:u((()=>[d("超时")])),_:1})])),_:1}))])),_:1}),o(C,null,{default:u((()=>[d("销售员："+c(e.item.salesUserName||"-"),1)])),_:1}),o(C,null,{default:u((()=>[d("评估师："+c(e.item.appraiser||"-"),1)])),_:1}),o(C,null,{default:u((()=>[d("销售日期："+c(e.item.soldTime||"-"),1)])),_:1})])),_:1})])),_:1})):n("",!0),"SoldOut"!=e.item.status&&"PaymentIng"!=e.item.status||e.isOrders?n("",!0):(l(),s(C,{key:3,class:"sold-sale"},{default:u((()=>[o(C,{class:"sold-item"},{default:u((()=>[d("销售日期："+c(e.item.soldTime||"-"),1)])),_:1}),o(C,{class:"sold-item"},{default:u((()=>[d("销售员："+c(e.item.salesUserName||"-"),1)])),_:1})])),_:1})),"Locked"!=e.item.status&&"ToBeSigned"!=e.item.status||e.isOrders?n("",!0):(l(),s(C,{key:4,class:"sold-sale"},{default:u((()=>[o(C,{class:"sold-item"},{default:u((()=>[d("预定日期："+c(e.item.reserveTime||"-"),1)])),_:1}),o(C,{class:"sold-item flex-between"},{default:u((()=>[o(P,null,{default:u((()=>[d("销售员："+c(e.item.salesUserName||"-"),1)])),_:1}),"Locked"!=e.item.status&&"ToBeSigned"!=e.item.status||1!=e.item.reservationTimeout?n("",!0):(l(),s(C,{key:0,class:"labels"},{default:u((()=>[o(P,null,{default:u((()=>[d("超时")])),_:1})])),_:1}))])),_:1})])),_:1})),"ForceCancel"!=e.item.status||e.isOrders?n("",!0):(l(),s(C,{key:5,class:"sold-sale"},{default:u((()=>[o(C,{class:"sold-item"},{default:u((()=>[d("退库日期："+c(e.item.reasonTime||"-"),1)])),_:1}),o(C,{class:"sold-item"},{default:u((()=>[d("退库原因："+c(e.item.reasonType||"-"),1)])),_:1})])),_:1}))])),_:1})])),_:1}),e.item.orderStatus&&e.isOrders&&1==e.item.priceViewPermission?(l(),s(C,{key:1,class:"prices"},{default:u((()=>[h("span",null,[d("定金："),o(P,null,{default:u((()=>[d(c(e.item.deposit||0)+"元",1)])),_:1})]),h("span",{class:"ml20"},[d("已收："),o(P,null,{default:u((()=>[d(c(m(I))+"元",1)])),_:1})]),h("span",{class:"ml20"},[d("成交价："),o(P,null,{default:u((()=>[d(c(e.item.dealPrice||0)+"万元",1)])),_:1})])])),_:1})):n("",!0)])),_:1},8,["class"])}}}),[["__scopeId","data-v-4faea17b"]]),Y=S(t({__name:"qrDialog",props:{qrUrl:{},isVisible:{type:Boolean}},emits:["close"],setup(e,{emit:t}){const a=e,s=t,i=w(!1);function u(){s("close")}return I((()=>a.isVisible),(e=>{i.value=e}),{immediate:!0}),(e,t)=>{const a=p,s=b(C("up-icon"),O);return l(),y("div",{class:r(["news-dialog",{show:m(i)}])},[h("div",{class:"box"},[h("div",{class:"body",onClick:t[0]||(t[0]=f((()=>{}),["stop"]))},[h("div",{class:"title font-medium"},"企业微信二维码"),o(a,{class:"qr-img",src:e.qrUrl,mode:"aspectFill","show-menu-by-longpress":!0},null,8,["src"])]),h("div",{class:"footer"},[o(s,{onClick:u,name:"close-circle",color:"#fff",size:"28"})])])],2)}}}),[["__scopeId","data-v-03ea8ee3"]]),Z=S(t({__name:"shareList",setup(t){const a=J(),r=w({}),f=w({}),h=N({current:1,size:10}),v=w([]),k=w(),S=w(!1),I=w(!1),O=w(""),M=w("");P((async()=>{if(T({title:"加载中",mask:!0}),a.value.id&&(h.carProductIds=a.value.id.split(",")),a.value.scene){const e=a.value.scene.split("="),t=await G(e[1]||a.value.scene);h.carProductIds=t.ids,M.value=t.userId,h.size=t.ids.length>10?t.ids.length:10}Z(),H(),z(),B()}));const z=async()=>{const e=await uni.$u.http.get(`/admin/user/share/enterprise?userId=${a.value.userId}`);console.log("usercode",e),O.value=e.data},G=e=>new Promise(((t,a)=>{uni.$u.http.get(`/product/home/getIdByShare/${e}`,{params:{shareId:e}}).then((e=>{0==e.code&&t(e.data)}))})),Z=()=>{let e="";e=Object.prototype.hasOwnProperty.call(a.value,"userId")?a.value.userId:M.value,uni.$u.http.get(x.getUserInfo+`/${e}`).then((e=>{r.value=e.data,f.value=e.data.userAttributeVo||{}}))};async function H(){var e;T({title:"加载中"});try{const e=JSON.parse(JSON.stringify(h));delete e.total;const t=await D().post("/product/home/getCarByConditionsNoAuth",{...e});h.total=t.data.count;const a=t.data.results;v.value=1===h.current?a:[...v.value,...a],B(),v.value.length||(S.value=!0)}finally{null==(e=k.value)||e.loadFinish()}}L((()=>{h.current*h.size>=h.total||(h.current++,H())}));const K=()=>{I.value=!0};return(t,h)=>{const k=i,w=p,N=_,P=R,T=b(C("u-modal"),A);return l(),s(k,{class:"page"},{default:u((()=>[o(q,{title:"微店",backBtnVisible:!1,showHome:!1}),o(k,{class:"card-box"},{default:u((()=>[o(k,{class:"card"},{default:u((()=>[o(k,{class:"base"},{default:u((()=>[o(k,null,{default:u((()=>[o(k,null,{default:u((()=>[d(c(m(r).name||m(r).username)+" ",1),m(f).serviceYears?(l(),s(k,{key:0,class:"year"},{default:u((()=>[d("从业"+c(m(f).serviceYears)+"年",1)])),_:1})):n("",!0)])),_:1}),o(k,{class:"li"},{default:u((()=>[o(w,{src:E}),o(N,null,{default:u((()=>{var e;return[d(c(null==(e=m(r).shopInfoSimpleVO)?void 0:e.shopName),1)]})),_:1})])),_:1}),o(k,{class:"li"},{default:u((()=>[o(w,{src:U}),o(N,null,{default:u((()=>{var e;return[d(c(null==(e=m(r).shopInfoSimpleVO)?void 0:e.shopAddr),1)]})),_:1})])),_:1})])),_:1}),o(w,{src:m(r).avatar||"/static/mine/avatar.png"},null,8,["src"])])),_:1}),m(f).personalSignature?(l(),s(k,{key:0,class:"sign"},{default:u((()=>[d("“"+c(m(f).personalSignature)+"”",1)])),_:1})):n("",!0),o(k,{class:"btn"},{default:u((()=>[o(P,{onClick:K},{default:u((()=>[o(w,{src:$}),d("添加企业微信 ")])),_:1}),o(P,{onClick:h[0]||(h[0]=a=>("callPhone"in t?t.callPhone:m(e))(m(r).realPhone))},{default:u((()=>[o(w,{src:F}),d(c(m(r).realPhone),1)])),_:1})])),_:1})])),_:1})])),_:1}),(l(!0),y(g,null,V(m(v),((e,t)=>(l(),s(Q,{key:t,item:e,userId:m(a).userId},null,8,["item","userId"])))),128)),o(Y,{onClose:h[1]||(h[1]=e=>I.value=!1),isVisible:m(I),qrUrl:m(O)},null,8,["isVisible","qrUrl"]),o(T,{show:m(S),title:"提示",content:"分享车源已下架",width:"300",onConfirm:h[2]||(h[2]=e=>("toTab"in t?t.toTab:m(j))("/pages/index/index"))},null,8,["show"])])),_:1})}}}),[["__scopeId","data-v-706bc131"]]);export{Z as default};
