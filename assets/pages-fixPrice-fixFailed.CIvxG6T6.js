import{d as a,a9 as s,r as e,B as t,E as l,X as o,Y as u,x as r,c as n,w as c,i,I as d,M as f,K as p,o as m,a as _,g,h,u as v,n as k,t as b,aj as R,W as x,Q as w,D as y,a1 as $,bG as D,ar as P,_ as K}from"./index-CK4DGatK.js";import{u as j}from"./useQuery.3dd8K18V.js";const I=K(a({__name:"fixFailed",setup(a){const K=j(),I=s({loseReason:"",statusRemark:""});e();const L=e([]);t((()=>{M()})),l((()=>{o("pickData"),u("pickData",(a=>{const{key:s,subKey:e}=a;I[e]=s}))}));const M=()=>{uni.$u.http.get("/product/purchaseOrder/getPurchaseDict").then((a=>{L.value=a.data.loseReasonList}))},S=r((()=>V(L.value,I.loseReason))),V=(a,s)=>{const e=null==a?void 0:a.filter((a=>a.value==s));return(null==e?void 0:e.length)?e[0].label:"请选择"},C=()=>{const a=(()=>{const{loseReason:a,statusRemark:s}=I;return a?"":"请选择战败原因"})();if(a)return void(new y).showToast(a);(new y).showLoading("提交中");const s={carPricingId:K.value.id,editStatus:1,...I};uni.$u.http.post("/product/carPricingFlowable/editStatus",s).then((()=>{$({delta:1,complete:()=>{setTimeout((()=>{K.value.source||D(`/pages/fixPrice/fixDetail?id=${K.value.id}&status=lose`),P("refreshList")}),10)}})}))};return(a,s)=>{const e=h,t=i,l=d(p("up-icon"),f),o=R,u=x;return m(),n(t,{class:"page f-c-s"},{default:c((()=>[_(t,{class:"content"},{default:c((()=>[_(t,{class:"form-box"},{default:c((()=>[_(t,{class:"form-item"},{default:c((()=>[_(t,null,{default:c((()=>[_(e,null,{default:c((()=>[g("*")])),_:1}),g("战败原因")])),_:1}),_(t,{class:"f-b-c",onClick:s[0]||(s[0]=a=>{return s="战败原因",e=v(L),t=v(I).loseReason,l="loseReason",void w(`/pages/carManage/pagePicker?title=${s}&list=${JSON.stringify(e)}&key=${t}&subKey=${l}&pageKey=purchase`);var s,e,t,l})},{default:c((()=>[_(e,{class:k({placeholder:"请选择"==v(S)})},{default:c((()=>[g(b(v(S)),1)])),_:1},8,["class"]),_(l,{name:"arrow-right"})])),_:1})])),_:1}),_(t,{class:"form-textarea"},{default:c((()=>[_(t,{class:"area-title"},{default:c((()=>[g("备注")])),_:1}),_(o,{modelValue:v(I).statusRemark,"onUpdate:modelValue":s[1]||(s[1]=a=>v(I).statusRemark=a),placeholder:"请输入",maxlength:"512"},null,8,["modelValue"]),_(t,{class:"limit"},{default:c((()=>{var a;return[g(b((null==(a=v(I).statusRemark)?void 0:a.length)||0)+"/512",1)]})),_:1})])),_:1})])),_:1})])),_:1}),_(t,{class:"bottom-btn"},{default:c((()=>[_(u,{class:"save-btn w_100",onClick:C},{default:c((()=>[g("确定")])),_:1})])),_:1})])),_:1})}}}),[["__scopeId","data-v-41fae8eb"]]);export{I as default};
