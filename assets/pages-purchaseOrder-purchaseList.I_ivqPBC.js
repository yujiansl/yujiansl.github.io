import{d as e,r as a,q as l,I as t,M as s,K as r,c as u,o as i,i as c,w as n,a as o,R as d,u as p,z as m,a5 as v,b as f,e as b,n as h,y,g,t as _,h as T,F as k,_ as S,v as P,a6 as A,D as C,s as D,f as j,Q as U,a9 as E,B as I,E as R,X as V,Y as w,Z as O,$ as x,a2 as L,ad as $}from"./index-CK4DGatK.js";import{N as B}from"./NavBar.DSs5OGCU.js";import{U as M,a as z}from"./u-dropdown-item.B66HFyYv.js";import{B as F}from"./brandDrop.WDU7kvw8.js";import{D as N}from"./datePicker.DPajrKz9.js";import{P as Q}from"./pricePicker.gxcGlZwI.js";import{P as Z,a as H}from"./purchase.B8DNaFGL.js";import{F as X,a as Y}from"./fixPrice.CFXyKkhm.js";import{u as q}from"./useQuery.3dd8K18V.js";import{L as G}from"./ListLoadRefreshView.CnNC2lkG.js";import{L as J}from"./listItem.De6Dqo0z.js";import{n as K}from"./noPurchaseCarInfo.BiDwqUh1.js";import{o as W}from"./omit.DzeQdT5l.js";import"./index.HDA2F_3Q.js";import"./time._VqwKl0d.js";import"./car_default.CyENNAub.js";import"./base.6l0JEBJr.js";import"./_baseGet.CmhOSbYr.js";import"./_getTag.DG-N9UUn.js";import"./isObject.C8HfsiHw.js";import"./isSymbol.Bym6OQCA.js";import"./_Uint8Array.B4mhORiM.js";import"./_baseClone.Cc-Y92km.js";const ee=S(e({__name:"purchaseDrop",props:{pricingCreateUserId:{type:Array,default:()=>[]}},emits:["search"],setup(e,{expose:S,emit:P}){const A=P,C=e,D=a([]),j=a(""),U=a([]);l((()=>{E()}));const E=()=>{uni.$u.http.get("/product/member/getALLUserByAuth",{params:{search:j.value}}).then((e=>{D.value=e.data}))};return S({open:()=>{U.value=C.pricingCreateUserId}}),(e,a)=>{const l=t(r("up-icon"),s),S=d,P=c,C=T,I=v;return i(),u(P,{class:"purchase-user"},{default:n((()=>[o(P,{class:"search-box"},{default:n((()=>[o(P,null,{default:n((()=>[o(l,{name:"search",size:"20"}),o(S,{modelValue:p(j),"onUpdate:modelValue":a[0]||(a[0]=e=>m(j)?j.value=e:null),type:"text",placeholder:"搜索","confirm-type":"search",onConfirm:E},null,8,["modelValue"])])),_:1})])),_:1}),o(I,{"scroll-y":"",class:"user-list"},{default:n((()=>[(i(!0),f(k,null,b(p(D),((e,a)=>{var t;return i(),u(P,{class:h(["user-li",{active:null==(t=p(U))?void 0:t.includes(e.userId)}]),key:a,onClick:a=>U.value=[e.userId]},{default:n((()=>{var a;return[o(P,null,{default:n((()=>[g(_(e.name)+" ",1),e.phone?(i(),u(C,{key:0},{default:n((()=>[g("("+_(e.phone)+")",1)])),_:2},1024)):y("",!0)])),_:2},1024),(null==(a=p(U))?void 0:a.includes(e.userId))?(i(),u(l,{key:0,name:"checkbox-mark",color:"#ff5719",size:"20"})):y("",!0)]})),_:2},1032,["class","onClick"])})),128))])),_:1}),o(P,{class:"brand-btn"},{default:n((()=>[o(P,{class:"clear",onClick:a[1]||(a[1]=e=>A("search",{id:""}))},{default:n((()=>[g("清空")])),_:1}),o(P,{class:"sure",onClick:a[2]||(a[2]=e=>{var a;return A("search",{id:(null==(a=p(U))?void 0:a.length)?p(U):""})})},{default:n((()=>[g("确定")])),_:1})])),_:1})])),_:1})}}}),[["__scopeId","data-v-525fe98a"]]),ae=S(e({__name:"priceDrop",props:{obj:{type:Object,default:()=>{}}},emits:["search"],setup(e,{emit:l}){const s=l,d=e;P((()=>d.obj),(e=>{const a=e.startPrice,l=e.endPrice;y.value=a||"",S.value=l||"",v.value=e.checkPrice}),{deep:!0});const v=a(""),y=a(""),S=a(""),j=a([{label:"不限",value:"0,0"},{label:"3万以下",value:"0,3"},{label:"3-5万",value:"3,5"},{label:"5-8万",value:"5,8"},{label:"8-10万",value:"8,10"},{label:"10-15万",value:"10,15"},{label:"15-20万",value:"15,20"},{label:"20-30万",value:"20,30"},{label:"30-50万",value:"30,50"},{label:"50-100万",value:"50,100"},{label:"100万以上",value:"100"}]),U=e=>{var a;const l=y.value,t=S.value;if(("0,0"!=v.value||l||t)&&(v.value=(null==(a=j.value.filter((e=>e.value==(l&&t?`${l},${t}`:l||(t?`0,${t}`:""))))[0])?void 0:a.value)||""),l&&t&&parseFloat(l)>parseFloat(t))return(new C).showToast("最高价必须大于最低价"),void D((()=>{"priceLow"==e?y.value="":S.value=""}))},E=()=>{const e=y.value&&y.value>0?y.value:"",a=S.value&&S.value>0?S.value:"",l=e&&a?`${e},${a}`:e||(a?`0,${a}`:""===e&&""===a?"0,0":v.value);s("search",e,a,l)};return(e,a)=>{const l=c,s=t(r("up-input"),A),d=T;return i(),u(l,{class:"price-drop"},{default:n((()=>[o(l,{class:"price-item"},{default:n((()=>[(i(!0),f(k,null,b(p(j),((e,a)=>(i(),u(l,{key:a,class:h({active:p(v)==e.value}),onClick:a=>(e=>{v.value=e.value;const a=v.value.split(",");y.value=a.length>1&&0==a[0]?"":a[0],S.value=a.length>1?0==a[1]?"":a[1]||"":""})(e)},{default:n((()=>[g(_(e.label),1)])),_:2},1032,["class","onClick"])))),128))])),_:1}),o(l,{class:"customs"},{default:n((()=>[o(s,{type:"number",inputAlign:"center",placeholder:"最低价",border:"bottom",modelValue:p(y),"onUpdate:modelValue":a[0]||(a[0]=e=>m(y)?y.value=e:null),onBlur:a[1]||(a[1]=e=>U("priceLow"))},null,8,["modelValue"]),o(d,null,{default:n((()=>[g("-")])),_:1}),o(s,{type:"number",inputAlign:"center",placeholder:"最高价",border:"bottom",modelValue:p(S),"onUpdate:modelValue":a[2]||(a[2]=e=>m(S)?S.value=e:null),onBlur:a[3]||(a[3]=e=>U("priceHigh"))},null,8,["modelValue"])])),_:1}),o(l,{onClick:E,class:"btns"},{default:n((()=>[g("确认")])),_:1})])),_:1})}}}),[["__scopeId","data-v-1fd88f02"]]),le=S(e({__name:"allDrop",props:{obj:{type:Object,default:()=>{}},sellData:{type:Object,default:()=>{}},pageStatus:{type:String,default:""}},emits:["search"],setup(e,{expose:S,emit:A}){const C=q(),D=A,E=e,I=a({uetoDateStart:"",uetoDateEnd:"",bodyColorList:[],mileageStart:"",mileageEnd:"",budgetaryPriceStart:"",budgetaryPriceEnd:"",myPricingPriceStart:"",myPricingPriceEnd:"",pricingRaterTimeStart:"",pricingRaterTimeEnd:"",loseTimeStart:"",loseTimeEnd:"",purchaseOrderTimeStart:"",purchaseOrderTimeEnd:"",signTimeStart:"",signTimeEnd:"",refuseTimeStart:"",refuseTimeEnd:"",createTimeStart:"",createTimeEnd:"",paymentMethod:"",purchaseType:"",pricingCreateUser:"",pricingCreateUserId:[],customerName:"",customerMobile:""}),R=a([]),V=a([]),w=a([]),O=a([]),x=a([]),L=a([]),$=a([]),B=a([]),M=a([]),z=a([]),F=a([]),G=a([]),J=a([]);P((()=>E.sellData),(e=>{const{name:a,id:l}=e;I.value.pricingCreateUser=a,I.value.pricingCreateUserId=l?[l]:l}),{deep:!0}),l((async()=>{K(),W()}));const K=()=>{uni.$u.http.get("/product/merchant/car/product/conditionListToMerchantPage").then((e=>{w.value=e.data.bodyColors}))},W=()=>{uni.$u.http.get("product/purchaseOrder/getPurchaseDict").then((e=>{const a=e.data;R.value=a.paymentMethod,V.value=a.purchaseType}))},ee=(e,a,l)=>{Array.isArray(I.value[e])?I.value[e].includes(a[l])?I.value[e]=I.value[e].filter((e=>e!==a[l])):I.value[e].push(a[l]):I.value[e]=I.value[e]==a.value?"":a.value},ae=()=>{for(const e in I.value)I.value[e]=Array.isArray(I.value[e])?[]:null;[O,F,G,J,x,L,$,B,M,z].forEach((e=>{Array.isArray(e.value)?e.value=[]:e.value=null})),D("search",I.value,!1,"clear")},le=()=>{const e=(e,a)=>{const l="start"==a?"00:00:00":"23:59:59";return e&&e.indexOf(l)<0?`${e} ${l}`:e||null};I.value.uetoDateStart=O.value[0]||null,I.value.uetoDateEnd=O.value[1]||null,I.value.mileageStart=F.value[0]||null,I.value.mileageEnd=F.value[1]||null,I.value.budgetaryPriceStart=G.value[0]||null,I.value.budgetaryPriceEnd=G.value[1]||null,I.value.myPricingPriceStart=J.value[0]||null,I.value.myPricingPriceEnd=J.value[1]||null,I.value.pricingRaterTimeStart=e(x.value[0],"start"),I.value.pricingRaterTimeEnd=e(x.value[1],"end"),I.value.loseTimeStart=e(B.value[0],"start"),I.value.loseTimeEnd=e(B.value[1],"end"),I.value.purchaseOrderTimeStart=e($.value[0],"start"),I.value.purchaseOrderTimeEnd=e($.value[1],"end"),I.value.signTimeStart=e(M.value[0],"start"),I.value.signTimeEnd=e(M.value[1],"end"),I.value.refuseTimeStart=e(L.value[0],"start"),I.value.refuseTimeEnd=e(L.value[1],"end"),I.value.createTimeStart=e(z.value[0],"start"),I.value.createTimeEnd=e(z.value[1],"end");const a=Object.values(I.value).every((e=>Array.isArray(e)?!(null==e?void 0:e.length):!(null==e?void 0:e.trim())));D("search",I.value,!a)};return S({open:()=>{const e=E.obj;Object.keys(I.value).forEach((a=>{I.value[a]=e[a]}));const a=(e,a)=>{const l="start"==a?"00:00:00":"23:59:59";return e&&e.indexOf(l)>-1?e.slice(0,10):e||""};I.value.bodyColorList=e.bodyColorList||[],O.value=[e.uetoDateStart,e.uetoDateEnd],x.value=[a(e.pricingRaterTimeStart,"start"),a(e.pricingRaterTimeEnd,"end")],L.value=[a(e.refuseTimeStart,"start"),a(e.refuseTimeEnd,"end")],$.value=[a(e.purchaseOrderTimeStart,"start"),a(e.purchaseOrderTimeEnd,"end")],B.value=[a(e.loseTimeStart,"start"),a(e.loseTimeEnd,"end")],M.value=[a(e.signTimeStart,"start"),a(e.signTimeEnd,"end")],z.value=[a(e.createTimeStart,"start"),a(e.createTimeEnd,"end")],F.value=[e.mileageStart,e.mileageEnd,`${e.mileageStart},${e.mileageEnd}`],G.value=[e.budgetaryPriceStart,e.budgetaryPriceEnd],J.value=[e.myPricingPriceStart,e.myPricingPriceEnd]}}),(a,l)=>{const S=c,P=T,A=d,D=t(r("up-icon"),s),E=v;return i(),f(k,null,[o(E,{class:"u-menu-wrap","scroll-y":""},{default:n((()=>[[p(Z)["采购状态"],p(X)["评估定价"],p(X)["销售定价"]].includes(+p(C).itemType)?(i(),f(k,{key:0},[o(S,{class:"models"},{default:n((()=>[o(S,{class:"sub-title"},{default:n((()=>[g("首次上牌")])),_:1}),o(N,{creatAt:p(O),"onUpdate:creatAt":l[0]||(l[0]=e=>m(O)?O.value=e:null),fields:"month"},null,8,["creatAt"])])),_:1}),o(S,{class:"models"},{default:n((()=>[o(S,{class:"sub-title"},{default:n((()=>[g("车身颜色")])),_:1}),o(S,{class:"sub-content"},{default:n((()=>[(i(!0),f(k,null,b(p(w),(e=>{var a;return i(),u(S,{onClick:a=>ee("bodyColorList",e,"name"),class:h({active:null==(a=p(I).bodyColorList)?void 0:a.includes(e.name)}),key:e.name},{default:n((()=>[o(P,{style:j(`background-color: ${e.value}`),class:"color-val"},null,8,["style"]),g(" "+_(e.name),1)])),_:2},1032,["onClick","class"])})),128))])),_:1})])),_:1}),o(S,{class:"models"},{default:n((()=>[o(S,{class:"sub-title"},{default:n((()=>[g("真实公里")])),_:1}),o(Q,{priceArr:p(F),"onUpdate:priceArr":l[1]||(l[1]=e=>m(F)?F.value=e:null),inputType:"float",unit:"万公里"},null,8,["priceArr"])])),_:1})],64)):y("",!0),[p(Z)["采购状态"],p(X)["评估定价"]].includes(+p(C).itemType)?(i(),f(k,{key:1},[o(S,{class:"models"},{default:n((()=>[o(S,{class:"sub-title"},{default:n((()=>[g("车主预期")])),_:1}),o(Q,{priceArr:p(G),"onUpdate:priceArr":l[2]||(l[2]=e=>m(G)?G.value=e:null)},null,8,["priceArr"])])),_:1}),o(S,{class:"models"},{default:n((()=>[o(S,{class:"sub-title"},{default:n((()=>[g("预估价格")])),_:1}),o(Q,{priceArr:p(J),"onUpdate:priceArr":l[3]||(l[3]=e=>m(J)?J.value=e:null)},null,8,["priceArr"])])),_:1})],64)):y("",!0),[p(H)["待采购"],p(H)["审核拒绝"]].includes(e.pageStatus)?(i(),f(k,{key:2},[o(S,{class:"models"},{default:n((()=>[o(S,{class:"sub-title"},{default:n((()=>[g("定价时间")])),_:1}),o(N,{creatAt:p(x),"onUpdate:creatAt":l[4]||(l[4]=e=>m(x)?x.value=e:null)},null,8,["creatAt"])])),_:1}),e.pageStatus===p(H)["审核拒绝"]?(i(),u(S,{key:0,class:"models"},{default:n((()=>[o(S,{class:"sub-title"},{default:n((()=>[g("拒绝时间")])),_:1}),o(N,{creatAt:p(L),"onUpdate:creatAt":l[5]||(l[5]=e=>m(L)?L.value=e:null)},null,8,["creatAt"])])),_:1})):y("",!0)],64)):y("",!0),[p(H)["审核中"],p(H)["已采购"]].includes(e.pageStatus)?(i(),u(S,{key:3,class:"models"},{default:n((()=>[o(S,{class:"sub-title"},{default:n((()=>[g("采购时间")])),_:1}),o(N,{creatAt:p($),"onUpdate:creatAt":l[6]||(l[6]=e=>m($)?$.value=e:null)},null,8,["creatAt"])])),_:1})):y("",!0),e.pageStatus===p(H)["战败"]?(i(),u(S,{key:4,class:"models"},{default:n((()=>[o(S,{class:"sub-title"},{default:n((()=>[g("战败时间")])),_:1}),o(N,{creatAt:p(B),"onUpdate:creatAt":l[7]||(l[7]=e=>m(B)?B.value=e:null)},null,8,["creatAt"])])),_:1})):y("",!0),[p(H)["已采购"],p(H)["战败"]].includes(e.pageStatus)?(i(),u(S,{key:5,class:"models"},{default:n((()=>[o(S,{class:"sub-title"},{default:n((()=>[g("签署时间")])),_:1}),o(N,{creatAt:p(M),"onUpdate:creatAt":l[8]||(l[8]=e=>m(M)?M.value=e:null)},null,8,["creatAt"])])),_:1})):y("",!0),[p(H)["待定价"],p(H)["待采购"],p(Y)["待定价"],p(Y)["已定价"]].includes(e.pageStatus)?(i(),u(S,{key:6,class:"models"},{default:n((()=>[o(S,{class:"sub-title"},{default:n((()=>[g("创建时间")])),_:1}),o(N,{creatAt:p(z),"onUpdate:creatAt":l[9]||(l[9]=e=>m(z)?z.value=e:null)},null,8,["creatAt"])])),_:1})):y("",!0),[p(Z)["订单状态"],p(Z)["入库状态"]].includes(+p(C).itemType)?(i(),f(k,{key:7},[o(S,{class:"models"},{default:n((()=>[o(S,{class:"sub-title"},{default:n((()=>[g("付款方式")])),_:1}),o(S,{class:"sub-content"},{default:n((()=>[(i(!0),f(k,null,b(p(R),(e=>(i(),u(S,{onClick:a=>ee("paymentMethod",e),class:h({active:p(I).paymentMethod==e.value}),key:e.label},{default:n((()=>[g(_(e.label),1)])),_:2},1032,["onClick","class"])))),128))])),_:1})])),_:1}),o(S,{class:"models"},{default:n((()=>[o(S,{class:"sub-title"},{default:n((()=>[g("采购类型")])),_:1}),o(S,{class:"sub-content"},{default:n((()=>[(i(!0),f(k,null,b(p(V),(e=>(i(),u(S,{onClick:a=>ee("purchaseType",e),class:h({active:p(I).purchaseType==e.value}),key:e.label},{default:n((()=>[g(_(e.label),1)])),_:2},1032,["onClick","class"])))),128))])),_:1})])),_:1}),o(S,{class:"models"},{default:n((()=>[o(S,{class:"sub-title"},{default:n((()=>[g("采购员")])),_:1}),o(A,{modelValue:p(I).pricingCreateUser,"onUpdate:modelValue":l[10]||(l[10]=e=>p(I).pricingCreateUser=e),placeholder:"请输入",onClick:l[11]||(l[11]=e=>("toPage"in a?a.toPage:p(U))(`/pages/carManage/sellUserList?title=采购员&id=${p(I).pricingCreateUserId}&isPurchase=1`))},null,8,["modelValue"]),p(I).pricingCreateUser?(i(),u(D,{key:0,name:"close-circle",size:"20",class:"close",onClick:l[12]||(l[12]=()=>{p(I).pricingCreateUser="",p(I).pricingCreateUserId=[]})})):y("",!0)])),_:1}),o(S,{class:"models"},{default:n((()=>[o(S,{class:"sub-title"},{default:n((()=>[g("客户姓名")])),_:1}),o(A,{modelValue:p(I).customerName,"onUpdate:modelValue":l[13]||(l[13]=e=>p(I).customerName=e),placeholder:"请输入"},null,8,["modelValue"])])),_:1}),o(S,{class:"models"},{default:n((()=>[o(S,{class:"sub-title"},{default:n((()=>[g("手机号码")])),_:1}),o(A,{modelValue:p(I).customerMobile,"onUpdate:modelValue":l[14]||(l[14]=e=>p(I).customerMobile=e),type:"number",placeholder:"请输入",maxlength:"11"},null,8,["modelValue"])])),_:1})],64)):y("",!0)])),_:1}),o(S,{class:"brand-btn"},{default:n((()=>[o(S,{class:"clear",onClick:ae},{default:n((()=>[g("重置")])),_:1}),o(S,{class:"sure",onClick:le},{default:n((()=>[g("查询")])),_:1})])),_:1})],64)}}}),[["__scopeId","data-v-66cf0e4b"]]),te=S(e({__name:"filter",props:{status:{type:Number,default:null},sellData:{type:Object,default:()=>{}},pageStatus:{type:String,default:""}},emits:["search"],setup(e,{expose:d,emit:m}){const v=q(),T=m,S=e,P=a(),A=a(),C=a(),D=a(),j=E({orders:"createTimeDesc",carBrandId:"",carSeriesId:"",purchasePriceStart:"",purchasePriceEnd:"",pricingCreateUser:"",pricingCreateUserId:[],scene:""}),U=a([]),I=a([{label:"全部",id:""},{label:"是",id:!0},{label:"否",id:!1}]),R=a("");l((()=>{const e=S.pageStatus;e!==H["待定价"]&&+v.value.itemType!==X["评估定价"]&&+v.value.itemType!==X["销售定价"]||(U.value=[{label:"创建时间升序",id:"createTimeAsc"},{label:"创建时间降序",id:"createTimeDesc"}],j.orders="createTimeDesc"),e===H["待采购"]&&(U.value=[{label:"定价时间升序",id:"raterTimeAsc"},{label:"定价时间降序",id:"raterTimeDesc"}],j.orders="raterTimeDesc"),e==H["已采购"]&&(U.value=[{label:"采购时间升序",id:"purchaseTimeAsc"},{label:"采购时间降序",id:"purchaseTimeDesc"},{label:"签署时间升序",id:"signTimeAsc"},{label:"签署时间降序",id:"signTimeDesc"}],j.orders="purchaseTimeDesc"),[H["审核中"]].includes(e)&&(U.value=[{label:"采购时间升序",id:"purchaseTimeAsc"},{label:"采购时间降序",id:"purchaseTimeDesc"}],j.orders="purchaseTimeDesc"),[H["战败"]].includes(e)&&(U.value=[{label:"战败时间升序",id:"loseTimeAsc"},{label:"战败时间降序",id:"loseTimeDesc"}],j.orders="loseTimeDesc"),[H["审核拒绝"]].includes(e)&&(U.value=[{label:"拒绝时间升序",id:"refuseTimeAsc"},{label:"拒绝时间降序",id:"refuseTimeDesc"}],j.orders="refuseTimeDesc"),[Z["订单状态"],Z["入库状态"]].includes(+v.value.itemType)&&(U.value=[{label:"创建时间升序",id:"createTimeAsc"},{label:"创建时间降序",id:"createTimeDesc"},{label:"采购日期升序",id:"purchaseTimeAsc"},{label:"采购日期降序",id:"purchaseTimeDesc"}],j.orders="createTimeDesc"),P.value.highlight(0,j.orders)}));const V=e=>{1==e&&A.value.open(),+v.value.itemType===X["销售定价"]&&2==e&&C.value.open(),3==e&&D.value.open()},w=()=>{var e;null==(e=P.value)||e.close()},O=()=>{T("search",j),w()},x=(e,a,l)=>{P.value.highlight(l,a.id.toString()),j[e]=a.id,O()},L=(e,a)=>{j.carBrandId=e,j.carSeriesId=a,P.value.highlight(1,a||e),O()},$=(e,a,l)=>{j.purchasePriceStart=e,j.purchasePriceEnd=a,R.value=l,P.value.highlight(2,e||a),O()},B=(e,a,l)=>{Object.assign(j,e),P.value.highlight(3,a),"clear"==l&&(P.value.highlight(1,""),P.value.highlight(2,""),j.carBrandId="",j.carSeriesId="",j.purchasePriceStart="",j.purchasePriceEnd="",R.value="",j.scene=""),O()};return d({close:w}),(a,l)=>{const d=c,m=t(r("up-icon"),s);return i(),u(M,{ref_key:"uDropdownRef",ref:P,class:"drop",borderRadius:"20rpx",onOpen:V},{default:n((()=>[o(z,{title:"排序"},{default:n((()=>[o(d,{class:"item-list"},{default:n((()=>[(i(!0),f(k,null,b(p(U),((e,a)=>(i(),u(d,{key:a,class:h({active:p(j).orders==e.id}),onClick:a=>x("orders",e,0)},{default:n((()=>[o(d,null,{default:n((()=>[g(_(e.label),1)])),_:2},1024),p(j).orders==e.id?(i(),u(m,{key:0,name:"checkbox-mark",color:"#ff5719",size:"20"})):y("",!0)])),_:2},1032,["class","onClick"])))),128))])),_:1})])),_:1}),o(z,{title:"品牌车系"},{default:n((()=>[o(F,{ref_key:"brandDropRef",ref:A,onSearch:L,pBrand:p(j).carBrandId,pSeries:p(j).carSeriesId},null,8,["pBrand","pSeries"])])),_:1}),[p(Z)["订单状态"],p(Z)["入库状态"]].includes(+p(v).itemType)?(i(),u(z,{key:0,title:"价格"},{default:n((()=>[o(ae,{onSearch:$,obj:{startPrice:p(j).purchasePriceStart,endPrice:p(j).purchasePriceEnd,checkPrice:p(R)}},null,8,["obj"])])),_:1})):y("",!0),[p(Z)["订单状态"],p(X)["评估定价"]].includes(+p(v).itemType)?(i(),u(z,{key:1,title:"现场"},{default:n((()=>[o(d,{class:"item-list"},{default:n((()=>[(i(!0),f(k,null,b(p(I),((e,a)=>(i(),u(d,{key:a,class:h({active:p(j).scene===e.id}),onClick:a=>x("scene",e,2)},{default:n((()=>[o(d,null,{default:n((()=>[g(_(e.label),1)])),_:2},1024),p(j).scene===e.id?(i(),u(m,{key:0,name:"checkbox-mark",color:"#ff5719",size:"20"})):y("",!0)])),_:2},1032,["class","onClick"])))),128))])),_:1})])),_:1})):y("",!0),+p(v).itemType===p(X)["销售定价"]?(i(),u(z,{key:2,title:"采购员"},{default:n((()=>[o(ee,{ref_key:"purchaseDropRef",ref:C,onSearch:l[0]||(l[0]=e=>x("pricingCreateUserId",e,2)),pricingCreateUserId:p(j).pricingCreateUserId},null,8,["pricingCreateUserId"])])),_:1})):y("",!0),o(z,{title:"筛选"},{default:n((()=>[o(le,{ref_key:"allDropRef",ref:D,onSearch:B,obj:p(j),sellData:e.sellData,pageStatus:e.pageStatus},null,8,["obj","sellData","pageStatus"])])),_:1})])),_:1},512)}}}),[["__scopeId","data-v-f2a424aa"]]),se=S(e({__name:"purchaseList",setup(e){const l=q(),d=a(),m=a(),v=a([]),T=a(),S=E({current:1,size:10,total:0,status:"",orders:"createTimeDesc"}),P=a([]),A=a({}),C=a("");async function j(){var e,a;O({title:"加载中",mask:!0});try{const e={...W(S,"total")},a=await x().get("/product/carPricing/page",{params:e});S.total=+a.data.count;const l=a.data.results;v.value=1===S.current?l:[...v.value,...l]}finally{1==S.current&&(null==(e=T.value)||e.initTop()),null==(a=T.value)||a.loadFinish(),L()}}I((e=>{const a=e.itemType,l=e.type;1==a?P.value=[{label:"待定价",val:"awaitAssess"},{label:"待采购",val:"awaitPricing"},{label:"审核中",val:"auditPricing"},{label:"已采购",val:"hasPurchased"},{label:"战败",val:"lose"},{label:"审核拒绝",val:"auditRejection"}]:2==a?P.value=[{label:"待签署",val:"waitSign"},{label:"待付款",val:"waitPayment"},{label:"付款中",val:"duringPayment"},{label:"已付全款",val:"completePayment"},{label:"已取消",val:"cancel"}]:3==a?P.value=[{label:"待入库",val:"waitStock"},{label:"已入库",val:"completeStock"}]:4==a?P.value=[{label:"待定价",val:"awaitRater"},{label:"已定价",val:"completedRater"},{label:"已采购",val:"hasPurchased"},{label:"战败",val:"lose"}]:5==a&&(P.value=[{label:"待定价",val:"awaitSell"},{label:"已定价",val:"completedSell"}]),Q(l),S.status=e.type||"",C.value=e.type||""})),R((()=>{V("sellData"),w("sellData",(e=>{A.value=e})),U()}));const U=()=>{S.current=1,j()},F=()=>{S.current++,j()},N=e=>{Object.assign(S,e),S.current=1,j()},Q=e=>{"lose"==e?S.orders="loseTimeDesc":"auditRejection"==e?S.orders="refuseTimeDesc":"awaitPricing"==e?S.orders="raterTimeDesc":["auditPricing","hasPurchased"].includes(e)?S.orders="purchaseTimeDesc":S.orders="createTimeDesc"},Z=a(),H=e=>{var a;null==(a=Z.value)||a.open(e)};return(e,a)=>{const I=c,R=t(r("up-icon"),s);return i(),u(I,{class:"page f-c-s"},{default:n((()=>[o(B,null,{title:n((()=>[o(I,{class:"head-drop f-r-a f-r-c"},{default:n((()=>[o(M,{ref_key:"uDropdownRef",ref:d,class:"drop",borderRadius:"20rpx"},{default:n((()=>[o(z,{title:p(P).filter((e=>e.val==p(C)))[0].label},{default:n((()=>[o(I,{class:"item-list"},{default:n((()=>[(i(!0),f(k,null,b(p(P),((e,a)=>(i(),u(I,{key:a,class:h({active:p(C)==e.val}),onClick:a=>(e=>{for(const a in S)S[a]="";D((()=>{var a;Object.assign(S,E({current:1,size:10,total:0,status:"",orders:"createTimeDesc"})),S.status=e.val,C.value=e.val,Q(e.val),d.value.close(),null==(a=m.value)||a.close(),j()}))})(e)},{default:n((()=>[o(I,null,{default:n((()=>[g(_(e.label),1)])),_:2},1024),p(C)==e.val?(i(),u(R,{key:0,name:"checkbox-mark",color:"#3C73FF",size:"20"})):y("",!0)])),_:2},1032,["class","onClick"])))),128))])),_:1})])),_:1},8,["title"])])),_:1},512)])),_:1})])),_:1}),p(S).status?(i(),u(te,{key:0,ref_key:"filterRef",ref:m,onSearch:N,sellData:p(A),pageStatus:p(S).status},null,8,["sellData","pageStatus"])):y("",!0),o(I,{class:"total"},{default:n((()=>{var e;return[g("共有 "+_(p(S).total)+" 辆"+_(null==(e=p(P).filter((e=>e.val==p(S).status))[0])?void 0:e.label),1)]})),_:1}),o(G,$({ref_key:"listLoadRef",ref:T,class:"scroll-view-box"},p(S),{istop:!1,onLoadMore:F,onLoadRefresh:U}),{"list-cont":n((()=>[(i(!0),f(k,null,b(p(v),((e,a)=>(i(),u(J,{key:a,item:e,itemType:p(l).itemType,onToShowPurchaseVinVerify:H},null,8,["item","itemType"])))),128))])),_:1},16),o(K,{ref_key:"noPurchaseCarInfoRef",ref:Z,type:"purchase"},null,512)])),_:1})}}}),[["__scopeId","data-v-f678b393"]]);export{se as default};
