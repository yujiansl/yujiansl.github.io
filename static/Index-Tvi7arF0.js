import{_ as ne}from"./empty-BiNgvBdS.js";import{b as ce,_ as ie,g as de}from"./index-BcSIpPe0.js";import{F as ue}from"./Index-BU8kA-XB.js";import{f as re,e as O,T as me,w as $,R as _e,k as pe,_ as ve}from"./index-c78MVIZI.js";import{b as fe}from"./validate-JA1bY0wI.js";import{u as ge,b as he,c as be}from"./index-DYQLPh63.js";import{E as A,n as we}from"./element-CD5rsoqi.js";import{r as g,Z as R,l as ye,d as Ve,ah as y,ap as Ae,m as p,p as v,U as t,u,q as e,O as a,T as m,S as V,R as k,P as xe,aF as Se,aG as ke}from"./vue-C87Wc4A0.js";import{V as Ce}from"./index-BZHf1ii5.js";import{g as Ie}from"./index-Cwe4D9Ts.js";import{C as De,D as Ne}from"./Delete-BgrM9xes.js";import"./LIKU-logo-CHqxCLOK.js";import"//at.alicdn.com/t/c/font_4557022_0o7l3b0t8egq.js";import"./vxe-sm_XFqm0.js";import"./Index.vue_vue_type_script_setup_true_lang-BhDJDWBy.js";const Ue=(b,r,d)=>{r===""?d(new Error("请输入密码")):fe(r)?d():d(new Error("密码格式错误"))},Re=(b,r,d)=>{r===""?d(new Error("请输入验证码")):d()},Fe=(b,r,d)=>{r===""?d(new Error("请再次输入密码")):r!==C.password?d(new Error("两次输入的密码不一致")):d()},q=g(!1),Pe=re(),Te=R({password:[{required:!0,validator:Ue,trigger:"blur"}],rePass:[{required:!0,validator:Fe,trigger:"blur"}],challengeResult:[{required:!0,validator:Re,trigger:"blur"}]}),qe=g(),z=JSON.parse(O("user-info")||"{}"),C=R({email:z.email||"79026@qq.com",name:z.name,password:"",rePass:"",challengeResult:""}),Oe=async b=>{b&&await b.validate(async(r,d)=>{if(r)try{const _=JSON.parse(O("user-info")||"{}"),I={password:C.password,rePassword:C.rePass,id:_.agent,userId:_.uid,challengeResult:C.challengeResult};q.value=!0,await ge(I),A.success("保存成功"),setTimeout(()=>{Pe.logout()},1e3)}catch(_){A.error("修改密码失败，请稍后再试"),q.value=!1,console.log("submitPass",_)}else console.log("error submit!",d)})};function Ge(){return{passFormRef:qe,passForm:C,passRules:Te,submitPass:Oe,passLoading:q}}const o=b=>(Se("data-v-06a22e09"),b=b(),ke(),b),Ee={class:"order base-box p-36 ml-40 mr-40 mt-20"},Be={class:"mx-640"},Le=o(()=>e("div",{class:"item-desc mt-14"},"如需修改登录邮箱，请联系客服",-1)),He={class:"created-at mb-60"},Je=o(()=>e("div",{class:"item-label"},"加入时间",-1)),$e={class:"item-desc"},ze={class:"w-full flex"},We={class:"flex justify-end w-full mb-40"},je={class:"table-wrapper"},Me=o(()=>e("div",{class:"flex-center flex-col h-full",style:{height:"300px"}},[e("span",null,[e("img",{src:ne,alt:""})]),e("span",{class:"custom-empty-text"},"暂无数据")],-1)),Qe={key:0},Ze={key:1},Ke={class:"base-box detail-box"},Xe=o(()=>e("div",{class:"flex-center w-full settlement-account-detail-title"},"结算账户详情",-1)),Ye={key:0},et={class:"settlement-account-detail-line"},tt=o(()=>e("span",{class:"settlement-account-field"},"结算币种：",-1)),st={class:"settlement-account-value item-value"},lt={class:"settlement-account-detail-line"},at=o(()=>e("span",{class:"settlement-account-field"},"银行国家/地区：",-1)),ot={class:"settlement-account-value item-value"},nt={class:"settlement-account-detail-line"},ct={key:0,class:"settlement-account-field"},it={key:1,class:"settlement-account-field"},dt={key:2,class:"settlement-account-field"},ut={class:"settlement-account-value item-value"},rt={key:0,class:"settlement-account-detail-line"},mt=o(()=>e("span",{class:"settlement-account-field"},"美元银行账号：",-1)),_t={class:"settlement-account-value item-value"},pt={class:"settlement-account-detail-line"},vt=o(()=>e("span",{class:"settlement-account-field"},"结算账户名称：",-1)),ft={class:"settlement-account-value item-value"},gt={class:"settlement-account-detail-line"},ht=o(()=>e("span",{class:"settlement-account-field"},"收款人地址：",-1)),bt={class:"settlement-account-value item-value"},wt=o(()=>e("div",{class:"enterprise-label mb-30"},"企业信息",-1)),yt={class:"settlement-account-detail-line"},Vt=o(()=>e("span",{class:"settlement-account-field"},"城市：",-1)),At={class:"settlement-account-value item-value"},xt={class:"settlement-account-detail-line"},St=o(()=>e("span",{class:"settlement-account-field"},"州/省：",-1)),kt={class:"settlement-account-value item-value"},Ct={class:"settlement-account-detail-line"},It=o(()=>e("span",{class:"settlement-account-field"},"邮编：",-1)),Dt={class:"settlement-account-value item-value"},Nt={key:1},Ut={class:"settlement-account-detail-line"},Rt=o(()=>e("span",{class:"settlement-account-field"},"结算币种：",-1)),Ft={class:"settlement-account-value item-value"},Pt={class:"settlement-account-detail-line"},Tt=o(()=>e("span",{class:"settlement-account-field"},"USDT 钱包地址：",-1)),qt={class:"settlement-account-value item-value"},Ot={class:"settlement-account-detail-line"},Gt=o(()=>e("span",{class:"settlement-account-field"},"钱包名称/备注：",-1)),Et={class:"settlement-account-value item-value"},Bt={class:"flex-center w-full mt-30 settlement-account-return-btn"},Lt=o(()=>e("div",{class:"item-desc mt-14"},"如需修改登录邮箱，请联系客服",-1)),Ht={class:"w-full flex"},Jt={key:0},$t=o(()=>e("div",{class:"bound-google mt-80"},[e("img",{src:ie,class:"bound-google-img"}),e("div",{class:"bound-google-text ml-28"},[e("div",{class:"bound-google-title"},"已绑定谷歌验证器"),e("div",{class:"bound-google-tips mt-8 mb-50"},"使用谷歌验证器 (Google Authenticator) 获取谷歌验证码")])],-1)),zt={class:"google-download flex ml-92"},Wt={key:1,class:"mx-640"},jt=o(()=>e("div",{class:"google-title mt-40"},"开启谷歌安全验证，将极大的保障您的账户安全",-1)),Mt=o(()=>e("div",{class:"google-text mt-30 mb-14"},"使用谷歌验证器 (Google Authenticator) 扫描二维码进行绑定",-1)),Qt={class:"google-download flex"},Zt={key:0,class:"auth-img mt-40 mb-50 ml-5"},Kt=["src"],Xt={key:1,class:"auth-img mt-40 mb-50 ml-5 flex-center"},Yt={class:"google-qrcode-loading"},es={class:"w-full mb-60"},ts=o(()=>e("div",{class:"google-input-label mb-12 flex-1"},"谷歌验证码",-1)),ss={class:""},ls={class:"flex"},as=ye({__name:"Index",setup(b){const r=JSON.parse(O("user-info")||"{}"),d=g(r["otp.enabled"]==="1"),_=g({otp:"",totpID:""}),I=g();me();const D=g("info"),G=g("USD"),c=g({}),F=g(null),P=g(!1),T=g(!1),N=g(!1),f=R({id:"",name:"",email:"",createdAt:""}),W=R({name:[{required:!0,message:"请输入代理名称",trigger:"blur"}]}),{passFormRef:E,passForm:w,passRules:j,submitPass:M,passLoading:Q}=Ge(),Z=async()=>{if(!_.value.otp){A.error("请输入谷歌验证码");return}const n={totpID:_.value.totpID,otp:_.value.otp};ce(n).then(()=>{A.success("绑定成功"),_e(JSON.stringify({...r,"otp.enabled":"1"}),"user-info"),d.value=!0}).catch(s=>{A.success("操作失败"),console.error(s)})},K=async()=>{try{const n=await de({id:r.agent});_.value.totpID=n.data.totpId,_.value.qrcode=n.data.qrcode}catch(n){console.log("getOtpQr",n)}},X=(n,s)=>{D.value==="settlementAccount"&&!F.value&&B(),D.value==="google"&&!d.value&&K()},B=()=>{const n=[];n.push({columnName:"luAgent",value:f.id}),Ie({searchItems:n}).then(i=>{F.value=pe(i.data.rows)}).catch(i=>{console.error(i)})},Y=n=>{G.value=n.currency,c.value=n,N.value=!0},ee=n=>{N.value=!1},te=()=>{T.value=!0},se=async()=>{const n={id:"",account:"yes"},s=new URLSearchParams(Object.entries(n)).toString();he(s).then(i=>{f.id=i.data.id,f.email=i.data.email,f.name=i.data.agentName,f.createdAt=i.data.createdAt}).catch(i=>{console.log(i)})},L=()=>{window.open("https://docs.likupay.com/google-authenticator","_blank")},le=async n=>{n&&await n.validate((s,i)=>{if(s)try{be(f).then(()=>{A.success("保存成功")}).catch(h=>{A.error("操作失败"),console.error(h)})}catch(h){console.error(h)}else console.error("error submit!",i)})};return Ve(()=>{se(),d.value=r["otp.enabled"]==="1"}),(n,s)=>{const i=y("el-input"),h=y("el-form-item"),x=y("el-button"),H=y("el-form"),U=y("el-tab-pane"),S=y("el-table-column"),J=y("SvgIcon"),ae=y("el-tabs"),oe=Ae("loading");return p(),v("div",null,[t(De,{onRefresh:B,modelValue:P.value,"onUpdate:modelValue":s[0]||(s[0]=l=>P.value=l),id:u(r).agent,role:"agent"},null,8,["modelValue","id"]),t(Ne,{modelValue:T.value,"onUpdate:modelValue":s[1]||(s[1]=l=>T.value=l),id:c.value.id},null,8,["modelValue","id"]),e("div",Ee,[t(ae,{modelValue:D.value,"onUpdate:modelValue":s[13]||(s[13]=l=>D.value=l),class:"page-tabs",onTabChange:X},{default:a(()=>[t(U,{label:"账户信息",name:"info"},{default:a(()=>[e("div",Be,[t(H,{ref_key:"agentFormRef",ref:I,"label-position":"top",model:f,rules:W,"label-width":"auto",class:"demo-ruleForm mt-40"},{default:a(()=>[t(h,{label:"登录邮箱",prop:"email"},{default:a(()=>[t(i,{modelValue:f.email,"onUpdate:modelValue":s[2]||(s[2]=l=>f.email=l),disabled:""},null,8,["modelValue"]),Le]),_:1}),t(h,{label:"代理名称",prop:"agentName"},{default:a(()=>[t(i,{modelValue:f.name,"onUpdate:modelValue":s[3]||(s[3]=l=>f.name=l),placeholder:"请输入代理名称",minlength:"1",maxlength:"30"},null,8,["modelValue"])]),_:1}),e("div",He,[Je,e("div",$e,m(u($)(f.createdAt)),1)]),t(h,null,{default:a(()=>[e("div",ze,[t(x,{type:"primary",onClick:s[4]||(s[4]=l=>le(I.value))},{default:a(()=>[V("保存")]),_:1})])]),_:1})]),_:1},8,["model","rules"])])]),_:1}),t(U,{label:"结算账户",name:"settlementAccount"},{default:a(()=>[e("div",We,[t(x,{type:"primary",onClick:s[5]||(s[5]=l=>P.value=!0)},{default:a(()=>[V("新增结算账户")]),_:1})]),e("div",je,[t(u(we),{data:F.value,style:{width:"100%"}},{empty:a(()=>[Me]),default:a(()=>[t(S,{prop:"accountName",label:"结算账户名称","min-width":"200"}),t(S,{prop:"currency",label:"账户币种","min-width":"200"},{default:a(l=>[l.row.currency==="USD"?(p(),v("div",Qe,"USD (美元)")):l.row.currency==="USDT"?(p(),v("div",Ze,"USDT (TRC20)")):k("",!0)]),_:1}),t(S,{prop:"account",label:"收款账户","min-width":"260"},{default:a(l=>[e("div",null,m(l.row.account||l.row.bankAddress),1)]),_:1}),t(S,{prop:"createdAt",label:"创建时间","min-width":"260"},{default:a(l=>[e("div",null,m(u($)(l.row.createdAt)),1)]),_:1}),t(S,{label:"操作","min-width":"130"},{default:a(l=>[t(x,{link:"",type:"primary",size:"default",onClick:os=>Y(l.row)},{default:a(()=>[V(" 管理结算账户 ")]),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"])]),t(ue,{modelValue:N.value,"onUpdate:modelValue":s[6]||(s[6]=l=>N.value=l)},{default:a(()=>[e("div",Ke,[Xe,G.value=="USD"?(p(),v("div",Ye,[e("div",et,[tt,e("span",st,m(c.value.currency),1)]),e("div",lt,[at,e("span",ot,m(c.value.region),1)]),e("div",nt,[c.value.bankName==="IBAN"?(p(),v("span",ct,"IBAN：")):k("",!0),c.value.bankName==="ACH"?(p(),v("span",it,"ACH 汇款路由号：")):k("",!0),c.value.bankName==="SWIFT"?(p(),v("span",dt,"SWIFT Code：")):k("",!0),e("span",ut,m(c.value.bankAddress),1)]),c.value.bankName==="ACH"||c.value.bankName==="SWIFT"?(p(),v("div",rt,[mt,e("span",_t,m(c.value.account),1)])):k("",!0),e("div",pt,[vt,e("span",ft,m(c.value.accountName),1)]),e("div",gt,[ht,e("span",bt,m(c.value.companyAddress),1)]),wt,e("div",yt,[Vt,e("span",At,m(c.value.city),1)]),e("div",xt,[St,e("span",kt,m(c.value.province),1)]),e("div",Ct,[It,e("span",Dt,m(c.value.postCode),1)])])):(p(),v("div",Nt,[e("div",Ut,[Rt,e("span",Ft,m(c.value.currency),1)]),e("div",Pt,[Tt,e("span",qt,m(c.value.account),1)]),e("div",Ot,[Gt,e("span",Et,m(c.value.accountName),1)])])),e("div",Bt,[t(x,{onClick:ee},{default:a(()=>[V("返回")]),_:1})]),e("div",{class:"flex-center w-full del-btn cursor-pointer",onClick:te}," 删除结算账户 ")])]),_:1},8,["modelValue"])]),_:1}),t(U,{label:"修改密码",name:"pass"},{default:a(()=>[t(H,{style:{"max-width":"640px"},ref_key:"passFormRef",ref:E,"label-position":"top",model:u(w),rules:u(j),"label-width":"auto",class:"demo-ruleForm mt-40"},{default:a(()=>[t(h,{label:"登录邮箱",prop:"email"},{default:a(()=>[t(i,{modelValue:u(w).name,"onUpdate:modelValue":s[7]||(s[7]=l=>u(w).name=l),disabled:""},null,8,["modelValue"]),Lt]),_:1}),t(h,{label:"设置新密码",prop:"password"},{default:a(()=>[t(i,{modelValue:u(w).password,"onUpdate:modelValue":s[8]||(s[8]=l=>u(w).password=l),type:"password",placeholder:"请输入新密码",maxlength:"30"},null,8,["modelValue"])]),_:1}),t(h,{label:"确认新密码",prop:"rePass"},{default:a(()=>[t(i,{modelValue:u(w).rePass,"onUpdate:modelValue":s[9]||(s[9]=l=>u(w).rePass=l),type:"password",placeholder:"请再次输入新密码",maxlength:"30"},null,8,["modelValue"])]),_:1}),t(Ce,{label:"验证旧密码",placeholder:"请输入旧密码",modelValue:u(w).challengeResult,"onUpdate:modelValue":s[10]||(s[10]=l=>u(w).challengeResult=l)},null,8,["modelValue"]),t(h,null,{default:a(()=>[e("div",Ht,[t(x,{type:"primary",loading:u(Q),onClick:s[11]||(s[11]=l=>u(M)(u(E)))},{default:a(()=>[V("保存")]),_:1},8,["loading"])])]),_:1})]),_:1},8,["model","rules"])]),_:1}),t(U,{label:"谷歌验证器",name:"google"},{default:a(()=>[d.value?(p(),v("div",Jt,[$t,e("div",zt,[e("div",{class:"cursor-pointer",onClick:L},[V(" 下载 Google Authenticator "),t(J,{name:"icon-xiazai",class:"ml-5"})])])])):(p(),v("div",Wt,[jt,Mt,e("div",Qt,[e("div",{class:"cursor-pointer",onClick:L},[V(" 下载 Google Authenticator "),t(J,{name:"icon-xiazai",class:"ml-5"})])]),_.value.qrcode?(p(),v("div",Zt,[e("img",{src:"data:image/png;base64,"+_.value.qrcode,class:"google-auth-img"},null,8,Kt)])):(p(),v("div",Xt,[xe(e("span",Yt,null,512),[[oe,!0]])])),e("div",es,[ts,e("div",ss,[t(i,{modelValue:_.value.otp,"onUpdate:modelValue":s[12]||(s[12]=l=>_.value.otp=l),placeholder:"请输入谷歌验证码",maxlength:"6"},null,8,["modelValue"])])]),e("div",ls,[t(x,{type:"primary",onClick:Z},{default:a(()=>[V("绑定")]),_:1})])]))]),_:1})]),_:1},8,["modelValue"])])])}}}),ys=ve(as,[["__scopeId","data-v-06a22e09"]]);export{ys as default};
