import{l as ye,aK as be,aD as we,aE as ge,Z as F,r as f,aL as ke,ah as h,m as p,p as _,U as l,O as n,q as t,S as g,T as c,u as k,F as B,a7 as Ve,aF as Ie,aG as Fe}from"./vue-BtEXIrqH.js";import{u as De}from"./useEnterprise-euz5rIMR.js";import{_ as Ue}from"./Index.vue_vue_type_script_setup_true_lang-CAnY41O0.js";import{F as Ce}from"./Index-BgrOBixy.js";import{d as Ne,g as Ae}from"./index-Cuh9gsAM.js";import{m as K,k as Re,l as Se}from"./index-B3sZ9j6O.js";import{U as O}from"./Index-DjrcDC4L.js";import{b as Te}from"./validate-riIxJwdE.js";import{c as C,e as Z}from"./commonFn-DSVr4W-5.js";import{n as H,E as I}from"./element-BbMnn7tA.js";import{_ as Ee}from"./index-bEAPwbJM.js";import"./LIKU-logo-BbnHVERV.js";import"//at.alicdn.com/t/c/font_4557022_266y8yxi6v9.js";import"./vxe-EK889JN8.js";const u=V=>(Ie("data-v-40095e2f"),V=V(),Fe(),V),xe=u(()=>t("div",{class:"delete-confirm-warning"}," 确定删除结算账户吗？ ",-1)),Me=u(()=>t("div",{class:"delete-google-title"}," 谷歌验证码 ",-1)),Pe={class:"delete-google-otp"},Le={class:"dialog-footer delete-confirm-footer"},$e={key:0,class:"base-box detail-box"},qe={class:"detail-line"},Ge=u(()=>t("span",{class:"detail-line-title"},"谷歌验证器",-1)),ze={key:0,class:"detail-line-value"},Be={key:1,class:"detail-line-value"},Ke={class:"detail-line"},Oe=u(()=>t("span",{class:"detail-line-title"},"注册时间",-1)),Ze={class:"detail-line-value"},He={class:"detail-line"},je=u(()=>t("span",{class:"detail-line-title"},"最后登录时间",-1)),Je={key:0,class:"detail-line-value"},Qe={key:1,class:"detail-line-value"},We={class:"detail-line"},Xe=u(()=>t("span",{class:"detail-line-title"},"最后登录IP",-1)),Ye={key:0,class:"detail-line-value"},el={key:1,class:"detail-line-value"},ll={class:"flex-center w-full mt-30"},tl={class:"detail-line"},al=u(()=>t("span",{class:"detail-line-title"},"提交时间",-1)),ol={class:"detail-line-value"},sl={class:"detail-line"},nl=u(()=>t("span",{class:"detail-line-title"},"审核通过时间",-1)),il={key:0,class:"detail-line-value"},rl={key:1,class:"detail-line-value"},dl={class:"flex-center w-full mt-30"},cl={key:0,class:"verificated flex-center"},ul={key:1,class:"not-verificated flex-center"},ml={key:0},pl={key:1,class:"lockout-status-text"},_l={key:1,class:"base-box detail-box"},vl=u(()=>t("div",{class:"flex-center w-full mt-30 settlement-account-detail-title"},"结算账户详情",-1)),fl={key:0},hl={class:"settlement-account-detail-line"},yl=u(()=>t("span",{class:"settlement-account-field"},"结算币种：",-1)),bl={class:"settlement-account-value"},wl={class:"settlement-account-detail-line"},gl=u(()=>t("span",{class:"settlement-account-field"},"银行国家/地区：",-1)),kl={class:"settlement-account-value"},Vl={class:"settlement-account-detail-line"},Il=u(()=>t("span",{class:"settlement-account-field"},"银行名称：",-1)),Fl={class:"settlement-account-value"},Dl={class:"settlement-account-detail-line"},Ul=u(()=>t("span",{class:"settlement-account-field"},"银行地址：",-1)),Cl={class:"settlement-account-value"},Nl={class:"settlement-account-detail-line"},Al=u(()=>t("span",{class:"settlement-account-field"}," 账号名：",-1)),Rl={class:"settlement-account-value"},Sl={class:"settlement-account-detail-line"},Tl=u(()=>t("span",{class:"settlement-account-field"},"银行账号：",-1)),El={class:"settlement-account-value"},xl={class:"settlement-account-detail-line"},Ml=u(()=>t("span",{class:"settlement-account-field"},"公司地址：",-1)),Pl={class:"settlement-account-value"},Ll={key:1},$l={class:"settlement-account-detail-line"},ql=u(()=>t("span",{class:"settlement-account-field"},"结算币种：",-1)),Gl={class:"settlement-account-value"},zl={class:"settlement-account-detail-line"},Bl=u(()=>t("span",{class:"settlement-account-field"},"USDT 钱包地址：",-1)),Kl={class:"settlement-account-value"},Ol={class:"settlement-account-detail-line"},Zl=u(()=>t("span",{class:"settlement-account-field"},"钱包名称/备注：",-1)),Hl={class:"settlement-account-value"},jl={class:"flex-center w-full mt-30 settlement-account-return-btn"},Jl=ye({__name:"Setting",props:be({row:{}},{modelValue:{},modelModifiers:{}}),emits:["update:modelValue"],setup(V){const w=V;we();const j=ge(),{enterpriseFormRef:S,enterpriseForm:J,enterpriseRules:Q,submitForm:Ql,resetForm:Wl}=De(),W=(o,e,s)=>{e==""||Te(e)?s():s(new Error("密码格式错误"))},X=(o,e,s)=>{e==""?s():e!==m.password?s(new Error("两次输入的密码不一致")):s()},m=F({merchantId:"",isEnabled:!0,password:"",rePassword:"",passwordChanged:"0",updatePassword:null,remark:"",challengeResult:""}),Y=F({password:[{trigger:"blur",validator:W}],rePassword:[{trigger:"blur",validator:X}],challengeResult:[{required:!0,message:"请输入谷歌验证码",trigger:"blur"}]}),i=F({...J,challengeResult:""}),ee=F({...Q,challengeResult:[{required:!0,message:"请输入谷歌验证码",trigger:"blur"}]}),T=f(""),v=f({}),N=f([]),E=f([]),x=ke(V,"modelValue"),A=f(!0),D=f(!1),M=f(),P=f("merchantInfo"),L=f(""),$=f(""),R=f(""),le=[{value:"director",label:"董事"},{value:"legal",label:"法定代表人"},{value:"beneficiary",label:"受益人"}],te=()=>{const o={paging:{pageNumber:1,pageSize:30},condition:{merchantID:w.row.id}};Re(o).then(e=>{var s;e.data.items&&(N.value=e.data.items,(s=N.value)==null||s.forEach(d=>{var b;(b=d.claims)==null||b.forEach(r=>{r.claimType==="currency"&&(d.currency=r.claimValue.toUpperCase()),r.claimType==="service_fee_percent"&&(d.service_fee_percent=parseFloat(r.claimValue)/10+"%")})}))}).catch(e=>{console.error(e)})},ae=()=>{const o=[];o.push({columnName:"luMerchant",value:w.row.id}),Ae({searchItems:o}).then(s=>{E.value=s.data.rows}).catch(s=>{console.error(s)})},oe=()=>{Se(w.row.id).then(o=>{const e=o.data?o.data:[],s=f({});e.forEach(d=>{s.value[d.claimType]=d.claimValue,i["kyb.companyName"]=s.value["kyb.companyName"]?s.value["kyb.companyName"]:"",i["kyb.registrationCountry"]=s.value["kyb.registrationCountry"]?s.value["kyb.registrationCountry"]:"",i["kyb.companyIDFile"]=s.value["kyb.companyIDFile"]?s.value["kyb.companyIDFile"]:"",i["kyb.ownerName"]=s.value["kyb.ownerName"]?s.value["kyb.ownerName"]:"",i["kyb.ownerType"]=s.value["kyb.ownerType"]?s.value["kyb.ownerType"]:"",i["kyb.ownerIDFile"]=s.value["kyb.ownerIDFile"]?s.value["kyb.ownerIDFile"]:""}),L.value=Z(i["kyb.companyIDFile"]?i["kyb.companyIDFile"]:""),$.value=Z(i["kyb.ownerIDFile"]?i["kyb.ownerIDFile"]:"")}).catch(o=>{console.error(o)})},se=(o,e)=>{o.paneName=="enterprise"&&oe(),o.paneName=="site"&&te(),o.paneName=="settlementAccount"&&ae()},q=o=>o=="1"?"正常":"禁用",G=o=>o=="1"?"已认证":"未认证",ne=o=>{T.value=o.currency.value,v.value=o,A.value=!1},ie=o=>{A.value=!0},re=async o=>{o&&await o.validate((e,s)=>{if(e)try{const d=[];for(let r in i)d.push({claimType:r,claimValue:i[r]});const b=F({});b.merchantId=w.row.id,b.claims=d,b.challengeResult=i.challengeResult,K(b).then(()=>{I.success("保存成功")}).catch(r=>{I.error("操作失败"),console.error(r)})}catch(d){console.error(d)}else console.error("error submit!",s)})},de=async o=>{o&&await o.validate((e,s)=>{if(e)try{m.merchantId=w.row.id,m.remark=w.row.remark,m.password&&m.rePassword&&(m.passwordChanged="1",m.updatePassword={userId:w.row["account~userID"].value,password:m.password},m.password="",m.rePassword=""),K(m).then(()=>{I.success("保存成功")}).catch(d=>{I.error("操作失败"),console.error(d)})}catch(d){console.error(d)}else console.error("error submit!",s)})},ce=o=>{j.push({path:"/admin/site/detail?id="+o})},ue=()=>{D.value=!0},me=async()=>{const o={id:v.value.id.value,challengeResult:R.value};Ne(o).then(e=>{I.success("删除成功"),setTimeout(()=>{window.location.reload()},1e3)}).catch(e=>{I.error("操作失败"),console.log(e)})};return(o,e)=>{const s=h("el-input"),d=h("el-button"),b=h("el-dialog"),r=h("el-form-item"),pe=h("el-switch"),z=h("el-form"),U=h("el-tab-pane"),_e=h("el-option"),ve=h("el-select"),y=h("el-table-column"),fe=h("el-tabs");return p(),_(B,null,[l(b,{modelValue:D.value,"onUpdate:modelValue":e[2]||(e[2]=a=>D.value=a),center:"",style:{width:"480px"}},{footer:n(()=>[t("div",Le,[l(d,{type:"primary",onClick:me},{default:n(()=>[g(" 确定删除 ")]),_:1}),l(d,{onClick:e[1]||(e[1]=a=>D.value=!1)},{default:n(()=>[g("取消")]),_:1})])]),default:n(()=>[xe,Me,t("div",Pe,[l(s,{modelValue:R.value,"onUpdate:modelValue":e[0]||(e[0]=a=>R.value=a),minlength:"6",maxlength:"6"},null,8,["modelValue"])])]),_:1},8,["modelValue"]),l(Ce,{modelValue:x.value,"onUpdate:modelValue":e[19]||(e[19]=a=>x.value=a)},{default:n(()=>[A.value?(p(),_("div",$e,[l(fe,{modelValue:P.value,"onUpdate:modelValue":e[18]||(e[18]=a=>P.value=a),class:"modal-tabs",onTabClick:se},{default:n(()=>[l(U,{label:"商户账号",name:"merchantInfo"},{default:n(()=>[l(z,{ref_key:"merchantFormRef",ref:M,"label-position":"top",rules:Y,"label-width":"auto",model:m},{default:n(()=>[l(r,{prop:"account~userName",label:"登录邮箱"},{default:n(()=>[l(s,{modelValue:o.row["account~userName"],"onUpdate:modelValue":e[3]||(e[3]=a=>o.row["account~userName"]=a),placeholder:"请输入登录邮箱",maxlength:"50",disabled:""},null,8,["modelValue"])]),_:1}),l(r,{prop:"password",label:"密码"},{default:n(()=>[l(s,{modelValue:m.password,"onUpdate:modelValue":e[4]||(e[4]=a=>m.password=a),placeholder:"请输入密码",type:"password",minlength:"8",maxlength:"30"},null,8,["modelValue"])]),_:1}),l(r,{prop:"rePassword",label:"确认密码"},{default:n(()=>[l(s,{modelValue:m.rePassword,"onUpdate:modelValue":e[5]||(e[5]=a=>m.rePassword=a),placeholder:"请再次确认密码",type:"password",minlength:"8",maxlength:"30"},null,8,["modelValue"])]),_:1}),l(r,{prop:"remark",label:"商户备注"},{default:n(()=>[l(s,{modelValue:o.row.remark,"onUpdate:modelValue":e[6]||(e[6]=a=>o.row.remark=a),placeholder:"备注信息仅管理员可见",type:"textarea",rows:3,maxlength:"50"},null,8,["modelValue"])]),_:1}),l(r,{prop:"isEnabled",label:"账号状态"},{default:n(()=>[l(pe,{modelValue:o.row.isEnabled,"onUpdate:modelValue":e[7]||(e[7]=a=>o.row.isEnabled=a),"inline-prompt":"","active-text":"正常","inactive-text":"禁用"},null,8,["modelValue"])]),_:1}),l(r,{prop:"challengeResult",label:"谷歌验证码"},{default:n(()=>[l(s,{modelValue:m.challengeResult,"onUpdate:modelValue":e[8]||(e[8]=a=>m.challengeResult=a),placeholder:"请输入谷歌验证码",minlength:"6",maxlength:"6"},null,8,["modelValue"])]),_:1}),t("div",qe,[Ge,o.row["account~otpEnabled"]=="1"?(p(),_("span",ze,"已启用")):(p(),_("span",Be,"未启用"))]),t("div",Ke,[Oe,t("span",Ze,c(k(C)(o.row.createdAt)),1)]),t("div",He,[je,o.row["account~latestLoginAt"]?(p(),_("span",Je,c(k(C)(o.row["account~latestLoginAt"])),1)):(p(),_("span",Qe,"无"))]),t("div",We,[Xe,o.row.lastLoginIP?(p(),_("span",Ye,c(o.row.lastLoginIP),1)):(p(),_("span",el,"无"))]),l(r,null,{default:n(()=>[t("div",ll,[l(d,{type:"primary",onClick:e[9]||(e[9]=a=>de(M.value))},{default:n(()=>[g("保存")]),_:1})])]),_:1})]),_:1},8,["rules","model"])]),_:1}),l(U,{label:"企业信息",name:"enterprise"},{default:n(()=>[l(z,{ref_key:"enterpriseFormRef",ref:S,"label-position":"top",rules:ee,"label-width":"auto",model:i},{default:n(()=>[l(r,{prop:"kyb.companyName",label:"企业名称"},{default:n(()=>[l(s,{modelValue:i["kyb.companyName"],"onUpdate:modelValue":e[10]||(e[10]=a=>i["kyb.companyName"]=a),placeholder:"请输入企业名称",maxlength:"50"},null,8,["modelValue"])]),_:1}),l(r,{prop:"kyb.registrationCountry",label:"企业注册地"},{default:n(()=>[l(Ue,{type:"region",modelValue:i["kyb.registrationCountry"],"onUpdate:modelValue":e[11]||(e[11]=a=>i["kyb.registrationCountry"]=a),placeholder:"请选择企业注册地"},null,8,["modelValue"])]),_:1}),l(r,{prop:"kyb.companyIDFile",label:"企业证件"},{default:n(()=>[l(O,{defaultImgUrl:L.value,id:"companyIDFile",modelValue:i["kyb.companyIDFile"],"onUpdate:modelValue":e[12]||(e[12]=a=>i["kyb.companyIDFile"]=a),ext:"img"},null,8,["defaultImgUrl","modelValue"])]),_:1}),l(r,{prop:"kyb.ownerName",label:"企业主姓名"},{default:n(()=>[l(s,{modelValue:i["kyb.ownerName"],"onUpdate:modelValue":e[13]||(e[13]=a=>i["kyb.ownerName"]=a),placeholder:"请输入企业主姓名",maxlength:"30"},null,8,["modelValue"])]),_:1}),l(r,{prop:"kyb.ownerType",label:"企业主类型"},{default:n(()=>[l(ve,{modelValue:i["kyb.ownerType"],"onUpdate:modelValue":e[14]||(e[14]=a=>i["kyb.ownerType"]=a)},{default:n(()=>[(p(),_(B,null,Ve(le,a=>l(_e,{key:a.value,label:a.label,value:a.value},null,8,["label","value"])),64))]),_:1},8,["modelValue"])]),_:1}),l(r,{prop:"kyb.ownerIDFile",label:"企业主证件"},{default:n(()=>[l(O,{defaultImgUrl:$.value,id:"ownerIDFile",modelValue:i["kyb.ownerIDFile"],"onUpdate:modelValue":e[15]||(e[15]=a=>i["kyb.ownerIDFile"]=a),ext:"img"},null,8,["defaultImgUrl","modelValue"])]),_:1}),t("div",tl,[al,t("span",ol,c(k(C)(o.row.createdAt)),1)]),t("div",sl,[nl,o.row.verificatedAt?(p(),_("span",il,c(k(C)(o.row.verificatedAt)),1)):(p(),_("span",rl,"无"))]),l(r,{prop:"challengeResult",label:"谷歌验证码"},{default:n(()=>[l(s,{modelValue:i.challengeResult,"onUpdate:modelValue":e[16]||(e[16]=a=>i.challengeResult=a),placeholder:"请输入谷歌验证码",minlength:"6",maxlength:"6"},null,8,["modelValue"])]),_:1}),l(r,null,{default:n(()=>[t("div",dl,[l(d,{type:"primary",onClick:e[17]||(e[17]=a=>re(k(S)))},{default:n(()=>[g("保存")]),_:1})])]),_:1})]),_:1},8,["rules","model"])]),_:1}),l(U,{label:"业务站点",name:"site"},{default:n(()=>[l(k(H),{data:N.value,style:{width:"100%"}},{default:n(()=>[l(y,{prop:"name",label:"站点名称",width:"160"}),l(y,{prop:"isVerificated",label:"认证状态",width:"100"},{default:n(a=>[a.row.isVerification=="1"?(p(),_("div",cl,c(G(a.row.isVerification)),1)):(p(),_("div",ul,c(G(a.row.isVerification)),1))]),_:1}),l(y,{prop:"currency",label:"收款币种",width:"80"}),l(y,{prop:"isEnabled",label:"状态",width:"80"},{default:n(a=>[a.row.isEnabled=="1"?(p(),_("div",ml,c(q(a.row.isEnabled)),1)):(p(),_("div",pl,c(q(a.row.isEnabled)),1))]),_:1}),l(y,{prop:"service_fee_percent",label:"收单费率",width:"80"}),l(y,{label:"操作",width:"120"},{default:n(a=>[l(d,{link:"",type:"primary",size:"small",onClick:he=>ce(a.row.id)},{default:n(()=>[g(" 管理站点 ")]),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"])]),_:1}),l(U,{label:"结算账号",name:"settlementAccount"},{default:n(()=>[l(k(H),{data:E.value,style:{width:"100%"}},{default:n(()=>[l(y,{prop:"accountName.value",label:"结算账户名称",width:"120"}),l(y,{prop:"currency.value",label:"账户币种",width:"120"}),l(y,{prop:"account.value",label:"收款账户",width:"240"}),l(y,{label:"操作",width:"120"},{default:n(a=>[l(d,{link:"",type:"primary",size:"small",onClick:he=>ne(a.row)},{default:n(()=>[g(" 管理 ")]),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"])]),_:1})]),_:1},8,["modelValue"])])):(p(),_("div",_l,[vl,T.value=="USD"?(p(),_("div",fl,[t("div",hl,[yl,t("span",bl,c(v.value.currency.value),1)]),t("div",wl,[gl,t("span",kl,c(v.value.region.value),1)]),t("div",Vl,[Il,t("span",Fl,c(v.value.bankName.value),1)]),t("div",Dl,[Ul,t("span",Cl,c(v.value.bankAddress.value),1)]),t("div",Nl,[Al,t("span",Rl,c(v.value.accountName.value),1)]),t("div",Sl,[Tl,t("span",El,c(v.value.account.value),1)]),t("div",xl,[Ml,t("span",Pl,c(v.value.companyAddress.value),1)])])):(p(),_("div",Ll,[t("div",$l,[ql,t("span",Gl,c(v.value.currency.value),1)]),t("div",zl,[Bl,t("span",Kl,c(v.value.account.value),1)]),t("div",Ol,[Zl,t("span",Hl,c(v.value.accountName.value),1)])])),t("div",jl,[l(d,{onClick:ie},{default:n(()=>[g("返回")]),_:1})]),t("div",{class:"flex-center w-full del-btn cursor-pointer mb-20",onClick:ue},"删除结算账户 ")]))]),_:1},8,["modelValue"])],64)}}}),mt=Ee(Jl,[["__scopeId","data-v-40095e2f"]]);export{mt as default};
