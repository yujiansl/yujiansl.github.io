import{u as ne}from"./useTable-B7hd0WvU.js";import{c as se,d as de,e as ce}from"./index-C7XNEq9c.js";import{F as ue}from"./Index-Di390-Cq.js";import{c as x,a as F,h as ie,t as pe}from"./commonFn-Ei0WKKhK.js";import{l as me,r as v,d as _e,ah as u,ap as q,m as i,p as h,q as o,U as l,O as r,F as S,a7 as k,M as y,S as N,P as T,u as d,I as ve,T as p,R as fe,aF as be,aG as he}from"./vue-BtEXIrqH.js";import{_ as ye}from"./index-Cfrc5ih1.js";import"./LIKU-logo-BbnHVERV.js";import"./element-BbMnn7tA.js";import"//at.alicdn.com/t/c/font_4557022_266y8yxi6v9.js";import"./vxe-EK889JN8.js";const f=g=>(be("data-v-4fbcd672"),g=g(),he(),g),ge={class:"order base-box p-36 ml-40 mr-40 mt-20"},we={class:"top-search"},Ve={class:"table-wrapper"},xe={key:0},Ne=["onClick"],Ce={class:"pager-wrapper mt-32 flex justify-end"},De={class:"base-box detail-box"},Se=f(()=>o("div",{class:"order-title mb-30"},"订单信息",-1)),ke={class:"mb-24 flex"},Te=f(()=>o("div",{class:"order-text"},"订单金额",-1)),ze={class:"order-value"},Ae={class:"mb-24 flex"},Ie=f(()=>o("div",{class:"order-text"},"下单用户",-1)),We={class:"order-value"},Me={class:"mb-24 flex"},Pe=f(()=>o("div",{class:"order-text"},"商户订单号",-1)),Ue={class:"order-value"},Le={class:"mb-24 flex"},Ye=f(()=>o("div",{class:"order-text"},"支付方式",-1)),Fe={class:"order-value"},qe={class:"mb-24 flex"},Re=f(()=>o("div",{class:"order-text"},"下单时间（香港）",-1)),Be={class:"order-value"},He=f(()=>o("div",{class:"order-line mt-42 mb-40"},null,-1)),Oe=f(()=>o("div",{class:"order-title mb-30"},"商品信息",-1)),Ee=me({__name:"Index",setup(g){const s=v({tradeState:"",payWay:"",channel:"",username:""}),z=v([]),w=v(!1),A=v([]),C=v([]),I=[{label:"待支付",value:"10"},{label:"支付成功",value:"20"},{label:"支付失败",value:"30"},{label:"取消支付",value:"40"},{label:"全额退款",value:"60"},{label:"部分退款",value:"61"}],D=v(!1),m=v({accountName:"",price:"",currency:"",bizNo:"",payWay:"",createdAt:""}),W=v("first"),{paginationData:b,handleCurrentChange:R,handSearch:B,tableData:H,queryTableData:je,loadingRef:O}=ne({searchData:s,url:"/traderecord/list",method:"post"}),E=()=>{s.value={}};function M(){const t=[];for(const a in s.value){let n=s.value[a];Array.isArray(n)&&(n=n.map(_=>ie.utc(new Date(_)).format("YYYY-MM-DD HH:mm:ss")).toString()),n&&t.push({columnName:a,value:n})}B(t)}const j=[{text:"Last week",value:()=>{const t=new Date,a=new Date;return a.setTime(a.getTime()-3600*1e3*24*7),[a,t]}},{text:"Last month",value:()=>{const t=new Date,a=new Date;return a.setTime(a.getTime()-3600*1e3*24*30),[a,t]}},{text:"Last 3 months",value:()=>{const t=new Date,a=new Date;return a.setTime(a.getTime()-3600*1e3*24*90),[a,t]}}],G=async()=>{try{const t=await se();A.value=t.data.map(a=>({name:a.code+"站点",value:a.code}))}catch(t){console.log(t,"e")}},K=async()=>{try{const t=await de();t.data&&t.data.length&&(C.value=t.data)}catch(t){console.log(t,"e")}},Z=t=>{var a;return(a=I.filter(n=>n.value===t)[0])==null?void 0:a.label},$=t=>{if(t==="10")return"order-wait";if(t==="20")return"order-success";if(t==="30")return"order-fail";if(t==="40")return"order-cancel";if(t==="50")return"order-refund";console.log(t,"value")},P=t=>{let a="";return C.value.forEach(n=>{n.code.toUpperCase()===t.toUpperCase()&&(a=n.name)}),a},J=t=>{const a={searchItems:[{columnName:"luTradeRecord",value:t}]};w.value=!0,ce(a).then(n=>{z.value=pe(n.data.rows)||[],w.value=!1}).catch(n=>{w.value=!1,console.log(n,"getProductApi")})},Q=t=>{J(t.id),m.value=t,D.value=!0};return _e(()=>{M(),G(),K()}),(t,a)=>{const n=u("el-option"),V=u("el-select"),_=u("el-form-item"),X=u("el-date-picker"),ee=u("el-input"),U=u("el-button"),ae=u("el-form"),c=u("el-table-column"),L=u("el-table"),te=u("el-pagination"),le=u("el-tab-pane"),oe=u("el-tabs"),re=q("permission"),Y=q("loading");return i(),h("div",ge,[o("div",we,[l(ae,{inline:!0,model:s.value,class:"demo-form-inline"},{default:r(()=>[l(_,null,{default:r(()=>[l(V,{modelValue:s.value.tradeState,"onUpdate:modelValue":a[0]||(a[0]=e=>s.value.tradeState=e),placeholder:"全部状态",clearable:""},{default:r(()=>[(i(),h(S,null,k(I,e=>l(n,{key:e.value,label:e.label,value:e.value},null,8,["label","value"])),64))]),_:1},8,["modelValue"])]),_:1}),l(_,null,{default:r(()=>[l(V,{modelValue:s.value.payWay,"onUpdate:modelValue":a[1]||(a[1]=e=>s.value.payWay=e),placeholder:"全部支付方式",clearable:""},{default:r(()=>[(i(!0),h(S,null,k(C.value,e=>(i(),y(n,{key:e.code,label:e.name,value:e.code},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),l(_,null,{default:r(()=>[l(V,{modelValue:s.value.channelName,"onUpdate:modelValue":a[2]||(a[2]=e=>s.value.channelName=e),placeholder:"全部支付通道",clearable:""},{default:r(()=>[(i(!0),h(S,null,k(A.value,e=>(i(),y(n,{key:e.value,label:e.name,value:e.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),l(_,null,{default:r(()=>[l(X,{modelValue:s.value.createdAt,"onUpdate:modelValue":a[3]||(a[3]=e=>s.value.createdAt=e),type:"daterange","unlink-panels":"","range-separator":"-","start-placeholder":"开始时间","end-placeholder":"结束时间",format:"YYYY-MM-DD",shortcuts:j,size:"default"},null,8,["modelValue"])]),_:1}),l(_,null,{default:r(()=>[l(ee,{modelValue:s.value.orderNo,"onUpdate:modelValue":a[4]||(a[4]=e=>s.value.orderNo=e),placeholder:"请输入订单号搜寻",clearable:""},null,8,["modelValue"])]),_:1}),l(_,null,{default:r(()=>[l(U,{type:"primary",onClick:E},{default:r(()=>[N("重置")]),_:1}),l(U,{type:"primary",onClick:M},{default:r(()=>[N("查询")]),_:1})]),_:1})]),_:1},8,["model"])]),o("div",Ve,[T((i(),y(L,{data:d(H),style:{width:"100%"}},{default:r(()=>[l(c,{prop:"merchant~merchantName",label:"站点名称",width:"150"}),l(c,{prop:"orderNo",label:"订单号",width:"280"}),l(c,{prop:"bizNo",label:"商户订单号",width:"280"}),l(c,{prop:"tradeState",label:"订单状态",width:"160"},{default:r(e=>[o("div",{class:ve($(e.row.tradeState))},p(Z(e.row.tradeState)),3)]),_:1}),l(c,{prop:"price",label:"订单金额",width:"180"},{default:r(e=>[d(x)(e.row.price,e.row.currencyMultiply)?(i(),h("span",xe,p(d(x)(e.row.price,e.row.currencyMultiply)+" "+e.row.currency),1)):fe("",!0)]),_:1}),l(c,{prop:"payWay",label:"支付方式",width:"180"},{default:r(e=>[N(p(P(e.row.payWay)),1)]),_:1}),l(c,{prop:"channelName",label:"通道名称",width:"100"}),l(c,{prop:"accountName",label:"下单用户",width:"220"}),l(c,{prop:"createdAt",label:"下单时间(香港)",width:"180"},{default:r(e=>[o("div",null,p(d(F)(e.row.createdAt)),1)]),_:1}),T((i(),y(c,{prop:"action",label:"操作",fixed:"right"},{default:r(e=>[o("div",{class:"action-btn cursor-pointer",onClick:Ge=>Q(e.row)},"查看详情",8,Ne)]),_:1})),[[re,["merchant","admin"]]])]),_:1},8,["data"])),[[Y,d(O)]])]),o("div",Ce,[l(te,{background:"",layout:d(b).layout,"page-sizes":d(b).pageSizes,total:d(b).total,"page-size":d(b).pageSize,currentPage:d(b).currentPage,onCurrentChange:d(R)},null,8,["layout","page-sizes","total","page-size","currentPage","onCurrentChange"])]),l(ue,{modelValue:D.value,"onUpdate:modelValue":a[6]||(a[6]=e=>D.value=e)},{default:r(()=>[o("div",De,[l(oe,{modelValue:W.value,"onUpdate:modelValue":a[5]||(a[5]=e=>W.value=e),class:"modal-tabs"},{default:r(()=>[l(le,{label:"订单详情",name:"first"},{default:r(()=>[Se,o("div",ke,[Te,o("div",ze,p(d(x)(t.scope.row.price,t.scope.row.currencyMultiply)+" "+m.value.currency),1)]),o("div",Ae,[Ie,o("div",We,p(m.value.accountName),1)]),o("div",Me,[Pe,o("div",Ue,p(m.value.bizNo),1)]),o("div",Le,[Ye,o("div",Fe,p(P(m.value.payWay)),1)]),o("div",qe,[Re,o("div",Be,p(d(F)(m.value.createdAt)),1)]),He,Oe,T((i(),y(L,{data:z.value,style:{width:"100%"}},{default:r(()=>[l(c,{prop:"name",label:"商品名称"}),l(c,{prop:"quantity",label:"商品数量"}),l(c,{prop:"price",label:"商品价格"},{default:r(e=>[N(p(d(x)(m.value.price,m.value.currencyMultiply)+" "+e.row.currency),1)]),_:1})]),_:1},8,["data"])),[[Y,w.value]])]),_:1})]),_:1},8,["modelValue"])])]),_:1},8,["modelValue"])])}}}),oa=ye(Ee,[["__scopeId","data-v-4fbcd672"]]);export{oa as default};
