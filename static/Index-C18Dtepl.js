import{l as te,r as p,aE as ae,d as le,ah as _,ap as se,m as f,p as h,q as a,T as r,U as l,O as o,a8 as oe,S as E,P as ne,u as c,M as q,I as P,R as b,aF as ie,aG as re}from"./vue-C87Wc4A0.js";import{_ as ce}from"./empty-BiNgvBdS.js";import{u as de}from"./useTable-CVQ-UVVt.js";import{e as ue,w as me,E as $,J as pe,N as _e,_ as fe}from"./index-c78MVIZI.js";import{_ as B}from"./Index.vue_vue_type_script_setup_true_lang-BhDJDWBy.js";import{F as ve}from"./Index-BU8kA-XB.js";import{V as he}from"./index-BZHf1ii5.js";import{n as be,E as T}from"./element-CD5rsoqi.js";import"//at.alicdn.com/t/c/font_4557022_0o7l3b0t8egq.js";import"./vxe-sm_XFqm0.js";import"./LIKU-logo-CHqxCLOK.js";const v=w=>(ie("data-v-f4065e83"),w=w(),re(),w),ge={class:"top-balance base-box flex items-center flex-wrap ml-40 mr-40 mt-20"},ye={class:"balance-item pr-80"},we=v(()=>a("div",{class:"item-title"},"站点总数",-1)),ke={class:"item-price mt-10 mb-8"},xe={class:"balance-item pr-80"},Ce=v(()=>a("div",{class:"item-title"},"已认证站点",-1)),Re={class:"item-price mt-10 mb-8"},Se={class:"balance-item"},Ie=v(()=>a("div",{class:"item-title"},"待审核站点",-1)),De={class:"item-price mt-10 mb-8"},Ve=v(()=>a("div",{class:"flex-1"},null,-1)),Ee={class:"order base-box p-36 ml-40 mr-40 mt-20"},Te={class:"top-search"},Ue={class:"table-wrapper"},Ne=v(()=>a("div",{class:"flex-center flex-col h-full",style:{height:"300px"}},[a("span",null,[a("img",{src:ce,alt:""})]),a("span",{class:"custom-empty-text"},"暂无数据")],-1)),Fe={key:0},ze={key:0},Ae={key:0},Me={key:0},je={class:"flex"},qe=["onClick"],Pe=["onClick"],$e=["onClick"],Be={class:"pager-wrapper mt-32 flex justify-between"},Ke=v(()=>a("div",null,null,-1)),Je={class:"base-box detail-box"},Oe=v(()=>a("div",{class:"risk-label w-full mb-12"},"风险保证金",-1)),Ge={class:"risk-value w-full mb-30 flex items-center"},He=v(()=>a("div",{class:"risk-label w-full mb-12"},"风险保证金金额",-1)),Le={class:"risk-value w-full mb-30 flex items-center"},Ze=v(()=>a("div",{class:"risk-label w-full mb-12"},"转账凭证",-1)),Qe={class:"w-full mb-30"},We={class:"flex-center mt-60"},Xe=te({__name:"Index",setup(w){let U={};const N=p(!1),F=JSON.parse(ue("user-info")||"{}"),z=ae(),K=p(),m=p({}),k=p({}),x=p(!1),C=p(!1),n=p({}),g=p({}),I=p(!1),{paginationData:y,handleCurrentChange:J,tableData:O,loadingRef:G,handSearch:H}=de({searchData:{},url:"/merchantapp/all",method:"post",onlyPage:!0});function R(){const t={};for(const s in m.value){const i=m.value[s];i&&(t[s]=i)}H(t)}const L=()=>{m.value={}},Z=async()=>{if(!n.value.processStatus){T.error("请选择认证审核状态");return}if(!n.value.challengeResult){T.error("请输入验证码");return}try{C.value=!0;const t={...U,claims:[{claimType:"approvalReason",claimValue:n.value.reason}],challengeResult:n.value.challengeResult,merchantId:g.value.virtualMerchantId};n.value.processStatus==="1"?t.isVerificated="1":t.isRejected="1",t[n.value.processStatus=="0"?"sendAppRejectEmail":"sendAppApproveEmail"]=1,await pe(t),x.value=!1,T.success("认证审核成功"),C.value=!1,R()}catch(t){C.value=!1,console.log(t,"processSubmit")}},d=(t,s)=>{var i;return(i=t==null?void 0:t.find(S=>S.claimType===s))==null?void 0:i.claimValue},D=(t,s)=>{if(g.value={...t},s==="process"){x.value=!0,I.value=d(t.claims,"isRisk")==="1",U={agentID:t.agentID,agentRate:t.agentRate,challengeId:t.challengeId,challengeResult:t.challengeResult,isDefault:t.isDefault,isEnabled:t.isEnabled,isRejected:t.isRejected,isVerificated:t.isVerificated,merchantId:t.merchantId,name:t.name,passwordChanged:t.passwordChanged,remark:t.remark,settledDays:t.settledDays};return}if(s==="management"){z.push({path:"/site/setting",query:{id:t.virtualMerchantId}});return}s==="config"&&z.push({path:"/site/config",query:{appId:t.appId}})},Q=async()=>{try{const t=await _e("1");k.value=t.data||{}}catch(t){console.log(t,"e")}};return le(()=>{N.value=F.SuperUser&&F.SuperUser==="1",Q(),R()}),(t,s)=>{const i=_("el-form-item"),S=_("el-input"),V=_("el-button"),A=_("el-form"),u=_("el-table-column"),W=_("el-pagination"),X=_("el-image"),M=_("el-option"),Y=_("el-select"),ee=se("loading");return f(),h("div",null,[a("div",ge,[a("div",ye,[we,a("div",ke,r(k.value.totalCount||0),1)]),a("div",xe,[Ce,a("div",Re,r(k.value.verifiedCount||0),1)]),a("div",Se,[Ie,a("div",De,r(k.value.approvingCount||0),1)]),Ve]),a("div",Ee,[a("div",Te,[l(A,{inline:!0,model:m.value,class:"demo-form-inline"},{default:o(()=>[l(i,null,{default:o(()=>[l(B,{placeholder:"全部站点状态",modelValue:m.value.merchantEnabled,"onUpdate:modelValue":s[0]||(s[0]=e=>m.value.merchantEnabled=e),type:"account"},null,8,["modelValue"])]),_:1}),l(i,null,{default:o(()=>[l(B,{placeholder:"全部认证状态",modelValue:m.value.merchantVerificated,"onUpdate:modelValue":s[1]||(s[1]=e=>m.value.merchantVerificated=e),type:"accountAuth"},null,8,["modelValue"])]),_:1}),l(i,null,{default:o(()=>[l(S,{modelValue:m.value.merchantName,"onUpdate:modelValue":s[2]||(s[2]=e=>m.value.merchantName=e),placeholder:"请输入站点名称",onKeyup:oe(R,["enter"]),clearable:"",maxlength:"30"},null,8,["modelValue"])]),_:1}),l(i,null,{default:o(()=>[l(V,{onClick:L},{default:o(()=>[E("重置")]),_:1}),l(V,{type:"primary",onClick:R},{default:o(()=>[E("查询")]),_:1})]),_:1})]),_:1},8,["model"])]),a("div",Ue,[ne((f(),q(c(be),{ref_key:"multipleTableRef",ref:K,data:c(O),style:{width:"100%"}},{empty:o(()=>[Ne]),default:o(()=>[l(u,{prop:"name",label:"站点名称","min-width":"180"}),l(u,{prop:"orderNo",label:"认证状态","min-width":"150"},{default:o(e=>[a("div",{class:P(e.row.isVerificated==="1"?"is-auth":"is-no-auth")},r(e.row.isVerificated==="1"?"已认证":"未认证"),3)]),_:1}),l(u,{prop:"bizNo",label:"站点状态","min-width":"100"},{default:o(e=>[a("div",{class:P(e.row.isEnabled==="1"?"":"disabled-status")},r(e.row.isEnabled==="1"?"正常":"禁用"),3)]),_:1}),l(u,{prop:"parentMerchantName",label:"所属商户","min-width":"150"}),l(u,{prop:"currency",label:"收款币种","min-width":"100"},{default:o(e=>[a("div",null,r(d(e.row.claims,"currency")),1)]),_:1}),l(u,{prop:"service_fee_percent",label:"收单费率","min-width":"180"},{default:o(e=>[d(e.row.claims,"service_fee_percent")?(f(),h("span",Fe,r((d(e.row.claims,"service_fee_percent")/10).toFixed(1)+" %"),1)):b("",!0)]),_:1}),l(u,{prop:"settledDays",label:"结算周期","min-width":"180"},{default:o(e=>[e.row.settledDays?(f(),h("span",ze,r("T + "+e.row.settledDays),1)):b("",!0)]),_:1}),l(u,{prop:"ecomChannel",label:"支付通道","min-width":"180"},{default:o(e=>[d(e.row.claims,"ecomChannel")?(f(),h("span",Ae,r(d(e.row.claims,"ecomChannel")+" 通道"),1)):b("",!0)]),_:1}),l(u,{prop:"createdAt",label:"加入时间","min-width":"180"},{default:o(e=>[a("div",null,r(c(me)(e.row.createdAt)),1)]),_:1}),l(u,{prop:"siteRemark",label:"备注","min-width":"180"},{default:o(e=>[d(e.row.claims,"siteRemark")?(f(),h("span",Me,r(d(e.row.claims,"siteRemark")),1)):b("",!0)]),_:1}),l(u,{prop:"action",label:"操作",fixed:"right","min-width":"220"},{default:o(e=>[a("div",je,[a("div",{class:"action-btn cursor-pointer mr-20",onClick:j=>D(e.row,"management")},"管理站点",8,qe),N.value?(f(),h("div",{key:0,class:"action-btn cursor-pointer mr-20",onClick:j=>D(e.row,"config")}," 系统配置 ",8,Pe)):b("",!0),e.row.isVerificated==="0"?(f(),h("div",{key:1,class:"action-btn cursor-pointer",onClick:j=>D(e.row,"process")}," 审核 ",8,$e)):b("",!0)])]),_:1})]),_:1},8,["data"])),[[ee,c(G)]])]),a("div",Be,[Ke,l(W,{background:"",layout:c(y).layout,"page-sizes":c(y).pageSizes,total:c(y).total,"page-size":c(y).pageSize,currentPage:c(y).currentPage,onCurrentChange:c(J)},null,8,["layout","page-sizes","total","page-size","currentPage","onCurrentChange"])]),l(ve,{modelValue:x.value,"onUpdate:modelValue":s[7]||(s[7]=e=>x.value=e)},{default:o(()=>[a("div",Je,[l(A,{"label-position":"top","label-width":"auto",model:n.value},{default:o(()=>[I.value?(f(),q(i,{key:0},{default:o(()=>[Oe,a("div",Ge,r(I.value?"已开启":"未开启"),1),He,a("div",Le,r(d(g.value.claims,"riskAmount")),1),Ze,a("div",Qe,[l(X,{style:{width:"100px",height:"100px"},src:c($)(d(g.value.claims,"credentialFile")),"zoom-rate":1.2,"max-scale":7,"min-scale":.2,"preview-src-list":[c($)(d(g.value.claims,"credentialFile"))],"initial-index":0,fit:"cover"},null,8,["src","preview-src-list"])])]),_:1})):b("",!0),l(i,{label:"认证审核操作"},{default:o(()=>[l(Y,{modelValue:n.value.processStatus,"onUpdate:modelValue":s[3]||(s[3]=e=>n.value.processStatus=e),placeholder:"请选择审核状态"},{default:o(()=>[l(M,{label:"审核通过",value:"1"}),l(M,{label:"审核不通过",value:"0"})]),_:1},8,["modelValue"])]),_:1}),l(i,{label:"驳回理由"},{default:o(()=>[l(S,{modelValue:n.value.reason,"onUpdate:modelValue":s[4]||(s[4]=e=>n.value.reason=e),type:"textarea",rows:3,placeholder:"请输入驳回理由",maxlength:"50"},null,8,["modelValue"])]),_:1}),l(he,{modelValue:n.value.challengeResult,"onUpdate:modelValue":s[5]||(s[5]=e=>n.value.challengeResult=e)},null,8,["modelValue"]),a("div",We,[l(V,{type:"primary",loading:C.value,onClick:s[6]||(s[6]=e=>Z())},{default:o(()=>[E("提交认证")]),_:1},8,["loading"])])]),_:1},8,["model"])])]),_:1},8,["modelValue"])])])}}}),dt=fe(Xe,[["__scopeId","data-v-f4065e83"]]);export{dt as default};
