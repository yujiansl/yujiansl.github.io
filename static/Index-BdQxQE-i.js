import{l as Ne,r as _,aE as Re,Z as De,d as Ae,ah as h,ap as Ie,m as u,p as f,q as e,T as i,U as t,O as s,S as g,P as M,V as P,F as q,a7 as E,M as N,a8 as ze,u as d,I as O,R as V,aF as Be,aG as Le}from"./vue-C87Wc4A0.js";import{_ as _e}from"./empty-BiNgvBdS.js";import{u as Me}from"./useTable-CVQ-UVVt.js";import{B as Z,q as R,W as de,w as ie,C as re,E as ue,x as Pe,k as qe,_ as Ee}from"./index-c78MVIZI.js";import{F as G}from"./Index-BU8kA-XB.js";import{U as ce}from"./Index-DqM0qE4v.js";import{e as We,f as $e,a as je}from"./index-Cap7k8T_.js";import{V as me}from"./index-BZHf1ii5.js";import{b as Ke,a as Oe}from"./index-CKZZcXKM.js";import{n as ve,E as H}from"./element-CD5rsoqi.js";import"//at.alicdn.com/t/c/font_4557022_0o7l3b0t8egq.js";import"./vxe-sm_XFqm0.js";import"./LIKU-logo-CHqxCLOK.js";const n=D=>(Be("data-v-3b85f316"),D=D(),Le(),D),Ze={class:"top-balance base-box flex flex-wrap ml-40 mr-40 mt-20 items-center"},Ge={class:"balance-item pr-80"},He=n(()=>e("div",{class:"item-title"},"系统未入账 (USD)",-1)),Je={class:"item-price mt-10 mb-8"},Qe={class:"balance-item pr-80"},Xe=n(()=>e("div",{class:"item-title"},"商户未入账 (USD)",-1)),Ye={class:"item-price mt-10 mb-8"},el={class:"balance-item pr-80"},ll=n(()=>e("div",{class:"item-title"},"待审核金额 (USD)",-1)),tl={class:"item-price mt-10 mb-8"},al={class:"balance-item"},sl=n(()=>e("div",{class:"item-title"},"已入账未结算 (USD)",-1)),ol={class:"item-price mt-10 mb-8"},nl={class:"order base-box p-36 ml-40 mr-40 mt-20"},dl={class:"top-search"},il={class:"table-wrapper"},rl=n(()=>e("div",{class:"flex-center flex-col h-full",style:{height:"300px"}},[e("span",null,[e("img",{src:_e,alt:""})]),e("span",{class:"custom-empty-text"},"暂无数据")],-1)),ul={key:0},cl={key:0},ml={class:"flex"},vl=["onClick"],_l=["onClick"],pl=n(()=>e("div",{class:"flex-center flex-col h-full",style:{height:"300px"}},[e("span",null,[e("img",{src:_e,alt:""})]),e("span",{class:"custom-empty-text"},"暂无数据")],-1)),hl=["onClick"],fl={class:"pager-wrapper mt-32 flex justify-between"},bl=n(()=>e("div",null,null,-1)),gl={class:"base-box detail-box"},xl=n(()=>e("div",{class:"detail-title mb-50"},"创建结算账单",-1)),wl={class:"flex-center mt-60"},yl={class:"base-box detail-box"},Vl=n(()=>e("div",{class:"detail-title mb-50"},"结算账单详情",-1)),Cl={class:"mb-24 flex"},kl=n(()=>e("div",{class:"order-text"},"结算批次号：",-1)),Fl={class:"order-value"},Sl={class:"mb-24 flex"},Ul=n(()=>e("div",{class:"order-text"},"结算状态：",-1)),Tl={class:"order-value"},Nl={class:"mb-24 flex"},Rl=n(()=>e("div",{class:"order-text"},"结算金额：",-1)),Dl={class:"order-value"},Al={class:"mb-24 flex"},Il=n(()=>e("div",{class:"order-text"},"订单笔数：",-1)),zl={class:"order-value"},Bl=n(()=>e("div",{class:"mb-24 flex"},[e("div",{class:"order-text"},"结算手续费："),e("div",{class:"order-value"},"0")],-1)),Ll=n(()=>e("div",{class:"order-line mt-42 mb-40"},null,-1)),Ml={key:0},Pl={class:"mb-24 flex"},ql=n(()=>e("div",{class:"order-text"},"结算收款账户：",-1)),El={class:"order-value"},Wl={class:"mb-24 flex"},$l=n(()=>e("div",{class:"order-text"},"申请结算时间：",-1)),jl={class:"order-value"},Kl={key:0,class:"mb-24 flex"},Ol=n(()=>e("div",{class:"order-text"},"结算打款凭证：",-1)),Zl={class:"order-value"},Gl=n(()=>e("div",{class:"order-line mt-42 mb-40"},null,-1)),Hl={key:1},Jl={class:"flex-center mt-60"},Ql={class:"base-box detail-box"},Xl=n(()=>e("div",{class:"detail-title mb-50"},"结算账单",-1)),Yl={class:"mb-24 flex"},et=n(()=>e("div",{class:"order-text"},"结算批次号：",-1)),lt={class:"order-value"},tt={class:"mb-24 flex"},at=n(()=>e("div",{class:"order-text"},"结算状态：",-1)),st={class:"order-value"},ot={class:"mb-24 flex"},nt=n(()=>e("div",{class:"order-text"},"结算金额：",-1)),dt={class:"order-value"},it={class:"mb-24 flex"},rt=n(()=>e("div",{class:"order-text"},"订单币种金额：",-1)),ut={class:"order-value"},ct={class:"mb-24 flex"},mt=n(()=>e("div",{class:"order-text"},"实际入账金额：",-1)),vt={class:"order-value"},_t={class:"mb-24 flex"},pt=n(()=>e("div",{class:"order-text"},"订单笔数：",-1)),ht={class:"order-value"},ft={class:"mb-24 flex"},bt=n(()=>e("div",{class:"order-text"},"收单手续费：",-1)),gt={class:"order-value"},xt={class:"mb-24 flex"},wt=n(()=>e("div",{class:"order-text"},"结算手续费：",-1)),yt={class:"order-value"},Vt=n(()=>e("div",{class:"order-line mt-42 mb-40"},null,-1)),Ct={class:"mb-24 flex"},kt=n(()=>e("div",{class:"order-text"},"实际结算金额：",-1)),Ft={class:"order-value"},St={class:"flex-center mt-60"},Ut=Ne({__name:"Index",setup(D){const w=_("first"),J=_([]),y=_({}),pe=Re(),c=_({channelCode:"",processNo:"",channel:"",username:""}),Q=_(""),S=_({}),m=_({documentFile:"",challengeResult:"",type:"",remark:""}),he=De({channelCode:[{required:!0,message:"请选择上游通道",trigger:"change"}],settlementTotal:[{required:!0,message:"请输入实际入账金额",trigger:"blur"}],challengeResult:[{required:!0,message:"请输入验证码",trigger:"change"}]}),W=_(!1),$=_(null),b=_({channelCode:"",settlementCurrency:"",settlementFile:"",settlementTotal:"",type:"",challengeResult:""}),j=_([]),A=_(!1),I=_(!1),X=_(!1),z=_(!1),r=_({}),K=[{label:"可结算",value:"10"},{label:"审核中",value:"20"},{label:"已结算",value:"30"}],{paginationData:U,handleCurrentChange:fe,tableData:Y,queryTableData:be,loadingRef:ee,handSearch:ge}=Me({searchData:c.value,url:"/settlement/list",method:"post"});function C(){const o=[];for(const a in c.value){const k=c.value[a];k&&o.push({columnName:a,value:k})}ge(o,w.value==="first"?"/settlement/list":"/settlementprocess/list")}const xe=async()=>{try{const o=await Pe();j.value=o.data.map(a=>({name:a.code,value:a.code}))}catch(o){console.log(o,"e")}},le=()=>{c.value={}},we=o=>{pe.push({name:"balanceConfirm",query:{processNo:o}})},te=async()=>{try{z.value=!0;const o={documentFile:m.value.documentFile,challengeResult:m.value.challengeResult,remark:m.value.remark,state:"30"},a=await Ke(o,y.value.id);H.success("提交成功"),A.value=!1,z.value=!1,m.value={},C(),console.log(a,"res")}catch(o){z.value=!1,console.log(o,"createBalance")}},ye=async o=>{o&&await o.validate(async(a,k)=>{if(!b.value.settlementFile){H.error("请上传上游账单");return}if(a){W.value=!0;try{await We(b.value),H.success("上传上游账单成功"),W.value=!1,I.value=!1,w.value="second",be("/settlementprocess/list")}catch{W.value=!1}}else console.log("error submit!",k)})},Ve=()=>{var o;(o=$.value)==null||o.resetFields(),I.value=!0},ae=(o,a)=>{Q.value=a,o.state!=="10"&&Fe(o.luWithdraw),r.value=o,A.value=!0},Ce=async()=>{try{const o=await $e();S.value=o.data||{}}catch(o){console.log("getStaticsData",o)}},ke=async()=>{try{const o=await je({paging:{pageNumber:1,pageSize:200}});J.value=o.data.items}catch{}},Fe=async o=>{try{const a=await Oe({paging:{pageNumber:1,pageSize:30}},o);y.value=qe(a.data.rows)[0]||{}}catch(a){console.log(a,"getWithdrawList")}};return Ae(()=>{C(),ke(),xe(),Ce()}),(o,a)=>{const k=h("SvgIcon"),x=h("el-button"),se=h("el-tab-pane"),Se=h("el-tabs"),B=h("el-option"),L=h("el-select"),p=h("el-form-item"),F=h("el-input"),T=h("el-form"),v=h("el-table-column"),Ue=h("el-pagination"),Te=h("el-image"),oe=Ie("loading");return u(),f("div",null,[e("div",Ze,[e("div",Ge,[He,e("div",Je,i(S.value.onAir),1)]),e("div",Qe,[Xe,e("div",Ye,i(S.value.merchantOnAir),1)]),e("div",el,[ll,e("div",tl,i(S.value.approving),1)]),e("div",al,[sl,e("div",ol,i(S.value.settled),1)]),t(x,{type:"primary",onClick:Ve,style:{height:"50px"},class:"flex-center"},{default:s(()=>[t(k,{class:"mr-8",name:"icon-tianjiaxinzhandian"}),g(" 创建结算账单 ")]),_:1})]),e("div",nl,[t(Se,{modelValue:w.value,"onUpdate:modelValue":a[0]||(a[0]=l=>w.value=l),class:"",onTabChange:C},{default:s(()=>[t(se,{label:"结算账单记录",name:"first"}),t(se,{label:"通道结算账单记录",name:"second"})]),_:1},8,["modelValue"]),e("div",dl,[M(t(T,{inline:!0,model:c.value,class:"demo-form-inline"},{default:s(()=>[t(p,null,{default:s(()=>[t(L,{modelValue:c.value.luVirtualMerchant,"onUpdate:modelValue":a[1]||(a[1]=l=>c.value.luVirtualMerchant=l),placeholder:"全部站点",clearable:""},{default:s(()=>[(u(!0),f(q,null,E(J.value,l=>(u(),N(B,{key:l.virtualMerchantId,label:l.name,value:l.virtualMerchantId},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),t(p,null,{default:s(()=>[t(L,{modelValue:c.value.state,"onUpdate:modelValue":a[2]||(a[2]=l=>c.value.state=l),placeholder:"全部结算状态",clearable:""},{default:s(()=>[(u(),f(q,null,E(K,l=>t(B,{key:l.value,label:l.label,value:l.value},null,8,["label","value"])),64))]),_:1},8,["modelValue"])]),_:1}),t(p,null,{default:s(()=>[t(F,{modelValue:c.value.settlementProcessNo,"onUpdate:modelValue":a[3]||(a[3]=l=>c.value.settlementProcessNo=l),placeholder:"请输入结算批次号搜寻",clearable:""},null,8,["modelValue"])]),_:1}),t(p,null,{default:s(()=>[t(x,{onClick:le},{default:s(()=>[g("重置")]),_:1}),t(x,{type:"primary",onClick:C},{default:s(()=>[g("查询")]),_:1})]),_:1})]),_:1},8,["model"]),[[P,w.value==="first"]]),M(t(T,{inline:!0,model:c.value,class:"demo-form-inline"},{default:s(()=>[t(p,null,{default:s(()=>[t(L,{modelValue:c.value.channelCode,"onUpdate:modelValue":a[4]||(a[4]=l=>c.value.channelCode=l),placeholder:"通道名称",clearable:""},{default:s(()=>[(u(!0),f(q,null,E(j.value,l=>(u(),N(B,{key:l.value,label:l.name,value:l.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),t(p,null,{default:s(()=>[t(F,{modelValue:c.value.processNo,"onUpdate:modelValue":a[5]||(a[5]=l=>c.value.processNo=l),placeholder:"请输入结算批次号搜寻",onKeyup:ze(C,["enter"]),clearable:""},null,8,["modelValue"])]),_:1}),t(p,null,{default:s(()=>[t(x,{onClick:le},{default:s(()=>[g("重置")]),_:1}),t(x,{type:"primary",onClick:C},{default:s(()=>[g("查询")]),_:1})]),_:1})]),_:1},8,["model"]),[[P,w.value==="second"]])]),e("div",il,[M((u(),N(d(ve),{data:d(Y),style:{width:"100%"}},{empty:s(()=>[rl]),default:s(()=>[t(v,{prop:"settlementProcessNo",label:"结算批次号","min-width":"200"}),t(v,{prop:"state",label:"结算状态",width:"100"},{default:s(l=>[e("div",{class:O(d(Z)(l.row.state).class)},i(d(Z)(l.row.state).value),3)]),_:1}),t(v,{prop:"virtualMerchant~merchantName",label:"站点名称",width:"150"}),t(v,{prop:"merchant~merchantName",label:"商户名称",width:"150"}),t(v,{prop:"agent~agentName",label:"代理名称",width:"150"}),t(v,{prop:"settlementTotal",label:"结算金额",width:"200"},{default:s(l=>[d(R)(l.row.settlementTotal)?(u(),f("span",ul,i(d(R)(l.row.settlementTotal)+" "+l.row.settlementCurrency),1)):V("",!0)]),_:1}),t(v,{prop:"orderTotal",label:"订单币种金额",width:"200"},{default:s(l=>[d(R)(l.row.orderTotal,l.row.orderCurrencyMultiply)?(u(),f("span",cl,i(d(R)(l.row.orderTotal,l.row.orderCurrencyMultiply)+" "+l.row.orderCurrency),1)):V("",!0)]),_:1}),t(v,{prop:"averageExchangeRate",label:"汇率",width:"200"},{default:s(l=>[e("div",null,i((+l.row.averageExchangeRate).toFixed(6)),1)]),_:1}),t(v,{prop:"orderCount",label:"订单笔数",width:"100"}),t(v,{prop:"action",label:"操作",fixed:"right",width:"150"},{default:s(l=>[e("div",ml,[l.row.state==="20"?(u(),f("div",{key:0,class:"action-btn cursor-pointer mr-20",onClick:ne=>ae(l.row,"auth")}," 审核 ",8,vl)):V("",!0),e("div",{class:"action-btn cursor-pointer",onClick:ne=>ae(l.row,"detail")},"查看详情",8,_l)])]),_:1})]),_:1},8,["data"])),[[P,w.value==="first"],[oe,d(ee)]]),M((u(),N(d(ve),{data:d(Y),style:{width:"100%"}},{empty:s(()=>[pl]),default:s(()=>[t(v,{prop:"processNo",label:"结算批次号",width:"200"}),t(v,{prop:"state",label:"状态",width:"100"},{default:s(l=>[e("div",{class:O(d(de)(l.row.state).class)},i(d(de)(l.row.state).value),3)]),_:1}),t(v,{prop:"channelCode",label:"通道名称",width:"200"},{default:s(l=>[g(i(l.row.channelCode+"通道"),1)]),_:1}),t(v,{prop:"settlementTotal",label:"结算金额",width:"200"},{default:s(l=>[g(i(((l.row.settlementTotal||0)/100).toFixed(2)+"USD"),1)]),_:1}),t(v,{prop:"createdAt",label:"结算日期",width:"200"},{default:s(l=>[g(i(d(ie)(l.row.createdAt)),1)]),_:1}),t(v,{prop:"action",label:"操作",fixed:"right",width:"100"},{default:s(l=>[l.row.state.toString()==="20"?(u(),f("div",{key:0,class:"action-btn cursor-pointer",onClick:ne=>we(l.row.processNo)}," 确认账单 ",8,hl)):V("",!0)]),_:1})]),_:1},8,["data"])),[[P,w.value==="second"],[oe,d(ee)]])]),e("div",fl,[bl,t(Ue,{background:"",layout:d(U).layout,"page-sizes":d(U).pageSizes,total:d(U).total,"page-size":d(U).pageSize,currentPage:d(U).currentPage,onCurrentChange:d(fe)},null,8,["layout","page-sizes","total","page-size","currentPage","onCurrentChange"])]),t(G,{modelValue:I.value,"onUpdate:modelValue":a[11]||(a[11]=l=>I.value=l)},{default:s(()=>[e("div",gl,[xl,t(T,{"label-position":"top","label-width":"auto",ref_key:"billFormRef",ref:$,rules:he,model:b.value},{default:s(()=>[t(p,{label:"选择上游通道",prop:"channelCode"},{default:s(()=>[t(L,{modelValue:b.value.channelCode,"onUpdate:modelValue":a[6]||(a[6]=l=>b.value.channelCode=l),placeholder:"请选择上游通道"},{default:s(()=>[(u(!0),f(q,null,E(j.value,l=>(u(),N(B,{key:l.value,label:l.name+"通道",value:l.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),t(p,{label:"上传上游账单",prop:"settlementFile"},{default:s(()=>[t(ce,{modelValue:b.value.settlementFile,"onUpdate:modelValue":a[7]||(a[7]=l=>b.value.settlementFile=l),id:"settlementFile",ext:"excel"},null,8,["modelValue"])]),_:1}),t(p,{label:"实际入账金额",prop:"settlementTotal"},{default:s(()=>[t(F,{modelValue:b.value.settlementTotal,"onUpdate:modelValue":a[8]||(a[8]=l=>b.value.settlementTotal=l),placeholder:"请输入实际入账金额",maxlength:"11"},null,8,["modelValue"])]),_:1}),t(me,{modelValue:b.value.challengeResult,"onUpdate:modelValue":a[9]||(a[9]=l=>b.value.challengeResult=l)},null,8,["modelValue"]),e("div",wl,[t(x,{type:"primary",onClick:a[10]||(a[10]=l=>ye($.value))},{default:s(()=>[g("上传上游账单")]),_:1})])]),_:1},8,["rules","model"])])]),_:1},8,["modelValue"]),t(G,{modelValue:A.value,"onUpdate:modelValue":a[15]||(a[15]=l=>A.value=l)},{default:s(()=>[e("div",yl,[Vl,e("div",Cl,[kl,e("div",Fl,i(r.value.settlementProcessNo),1)]),e("div",Sl,[Ul,e("div",Tl,[e("div",{class:O(d(Z)(r.value.state).class)},i(d(re)(r.value.state,K)),3)])]),e("div",Nl,[Rl,e("div",Dl,i(d(R)(r.value.settlementTotal)+" "+r.value.settlementCurrency),1)]),e("div",Al,[Il,e("div",zl,i(r.value.orderCount),1)]),Bl,Ll,r.value.state!=="10"?(u(),f("div",Ml,[e("div",Pl,[ql,e("div",El,i(y.value["settlementAccount~accountName"]||""),1)]),e("div",Wl,[$l,e("div",jl,i(d(ie)(y.value.createdAt||"")),1)]),r.value.state==="30"?(u(),f("div",Kl,[Ol,e("div",Zl,[t(Te,{style:{width:"100px",height:"100px"},src:d(ue)(y.value.documentFile),"zoom-rate":1.2,"max-scale":7,"min-scale":.2,"preview-src-list":[d(ue)(y.value.documentFile)],"initial-index":0,fit:"cover"},null,8,["src","preview-src-list"])])])):V("",!0),Gl])):V("",!0),r.value.state==="20"&&Q.value==="auth"?(u(),f("div",Hl,[t(T,{"label-position":"top","label-width":"auto",model:m.value},{default:s(()=>[t(p,{label:"结算打款凭证"},{default:s(()=>[t(ce,{modelValue:m.value.documentFile,"onUpdate:modelValue":a[12]||(a[12]=l=>m.value.documentFile=l),id:"documentFile",ext:"img"},null,8,["modelValue"])]),_:1}),t(p,{label:"结算备注"},{default:s(()=>[t(F,{modelValue:m.value.remark,"onUpdate:modelValue":a[13]||(a[13]=l=>m.value.remark=l),placeholder:"请输入结算备注",maxlength:"50"},null,8,["modelValue"])]),_:1}),t(me,{modelValue:m.value.challengeResult,"onUpdate:modelValue":a[14]||(a[14]=l=>m.value.challengeResult=l)},null,8,["modelValue"]),e("div",Jl,[t(x,{type:"primary",loading:z.value,onClick:te},{default:s(()=>[g("确认并申请结算")]),_:1},8,["loading"])])]),_:1},8,["model"])])):V("",!0)])]),_:1},8,["modelValue"]),t(G,{modelValue:X.value,"onUpdate:modelValue":a[18]||(a[18]=l=>X.value=l)},{default:s(()=>[e("div",Ql,[Xl,e("div",Yl,[et,e("div",lt,i(r.value.settlementProcessNo),1)]),e("div",tt,[at,e("div",st,i(d(re)(r.value.state,K)),1)]),e("div",ot,[nt,e("div",dt,i(r.value.settlementTotal),1)]),e("div",it,[rt,e("div",ut,i(r.value.orderTotal),1)]),e("div",ct,[mt,e("div",vt,i(r.value.createdAt),1)]),e("div",_t,[pt,e("div",ht,i(r.value.orderCount),1)]),e("div",ft,[bt,e("div",gt,i(r.value.orderServiceFee),1)]),e("div",xt,[wt,e("div",yt,i(y.value.settlementFee||r.value.settlementServiceFee),1)]),Vt,e("div",Ct,[kt,e("div",Ft,i(r.value.accountName),1)]),e("div",null,[t(T,{"label-position":"top","label-width":"auto",model:m.value},{default:s(()=>[t(p,{label:"结算收款账户"},{default:s(()=>[t(F,{modelValue:m.value.account,"onUpdate:modelValue":a[16]||(a[16]=l=>m.value.account=l),maxlength:"50"},null,8,["modelValue"])]),_:1}),t(p,{label:"谷歌验证码"},{default:s(()=>[t(F,{modelValue:m.value.code,"onUpdate:modelValue":a[17]||(a[17]=l=>m.value.code=l),maxlength:"6"},null,8,["modelValue"])]),_:1}),e("div",St,[t(x,{type:"primary",onClick:te},{default:s(()=>[g("确认并申请结算")]),_:1})])]),_:1},8,["model"])])])]),_:1},8,["modelValue"])])])}}}),Wt=Ee(Ut,[["__scopeId","data-v-3b85f316"]]);export{Wt as default};
