import{e as i,h as y,_ as M}from"./index-bEAPwbJM.js";import{E as m}from"./element-BbMnn7tA.js";import{l as b,aK as x,r as t,aL as E,d as B,b as N,ah as p,m as d,M as T,O,q as v,T as f,p as _,U as g}from"./vue-BtEXIrqH.js";const S={class:"label"},U={key:0,class:"w-full"},J={key:1,class:"relative w-full"},L=b({__name:"index",props:{modelValue:{},modelModifiers:{}},emits:x(["getChallengeId"],["update:modelValue"]),setup(h,{emit:V}){const n=t(!1),C=JSON.parse(i("user-info")||"{}"),I=V,w=E(h,"modelValue"),l=t(""),o=t("发送验证码"),c=t(!1),k=async()=>{if(c.value)return;c.value=!0,o.value="发送中";const e={challengeType:"EmailConfirmCode",email:C.name};try{const s=(await y(e)).data.challengeId;I("getChallengeId",s),m({message:"验证码已发送",type:"success"}),o.value=60;const r=window.setInterval(()=>{o.value--<=0&&(o.value="发送验证码",c.value=!1,window.clearInterval(r))},1e3)}catch(a){console.log(a,"e"),m.error("获取验证码失败，请稍后再试")}};return B(()=>{const e=JSON.parse(i("user-info")||"{}");n.value=e["otp.enabled"]&&e["otp.enabled"]==="1"}),N(()=>l.value,e=>{w.value=e}),(e,a)=>{const s=p("el-input"),r=p("el-form-item");return d(),T(r,{prop:"challengeResult"},{default:O(()=>[v("div",S,f(n.value?"谷歌验证码":"邮箱验证码"),1),n.value?(d(),_("div",U,[g(s,{modelValue:l.value,"onUpdate:modelValue":a[0]||(a[0]=u=>l.value=u),placeholder:"请输入谷歌验证码"},null,8,["modelValue"])])):(d(),_("div",J,[g(s,{modelValue:l.value,"onUpdate:modelValue":a[1]||(a[1]=u=>l.value=u),placeholder:"请输入邮箱验证码"},null,8,["modelValue"]),v("span",{onClick:k,class:"absolute abs-center code"},f(o.value),1)]))]),_:1})}}}),F=M(L,[["__scopeId","data-v-7c9f8cdc"]]);export{F as V};
