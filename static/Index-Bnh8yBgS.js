import{m as Y,j as ee}from"./index-B3sZ9j6O.js";import{u as te}from"./useTable-Br0VH9YA.js";import{_ as z,f as oe}from"./index-bEAPwbJM.js";import{l as A,aK as le,aD as ae,r as c,Z as T,aL as se,ah as u,m as f,M as B,O as l,q as t,U as e,p as b,F as ne,a7 as ie,S as D,aF as P,aG as q,aE as re,d as ce,ap as de,T as M,P as ue,u as _,R as me}from"./vue-BtEXIrqH.js";import{_ as N}from"./Index.vue_vue_type_script_setup_true_lang-CAnY41O0.js";import pe from"./Setting-Ndm7jeH2.js";import{F as _e}from"./Index-BgrOBixy.js";import{E as j,n as fe}from"./element-BbMnn7tA.js";import{c as ve}from"./commonFn-DSVr4W-5.js";import"//at.alicdn.com/t/c/font_4557022_266y8yxi6v9.js";import"./vxe-EK889JN8.js";import"./useEnterprise-euz5rIMR.js";import"./index-Cuh9gsAM.js";import"./Index-DjrcDC4L.js";import"./validate-riIxJwdE.js";import"./LIKU-logo-BbnHVERV.js";const he=m=>(P("data-v-b185e954"),m=m(),q(),m),be={class:"flex-1 form-with-title"},Ve=he(()=>t("div",{class:"detail-title"},"商户认证审核",-1)),ge={class:"base-box detail-box"},ye={class:"flex-center w-full mt-30"},we=A({__name:"Verification",props:le({id:{}},{modelValue:{},modelModifiers:{}}),emits:["update:modelValue"],setup(m){const I=m;ae();const k=c(),r=T({merchantId:"",isRejected:"0",isVerificated:"1",approvalReason:"",challengeResult:""}),d=T({challengeResult:[{required:!0,message:"请输入谷歌验证码",trigger:"blur"}]}),C=[{value:"0",label:"审核不通过"},{value:"1",label:"审核通过"}],V=se(m,"modelValue"),x=async g=>{g&&await g.validate((n,y)=>{if(n)try{r.isVerificated=="0"?r.isRejected="1":r.isRejected="0",r.merchantId=I.id,Y(r).then(()=>{j.success("保存成功")}).catch(v=>{j.error("操作失败"),console.error(v)})}catch(v){console.error(v)}else console.error("error submit!",y)})};return(g,n)=>{const y=u("el-option"),v=u("el-select"),p=u("el-form-item"),R=u("el-input"),U=u("el-button"),$=u("el-form");return f(),B(_e,{modelValue:V.value,"onUpdate:modelValue":n[4]||(n[4]=i=>V.value=i)},{default:l(()=>[t("div",be,[Ve,t("div",ge,[e($,{ref_key:"modifyMerchantFormRef",ref:k,"label-position":"top",rules:d,"label-width":"auto",model:r},{default:l(()=>[e(p,{prop:"isRejected",label:"认证审核操作"},{default:l(()=>[e(v,{modelValue:r.isVerificated,"onUpdate:modelValue":n[0]||(n[0]=i=>r.isVerificated=i)},{default:l(()=>[(f(),b(ne,null,ie(C,i=>e(y,{key:i.value,label:i.label,value:i.value},null,8,["label","value"])),64))]),_:1},8,["modelValue"])]),_:1}),e(p,{prop:"remark",label:"驳回理由"},{default:l(()=>[e(R,{modelValue:r.approvalReason,"onUpdate:modelValue":n[1]||(n[1]=i=>r.approvalReason=i),placeholder:"请输入驳回理由",type:"textarea",rows:3,maxlength:"50"},null,8,["modelValue"])]),_:1}),e(p,{prop:"challengeResult",label:"谷歌验证码"},{default:l(()=>[e(R,{modelValue:r.challengeResult,"onUpdate:modelValue":n[2]||(n[2]=i=>r.challengeResult=i),placeholder:"请输入谷歌验证码",minlength:"6",maxlength:"6"},null,8,["modelValue"])]),_:1}),e(p,null,{default:l(()=>[t("div",ye,[e(U,{type:"primary",onClick:n[3]||(n[3]=i=>x(k.value))},{default:l(()=>[D("保存")]),_:1})])]),_:1})]),_:1},8,["rules","model"])])])]),_:1},8,["modelValue"])}}}),Ce=z(we,[["__scopeId","data-v-b185e954"]]),S=m=>(P("data-v-37b2843e"),m=m(),q(),m),xe={class:"top-balance base-box flex items-center flex-wrap ml-40 mr-40 mt-20"},ke={class:"balance-item pr-80"},Re=S(()=>t("div",{class:"item-title"},"商户总数",-1)),Me={class:"item-price mt-10 mb-8"},Se={class:"balance-item pr-80"},Ie=S(()=>t("div",{class:"item-title"},"已认证商户",-1)),Ue={class:"item-price mt-10 mb-8"},$e={class:"balance-item"},De=S(()=>t("div",{class:"item-title"},"待审核商户",-1)),Ee={class:"item-price mt-10 mb-8"},Fe=S(()=>t("div",{class:"flex-1"},null,-1)),Te={class:"order base-box p-36 ml-40 mr-40 mt-20"},Ne={class:"top-search"},je={class:"table-wrapper"},ze={key:0,class:"verificated flex-center"},Ae={key:1,class:"not-verificated flex-center"},Be={key:0},Pe={key:1,class:"lockout-status-text"},qe={class:"flex"},Ge=["onClick"],Ke=["onClick"],Le=["onClick"],Oe={class:"pager-wrapper mt-32 flex justify-between"},Ze=A({__name:"Index",setup(m){const I=c(),k=oe(),r=re(),d=c({});c([]),c([]);const C=c(!1),V=c(!1);c(!1);const x=c({}),g=c(""),n=c(0),y=c(0),v=c(0),{paginationData:p,handleCurrentChange:R,tableData:U,loadingRef:$,handSearch:i}=te({searchData:{},url:"/merchant/list",method:"post"}),G=async a=>{try{let s=await k.login({refresh:!0},a);await r.push("/"),location.reload()}catch(s){console.log(s,"e")}};function K(){const a=[];for(const s in d.value){const h=d.value[s];h&&a.push({columnName:s,value:h})}i(a)}const L=()=>{d.value={}},O=a=>{x.value=a,x.value.isEnabled=a.isEnabled=="1",V.value=!0},Z=a=>{g.value=a.id,C.value=!0},H=async()=>{try{ee(0).then(a=>{n.value=a.data.totalCount,y.value=a.data.verificatedCount,v.value=a.data.reviewingCount}).catch(a=>{console.error(a)})}catch(a){console.error(a)}};return ce(()=>{i(),H()}),(a,s)=>{const h=u("el-form-item"),J=u("el-input"),E=u("el-button"),Q=u("el-form"),w=u("el-table-column"),W=u("el-pagination"),X=de("loading");return f(),b("div",null,[t("div",xe,[t("div",ke,[Re,t("div",Me,M(n.value),1)]),t("div",Se,[Ie,t("div",Ue,M(y.value),1)]),t("div",$e,[De,t("div",Ee,M(v.value),1)]),Fe]),t("div",Te,[t("div",Ne,[e(Q,{inline:!0,model:d.value,class:"demo-form-inline"},{default:l(()=>[e(h,null,{default:l(()=>[e(N,{placeholder:"全部认证状态",modelValue:d.value.isVerificated,"onUpdate:modelValue":s[0]||(s[0]=o=>d.value.isVerificated=o),type:"accountAuth"},null,8,["modelValue"])]),_:1}),e(h,null,{default:l(()=>[e(N,{placeholder:"全部账户状态",modelValue:d.value.isEnabled,"onUpdate:modelValue":s[1]||(s[1]=o=>d.value.isEnabled=o),type:"account"},null,8,["modelValue"])]),_:1}),e(h,null,{default:l(()=>[e(J,{modelValue:d.value.merchantName,"onUpdate:modelValue":s[2]||(s[2]=o=>d.value.merchantName=o),placeholder:"请输入商户名称",clearable:""},null,8,["modelValue"])]),_:1}),e(h,null,{default:l(()=>[e(E,{type:"primary",onClick:L},{default:l(()=>[D("重置")]),_:1}),e(E,{type:"primary",onClick:K},{default:l(()=>[D("查询")]),_:1})]),_:1})]),_:1},8,["model"])]),t("div",je,[ue((f(),B(_(fe),{ref_key:"multipleTableRef",ref:I,data:_(U),style:{width:"100%"}},{default:l(()=>[e(w,{prop:"merchantName",label:"商户名称"}),e(w,{prop:"merchantAppCount",label:"站点数",width:"100"}),e(w,{prop:"isVerificated",label:"认证状态"},{default:l(o=>[o.row.isVerificated=="1"?(f(),b("div",ze," 已认证 ")):(f(),b("div",Ae," 未认证 "))]),_:1}),e(w,{prop:"isEnabled",label:"账户状态"},{default:l(o=>[o.row.isEnabled=="1"?(f(),b("div",Be," 正常 ")):(f(),b("div",Pe," 禁用 "))]),_:1}),e(w,{prop:"createdAt",label:"注册时间"},{default:l(o=>[t("div",null,M(_(ve)(o.row.createdAt)),1)]),_:1}),e(w,{prop:"action",label:"操作",fixed:"right",width:"250"},{default:l(o=>[t("div",qe,[o.row.isVerificated!="1"||o.row.isRejected!="1"?(f(),b("div",{key:0,class:"action-btn cursor-pointer mr-20",onClick:F=>Z(o.row)},"审核 ",8,Ge)):me("",!0),t("div",{class:"action-btn cursor-pointer mr-20",onClick:F=>O(o.row)},"商户设置",8,Ke),t("div",{class:"action-btn cursor-pointer",onClick:F=>G(o.row.id)},"进入商户后台",8,Le)])]),_:1})]),_:1},8,["data"])),[[X,_($)]])]),t("div",Oe,[e(W,{background:"",layout:_(p).layout,"page-sizes":_(p).pageSizes,total:_(p).total,"page-size":_(p).pageSize,currentPage:_(p).currentPage,onCurrentChange:_(R)},null,8,["layout","page-sizes","total","page-size","currentPage","onCurrentChange"])]),e(Ce,{modelValue:C.value,"onUpdate:modelValue":s[3]||(s[3]=o=>C.value=o),id:g.value},null,8,["modelValue","id"]),e(pe,{modelValue:V.value,"onUpdate:modelValue":s[4]||(s[4]=o=>V.value=o),row:x.value},null,8,["modelValue","row"])])])}}}),dt=z(Ze,[["__scopeId","data-v-37b2843e"]]);export{dt as default};
