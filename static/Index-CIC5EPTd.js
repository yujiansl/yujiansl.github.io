import{u as X}from"./useTable-Br0VH9YA.js";import{F as Y}from"./Index-BgrOBixy.js";import{i as z,_ as I}from"./index-bEAPwbJM.js";import{l as F,aK as ee,aE as te,r as p,aL as le,Z as S,ah as n,m as g,M as x,O as l,q as u,U as e,p as T,F as N,a7 as q,S as C,d as ae,ap as oe,T as D,P as ne,u as d,aF as re,aG as se}from"./vue-BtEXIrqH.js";import{E as M,n as ue}from"./element-BbMnn7tA.js";import{n as ce}from"./index-B3sZ9j6O.js";import{c as ie}from"./commonFn-DSVr4W-5.js";import"./LIKU-logo-BbnHVERV.js";import"//at.alicdn.com/t/c/font_4557022_266y8yxi6v9.js";import"./vxe-EK889JN8.js";function de(){return z({url:"/userblacklist/count",method:"get"})}function me(m){return z({url:"/userblacklist/create",method:"post",data:m})}function pe(m){return z({url:"/userblacklist/delete",method:"post",data:m})}const _e={class:"base-box detail-box"},fe={class:"flex-center w-full mt-30"},he=F({__name:"Create",props:ee({merchantOptions:{}},{modelValue:{},modelModifiers:{}}),emits:["update:modelValue"],setup(m){te(),p({});const b=le(m,"modelValue"),y=p(),t=S({username:"",luMerchant:"",reason:"",challengeResult:""}),V=S({username:[{required:!0,message:"请输入用户名称",trigger:"blur"}],luMerchant:[{required:!0,message:"请选择所属站点",trigger:"change"}],challengeResult:[{required:!0,message:"请输入谷歌验证码",trigger:"blur"}]}),k=async _=>{_&&await _.validate((a,f)=>{if(a){try{me(t).then(()=>{M.success("保存成功"),setTimeout(()=>{window.location.reload()},1e3)}).catch(c=>{M.error("操作失败"),console.error(c)})}catch(c){console.error(c)}console.log("submit!")}else console.error("error submit!",f)})};return(_,a)=>{const f=n("el-input"),c=n("el-form-item"),B=n("el-option"),U=n("el-select"),R=n("el-button"),L=n("el-form");return g(),x(Y,{modelValue:b.value,"onUpdate:modelValue":a[5]||(a[5]=o=>b.value=o)},{default:l(()=>[u("div",_e,[e(L,{ref_key:"userBlackListFormRef",ref:y,"label-position":"top",rules:V,"label-width":"auto",model:t},{default:l(()=>[e(c,{prop:"username",label:"用户名称"},{default:l(()=>[e(f,{modelValue:t.username,"onUpdate:modelValue":a[0]||(a[0]=o=>t.username=o),placeholder:"请输入用户名称",maxlength:"50"},null,8,["modelValue"])]),_:1}),e(c,{prop:"luMerchant",label:"所属站点"},{default:l(()=>[e(U,{class:"select-currency-input",modelValue:t.luMerchant,"onUpdate:modelValue":a[1]||(a[1]=o=>t.luMerchant=o),placeholder:"请选择所属站点"},{default:l(()=>[(g(!0),T(N,null,q(_.merchantOptions,o=>(g(),x(B,{key:o.id.value,label:o.merchantName.value,value:o.id.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),e(c,{prop:"reason",label:"添加理由"},{default:l(()=>[e(f,{modelValue:t.reason,"onUpdate:modelValue":a[2]||(a[2]=o=>t.reason=o),placeholder:"请输入添加理由",type:"textarea",rows:3,maxlength:"50"},null,8,["modelValue"])]),_:1}),e(c,{prop:"challengeResult",label:"谷歌验证码"},{default:l(()=>[e(f,{modelValue:t.challengeResult,"onUpdate:modelValue":a[3]||(a[3]=o=>t.challengeResult=o),placeholder:"请输入谷歌验证码",minlength:"6",maxlength:"6"},null,8,["modelValue"])]),_:1}),e(c,null,{default:l(()=>[u("div",fe,[e(R,{type:"primary",onClick:a[4]||(a[4]=o=>k(y.value))},{default:l(()=>[C("保存")]),_:1})])]),_:1})]),_:1},8,["rules","model"])])]),_:1},8,["modelValue"])}}}),ge=I(he,[["__scopeId","data-v-c3593da5"]]),$=m=>(re("data-v-4e015fe8"),m=m(),se(),m),be={class:"top-section base-box flex items-center ml-40 mr-40 mt-20"},ve={class:"pr-80"},Ve=$(()=>u("div",{class:"item-title"},"黑名单总数",-1)),ye={class:"item-price mt-10 mb-8"},ke={class:"order base-box p-36 ml-40 mr-40 mt-20"},we={class:"top-search"},Ce={class:"table-wrapper"},xe=$(()=>u("div",{class:"action-btn cursor-pointer mr-20"},"移出黑名单 ",-1)),Me={class:"pager-wrapper mt-32 flex justify-between"},Be=F({__name:"Index",setup(m){const b=p([]),y=p(),t=S({luMerchant:"",username:""}),V=p(!1);p({});const k=p(0),_=p({}),{paginationData:a,handleCurrentChange:f,handleSizeChange:c,tableData:B,queryTableData:U,loadingRef:R,handSearch:L,reset:o}=X({searchData:_,url:"/userblacklist/list",method:"post"});function E(){const i=[];t.luMerchant&&i.push({columnName:"luMerchant",value:t.luMerchant}),t.username&&i.push({columnName:"username",value:t.username}),_.searchItems=i,L()}function O(){t.username="",t.luMerchant=""}const P=async()=>{try{const i=await de();k.value=i.data.totalCount}catch(i){console.error(i)}},A=async i=>{const r={id:i.id};pe(r).then(v=>{M.success("删除成功"),setTimeout(()=>{window.location.reload()},1e3)}).catch(v=>{console.error(v),M.error("操作失败")})},G=async()=>{ce({paging:{pageSize:50,pageNumber:1}}).then(r=>{b.value=r.data.rows}).catch(r=>{console.error(r)})};return ae(()=>{U(),P(),G()}),(i,r)=>{const v=n("el-button"),K=n("el-option"),Z=n("el-select"),w=n("el-form-item"),j=n("el-input"),H=n("el-form"),h=n("el-table-column"),J=n("el-popconfirm"),Q=n("el-pagination"),W=oe("loading");return g(),T("div",null,[u("div",be,[u("div",ve,[Ve,u("div",ye,D(k.value),1)]),e(v,{type:"primary",onClick:r[0]||(r[0]=s=>V.value=!0),class:"flex-center create-button"},{default:l(()=>[C(" 添加黑名单 ")]),_:1})]),u("div",ke,[u("div",we,[e(H,{inline:!0,model:t,class:"demo-form-inline"},{default:l(()=>[e(w,null,{default:l(()=>[e(Z,{modelValue:t.luMerchant,"onUpdate:modelValue":r[1]||(r[1]=s=>t.luMerchant=s),placeholder:"全部站点",clearable:""},{default:l(()=>[(g(!0),T(N,null,q(b.value,s=>(g(),x(K,{key:s.id.value,label:s.merchantName.value,value:s.id.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),e(w,null,{default:l(()=>[e(j,{modelValue:t.username,"onUpdate:modelValue":r[2]||(r[2]=s=>t.username=s),placeholder:"请输入用户名称搜寻",clearable:""},null,8,["modelValue"])]),_:1}),e(w,null,{default:l(()=>[e(v,{type:"primary",onClick:O},{default:l(()=>[C("重置")]),_:1})]),_:1}),e(w,null,{default:l(()=>[e(v,{type:"primary",onClick:E},{default:l(()=>[C("查询")]),_:1})]),_:1})]),_:1},8,["model"])]),u("div",Ce,[ne((g(),x(d(ue),{ref_key:"multipleTableRef",ref:y,data:d(B),style:{width:"100%"}},{default:l(()=>[e(h,{prop:"id",label:"用户ID",width:"180"}),e(h,{prop:"username",label:"用户名称",width:"120"}),e(h,{prop:"region",label:"国家地区",width:"120"}),e(h,{prop:"merchant~merchantName",label:"所属站点",width:"120"}),e(h,{prop:"reason",label:"添加理由",width:"240"}),e(h,{prop:"createdAt",label:"添加时间",width:"180"},{default:l(s=>[u("div",null,D(d(ie)(s.row.createdAt)),1)]),_:1}),e(h,{prop:"action",label:"操作",fixed:"right",width:"120"},{default:l(s=>[e(J,{title:"确定删除黑名单用户吗?",width:"200",onConfirm:Ue=>A(s.row)},{reference:l(()=>[xe]),_:2},1032,["onConfirm"])]),_:1})]),_:1},8,["data"])),[[W,d(R)]])]),u("div",Me,[e(Q,{background:"",layout:d(a).layout,"page-sizes":d(a).pageSizes,total:d(a).total,"page-size":d(a).pageSize,currentPage:d(a).currentPage,onSizeChange:d(c),onCurrentChange:d(f)},null,8,["layout","page-sizes","total","page-size","currentPage","onSizeChange","onCurrentChange"])]),e(ge,{modelValue:V.value,"onUpdate:modelValue":r[3]||(r[3]=s=>V.value=s),"merchant-options":b.value},null,8,["modelValue","merchant-options"])])])}}}),$e=I(Be,[["__scopeId","data-v-4e015fe8"]]);export{$e as default};
