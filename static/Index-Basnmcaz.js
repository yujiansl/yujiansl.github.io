import{u as re}from"./useTable-Br0VH9YA.js";import{b as se,c as de,d as ce}from"./index-B3sZ9j6O.js";import{F as ue}from"./Index-BgrOBixy.js";import{c as Y,h as ie,t as pe}from"./commonFn-DSVr4W-5.js";import{l as me,r as _,d as _e,ah as c,ap as F,m as p,p as V,q as o,U as l,O as n,F as N,a7 as S,M as h,S as y,P as k,u,I as ve,T as i,aF as fe,aG as be}from"./vue-BtEXIrqH.js";import{_ as he}from"./index-bEAPwbJM.js";import"./LIKU-logo-BbnHVERV.js";import"./element-BbMnn7tA.js";import"//at.alicdn.com/t/c/font_4557022_266y8yxi6v9.js";import"./vxe-EK889JN8.js";const v=g=>(fe("data-v-eca15e8a"),g=g(),be(),g),ye={class:"order base-box p-36 ml-40 mr-40 mt-20"},ge={class:"top-search"},we={class:"table-wrapper"},xe=["onClick"],Ve={class:"pager-wrapper mt-32 flex justify-end"},De={class:"base-box detail-box"},Ce=v(()=>o("div",{class:"order-title mb-30"},"订单信息",-1)),Ne={class:"mb-24 flex"},Se=v(()=>o("div",{class:"order-text"},"订单金额",-1)),ke={class:"order-value"},Te={class:"mb-24 flex"},ze=v(()=>o("div",{class:"order-text"},"下单用户",-1)),Ie={class:"order-value"},We={class:"mb-24 flex"},Ae=v(()=>o("div",{class:"order-text"},"商户订单号",-1)),Pe={class:"order-value"},Ue={class:"mb-24 flex"},Le=v(()=>o("div",{class:"order-text"},"支付方式",-1)),Ye={class:"order-value"},Fe={class:"mb-24 flex"},Me=v(()=>o("div",{class:"order-text"},"下单时间（香港）",-1)),qe={class:"order-value"},Be=v(()=>o("div",{class:"order-line mt-42 mb-40"},null,-1)),Re=v(()=>o("div",{class:"order-title mb-30"},"商品信息",-1)),He=me({__name:"Index",setup(g){const s=_({tradeState:"",payWay:"",channel:"",username:""}),T=_([]),w=_(!1),z=_([]),D=_([]),I=[{label:"待支付",value:"10"},{label:"支付成功",value:"20"},{label:"支付失败",value:"30"},{label:"取消支付",value:"40"},{label:"全额退款",value:"60"},{label:"部分退款",value:"61"}],C=_(!1),f=_({accountName:"",price:"",currency:"",bizNo:"",payWay:"",createdAt:""}),W=_("first"),{paginationData:b,handleCurrentChange:M,handSearch:q,tableData:B,queryTableData:R,loadingRef:H}=re({searchData:s,url:"/traderecord/list",method:"post"}),O=()=>{s.value={}};function E(){const t=[];for(const e in s.value){let r=s.value[e];Array.isArray(r)&&(r=r.map(m=>ie.utc(new Date(m)).format("YYYY-MM-DD HH:mm:ss")).toString()),r&&t.push({columnName:e,value:r})}q(t)}const j=[{text:"Last week",value:()=>{const t=new Date,e=new Date;return e.setTime(e.getTime()-3600*1e3*24*7),[e,t]}},{text:"Last month",value:()=>{const t=new Date,e=new Date;return e.setTime(e.getTime()-3600*1e3*24*30),[e,t]}},{text:"Last 3 months",value:()=>{const t=new Date,e=new Date;return e.setTime(e.getTime()-3600*1e3*24*90),[e,t]}}],G=async()=>{try{const t=await se();z.value=t.data.map(e=>({name:e.code+"站点",value:e.code}))}catch(t){console.log(t,"e")}},K=async()=>{try{const t=await de();t.data&&t.data.length&&(D.value=t.data)}catch(t){console.log(t,"e")}},Z=t=>{var e;return(e=I.filter(r=>r.value===t)[0])==null?void 0:e.label},$=t=>{if(t==="10")return"order-wait";if(t==="20")return"order-success";if(t==="30")return"order-fail";if(t==="40")return"order-cancel";if(t==="50")return"order-refund";console.log(t,"value")},A=t=>{let e="";return D.value.forEach(r=>{r.code.toUpperCase()===t.toUpperCase()&&(e=r.name)}),e},J=t=>{const e={searchItems:[{columnName:"luTradeRecord",value:t}]};w.value=!0,ce(e).then(r=>{T.value=pe(r.data.rows)||[],w.value=!1}).catch(r=>{w.value=!1,console.log(r,"getProductApi")})},Q=t=>{J(t.id),f.value=t,C.value=!0};return _e(()=>{R(),G(),K()}),(t,e)=>{const r=c("el-option"),x=c("el-select"),m=c("el-form-item"),X=c("el-date-picker"),ee=c("el-input"),P=c("el-button"),ae=c("el-form"),d=c("el-table-column"),U=c("el-table"),te=c("el-pagination"),le=c("el-tab-pane"),oe=c("el-tabs"),ne=F("permission"),L=F("loading");return p(),V("div",ye,[o("div",ge,[l(ae,{inline:!0,model:s.value,class:"demo-form-inline"},{default:n(()=>[l(m,null,{default:n(()=>[l(x,{modelValue:s.value.channelName,"onUpdate:modelValue":e[0]||(e[0]=a=>s.value.channelName=a),placeholder:"全部站点",clearable:""},{default:n(()=>[(p(!0),V(N,null,S(z.value,a=>(p(),h(r,{key:a.value,label:a.name,value:a.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),l(m,null,{default:n(()=>[l(x,{modelValue:s.value.tradeState,"onUpdate:modelValue":e[1]||(e[1]=a=>s.value.tradeState=a),placeholder:"全部状态",clearable:""},{default:n(()=>[(p(),V(N,null,S(I,a=>l(r,{key:a.value,label:a.label,value:a.value},null,8,["label","value"])),64))]),_:1},8,["modelValue"])]),_:1}),l(m,null,{default:n(()=>[l(x,{modelValue:s.value.payWay,"onUpdate:modelValue":e[2]||(e[2]=a=>s.value.payWay=a),placeholder:"全部支付方式",clearable:""},{default:n(()=>[(p(!0),V(N,null,S(D.value,a=>(p(),h(r,{key:a.code,label:a.name,value:a.code},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),l(m,null,{default:n(()=>[l(X,{modelValue:s.value.createdAt,"onUpdate:modelValue":e[3]||(e[3]=a=>s.value.createdAt=a),type:"daterange","unlink-panels":"","range-separator":"-","start-placeholder":"开始时间","end-placeholder":"结束时间",format:"YYYY-MM-DD",shortcuts:j,size:"default"},null,8,["modelValue"])]),_:1}),l(m,null,{default:n(()=>[l(ee,{modelValue:s.value.orderNo,"onUpdate:modelValue":e[4]||(e[4]=a=>s.value.orderNo=a),placeholder:"请输入订单号搜寻",clearable:""},null,8,["modelValue"])]),_:1}),l(m,null,{default:n(()=>[l(P,{type:"primary",onClick:O},{default:n(()=>[y("重置")]),_:1}),l(P,{type:"primary",onClick:E},{default:n(()=>[y("查询")]),_:1})]),_:1})]),_:1},8,["model"])]),o("div",we,[k((p(),h(U,{data:u(B),style:{width:"100%"}},{default:n(()=>[l(d,{prop:"channelName",label:"站点名称",width:"100"}),l(d,{prop:"orderNo",label:"订单号",width:"280"}),l(d,{prop:"bizNo",label:"商户订单号",width:"280"}),l(d,{prop:"tradeState",label:"订单状态",width:"160"},{default:n(a=>[o("div",{class:ve($(a.row.tradeState))},i(Z(a.row.tradeState)),3)]),_:1}),l(d,{prop:"price",label:"订单金额",width:"180"},{default:n(a=>[y(i(a.row.price+" "+a.row.currency),1)]),_:1}),l(d,{prop:"payWay",label:"支付方式",width:"180"},{default:n(a=>[y(i(A(a.row.payWay)),1)]),_:1}),l(d,{prop:"accountName",label:"下单用户",width:"220"}),l(d,{prop:"createdAt",label:"下单时间(香港)",width:"180"},{default:n(a=>[o("div",null,i(u(Y)(a.row.createdAt)),1)]),_:1}),k((p(),h(d,{prop:"action",label:"操作",fixed:"right"},{default:n(a=>[o("div",{class:"action-btn cursor-pointer",onClick:Oe=>Q(a.row)},"查看详情",8,xe)]),_:1})),[[ne,["merchant","admin"]]])]),_:1},8,["data"])),[[L,u(H)]])]),o("div",Ve,[l(te,{background:"",layout:u(b).layout,"page-sizes":u(b).pageSizes,total:u(b).total,"page-size":u(b).pageSize,currentPage:u(b).currentPage,onCurrentChange:u(M)},null,8,["layout","page-sizes","total","page-size","currentPage","onCurrentChange"])]),l(ue,{modelValue:C.value,"onUpdate:modelValue":e[6]||(e[6]=a=>C.value=a)},{default:n(()=>[o("div",De,[l(oe,{modelValue:W.value,"onUpdate:modelValue":e[5]||(e[5]=a=>W.value=a),class:"modal-tabs"},{default:n(()=>[l(le,{label:"订单详情",name:"first"},{default:n(()=>[Ce,o("div",Ne,[Se,o("div",ke,i(f.value.price+" "+f.value.currency),1)]),o("div",Te,[ze,o("div",Ie,i(f.value.accountName),1)]),o("div",We,[Ae,o("div",Pe,i(f.value.bizNo),1)]),o("div",Ue,[Le,o("div",Ye,i(A(f.value.payWay)),1)]),o("div",Fe,[Me,o("div",qe,i(u(Y)(f.value.createdAt)),1)]),Be,Re,k((p(),h(U,{data:T.value,style:{width:"100%"}},{default:n(()=>[l(d,{prop:"name",label:"商品名称"}),l(d,{prop:"quantity",label:"商品数量"}),l(d,{prop:"price",label:"商品价格"},{default:n(a=>[y(i(a.row.price+" "+a.row.currency),1)]),_:1})]),_:1},8,["data"])),[[L,w.value]])]),_:1})]),_:1},8,["modelValue"])])]),_:1},8,["modelValue"])])}}}),aa=he(He,[["__scopeId","data-v-eca15e8a"]]);export{aa as default};
