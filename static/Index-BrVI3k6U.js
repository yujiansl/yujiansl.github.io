import{l as C,m as I,_ as V}from"./index-Cfrc5ih1.js";import{f as j}from"./commonFn-Ei0WKKhK.js";import{l as w,aK as T,aL as q,r as p,b as M,ah as N,m as t,p as n,q as c,U as _,R as g,M as S,S as B,T as F,I as z}from"./vue-BtEXIrqH.js";import{E as k}from"./element-BbMnn7tA.js";function E(d){return C({url:"/secruritytoken",method:"get",params:d})}const P={key:0,class:"w-full h-full flex-center cursor-pointer relative img-upload"},R=["for"],D=["src"],K=["id"],L=["for"],O=["src"],W={key:1},A=["id"],G=w({__name:"Index",props:T({ext:{},id:{},defaultImgUrl:{}},{modelValue:{},modelModifiers:{}}),emits:["update:modelValue"],setup(d){const f=q(d,"modelValue"),m=d,l=p(""),a=p(null),r=p(),x=e=>{const o=e.type;return m.ext==="excel"&&(o.startsWith("application/vnd.openxmlformats-officedocument.spreadsheetml.sheet")||o==="application/vnd.ms-excel")?(console.log("excel"),!0):m.ext==="img"&&["image/jpeg","image/png","image/gif","image/jpg"].includes(o)?(console.log("img"),!0):(k.error("文件格式错误"),r.value.value="",a.value=null,!1)},U=async()=>{var s,i,y;if(!a.value){k.error("请选择文件");return}if(!x(a.value))return;const o={role:"likustatics",action:"PutObject",fileName:a.value.name};try{const u=await E(o),b=(s=u.data)==null?void 0:s.url;await I({url:b,method:"put",data:a.value}),f.value=(i=u.data)==null?void 0:i.objectPath,m.ext==="img"&&(l.value=j((y=u.data)==null?void 0:y.objectPath))}catch(u){console.error(u)}},v=e=>{!e||e.target.files.length===0||(a.value=e.target.files[0],U())};M(()=>f.value,e=>{e||(a.value=null,l.value="",r.value.value="")});const h=()=>{a.value=null,f.value="",l.value="",r.value.value=""};return(e,o)=>{var i;const s=N("SvgIcon");return l.value===""&&e.defaultImgUrl?(t(),n("div",P,[c("label",{for:e.id},[c("img",{src:e.defaultImgUrl,alt:""},null,8,D),c("input",{type:"file",id:e.id,ref_key:"inputFef",ref:r,onChange:v,style:{display:"none"}},null,40,K)],8,R),e.defaultImgUrl?(t(),n("div",{key:0,class:"close flex-center",onClick:h},[_(s,{name:"icon-guanbi-quanpingdanchuang1",size:"20px"})])):g("",!0)])):(t(),n("div",{key:1,class:z([l.value?"img-upload":"upload","w-full h-full flex-center cursor-pointer relative"])},[c("label",{for:e.id,class:"w-full"},[l.value?(t(),n("img",{key:0,src:l.value,alt:""},null,8,O)):(t(),n("span",W,[a.value?g("",!0):(t(),S(s,{key:0,name:"icon-dianjishangchuan",class:"mr-10"})),B(" "+F(((i=a.value)==null?void 0:i.name)||"点击上传"),1)])),c("input",{type:"file",id:e.id,ref_key:"inputFef",ref:r,onChange:v,style:{display:"none"}},null,40,A)],8,L),a.value||l.value?(t(),n("div",{key:0,class:"close flex-center",onClick:h},[_(s,{name:"icon-guanbi-quanpingdanchuang1",size:"20px"})])):g("",!0)],2))}}}),Y=V(G,[["__scopeId","data-v-b8dee1a3"]]);export{Y as U};
