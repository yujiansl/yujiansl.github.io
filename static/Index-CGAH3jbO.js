import{u as X}from"./useTable-B7hd0WvU.js";import{F as Y}from"./Index-Di390-Cq.js";import{i as I,_ as D}from"./index-Cfrc5ih1.js";import{l as F,aK as ee,aE as te,r as p,aL as le,Z as T,ah as n,m as h,M,O as l,q as u,U as e,p as R,F as N,a7 as q,S as C,d as ae,ap as oe,T as z,P as ne,u as c,aF as re,aG as se}from"./vue-BtEXIrqH.js";import{V as ue}from"./index-BwQtaG9W.js";import{E as x,n as ie}from"./element-BbMnn7tA.js";import{l as ce}from"./index-C7XNEq9c.js";import{a as me}from"./commonFn-Ei0WKKhK.js";import"./LIKU-logo-BbnHVERV.js";import"//at.alicdn.com/t/c/font_4557022_266y8yxi6v9.js";import"./vxe-EK889JN8.js";function de(){return I({url:"/userblacklist/count",method:"get"})}function pe(m){return I({url:"/userblacklist/create",method:"post",data:m})}function _e(m){return I({url:"/userblacklist/delete",method:"post",data:m})}const fe={class:"base-box detail-box"},he={class:"flex-center w-full mt-30"},be=F({__name:"Create",props:ee({merchantOptions:{}},{modelValue:{},modelModifiers:{}}),emits:["update:modelValue"],setup(m){te(),p({});const b=le(m,"modelValue"),y=p(),t=T({username:"",luMerchant:"",reason:"",challengeResult:""}),V=T({username:[{required:!0,message:"请输入用户名称",trigger:"blur"}],luMerchant:[{required:!0,message:"请选择所属站点",trigger:"change"}]}),k=async _=>{_&&await _.validate((a,g)=>{if(a){try{pe(t).then(()=>{x.success("保存成功"),setTimeout(()=>{},1e3)}).catch(d=>{x.error("操作失败"),console.error(d)})}catch(d){console.error(d)}console.log("submit!")}else console.error("error submit!",g)})};return(_,a)=>{const g=n("el-input"),d=n("el-form-item"),B=n("el-option"),U=n("el-select"),L=n("el-button"),S=n("el-form");return h(),M(Y,{modelValue:b.value,"onUpdate:modelValue":a[5]||(a[5]=o=>b.value=o),title:"添加黑名单"},{default:l(()=>[u("div",fe,[e(S,{ref_key:"userBlackListFormRef",ref:y,"label-position":"top",rules:V,"label-width":"auto",model:t},{default:l(()=>[e(d,{prop:"username",label:"用户名称"},{default:l(()=>[e(g,{modelValue:t.username,"onUpdate:modelValue":a[0]||(a[0]=o=>t.username=o),placeholder:"请输入用户名称",maxlength:"50"},null,8,["modelValue"])]),_:1}),e(d,{prop:"luMerchant",label:"所属站点"},{default:l(()=>[e(U,{class:"select-currency-input",modelValue:t.luMerchant,"onUpdate:modelValue":a[1]||(a[1]=o=>t.luMerchant=o),placeholder:"请选择所属站点"},{default:l(()=>[(h(!0),R(N,null,q(_.merchantOptions,o=>(h(),M(B,{key:o.id.value,label:o.merchantName.value,value:o.id.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),e(d,{prop:"reason",label:"添加理由"},{default:l(()=>[e(g,{modelValue:t.reason,"onUpdate:modelValue":a[2]||(a[2]=o=>t.reason=o),placeholder:"请输入添加理由",type:"textarea",rows:3,maxlength:"50"},null,8,["modelValue"])]),_:1}),e(ue,{modelValue:t.challengeResult,"onUpdate:modelValue":a[3]||(a[3]=o=>t.challengeResult=o)},null,8,["modelValue"]),e(d,null,{default:l(()=>[u("div",he,[e(L,{type:"primary",onClick:a[4]||(a[4]=o=>k(y.value))},{default:l(()=>[C("保存")]),_:1})])]),_:1})]),_:1},8,["rules","model"])])]),_:1},8,["modelValue"])}}}),ge=D(be,[["__scopeId","data-v-fcc88f4f"]]),$=m=>(re("data-v-4e015fe8"),m=m(),se(),m),ve={class:"top-section base-box flex items-center ml-40 mr-40 mt-20"},Ve={class:"pr-80"},ye=$(()=>u("div",{class:"item-title"},"黑名单总数",-1)),ke={class:"item-price mt-10 mb-8"},we={class:"order base-box p-36 ml-40 mr-40 mt-20"},Ce={class:"top-search"},Me={class:"table-wrapper"},xe=$(()=>u("div",{class:"action-btn cursor-pointer mr-20"},"移出黑名单 ",-1)),Be={class:"pager-wrapper mt-32 flex justify-between"},Ue=F({__name:"Index",setup(m){const b=p([]),y=p(),t=T({luMerchant:"",username:""}),V=p(!1);p({});const k=p(0),_=p({}),{paginationData:a,handleCurrentChange:g,handleSizeChange:d,tableData:B,queryTableData:U,loadingRef:L,handSearch:S,reset:o}=X({searchData:_,url:"/userblacklist/list",method:"post"});function E(){const i=[];t.luMerchant&&i.push({columnName:"luMerchant",value:t.luMerchant}),t.username&&i.push({columnName:"username",value:t.username}),_.searchItems=i,S()}function O(){t.username="",t.luMerchant=""}const P=async()=>{try{const i=await de();k.value=i.data.totalCount}catch(i){console.error(i)}},A=async i=>{const r={id:i.id};_e(r).then(v=>{x.success("删除成功"),setTimeout(()=>{window.location.reload()},1e3)}).catch(v=>{console.error(v),x.error("操作失败")})},G=async()=>{ce({paging:{pageSize:50,pageNumber:1}}).then(r=>{b.value=r.data.rows}).catch(r=>{console.error(r)})};return ae(()=>{U(),P(),G()}),(i,r)=>{const v=n("el-button"),K=n("el-option"),Z=n("el-select"),w=n("el-form-item"),j=n("el-input"),H=n("el-form"),f=n("el-table-column"),J=n("el-popconfirm"),Q=n("el-pagination"),W=oe("loading");return h(),R("div",null,[u("div",ve,[u("div",Ve,[ye,u("div",ke,z(k.value),1)]),e(v,{type:"primary",onClick:r[0]||(r[0]=s=>V.value=!0),class:"flex-center create-button"},{default:l(()=>[C(" 添加黑名单 ")]),_:1})]),u("div",we,[u("div",Ce,[e(H,{inline:!0,model:t,class:"demo-form-inline"},{default:l(()=>[e(w,null,{default:l(()=>[e(Z,{modelValue:t.luMerchant,"onUpdate:modelValue":r[1]||(r[1]=s=>t.luMerchant=s),placeholder:"全部站点",clearable:""},{default:l(()=>[(h(!0),R(N,null,q(b.value,s=>(h(),M(K,{key:s.id.value,label:s.merchantName.value,value:s.id.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),e(w,null,{default:l(()=>[e(j,{modelValue:t.username,"onUpdate:modelValue":r[2]||(r[2]=s=>t.username=s),placeholder:"请输入用户名称搜寻",clearable:""},null,8,["modelValue"])]),_:1}),e(w,null,{default:l(()=>[e(v,{type:"primary",onClick:O},{default:l(()=>[C("重置")]),_:1})]),_:1}),e(w,null,{default:l(()=>[e(v,{type:"primary",onClick:E},{default:l(()=>[C("查询")]),_:1})]),_:1})]),_:1},8,["model"])]),u("div",Me,[ne((h(),M(c(ie),{ref_key:"multipleTableRef",ref:y,data:c(B),style:{width:"100%"}},{default:l(()=>[e(f,{prop:"id",label:"用户ID",width:"180"}),e(f,{prop:"username",label:"用户名称",width:"120"}),e(f,{prop:"region",label:"国家地区",width:"120"}),e(f,{prop:"merchant~merchantName",label:"所属站点",width:"120"}),e(f,{prop:"reason",label:"添加理由",width:"240"}),e(f,{prop:"createdAt",label:"添加时间",width:"180"},{default:l(s=>[u("div",null,z(c(me)(s.row.createdAt)),1)]),_:1}),e(f,{prop:"action",label:"操作",fixed:"right",width:"120"},{default:l(s=>[e(J,{title:"确定删除黑名单用户吗?",width:"200",onConfirm:Le=>A(s.row)},{reference:l(()=>[xe]),_:2},1032,["onConfirm"])]),_:1})]),_:1},8,["data"])),[[W,c(L)]])]),u("div",Be,[e(Q,{background:"",layout:c(a).layout,"page-sizes":c(a).pageSizes,total:c(a).total,"page-size":c(a).pageSize,currentPage:c(a).currentPage,onSizeChange:c(d),onCurrentChange:c(g)},null,8,["layout","page-sizes","total","page-size","currentPage","onSizeChange","onCurrentChange"])]),e(ge,{modelValue:V.value,"onUpdate:modelValue":r[3]||(r[3]=s=>V.value=s),"merchant-options":b.value},null,8,["modelValue","merchant-options"])])])}}}),Oe=D(Ue,[["__scopeId","data-v-4e015fe8"]]);export{Oe as default};
