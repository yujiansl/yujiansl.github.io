import{l as we,aK as ke,Z as F,aD as Ve,aE as ge,r as y,aL as Ie,ah as h,m as u,p as m,U as t,O as n,q as a,S as V,T as d,u as g,F as O,a7 as Fe,aF as De,aG as Ae}from"./vue-BtEXIrqH.js";import{u as Se}from"./useEnterprise-euz5rIMR.js";import{_ as Ue}from"./Index.vue_vue_type_script_setup_true_lang-TK6O32Dg.js";import{F as Ne}from"./Index-Di390-Cq.js";import{d as Ce,g as Re}from"./index-BqctQlg1.js";import{m as Z,k as Te,a as Ee}from"./index-C7XNEq9c.js";import{U as H}from"./Index-BrVI3k6U.js";import{b as Me}from"./validate-JA1bY0wI.js";import{a as C,f as j}from"./commonFn-Ei0WKKhK.js";import{V as E}from"./index-BwQtaG9W.js";import{n as J,E as D}from"./element-BbMnn7tA.js";import{_ as Pe}from"./index-Cfrc5ih1.js";import"./LIKU-logo-BbnHVERV.js";import"//at.alicdn.com/t/c/font_4557022_266y8yxi6v9.js";import"./vxe-EK889JN8.js";const p=I=>(De("data-v-d299c5de"),I=I(),Ae(),I),xe=p(()=>a("div",{class:"delete-confirm-warning"}," 确定删除结算账户吗？ ",-1)),Le={class:"delete-google-otp"},$e={class:"delete-confirm-footer"},Ge={key:0,class:"base-box detail-box"},ze={class:"detail-line"},Be=p(()=>a("span",{class:"detail-line-title"},"谷歌验证器",-1)),Ke={key:0,class:"detail-line-value"},qe={key:1,class:"detail-line-value"},Oe={class:"detail-line"},Ze=p(()=>a("span",{class:"detail-line-title"},"注册时间",-1)),He={class:"detail-line-value"},je={class:"detail-line"},Je=p(()=>a("span",{class:"detail-line-title"},"最后登录时间",-1)),Qe={key:0,class:"detail-line-value"},We={key:1,class:"detail-line-value"},Xe={class:"detail-line"},Ye=p(()=>a("span",{class:"detail-line-title"},"最后登录IP",-1)),et={key:0,class:"detail-line-value"},tt={key:1,class:"detail-line-value"},lt={class:"flex-center w-full mt-30"},at={class:"detail-line"},ot=p(()=>a("span",{class:"detail-line-title"},"提交时间",-1)),st={class:"detail-line-value"},nt={class:"detail-line"},it=p(()=>a("span",{class:"detail-line-title"},"审核通过时间",-1)),rt={key:0,class:"detail-line-value"},dt={key:1,class:"detail-line-value"},ct={class:"flex-center w-full mt-30"},ut={key:0,class:"verificated flex-center"},mt={key:1,class:"not-verificated flex-center"},pt={key:0},_t={key:1,class:"lockout-status-text"},vt={key:1,class:"base-box detail-box"},ft=p(()=>a("div",{class:"flex-center w-full mt-30 settlement-account-detail-title"},"结算账户详情",-1)),yt={key:0},ht={class:"settlement-account-detail-line"},bt=p(()=>a("span",{class:"settlement-account-field"},"结算币种：",-1)),wt={class:"settlement-account-value"},kt={class:"settlement-account-detail-line"},Vt=p(()=>a("span",{class:"settlement-account-field"},"银行国家/地区：",-1)),gt={class:"settlement-account-value"},It={class:"settlement-account-detail-line"},Ft=p(()=>a("span",{class:"settlement-account-field"},"银行名称：",-1)),Dt={class:"settlement-account-value"},At={class:"settlement-account-detail-line"},St=p(()=>a("span",{class:"settlement-account-field"},"银行地址：",-1)),Ut={class:"settlement-account-value"},Nt={class:"settlement-account-detail-line"},Ct=p(()=>a("span",{class:"settlement-account-field"},"结算账户名称：",-1)),Rt={class:"settlement-account-value"},Tt={class:"settlement-account-detail-line"},Et=p(()=>a("span",{class:"settlement-account-field"},"银行账号：",-1)),Mt={class:"settlement-account-value"},Pt={class:"settlement-account-detail-line"},xt=p(()=>a("span",{class:"settlement-account-field"},"公司地址：",-1)),Lt={class:"settlement-account-value"},$t={key:1},Gt={class:"settlement-account-detail-line"},zt=p(()=>a("span",{class:"settlement-account-field"},"结算币种：",-1)),Bt={class:"settlement-account-value"},Kt={class:"settlement-account-detail-line"},qt=p(()=>a("span",{class:"settlement-account-field"},"USDT 钱包地址：",-1)),Ot={class:"settlement-account-value"},Zt={class:"settlement-account-detail-line"},Ht=p(()=>a("span",{class:"settlement-account-field"},"钱包名称/备注：",-1)),jt={class:"settlement-account-value"},Jt={class:"flex-center w-full mt-30 settlement-account-return-btn"},Qt=we({__name:"Setting",props:ke({row:{}},{modelValue:{},modelModifiers:{}}),emits:["update:modelValue"],setup(I){const{enterpriseFormRef:M,enterpriseForm:Q,enterpriseRules:W,submitForm:Wt,resetForm:Xt}=Se(),k=I,X=(o,e,s)=>{e===""||Me(e)?s():s(new Error("密码格式错误"))},Y=(o,e,s)=>{e===""?s():e!==c.password?s(new Error("两次输入的密码不一致")):s()},c=F({merchantId:"",isEnabled:!0,password:"",rePassword:"",passwordChanged:"0",updatePassword:null,remark:"",challengeResult:""}),ee=F({password:[{trigger:"blur",validator:X}],rePassword:[{trigger:"blur",validator:Y}]}),i=F({...Q,challengeResult:""}),te=F({...W}),A=F({id:"",challengeResult:""});Ve();const le=ge(),P=y(""),f=y({}),S=y(null),R=y(null),x=Ie(I,"modelValue"),T=y(!0),U=y(!1),L=y(),$=y(),G=y("merchantInfo"),z=y(""),B=y(""),ae=[{value:"director",label:"董事"},{value:"legal",label:"法定代表人"},{value:"beneficiary",label:"受益人"}],oe=()=>{const o={paging:{pageNumber:1,pageSize:30},condition:{merchantID:k.row.id}};Te(o).then(e=>{var s;e.data.items&&(S.value=e.data.items,(s=S.value)==null||s.forEach(r=>{var w;(w=r.claims)==null||w.forEach(_=>{_.claimType==="currency"&&(r.currency=_.claimValue.toUpperCase()),_.claimType==="service_fee_percent"&&(r.service_fee_percent=parseFloat(_.claimValue)/10+"%")})}))}).catch(e=>{console.error(e)})},se=()=>{const o=[];o.push({columnName:"luMerchant",value:k.row.id}),Re({searchItems:o}).then(s=>{R.value=s.data.rows}).catch(s=>{console.error(s)})},ne=()=>{Ee(k.row.id).then(o=>{const e=o.data?o.data:[],s=y({});e.forEach(r=>{s.value[r.claimType]=r.claimValue,i["kyb.companyName"]=s.value["kyb.companyName"]?s.value["kyb.companyName"]:"",i["kyb.registrationCountry"]=s.value["kyb.registrationCountry"]?s.value["kyb.registrationCountry"]:"",i["kyb.companyIDFile"]=s.value["kyb.companyIDFile"]?s.value["kyb.companyIDFile"]:"",i["kyb.ownerName"]=s.value["kyb.ownerName"]?s.value["kyb.ownerName"]:"",i["kyb.ownerType"]=s.value["kyb.ownerType"]?s.value["kyb.ownerType"]:"",i["kyb.ownerIDFile"]=s.value["kyb.ownerIDFile"]?s.value["kyb.ownerIDFile"]:""}),z.value=j(i["kyb.companyIDFile"]?i["kyb.companyIDFile"]:""),B.value=j(i["kyb.ownerIDFile"]?i["kyb.ownerIDFile"]:"")}).catch(o=>{console.error(o)})},ie=(o,e)=>{o.paneName==="enterprise"&&ne(),o.paneName==="relativeSites"&&!S.value&&oe(),o.paneName==="settlementAccount"&&!R.value&&se()},K=o=>o==="1"?"正常":"禁用",q=o=>o==="1"?"已认证":"未认证",re=o=>{P.value=o.currency.value,f.value=o,T.value=!1},de=o=>{T.value=!0},ce=async o=>{o&&await o.validate((e,s)=>{if(e)try{const r=[];for(let _ in i)r.push({claimType:_,claimValue:i[_]});const w=F({});w.merchantId=k.row.id,w.claims=r,w.challengeResult=i.challengeResult,Z(w).then(()=>{D.success("保存成功")}).catch(_=>{D.error("操作失败"),console.error(_)})}catch(r){console.error(r)}else console.error("error submit!",s)})},ue=async o=>{o&&await o.validate((e,s)=>{if(e)try{c.merchantId=k.row.id,c.remark=k.row.remark,c.password&&c.rePassword&&(c.passwordChanged="1",c.updatePassword={userId:k.row["account~userID"].value,password:c.password},c.password="",c.rePassword=""),Z(c).then(()=>{D.success("保存成功")}).catch(r=>{D.error("操作失败"),console.error(r)})}catch(r){console.error(r)}else console.error("error submit!",s)})},me=o=>{le.push({path:"/admin/site/detail?id="+o})},pe=()=>{U.value=!0},_e=async o=>{o&&await o.validate((e,s)=>{if(e)try{A.id=f.value.id.value,Ce(A).then(r=>{D.success("删除成功"),setTimeout(()=>{window.location.reload()},1e3)}).catch(r=>{D.error("操作失败"),console.log(r)})}catch(r){console.error(r)}else console.e("error submit!",s)})};return(o,e)=>{const s=h("el-form"),r=h("el-button"),w=h("el-dialog"),_=h("el-input"),v=h("el-form-item"),ve=h("el-switch"),N=h("el-tab-pane"),fe=h("el-option"),ye=h("el-select"),b=h("el-table-column"),he=h("el-tabs");return u(),m(O,null,[t(w,{modelValue:U.value,"onUpdate:modelValue":e[3]||(e[3]=l=>U.value=l),center:"",style:{width:"480px"}},{footer:n(()=>[a("div",$e,[t(r,{type:"primary",onClick:e[1]||(e[1]=l=>_e($.value))},{default:n(()=>[V(" 确定删除 ")]),_:1}),t(r,{onClick:e[2]||(e[2]=l=>U.value=!1)},{default:n(()=>[V("取消")]),_:1})])]),default:n(()=>[xe,a("div",Le,[t(s,{ref_key:"deleteSettlementAccountFormRef",ref:$,"label-position":"top","label-width":"auto",model:A},{default:n(()=>[t(E,{modelValue:A.challengeResult,"onUpdate:modelValue":e[0]||(e[0]=l=>A.challengeResult=l)},null,8,["modelValue"])]),_:1},8,["model"])])]),_:1},8,["modelValue"]),t(Ne,{modelValue:x.value,"onUpdate:modelValue":e[20]||(e[20]=l=>x.value=l),title:"商户设置"},{default:n(()=>[T.value?(u(),m("div",Ge,[t(he,{modelValue:G.value,"onUpdate:modelValue":e[19]||(e[19]=l=>G.value=l),class:"modal-tabs",onTabClick:ie},{default:n(()=>[t(N,{label:"商户账号",name:"merchantInfo"},{default:n(()=>[t(s,{ref_key:"merchantFormRef",ref:L,"label-position":"top",rules:ee,"label-width":"auto",model:c,class:"mt-24"},{default:n(()=>[t(v,{prop:"account~userName",label:"登录邮箱"},{default:n(()=>[t(_,{modelValue:o.row["account~userName"],"onUpdate:modelValue":e[4]||(e[4]=l=>o.row["account~userName"]=l),placeholder:"请输入登录邮箱",maxlength:"50",disabled:""},null,8,["modelValue"])]),_:1}),t(v,{prop:"password",label:"密码"},{default:n(()=>[t(_,{modelValue:c.password,"onUpdate:modelValue":e[5]||(e[5]=l=>c.password=l),placeholder:"请输入密码",type:"password",minlength:"8",maxlength:"30"},null,8,["modelValue"])]),_:1}),t(v,{prop:"rePassword",label:"确认密码"},{default:n(()=>[t(_,{modelValue:c.rePassword,"onUpdate:modelValue":e[6]||(e[6]=l=>c.rePassword=l),placeholder:"请再次确认密码",type:"password",minlength:"8",maxlength:"30"},null,8,["modelValue"])]),_:1}),t(v,{prop:"remark",label:"商户备注"},{default:n(()=>[t(_,{modelValue:o.row.remark,"onUpdate:modelValue":e[7]||(e[7]=l=>o.row.remark=l),placeholder:"备注信息仅管理员可见",type:"textarea",rows:3,maxlength:"50"},null,8,["modelValue"])]),_:1}),t(v,{prop:"isEnabled",label:"账号状态"},{default:n(()=>[t(ve,{modelValue:o.row.isEnabled,"onUpdate:modelValue":e[8]||(e[8]=l=>o.row.isEnabled=l),"inline-prompt":"","active-text":"正常","inactive-text":"禁用"},null,8,["modelValue"])]),_:1}),t(E,{modelValue:c.challengeResult,"onUpdate:modelValue":e[9]||(e[9]=l=>c.challengeResult=l)},null,8,["modelValue"]),a("div",ze,[Be,o.row["account~otpEnabled"]==="1"?(u(),m("span",Ke,"已启用")):(u(),m("span",qe,"未启用"))]),a("div",Oe,[Ze,a("span",He,d(g(C)(o.row.createdAt)),1)]),a("div",je,[Je,o.row["account~latestLoginAt"]?(u(),m("span",Qe,d(g(C)(o.row["account~latestLoginAt"])),1)):(u(),m("span",We,"无"))]),a("div",Xe,[Ye,o.row.lastLoginIP?(u(),m("span",et,d(o.row.lastLoginIP),1)):(u(),m("span",tt,"无"))]),t(v,null,{default:n(()=>[a("div",lt,[t(r,{type:"primary",onClick:e[10]||(e[10]=l=>ue(L.value))},{default:n(()=>[V("保存")]),_:1})])]),_:1})]),_:1},8,["rules","model"])]),_:1}),t(N,{label:"企业信息",name:"enterprise"},{default:n(()=>[t(s,{ref_key:"enterpriseFormRef",ref:M,"label-position":"top",rules:te,"label-width":"auto",model:i,class:"mt-24"},{default:n(()=>[t(v,{prop:"kyb.companyName",label:"企业名称"},{default:n(()=>[t(_,{modelValue:i["kyb.companyName"],"onUpdate:modelValue":e[11]||(e[11]=l=>i["kyb.companyName"]=l),placeholder:"请输入企业名称",maxlength:"50"},null,8,["modelValue"])]),_:1}),t(v,{prop:"kyb.registrationCountry",label:"企业注册地"},{default:n(()=>[t(Ue,{type:"region",modelValue:i["kyb.registrationCountry"],"onUpdate:modelValue":e[12]||(e[12]=l=>i["kyb.registrationCountry"]=l),placeholder:"请选择企业注册地"},null,8,["modelValue"])]),_:1}),t(v,{prop:"kyb.companyIDFile",label:"企业证件"},{default:n(()=>[t(H,{defaultImgUrl:z.value,id:"companyIDFile",modelValue:i["kyb.companyIDFile"],"onUpdate:modelValue":e[13]||(e[13]=l=>i["kyb.companyIDFile"]=l),ext:"img"},null,8,["defaultImgUrl","modelValue"])]),_:1}),t(v,{prop:"kyb.ownerName",label:"企业主姓名"},{default:n(()=>[t(_,{modelValue:i["kyb.ownerName"],"onUpdate:modelValue":e[14]||(e[14]=l=>i["kyb.ownerName"]=l),placeholder:"请输入企业主姓名",maxlength:"30"},null,8,["modelValue"])]),_:1}),t(v,{prop:"kyb.ownerType",label:"企业主类型"},{default:n(()=>[t(ye,{modelValue:i["kyb.ownerType"],"onUpdate:modelValue":e[15]||(e[15]=l=>i["kyb.ownerType"]=l)},{default:n(()=>[(u(),m(O,null,Fe(ae,l=>t(fe,{key:l.value,label:l.label,value:l.value},null,8,["label","value"])),64))]),_:1},8,["modelValue"])]),_:1}),t(v,{prop:"kyb.ownerIDFile",label:"企业主证件"},{default:n(()=>[t(H,{defaultImgUrl:B.value,id:"ownerIDFile",modelValue:i["kyb.ownerIDFile"],"onUpdate:modelValue":e[16]||(e[16]=l=>i["kyb.ownerIDFile"]=l),ext:"img"},null,8,["defaultImgUrl","modelValue"])]),_:1}),a("div",at,[ot,a("span",st,d(g(C)(o.row.createdAt)),1)]),a("div",nt,[it,o.row.verificatedAt?(u(),m("span",rt,d(g(C)(o.row.verificatedAt)),1)):(u(),m("span",dt,"无"))]),t(E,{modelValue:i.challengeResult,"onUpdate:modelValue":e[17]||(e[17]=l=>i.challengeResult=l)},null,8,["modelValue"]),t(v,null,{default:n(()=>[a("div",ct,[t(r,{type:"primary",onClick:e[18]||(e[18]=l=>ce(g(M)))},{default:n(()=>[V("保存")]),_:1})])]),_:1})]),_:1},8,["rules","model"])]),_:1}),t(N,{label:"业务站点",name:"relativeSites"},{default:n(()=>[t(g(J),{data:S.value,style:{width:"100%"}},{default:n(()=>[t(b,{prop:"name",label:"站点名称",width:"160"}),t(b,{prop:"isVerificated",label:"认证状态",width:"100"},{default:n(l=>[l.row.isVerification==="1"?(u(),m("div",ut,d(q(l.row.isVerification)),1)):(u(),m("div",mt,d(q(l.row.isVerification)),1))]),_:1}),t(b,{prop:"currency",label:"收款币种",width:"80"}),t(b,{prop:"isEnabled",label:"状态",width:"80"},{default:n(l=>[l.row.isEnabled==="1"?(u(),m("div",pt,d(K(l.row.isEnabled)),1)):(u(),m("div",_t,d(K(l.row.isEnabled)),1))]),_:1}),t(b,{prop:"service_fee_percent",label:"收单费率",width:"80"}),t(b,{label:"操作",width:"120"},{default:n(l=>[t(r,{link:"",type:"primary",size:"small",onClick:be=>me(l.row.id)},{default:n(()=>[V(" 管理站点 ")]),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"])]),_:1}),t(N,{label:"结算账户",name:"settlementAccount"},{default:n(()=>[t(g(J),{data:R.value,style:{width:"100%"}},{default:n(()=>[t(b,{prop:"accountName.value",label:"结算账户名称",width:"120"}),t(b,{prop:"currency.value",label:"账户币种",width:"120"}),t(b,{prop:"account.value",label:"收款账户",width:"240"}),t(b,{label:"操作",width:"130"},{default:n(l=>[t(r,{link:"",type:"primary",size:"small",onClick:be=>re(l.row)},{default:n(()=>[V(" 管理 ")]),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"])]),_:1})]),_:1},8,["modelValue"])])):(u(),m("div",vt,[ft,P.value=="USD"?(u(),m("div",yt,[a("div",ht,[bt,a("span",wt,d(f.value.currency.value),1)]),a("div",kt,[Vt,a("span",gt,d(f.value.region.value),1)]),a("div",It,[Ft,a("span",Dt,d(f.value.bankName.value),1)]),a("div",At,[St,a("span",Ut,d(f.value.bankAddress.value),1)]),a("div",Nt,[Ct,a("span",Rt,d(f.value.accountName.value),1)]),a("div",Tt,[Et,a("span",Mt,d(f.value.account.value),1)]),a("div",Pt,[xt,a("span",Lt,d(f.value.companyAddress.value),1)])])):(u(),m("div",$t,[a("div",Gt,[zt,a("span",Bt,d(f.value.currency.value),1)]),a("div",Kt,[qt,a("span",Ot,d(f.value.account.value),1)]),a("div",Zt,[Ht,a("span",jt,d(f.value.accountName.value),1)])])),a("div",Jt,[t(r,{onClick:de},{default:n(()=>[V("返回")]),_:1})]),a("div",{class:"flex-center w-full del-btn cursor-pointer mb-20",onClick:pe},"删除结算账户 ")]))]),_:1},8,["modelValue"])],64)}}}),_l=Pe(Qt,[["__scopeId","data-v-d299c5de"]]);export{_l as default};
