import{l as I,m as b,_ as V}from"./index-bEAPwbJM.js";import{e as j}from"./commonFn-DSVr4W-5.js";import{l as T,aK as q,aL as w,r as f,ah as M,m as t,p as n,q as c,U as _,R as p,M as N,S,T as B,I as F}from"./vue-BtEXIrqH.js";import{E as k}from"./element-BbMnn7tA.js";function z(u){return I({url:"/secruritytoken",method:"get",params:u})}const E={key:0,class:"w-full h-full flex-center cursor-pointer relative img-upload"},P=["for"],R=["src"],D=["id"],K=["for"],L=["src"],O={key:1},W=["id"],A=T({__name:"Index",props:q({ext:{},id:{},defaultImgUrl:{}},{modelValue:{},modelModifiers:{}}),emits:["update:modelValue"],setup(u){const g=w(u,"modelValue"),m=u,l=f(""),a=f(null),d=f(),x=e=>{const o=e.type;return m.ext==="excel"&&(o.startsWith("application/vnd.openxmlformats-officedocument.spreadsheetml.sheet")||o==="application/vnd.ms-excel")?(console.log("excel"),!0):m.ext==="img"&&["image/jpeg","image/png","image/gif","image/jpg"].includes(o)?(console.log("img"),!0):(k.error("文件格式错误"),d.value.value="",a.value=null,!1)},U=async()=>{var s,r,y;if(!a.value){k.error("请选择文件");return}if(!x(a.value))return;const o={role:"likustatics",action:"PutObject",fileName:a.value.name};try{const i=await z(o),C=(s=i.data)==null?void 0:s.url;await b({url:C,method:"put",data:a.value}),g.value=(r=i.data)==null?void 0:r.objectPath,m.ext==="img"&&(l.value=j((y=i.data)==null?void 0:y.objectPath))}catch(i){console.error(i)}},v=e=>{!e||e.target.files.length===0||(a.value=e.target.files[0],U())},h=()=>{a.value=null,g.value="",l.value="",d.value.value=""};return(e,o)=>{var r;const s=M("SvgIcon");return l.value==""&&e.defaultImgUrl?(t(),n("div",E,[c("label",{for:e.id},[c("img",{src:e.defaultImgUrl,alt:""},null,8,R),c("input",{type:"file",id:e.id,ref_key:"inputFef",ref:d,onChange:v,style:{display:"none"}},null,40,D)],8,P),e.defaultImgUrl?(t(),n("div",{key:0,class:"close flex-center",onClick:h},[_(s,{name:"icon-guanbi-quanpingdanchuang1",size:"20px"})])):p("",!0)])):(t(),n("div",{key:1,class:F([l.value?"img-upload":"upload","w-full h-full flex-center cursor-pointer relative"])},[c("label",{for:e.id,class:"w-full"},[l.value?(t(),n("img",{key:0,src:l.value,alt:""},null,8,L)):(t(),n("span",O,[a.value?p("",!0):(t(),N(s,{key:0,name:"icon-dianjishangchuan",class:"mr-10"})),S(" "+B(((r=a.value)==null?void 0:r.name)||"点击上传"),1)])),c("input",{type:"file",id:e.id,ref_key:"inputFef",ref:d,onChange:v,style:{display:"none"}},null,40,W)],8,K),a.value||l.value?(t(),n("div",{key:0,class:"close flex-center",onClick:h},[_(s,{name:"icon-guanbi-quanpingdanchuang1",size:"20px"})])):p("",!0)],2))}}}),X=V(A,[["__scopeId","data-v-e572dcf3"]]);export{X as U};
