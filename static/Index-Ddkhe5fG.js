import{l as N,aL as X,aE as Y,r as p,aK as ee,Z as T,ah as n,m as h,M as C,O as a,q as u,U as e,p as I,F as q,a7 as $,S as w,d as te,ap as le,T as F,a8 as ae,P as oe,u as c,aF as ne,aG as se}from"./vue-C87Wc4A0.js";import{u as re}from"./useTable-CVQ-UVVt.js";import{F as ue}from"./Index-BU8kA-XB.js";import{P as R,_ as P,w as ie,V as ce}from"./index-c78MVIZI.js";import{V as me}from"./index-BZHf1ii5.js";import{E as M,n as de}from"./element-CD5rsoqi.js";import"./LIKU-logo-CHqxCLOK.js";import"//at.alicdn.com/t/c/font_4557022_0o7l3b0t8egq.js";import"./vxe-sm_XFqm0.js";function pe(){return R({url:"/userblacklist/count",method:"get"})}function _e(m){return R({url:"/userblacklist/create",method:"post",data:m})}function fe(m){return R({url:"/userblacklist/delete",method:"post",data:m})}const he={class:"base-box detail-box"},be={class:"flex-center w-full mt-30"},ge=N({__name:"Create",props:X({merchantOptions:{}},{modelValue:{},modelModifiers:{}}),emits:["update:modelValue"],setup(m){Y(),p({});const b=ee(m,"modelValue"),y=p(),t=T({username:"",luMerchant:"",reason:"",challengeResult:""}),V=T({username:[{required:!0,message:"请输入用户名称",trigger:"blur"}],luMerchant:[{required:!0,message:"请选择所属站点",trigger:"change"}]}),k=async _=>{_&&await _.validate((l,g)=>{if(l){try{_e(t).then(()=>{M.success("保存成功"),setTimeout(()=>{},1e3)}).catch(d=>{M.error("操作失败"),console.error(d)})}catch(d){console.error(d)}console.log("submit!")}else console.error("error submit!",g)})};return(_,l)=>{const g=n("el-input"),d=n("el-form-item"),x=n("el-option"),B=n("el-select"),U=n("el-button"),L=n("el-form");return h(),C(ue,{modelValue:b.value,"onUpdate:modelValue":l[5]||(l[5]=o=>b.value=o),title:"添加黑名单"},{default:a(()=>[u("div",he,[e(L,{ref_key:"userBlackListFormRef",ref:y,"label-position":"top",rules:V,"label-width":"auto",model:t},{default:a(()=>[e(d,{prop:"username",label:"用户名称"},{default:a(()=>[e(g,{modelValue:t.username,"onUpdate:modelValue":l[0]||(l[0]=o=>t.username=o),placeholder:"请输入用户名称",maxlength:"50"},null,8,["modelValue"])]),_:1}),e(d,{prop:"luMerchant",label:"所属站点"},{default:a(()=>[e(B,{class:"select-currency-input",modelValue:t.luMerchant,"onUpdate:modelValue":l[1]||(l[1]=o=>t.luMerchant=o),placeholder:"请选择所属站点"},{default:a(()=>[(h(!0),I(q,null,$(_.merchantOptions,o=>(h(),C(x,{key:o.id.value,label:o.merchantName.value,value:o.id.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),e(d,{prop:"reason",label:"添加理由"},{default:a(()=>[e(g,{modelValue:t.reason,"onUpdate:modelValue":l[2]||(l[2]=o=>t.reason=o),placeholder:"请输入添加理由",type:"textarea",rows:3,maxlength:"50"},null,8,["modelValue"])]),_:1}),e(me,{modelValue:t.challengeResult,"onUpdate:modelValue":l[3]||(l[3]=o=>t.challengeResult=o)},null,8,["modelValue"]),e(d,null,{default:a(()=>[u("div",be,[e(U,{type:"primary",onClick:l[4]||(l[4]=o=>k(y.value))},{default:a(()=>[w("保存")]),_:1})])]),_:1})]),_:1},8,["rules","model"])])]),_:1},8,["modelValue"])}}}),ve=P(ge,[["__scopeId","data-v-1c5dd0c8"]]),z=m=>(ne("data-v-a13bf720"),m=m(),se(),m),Ve={class:"top-section base-box flex items-center mt-20"},ye={class:"pr-80"},ke=z(()=>u("div",{class:"item-title"},"黑名单总数",-1)),we={class:"item-price mt-10 mb-8"},Ce={class:"order base-box p-36 ml-40 mr-40 mt-20"},Me={class:"top-search"},xe={class:"table-wrapper"},Be=z(()=>u("div",{class:"action-btn cursor-pointer mr-20"},"移出黑名单 ",-1)),Ue={class:"pager-wrapper mt-32 flex justify-between"},Le=z(()=>u("div",null,null,-1)),Se=N({__name:"Index",setup(m){const b=p([]),y=p(),t=T({luMerchant:"",username:""}),V=p(!1);p({});const k=p(0),_=p({}),{paginationData:l,handleCurrentChange:g,handleSizeChange:d,tableData:x,queryTableData:B,loadingRef:U,handSearch:L,reset:o}=re({searchData:_,url:"/userblacklist/list",method:"post"});function D(){const i=[];t.luMerchant&&i.push({columnName:"luMerchant",value:t.luMerchant}),t.username&&i.push({columnName:"username",value:t.username}),_.searchItems=i,L()}function E(){t.username="",t.luMerchant=""}const K=async()=>{try{const i=await pe();k.value=i.data.totalCount}catch(i){console.error(i)}},O=async i=>{const s={id:i.id};fe(s).then(v=>{M.success("删除成功"),setTimeout(()=>{window.location.reload()},1e3)}).catch(v=>{console.error(v),M.error("操作失败")})},A=async()=>{ce({paging:{pageSize:50,pageNumber:1}}).then(s=>{b.value=s.data.rows}).catch(s=>{console.error(s)})};return te(()=>{B(),K(),A()}),(i,s)=>{const v=n("el-button"),G=n("el-option"),Z=n("el-select"),S=n("el-form-item"),j=n("el-input"),H=n("el-form"),f=n("el-table-column"),J=n("el-popconfirm"),Q=n("el-pagination"),W=le("loading");return h(),I("div",null,[u("div",Ve,[u("div",ye,[ke,u("div",we,F(k.value),1)]),e(v,{type:"primary",onClick:s[0]||(s[0]=r=>V.value=!0),class:"flex-center create-button"},{default:a(()=>[w(" 添加黑名单 ")]),_:1})]),u("div",Ce,[u("div",Me,[e(H,{inline:!0,model:t,class:"demo-form-inline"},{default:a(()=>[e(S,null,{default:a(()=>[e(Z,{modelValue:t.luMerchant,"onUpdate:modelValue":s[1]||(s[1]=r=>t.luMerchant=r),placeholder:"全部站点",clearable:""},{default:a(()=>[(h(!0),I(q,null,$(b.value,r=>(h(),C(G,{key:r.id.value,label:r.merchantName.value,value:r.id.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),e(S,null,{default:a(()=>[e(j,{modelValue:t.username,"onUpdate:modelValue":s[2]||(s[2]=r=>t.username=r),placeholder:"请输入用户名称搜寻",onKeyup:ae(D,["enter"]),clearable:""},null,8,["modelValue"])]),_:1}),e(S,null,{default:a(()=>[e(v,{class:"mr-20",onClick:E},{default:a(()=>[w("重置")]),_:1}),e(v,{type:"primary",onClick:D},{default:a(()=>[w("查询")]),_:1})]),_:1})]),_:1},8,["model"])]),u("div",xe,[oe((h(),C(c(de),{ref_key:"multipleTableRef",ref:y,data:c(x),style:{width:"100%"}},{default:a(()=>[e(f,{prop:"id",label:"用户ID","min-width":"180"}),e(f,{prop:"username",label:"用户名称","min-width":"120"}),e(f,{prop:"region",label:"国家地区","min-width":"120"}),e(f,{prop:"merchant~merchantName",label:"所属站点","min-width":"120"}),e(f,{prop:"reason",label:"添加理由","min-width":"240"}),e(f,{prop:"createdAt",label:"添加时间","min-width":"180"},{default:a(r=>[u("div",null,F(c(ie)(r.row.createdAt)),1)]),_:1}),e(f,{prop:"action",label:"操作",fixed:"right","min-width":"120"},{default:a(r=>[e(J,{title:"确定删除黑名单用户吗?",width:"200",onConfirm:Te=>O(r.row)},{reference:a(()=>[Be]),_:2},1032,["onConfirm"])]),_:1})]),_:1},8,["data"])),[[W,c(U)]])]),u("div",Ue,[Le,e(Q,{background:"",layout:c(l).layout,"page-sizes":c(l).pageSizes,total:c(l).total,"page-size":c(l).pageSize,currentPage:c(l).currentPage,onSizeChange:c(d),onCurrentChange:c(g)},null,8,["layout","page-sizes","total","page-size","currentPage","onSizeChange","onCurrentChange"])]),e(ve,{modelValue:V.value,"onUpdate:modelValue":s[3]||(s[3]=r=>V.value=r),"merchant-options":b.value},null,8,["modelValue","merchant-options"])])])}}}),Ee=P(Se,[["__scopeId","data-v-a13bf720"]]);export{Ee as default};
