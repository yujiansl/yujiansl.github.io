import{u as Ve,b as ke,_ as we,g as Ae}from"./index-Dqw4PlPF.js";import{u as Se}from"./useTable-Br0VH9YA.js";import{Z as S,r as m,l as xe,d as E,ah as _,ap as Ue,m as f,p as k,U as l,O as a,u as s,M as G,q as e,S as g,R as Ce,T as b,B as H,F as Re,a7 as De,P as Ne,aF as Fe,aG as Te}from"./vue-BtEXIrqH.js";import{F as J}from"./Index-BgrOBixy.js";import{e as qe,j as Ie,k as Pe,_ as ze}from"./index-bEAPwbJM.js";import{V as Ge}from"./index-BauZgp7a.js";import{_ as Oe}from"./Index.vue_vue_type_script_setup_true_lang-CAnY41O0.js";import{g as $e,c as Z,d as Be}from"./index-Cuh9gsAM.js";import{c as Le}from"./commonFn-DSVr4W-5.js";import{n as Me,E as w}from"./element-BbMnn7tA.js";import"./index-B3sZ9j6O.js";import"./validate-riIxJwdE.js";import"./LIKU-logo-BbnHVERV.js";import"//at.alicdn.com/t/c/font_4557022_266y8yxi6v9.js";import"./vxe-EK889JN8.js";const je=S({tradeState:"",payWay:"",channel:"",username:""}),Qe=S({currency:"",region:"",bankName:"",bankAddress:"",bankNoName:"",bankNo:"",companyAddress:"",code:""}),Ee=S({name:[{required:!0,message:"Please input Activity name",trigger:"blur"}]}),He=m(),K=m(),W=m(!1),Je=m(!1),{paginationData:Ze,handleCurrentChange:Ke,tableData:We,queryTableData:Xe,loadingRef:Ye,handSearch:et}=Se({url:"/settings/settlementaccount/list",method:"post"});function tt(){console.log("submit!")}const lt=x=>{K.value=x,W.value=!0};function ot(){return{toDetail:lt,queryForm:je,onSubmit:tt,paginationData:Ze,handleCurrentChange:Ke,tableData:We,queryTableData:Xe,loadingRef:Ye,handSearch:et,detailVisible:W,row:K,addForm:Qe,addVisible:Je,addRules:Ee,addFormRef:He}}const c=x=>(Fe("data-v-bebd6b6b"),x=x(),Te(),x),at={class:"order base-box p-36 ml-40 mr-40 mt-20"},st={class:"mx-640"},nt=c(()=>e("div",{class:"item-desc mt-14"},"如需修改登录邮箱，请联系客服",-1)),ut=c(()=>e("div",{class:"flex-center mb-60"},[e("div",{class:"item-label"},"加入时间"),e("div",{class:"item-desc"},"2023-05-3")],-1)),dt={class:"w-full flex"},ct={class:"flex justify-end w-full mb-40"},rt={class:"table-wrapper"},it={class:"pager-wrapper mt-32 flex justify-end"},mt={class:"base-box detail-box"},pt=c(()=>e("div",{class:"flex-center w-full mt-30 settlement-account-detail-title"},"结算账户详情",-1)),_t={key:0},gt={class:"settlement-account-detail-line"},vt=c(()=>e("span",{class:"settlement-account-field"},"结算币种：",-1)),ft={class:"settlement-account-value"},bt={class:"settlement-account-detail-line"},ht=c(()=>e("span",{class:"settlement-account-field"},"银行国家/地区：",-1)),yt={class:"settlement-account-value"},Vt={class:"settlement-account-detail-line"},kt=c(()=>e("span",{class:"settlement-account-field"},"银行名称：",-1)),wt={class:"settlement-account-value"},At={class:"settlement-account-detail-line"},St=c(()=>e("span",{class:"settlement-account-field"},"银行地址：",-1)),xt={class:"settlement-account-value"},Ut={class:"settlement-account-detail-line"},Ct=c(()=>e("span",{class:"settlement-account-field"}," 账号名：",-1)),Rt={class:"settlement-account-value"},Dt={class:"settlement-account-detail-line"},Nt=c(()=>e("span",{class:"settlement-account-field"},"银行账号：",-1)),Ft={class:"settlement-account-value"},Tt={class:"settlement-account-detail-line"},qt=c(()=>e("span",{class:"settlement-account-field"},"公司地址：",-1)),It={class:"settlement-account-value"},Pt={key:1},zt={class:"settlement-account-detail-line"},Gt=c(()=>e("span",{class:"settlement-account-field"},"结算币种：",-1)),Ot={class:"settlement-account-value"},$t={class:"settlement-account-detail-line"},Bt=c(()=>e("span",{class:"settlement-account-field"},"USDT 钱包地址：",-1)),Lt={class:"settlement-account-value"},Mt={class:"settlement-account-detail-line"},jt=c(()=>e("span",{class:"settlement-account-field"},"钱包名称/备注：",-1)),Qt={class:"settlement-account-value"},Et={class:"flex-center w-full mt-30 settlement-account-return-btn"},Ht={class:"detail-box"},Jt=c(()=>e("div",{class:"detail-title mb-50"},"新增结算收款账户",-1)),Zt=c(()=>e("div",{class:"select-currency"},[e("span",{class:"select-currency-flag"},"*"),e("span",{class:"select-currency-title"},"选择结算币种")],-1)),Kt={class:"flex-center w-full mt-30"},Wt={class:"flex-center w-full mt-30"},Xt=c(()=>e("div",{class:"item-desc mt-14"},"如需修改登录邮箱，请联系客服",-1)),Yt={class:"w-full flex"},el={key:0},tl=c(()=>e("div",{class:"bound-google mt-80"},[e("img",{src:we,class:"bound-google-img"}),e("div",{class:"bound-google-text ml-28"},[e("div",{class:"bound-google-title"}," 已绑定谷歌验证器 "),e("div",{class:"bound-google-tips mt-8 mb-50"}," 使用谷歌验证器 (Google Authenticator) 获取谷歌验证码 ")])],-1)),ll={class:"google-download flex ml-92"},ol={key:1},al=c(()=>e("div",{class:"google-title mt-40"},"开启谷歌安全验证，将极大的保障您的账户安全",-1)),sl=c(()=>e("div",{class:"google-text mt-30 mb-14"},"使用谷歌验证器 (Google Authenticator) 扫描二维码进行绑定",-1)),nl={class:"google-download flex"},ul={key:0,class:"auth-img mt-40 mb-50 ml-5"},dl=["src"],cl={key:1,class:"auth-img mt-40 mb-50 ml-5 flex-center"},rl={class:"google-qrcode-loading"},il={class:"w-full mb-60"},ml=c(()=>e("div",{class:"google-input-label mb-12 flex-1"},"谷歌验证码",-1)),pl={class:""},_l={class:"flex"},gl=c(()=>e("div",{class:"delete-confirm-warning"}," 确定删除结算账户吗？ ",-1)),vl=c(()=>e("div",{class:"delete-google-title"}," 谷歌验证码 ",-1)),fl={class:"delete-google-otp"},bl={class:"dialog-footer delete-confirm-footer"},hl=xe({__name:"Index",setup(x){const y=JSON.parse(qe("user-info")||"{}"),D=m(y["otp.enabled"]==="1"),V=m({otp:"",totpID:""}),X=[{value:"USD",label:"USD"},{value:"USDT",label:"USDT"}],r=S({id:"",role:"",currency:"USD",type:"10",region:"",bankName:"",bankAddress:"",account:"",accountName:"",companyAddress:"",remark:"",challengeResult:""}),v=S({id:"",role:"",currency:"USDT",type:"20",currency:"",account:"",accountName:"",challengeResult:""}),Y=S({account:[{required:!0,message:"请输入USDT(TRC20)钱包地址",trigger:"blur"}],accountName:[{required:!0,message:"请输入钱包名称/备注",trigger:"blur"}],challengeResult:[{required:!0,message:"请输入谷歌验证码",trigger:"blur"}]}),ee=S({region:[{required:!0,message:"请选择银行账户开户国家",trigger:"change"}],bankName:[{required:!0,message:"请输入银行名称",trigger:"blur"}],bankAddress:[{required:!0,message:"请输入银行地址",trigger:"blur"}],account:[{required:!0,message:"请输入完整的银行账号",trigger:"blur"}],accountName:[{required:!0,message:"请输入账号名",trigger:"blur"}],companyAddress:[{required:!0,message:"请输入公司所在地址",trigger:"blur"}],challengeResult:[{required:!0,message:"请输入谷歌验证码",trigger:"blur"}]}),O=m(),$=m(),{roles:te}=Ie(),P=m("settlementAccount"),A=m("USD"),z=m(""),p=m({}),B=m([]),N=m(!1),{toDetail:yl,queryForm:Vl,onSubmit:kl,paginationData:U,handleCurrentChange:le,tableData:wl,queryTableData:oe,loadingRef:Al,handSearch:Sl,row:xl,detailVisible:C,addForm:Ul,addVisible:F,addRules:Cl,addFormRef:Rl}=ot(),{passFormRef:T,passForm:i,passRules:L,submitPass:M,passLoading:ae}=Ve(),se=async()=>{if(!V.value.otp){w.error("请输入谷歌验证码");return}try{await ke(V.value),w.success("绑定成功"),Pe(JSON.stringify({...y,"otp.enabled":"1"}),"user-info"),D.value=y["otp.enabled"]==="1"}catch(d){console.log("getOtpQr",d)}};E(()=>{oe(),D.value=y["otp.enabled"]==="1"});const ne=async()=>{try{const d=await Ae({id:y.mer});V.value.totpID=d.data.totpId,V.value.qrcode=d.data.qrcode}catch(d){console.log("getOtpQr",d)}},ue=(d,t)=>{P.value==="google"&&!D.value&&ne()},de=()=>{const d=[];d.push({columnName:"luMerchant",value:y.mer}),$e({searchItems:d}).then(u=>{B.value=u.data.rows}).catch(u=>{console.error(u)})},ce=async d=>{d&&await d.validate((t,u)=>{if(t)try{r.currency=A,r.role="merchant",r.id=y.mer,Z(r).then(()=>{w.success("保存成功"),setTimeout(()=>{window.location.reload()},1e3)}).catch(n=>{w.error("操作失败"),console.error(n)})}catch(n){console.error(n)}else console.error("error submit!",u)})},re=async d=>{d&&await d.validate((t,u)=>{if(t)try{v.currency=A,v.role="merchant",v.id=y.mer,Z(v).then(()=>{w.success("保存成功"),setTimeout(()=>{window.location.reload()},1e3)}).catch(n=>{w.error("操作失败"),console.error(n)})}catch(n){console.error(n)}else console.error("error submit!",u)})},ie=d=>{A.value=d.currency.value,p.value=d,C.value=!0},me=d=>{C.value=!1},pe=()=>{N.value=!0},_e=async()=>{const d={id:p.value.id.value,challengeResult:z.value};Be(d).then(t=>{w.success("删除成功"),setTimeout(()=>{window.location.reload()},1e3)}).catch(t=>{w.error("操作失败"),console.log(t)})},j=()=>{window.open("https://docs.liku.io/google-authenticator","_blank")};return E(()=>{de()}),(d,t)=>{const u=_("el-input"),n=_("el-form-item"),h=_("el-button"),q=_("el-form"),I=_("el-tab-pane"),R=_("el-table-column"),ge=_("el-pagination"),ve=_("el-option"),fe=_("el-select"),Q=_("SvgIcon"),be=_("el-tabs"),he=_("el-dialog"),ye=Ue("loading");return f(),k("div",at,[l(be,{modelValue:P.value,"onUpdate:modelValue":t[26]||(t[26]=o=>P.value=o),class:"page-tabs",onTabChange:ue},{default:a(()=>[s(te).includes("admin")?(f(),G(I,{key:0,label:"账户信息",name:"info"},{default:a(()=>[e("div",st,[l(q,{ref_key:"passFormRef",ref:T,"label-position":"top",model:s(i),rules:s(L),"label-width":"auto",class:"demo-ruleForm mt-40"},{default:a(()=>[l(n,{label:"登录邮箱",prop:"currency"},{default:a(()=>[l(u,{modelValue:s(i).email,"onUpdate:modelValue":t[0]||(t[0]=o=>s(i).email=o),disabled:""},null,8,["modelValue"]),nt]),_:1}),l(n,{label:"代理名称",prop:"name"},{default:a(()=>[l(u,{modelValue:s(i).password,"onUpdate:modelValue":t[1]||(t[1]=o=>s(i).password=o),placeholder:"请输入新密码"},null,8,["modelValue"])]),_:1}),ut,l(n,null,{default:a(()=>[e("div",dt,[l(h,{type:"primary",onClick:t[2]||(t[2]=o=>s(M)(s(T)))},{default:a(()=>[g("保存")]),_:1})])]),_:1})]),_:1},8,["model","rules"])])]),_:1})):Ce("",!0),l(I,{label:"结算账户",name:"settlementAccount"},{default:a(()=>[e("div",ct,[l(h,{type:"primary",onClick:t[3]||(t[3]=o=>F.value=!0)},{default:a(()=>[g("新增结算账户")]),_:1})]),e("div",rt,[l(s(Me),{data:B.value,style:{width:"100%"}},{default:a(()=>[l(R,{prop:"accountName.value",label:"结算账户名称",width:"200"}),l(R,{prop:"currency.value",label:"账户币种",width:"200"}),l(R,{prop:"account.value",label:"收款账户",width:"260"}),l(R,{prop:"createdAt.value",label:"创建时间",width:"260"},{default:a(o=>[e("div",null,b(s(Le)(o.row.createdAt.value)),1)]),_:1}),l(R,{label:"操作",width:"120"},{default:a(o=>[l(h,{link:"",type:"primary",size:"default",onClick:Dl=>ie(o.row)},{default:a(()=>[g(" 管理结算账户 ")]),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"])]),e("div",it,[l(ge,{background:"",layout:s(U).layout,"page-sizes":s(U).pageSizes,total:s(U).total,"page-size":s(U).pageSize,currentPage:s(U).currentPage,onCurrentChange:s(le)},null,8,["layout","page-sizes","total","page-size","currentPage","onCurrentChange"])]),l(J,{modelValue:s(C),"onUpdate:modelValue":t[4]||(t[4]=o=>H(C)?C.value=o:null)},{default:a(()=>[e("div",mt,[pt,A.value=="USD"?(f(),k("div",_t,[e("div",gt,[vt,e("span",ft,b(p.value.currency.value),1)]),e("div",bt,[ht,e("span",yt,b(p.value.region.value),1)]),e("div",Vt,[kt,e("span",wt,b(p.value.bankName.value),1)]),e("div",At,[St,e("span",xt,b(p.value.bankAddress.value),1)]),e("div",Ut,[Ct,e("span",Rt,b(p.value.accountName.value),1)]),e("div",Dt,[Nt,e("span",Ft,b(p.value.account.value),1)]),e("div",Tt,[qt,e("span",It,b(p.value.companyAddress.value),1)])])):(f(),k("div",Pt,[e("div",zt,[Gt,e("span",Ot,b(p.value.currency.value),1)]),e("div",$t,[Bt,e("span",Lt,b(p.value.account.value),1)]),e("div",Mt,[jt,e("span",Qt,b(p.value.accountName.value),1)])])),e("div",Et,[l(h,{onClick:me},{default:a(()=>[g("返回")]),_:1})]),e("div",{class:"flex-center w-full del-btn cursor-pointer",onClick:pe},"删除结算账户 ")])]),_:1},8,["modelValue"]),l(J,{modelValue:s(F),"onUpdate:modelValue":t[18]||(t[18]=o=>H(F)?F.value=o:null)},{default:a(()=>[e("div",Ht,[Jt,Zt,l(fe,{class:"select-currency-input",modelValue:A.value,"onUpdate:modelValue":t[5]||(t[5]=o=>A.value=o)},{default:a(()=>[(f(),k(Re,null,De(X,o=>l(ve,{key:o.value,label:o.label,value:o.value},null,8,["label","value"])),64))]),_:1},8,["modelValue"]),A.value=="USD"?(f(),G(q,{key:0,ref_key:"settlementAccountFormRef",ref:O,"label-position":"top",rules:ee,"label-width":"auto",model:r},{default:a(()=>[l(n,{prop:"region",label:"银行国家/地区"},{default:a(()=>[l(Oe,{modelValue:r.region,"onUpdate:modelValue":t[6]||(t[6]=o=>r.region=o),type:"region",placeholder:"请选择银行账户开户国家"},null,8,["modelValue"])]),_:1}),l(n,{prop:"bankName",label:"银行名称"},{default:a(()=>[l(u,{modelValue:r.bankName,"onUpdate:modelValue":t[7]||(t[7]=o=>r.bankName=o),placeholder:"请输入银行名称",maxlength:"50"},null,8,["modelValue"])]),_:1}),l(n,{prop:"bankAddress",label:"银行地址"},{default:a(()=>[l(u,{modelValue:r.bankAddress,"onUpdate:modelValue":t[8]||(t[8]=o=>r.bankAddress=o),placeholder:"请输入银行地址",maxlength:"50"},null,8,["modelValue"])]),_:1}),l(n,{prop:"accountName",label:"账号名"},{default:a(()=>[l(u,{modelValue:r.accountName,"onUpdate:modelValue":t[9]||(t[9]=o=>r.accountName=o),placeholder:"请输入账号名",maxlength:"50"},null,8,["modelValue"])]),_:1}),l(n,{prop:"account",label:"银行账号"},{default:a(()=>[l(u,{modelValue:r.account,"onUpdate:modelValue":t[10]||(t[10]=o=>r.account=o),placeholder:"请输入完整的银行账号",maxlength:"64"},null,8,["modelValue"])]),_:1}),l(n,{prop:"companyAddress",label:"公司地址"},{default:a(()=>[l(u,{modelValue:r.companyAddress,"onUpdate:modelValue":t[11]||(t[11]=o=>r.companyAddress=o),placeholder:"请输入公司所在地址",maxlength:"50"},null,8,["modelValue"])]),_:1}),l(n,{prop:"challengeResult",label:"谷歌验证码"},{default:a(()=>[l(u,{modelValue:r.challengeResult,"onUpdate:modelValue":t[12]||(t[12]=o=>r.challengeResult=o),placeholder:"请输入谷歌验证码",minlength:"6",maxlength:"6"},null,8,["modelValue"])]),_:1}),l(n,null,{default:a(()=>[e("div",Kt,[l(h,{type:"primary",onClick:t[13]||(t[13]=o=>ce(O.value))},{default:a(()=>[g("保存 ")]),_:1})])]),_:1})]),_:1},8,["rules","model"])):(f(),G(q,{key:1,ref_key:"trcSettlementAccountFormRef",ref:$,"label-position":"top",rules:Y,"label-width":"auto",model:v},{default:a(()=>[l(n,{prop:"account",label:"USDT钱包地址"},{default:a(()=>[l(u,{modelValue:v.account,"onUpdate:modelValue":t[14]||(t[14]=o=>v.account=o),placeholder:"请输入USDT(TRC20)钱包地址",maxlength:"64"},null,8,["modelValue"])]),_:1}),l(n,{prop:"accountName",label:"钱包名称/备注"},{default:a(()=>[l(u,{modelValue:v.accountName,"onUpdate:modelValue":t[15]||(t[15]=o=>v.accountName=o),placeholder:"请输入钱包名称备注",maxlength:"30"},null,8,["modelValue"])]),_:1}),l(n,{prop:"challengeResult",label:"谷歌验证码"},{default:a(()=>[l(u,{modelValue:v.challengeResult,"onUpdate:modelValue":t[16]||(t[16]=o=>v.challengeResult=o),placeholder:"请输入谷歌验证码",minlength:"6",maxlength:"6"},null,8,["modelValue"])]),_:1}),l(n,null,{default:a(()=>[e("div",Wt,[l(h,{type:"primary",onClick:t[17]||(t[17]=o=>re($.value))},{default:a(()=>[g("保存 ")]),_:1})])]),_:1})]),_:1},8,["rules","model"]))])]),_:1},8,["modelValue"])]),_:1}),l(I,{label:"修改密码",name:"pass"},{default:a(()=>[l(q,{ref_key:"passFormRef",ref:T,"label-position":"top",model:s(i),rules:s(L),"label-width":"auto",class:"demo-ruleForm mt-40"},{default:a(()=>[l(n,{label:"登录邮箱",prop:"email"},{default:a(()=>[l(u,{modelValue:s(i).email,"onUpdate:modelValue":t[19]||(t[19]=o=>s(i).email=o),disabled:""},null,8,["modelValue"]),Xt]),_:1}),l(n,{label:"新密码",prop:"password"},{default:a(()=>[l(u,{modelValue:s(i).password,"onUpdate:modelValue":t[20]||(t[20]=o=>s(i).password=o),type:"password",placeholder:"请输入新密码"},null,8,["modelValue"])]),_:1}),l(n,{label:"确认新密码",prop:"rePass"},{default:a(()=>[l(u,{modelValue:s(i).rePass,"onUpdate:modelValue":t[21]||(t[21]=o=>s(i).rePass=o),type:"password",placeholder:"请输入确认密码"},null,8,["modelValue"])]),_:1}),l(Ge,{modelValue:s(i).challengeResult,"onUpdate:modelValue":t[22]||(t[22]=o=>s(i).challengeResult=o),onGetChallengeId:t[23]||(t[23]=o=>s(i).challengeId=o)},null,8,["modelValue"]),l(n,null,{default:a(()=>[e("div",Yt,[l(h,{type:"primary",loading:s(ae),onClick:t[24]||(t[24]=o=>s(M)(s(T)))},{default:a(()=>[g("保存")]),_:1},8,["loading"])])]),_:1})]),_:1},8,["model","rules"])]),_:1}),l(I,{label:"谷歌验证器",name:"google"},{default:a(()=>[D.value?(f(),k("div",el,[tl,e("div",ll,[e("div",{class:"cursor-pointer",onClick:j},[g(" 下载 Google Authenticator "),l(Q,{name:"icon-xiazai",class:"ml-5"})])])])):(f(),k("div",ol,[al,sl,e("div",nl,[e("div",{class:"cursor-pointer",onClick:j},[g(" 下载 Google Authenticator "),l(Q,{name:"icon-xiazai",class:"ml-5"})])]),V.value.qrcode?(f(),k("div",ul,[e("img",{src:"data:image/png;base64,"+V.value.qrcode,class:"google-auth-img"},null,8,dl)])):(f(),k("div",cl,[Ne(e("span",rl,null,512),[[ye,!0]])])),e("div",il,[ml,e("div",pl,[l(u,{modelValue:V.value.otp,"onUpdate:modelValue":t[25]||(t[25]=o=>V.value.otp=o),placeholder:"请输入谷歌验证码"},null,8,["modelValue"])])]),e("div",_l,[l(h,{type:"primary",onClick:se},{default:a(()=>[g("绑定")]),_:1})])]))]),_:1})]),_:1},8,["modelValue"]),l(he,{modelValue:N.value,"onUpdate:modelValue":t[29]||(t[29]=o=>N.value=o),center:"",style:{width:"480px"}},{footer:a(()=>[e("div",bl,[l(h,{type:"primary",onClick:_e},{default:a(()=>[g(" 确定删除 ")]),_:1}),l(h,{onClick:t[28]||(t[28]=o=>N.value=!1)},{default:a(()=>[g("取消")]),_:1})])]),default:a(()=>[gl,vl,e("div",fl,[l(u,{modelValue:z.value,"onUpdate:modelValue":t[27]||(t[27]=o=>z.value=o),minlength:"6",maxlength:"6"},null,8,["modelValue"])])]),_:1},8,["modelValue"])])}}}),El=ze(hl,[["__scopeId","data-v-bebd6b6b"]]);export{El as default};
