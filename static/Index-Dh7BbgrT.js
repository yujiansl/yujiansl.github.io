import{l as Fe,r as m,aE as Ne,Z as Te,d as Ie,ah as f,ap as Ae,m as _,p as g,q as e,T as n,U as t,O as s,S as h,P as B,V as P,F as M,a7 as q,M as N,u as i,I as j,R as T,aF as Re,aG as De}from"./vue-BtEXIrqH.js";import{u as Le}from"./useTable-Br0VH9YA.js";import{b as ze}from"./index-B3sZ9j6O.js";import{F as G}from"./Index-BgrOBixy.js";import{U as de}from"./Index-DjrcDC4L.js";import{c as Be,g as Pe,a as Me}from"./index-BmuQMldO.js";import{V as ie}from"./index-BauZgp7a.js";import{g as Z,c as E,f as re,a as ue,e as qe,t as Ee}from"./commonFn-DSVr4W-5.js";import{b as We,a as Oe}from"./index-BK5Vxhfz.js";import{n as ce,E as H}from"./element-BbMnn7tA.js";import{_ as $e}from"./index-bEAPwbJM.js";import"./LIKU-logo-BbnHVERV.js";import"//at.alicdn.com/t/c/font_4557022_266y8yxi6v9.js";import"./vxe-EK889JN8.js";const d=I=>(Re("data-v-974883f5"),I=I(),De(),I),je={class:"top-balance base-box flex flex-wrap ml-40 mr-40 mt-20 items-center"},Ge={class:"balance-item pr-80"},Ze=d(()=>e("div",{class:"item-title"},"系统未入账 (USD)",-1)),He={class:"item-price mt-10 mb-8"},Ke={class:"balance-item pr-80"},Je=d(()=>e("div",{class:"item-title"},"商户未入账 (USD)",-1)),Qe={class:"item-price mt-10 mb-8"},Xe={class:"balance-item pr-80"},Ye=d(()=>e("div",{class:"item-title"},"待审核金额 (USD)",-1)),el={class:"item-price mt-10 mb-8"},ll={class:"balance-item"},tl=d(()=>e("div",{class:"item-title"},"已入账未结算 (USD)",-1)),al={class:"item-price mt-10 mb-8"},sl={class:"order base-box p-36 ml-40 mr-40 mt-20"},ol={class:"top-search"},nl={class:"table-wrapper"},dl={class:"flex"},il=["onClick"],rl=["onClick"],ul=["onClick"],cl={class:"pager-wrapper mt-32 flex justify-between"},vl={class:"base-box detail-box"},ml=d(()=>e("div",{class:"detail-title mb-50"},"创建结算账单",-1)),_l={class:"flex-center mt-60"},pl={class:"base-box detail-box"},hl=d(()=>e("div",{class:"detail-title mb-50"},"结算账单详情",-1)),bl={class:"mb-24 flex"},fl=d(()=>e("div",{class:"order-text"},"结算批次号：",-1)),gl={class:"order-value"},xl={class:"mb-24 flex"},Vl=d(()=>e("div",{class:"order-text"},"结算状态：",-1)),wl={class:"order-value"},yl={class:"mb-24 flex"},Cl=d(()=>e("div",{class:"order-text"},"结算金额：",-1)),kl={class:"order-value"},Sl={class:"mb-24 flex"},Ul=d(()=>e("div",{class:"order-text"},"订单笔数：",-1)),Fl={class:"order-value"},Nl={class:"mb-24 flex"},Tl=d(()=>e("div",{class:"order-text"},"结算手续费：",-1)),Il={class:"order-value"},Al={class:"mb-24 flex"},Rl=d(()=>e("div",{class:"order-text"},"账单时间：",-1)),Dl={class:"order-value"},Ll=d(()=>e("div",{class:"order-line mt-42 mb-40"},null,-1)),zl={key:0},Bl={class:"mb-24 flex"},Pl=d(()=>e("div",{class:"order-text"},"实际结算金额：",-1)),Ml={class:"order-value"},ql={class:"mb-24 flex"},El=d(()=>e("div",{class:"order-text"},"结算收款账户：",-1)),Wl={class:"order-value"},Ol={class:"mb-24 flex"},$l=d(()=>e("div",{class:"order-text"},"申请结算时间：",-1)),jl={class:"order-value"},Gl={key:0,class:"mb-24 flex"},Zl=d(()=>e("div",{class:"order-text"},"结算打款凭证：",-1)),Hl={class:"order-value"},Kl=["src"],Jl=d(()=>e("div",{class:"order-line mt-42 mb-40"},null,-1)),Ql={key:1},Xl={class:"flex-center mt-60"},Yl={class:"base-box detail-box"},et=d(()=>e("div",{class:"detail-title mb-50"},"结算账单",-1)),lt={class:"mb-24 flex"},tt=d(()=>e("div",{class:"order-text"},"结算批次号：",-1)),at={class:"order-value"},st={class:"mb-24 flex"},ot=d(()=>e("div",{class:"order-text"},"结算状态：",-1)),nt={class:"order-value"},dt={class:"mb-24 flex"},it=d(()=>e("div",{class:"order-text"},"结算金额：",-1)),rt={class:"order-value"},ut={class:"mb-24 flex"},ct=d(()=>e("div",{class:"order-text"},"订单币种金额：",-1)),vt={class:"order-value"},mt={class:"mb-24 flex"},_t=d(()=>e("div",{class:"order-text"},"实际入账金额：",-1)),pt={class:"order-value"},ht={class:"mb-24 flex"},bt=d(()=>e("div",{class:"order-text"},"订单笔数：",-1)),ft={class:"order-value"},gt={class:"mb-24 flex"},xt=d(()=>e("div",{class:"order-text"},"收单手续费：",-1)),Vt={class:"order-value"},wt={class:"mb-24 flex"},yt=d(()=>e("div",{class:"order-text"},"结算手续费：",-1)),Ct={class:"order-value"},kt={class:"mb-24 flex"},St=d(()=>e("div",{class:"order-text"},"账单时间：",-1)),Ut={class:"order-value"},Ft=d(()=>e("div",{class:"order-line mt-42 mb-40"},null,-1)),Nt={class:"mb-24 flex"},Tt=d(()=>e("div",{class:"order-text"},"实际结算金额：",-1)),It={class:"order-value"},At={class:"flex-center mt-60"},Rt=Fe({__name:"Index",setup(I){const V=m("first"),K=m([]),y=m({}),ve=Ne(),v=m({channelCode:"",processNo:"",channel:"",username:""}),J=m(""),k=m({}),u=m({documentFile:"",challengeResult:"",challengeId:"",remark:""}),me=Te({channelCode:[{required:!0,message:"请选择上游通道",trigger:"change"}],settlementTotal:[{required:!0,message:"请输入实际入账金额",trigger:"blur"}],challengeResult:[{required:!0,message:"请输入验证码",trigger:"change"}]}),W=m(!1),Q=m(null),b=m({channelCode:"",settlementCurrency:"",settlementFile:"",settlementTotal:"",challengeId:"",challengeResult:""}),O=m([]),_e=[{label:"全部狀態",value:"1"},{label:"待支付",value:"10"},{label:"支付成功",value:"20"},{label:"支付失败",value:"30"}],A=m(!1),R=m(!1),X=m(!1),D=m(!1),r=m({}),$=[{label:"可结算",value:"10"},{label:"审核中",value:"20"},{label:"已结算",value:"30"}],{paginationData:S,handleCurrentChange:pe,tableData:Y,queryTableData:he,loadingRef:ee,handSearch:be}=Le({searchData:v.value,url:"/settlement/list",method:"post"});function U(){const o=[];for(const a in v.value){const w=v.value[a];w&&o.push({columnName:a,value:w})}be(o,V.value==="first"?"/settlement/list":"/settlementprocess/list")}const fe=async()=>{try{const o=await ze();O.value=o.data.map(a=>({name:a.code,value:a.code}))}catch(o){console.log(o,"e")}},le=()=>{v.value={}},ge=o=>{var a;return(a=_e.filter(w=>w.value===o)[0])==null?void 0:a.label},xe=o=>{ve.push({name:"balanceConfirm",query:{processNo:o}})},te=async()=>{try{D.value=!0;const o={documentFile:u.value.documentFile,challengeId:u.value.challengeId,challengeResult:u.value.challengeResult,remark:u.value.remark,state:"30"},a=await We(o,y.value.id);H.success("提交成功"),A.value=!1,D.value=!1,u.value={},U(),console.log(a,"res")}catch(o){D.value=!1,console.log(o,"createBalance")}},Ve=async o=>{o&&await o.validate(async(a,w)=>{if(!b.value.settlementFile){H.error("请上传上游账单");return}if(a){W.value=!0;try{await Be(b.value),H.success("上传上游账单成功"),W.value=!1,R.value=!1,V.value="second",he("/settlementprocess/list")}catch{W.value=!1}}else console.log("error submit!",w)})},we=()=>{b.value={},R.value=!0},ae=(o,a)=>{J.value=a,o.state!=="10"&&ke(o.luWithdraw),r.value=o,A.value=!0},ye=async()=>{try{const o=await Pe();k.value=o.data||{}}catch(o){console.log("getStaticsData",o)}},Ce=async()=>{try{const o=await Me({paging:{pageNumber:1,pageSize:200}});K.value=o.data.items}catch{}},ke=async o=>{try{const a=await Oe({paging:{pageNumber:1,pageSize:30}},o);y.value=Ee(a.data.rows)[0]||{},console.log("getWithdrawList.value",a.data)}catch(a){console.log(a,"getWithdrawList")}};return Ie(()=>{U(),Ce(),fe(),ye()}),(o,a)=>{const w=f("SvgIcon"),x=f("el-button"),se=f("el-tab-pane"),Se=f("el-tabs"),L=f("el-option"),z=f("el-select"),p=f("el-form-item"),C=f("el-input"),F=f("el-form"),c=f("el-table-column"),Ue=f("el-pagination"),oe=Ae("loading");return _(),g("div",null,[e("div",je,[e("div",Ge,[Ze,e("div",He,n(k.value.onAir),1)]),e("div",Ke,[Je,e("div",Qe,n(k.value.merchantOnAir),1)]),e("div",Xe,[Ye,e("div",el,n(k.value.approving),1)]),e("div",ll,[tl,e("div",al,n(k.value.settled),1)]),t(x,{type:"primary",onClick:we,style:{height:"50px"},class:"flex-center"},{default:s(()=>[t(w,{class:"mr-8",name:"icon-tianjiaxinzhandian"}),h(" 创建结算账单 ")]),_:1})]),e("div",sl,[t(Se,{modelValue:V.value,"onUpdate:modelValue":a[0]||(a[0]=l=>V.value=l),class:"",onTabChange:U},{default:s(()=>[t(se,{label:"结算账单记录",name:"first"}),t(se,{label:"通道结算账单记录",name:"second"})]),_:1},8,["modelValue"]),e("div",ol,[B(t(F,{inline:!0,model:v.value,class:"demo-form-inline"},{default:s(()=>[t(p,null,{default:s(()=>[t(z,{modelValue:v.value.luVirtualMerchant,"onUpdate:modelValue":a[1]||(a[1]=l=>v.value.luVirtualMerchant=l),placeholder:"全部站点",clearable:""},{default:s(()=>[(_(!0),g(M,null,q(K.value,l=>(_(),N(L,{key:l.virtualMerchantId,label:l.name,value:l.virtualMerchantId},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),t(p,null,{default:s(()=>[t(z,{modelValue:v.value.state,"onUpdate:modelValue":a[2]||(a[2]=l=>v.value.state=l),placeholder:"全部结算状态",clearable:""},{default:s(()=>[(_(),g(M,null,q($,l=>t(L,{key:l.value,label:l.label,value:l.value},null,8,["label","value"])),64))]),_:1},8,["modelValue"])]),_:1}),t(p,null,{default:s(()=>[t(C,{modelValue:v.value.settlementProcessNo,"onUpdate:modelValue":a[3]||(a[3]=l=>v.value.settlementProcessNo=l),placeholder:"请输入结算批次号搜寻",clearable:""},null,8,["modelValue"])]),_:1}),t(p,null,{default:s(()=>[t(x,{type:"primary",onClick:le},{default:s(()=>[h("重置")]),_:1}),t(x,{type:"primary",onClick:U},{default:s(()=>[h("查询")]),_:1})]),_:1})]),_:1},8,["model"]),[[P,V.value==="first"]]),B(t(F,{inline:!0,model:v.value,class:"demo-form-inline"},{default:s(()=>[t(p,null,{default:s(()=>[t(z,{modelValue:v.value.channelCode,"onUpdate:modelValue":a[4]||(a[4]=l=>v.value.channelCode=l),placeholder:"通道名称",clearable:""},{default:s(()=>[(_(!0),g(M,null,q(O.value,l=>(_(),N(L,{key:l.value,label:l.name,value:l.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),t(p,null,{default:s(()=>[t(C,{modelValue:v.value.processNo,"onUpdate:modelValue":a[5]||(a[5]=l=>v.value.processNo=l),placeholder:"请输入结算批次号搜寻",clearable:""},null,8,["modelValue"])]),_:1}),t(p,null,{default:s(()=>[t(x,{type:"primary",onClick:le},{default:s(()=>[h("重置")]),_:1}),t(x,{type:"primary",onClick:U},{default:s(()=>[h("查询")]),_:1})]),_:1})]),_:1},8,["model"]),[[P,V.value==="second"]])]),e("div",nl,[B((_(),N(i(ce),{data:i(Y),style:{width:"100%"}},{default:s(()=>[t(c,{prop:"settlementProcessNo",label:"结算批次号",width:"200"}),t(c,{prop:"state",label:"结算状态",width:"100"},{default:s(l=>[e("div",{class:j(i(Z)(l.row.state).class)},n(i(Z)(l.row.state).value),3)]),_:1}),t(c,{prop:"virtualMerchant~merchantName",label:"站点名称",width:"150"}),t(c,{prop:"merchant~merchantName",label:"商户名称",width:"150"}),t(c,{prop:"agent~agentName",label:"代理名称",width:"150"}),t(c,{prop:"settlementTotal",label:"结算金额",width:"200"},{default:s(l=>[h(n(l.row.settlementTotal+" "+l.row.settlementCurrency),1)]),_:1}),t(c,{prop:"orderTotal",label:"订单币种金额",width:"200"},{default:s(l=>[h(n(l.row.orderTotal+" "+l.row.orderCurrency),1)]),_:1}),t(c,{prop:"averageExchangeRate",label:"汇率",width:"200"}),t(c,{prop:"orderCount",label:"订单笔数",width:"100"}),t(c,{prop:"createdAt",label:"账单时间",width:"200"},{default:s(l=>[e("div",null,n(i(E)(l.row.createdAt)),1)]),_:1}),t(c,{prop:"action",label:"操作",fixed:"right",width:"150"},{default:s(l=>[e("div",dl,[l.row.state==="20"?(_(),g("div",{key:0,class:"action-btn cursor-pointer mr-20",onClick:ne=>ae(l.row,"auth")}," 审核 ",8,il)):T("",!0),e("div",{class:"action-btn cursor-pointer",onClick:ne=>ae(l.row,"detail")},"查看详情",8,rl)])]),_:1})]),_:1},8,["data"])),[[P,V.value==="first"],[oe,i(ee)]]),B((_(),N(i(ce),{data:i(Y),style:{width:"100%"}},{default:s(()=>[t(c,{prop:"processNo",label:"结算批次号",width:"200"}),t(c,{prop:"state",label:"状态"},{default:s(l=>[e("div",{class:j(i(re)(l.row.state).class)},n(i(re)(l.row.state).value),3)]),_:1}),t(c,{prop:"channelCode",label:"通道名称"},{default:s(l=>[h(n(l.row.channelCode+"通道"),1)]),_:1}),t(c,{prop:"settlementTotal",label:"结算金额"},{default:s(l=>[h(n((l.row.settlementTotal||0)+"USD"),1)]),_:1}),t(c,{prop:"createdAt",label:"结算日期"},{default:s(l=>[h(n(ge(l.row.tradeState)),1)]),_:1}),t(c,{prop:"action",label:"操作"},{default:s(l=>[l.row.state.toString()==="20"?(_(),g("div",{key:0,class:"action-btn",onClick:ne=>xe(l.row.processNo)}," 确认账单 ",8,ul)):T("",!0)]),_:1})]),_:1},8,["data"])),[[P,V.value==="second"],[oe,i(ee)]])]),e("div",cl,[t(Ue,{background:"",layout:i(S).layout,"page-sizes":i(S).pageSizes,total:i(S).total,"page-size":i(S).pageSize,currentPage:i(S).currentPage,onCurrentChange:i(pe)},null,8,["layout","page-sizes","total","page-size","currentPage","onCurrentChange"])]),t(G,{modelValue:R.value,"onUpdate:modelValue":a[11]||(a[11]=l=>R.value=l)},{default:s(()=>[e("div",vl,[ml,t(F,{"label-position":"top","label-width":"auto",ref_key:"billFormRef",ref:Q,rules:me,model:b.value},{default:s(()=>[t(p,{label:"选择上游通道",prop:"channelCode"},{default:s(()=>[t(z,{modelValue:b.value.channelCode,"onUpdate:modelValue":a[6]||(a[6]=l=>b.value.channelCode=l),placeholder:"请选择上游通道"},{default:s(()=>[(_(!0),g(M,null,q(O.value,l=>(_(),N(L,{key:l.value,label:l.name+"通道",value:l.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),t(p,{label:"上传上游账单",prop:"settlementFile"},{default:s(()=>[t(de,{modelValue:b.value.settlementFile,"onUpdate:modelValue":a[7]||(a[7]=l=>b.value.settlementFile=l),id:"settlementFile",ext:"excel"},null,8,["modelValue"])]),_:1}),t(p,{label:"实际入账金额",prop:"settlementTotal"},{default:s(()=>[t(C,{modelValue:b.value.settlementTotal,"onUpdate:modelValue":a[8]||(a[8]=l=>b.value.settlementTotal=l),placeholder:"请输入实际入账金额"},null,8,["modelValue"])]),_:1}),t(ie,{modelValue:b.value.challengeResult,"onUpdate:modelValue":a[9]||(a[9]=l=>b.value.challengeResult=l)},null,8,["modelValue"]),e("div",_l,[t(x,{type:"primary",onClick:a[10]||(a[10]=l=>Ve(Q.value))},{default:s(()=>[h("上传上游账单")]),_:1})])]),_:1},8,["rules","model"])])]),_:1},8,["modelValue"]),t(G,{modelValue:A.value,"onUpdate:modelValue":a[16]||(a[16]=l=>A.value=l)},{default:s(()=>[e("div",pl,[hl,e("div",bl,[fl,e("div",gl,n(r.value.settlementProcessNo),1)]),e("div",xl,[Vl,e("div",wl,[e("div",{class:j(i(Z)(r.value.state).class)},n(i(ue)(r.value.state,$)),3)])]),e("div",yl,[Cl,e("div",kl,n(r.value.settlementTotal+" "+r.value.settlementCurrency),1)]),e("div",Sl,[Ul,e("div",Fl,n(r.value.orderCount),1)]),e("div",Nl,[Tl,e("div",Il,n(r.value.createdAt),1)]),e("div",Al,[Rl,e("div",Dl,n(i(E)(r.value.createdAt)),1)]),Ll,r.value.state!=="10"?(_(),g("div",zl,[e("div",Bl,[Pl,e("div",Ml,n(y.value.settlementAmount||0),1)]),e("div",ql,[El,e("div",Wl,n(y.value["settlementAccount~accountName"]||""),1)]),e("div",Ol,[$l,e("div",jl,n(i(E)(y.value.createdAt||"")),1)]),r.value.state==="30"?(_(),g("div",Gl,[Zl,e("div",Hl,[e("img",{src:i(qe)(y.value.documentFile),style:{width:"100px",height:"auto"},alt:""},null,8,Kl)])])):T("",!0),Jl])):T("",!0),r.value.state==="20"&&J.value==="auth"?(_(),g("div",Ql,[t(F,{"label-position":"top","label-width":"auto",model:u.value},{default:s(()=>[t(p,{label:"结算打款凭证"},{default:s(()=>[t(de,{modelValue:u.value.documentFile,"onUpdate:modelValue":a[12]||(a[12]=l=>u.value.documentFile=l),id:"documentFile",ext:"img"},null,8,["modelValue"])]),_:1}),t(p,{label:"结算备注"},{default:s(()=>[t(C,{modelValue:u.value.remark,"onUpdate:modelValue":a[13]||(a[13]=l=>u.value.remark=l),placeholder:"请输入结算备注",maxlength:"50"},null,8,["modelValue"])]),_:1}),t(ie,{modelValue:u.value.challengeResult,"onUpdate:modelValue":a[14]||(a[14]=l=>u.value.challengeResult=l),onGetChallengeId:a[15]||(a[15]=l=>u.value.challengeId=l)},null,8,["modelValue"]),e("div",Xl,[t(x,{type:"primary",loading:D.value,onClick:te},{default:s(()=>[h("确认并申请结算")]),_:1},8,["loading"])])]),_:1},8,["model"])])):T("",!0)])]),_:1},8,["modelValue"]),t(G,{modelValue:X.value,"onUpdate:modelValue":a[19]||(a[19]=l=>X.value=l)},{default:s(()=>[e("div",Yl,[et,e("div",lt,[tt,e("div",at,n(r.value.settlementProcessNo),1)]),e("div",st,[ot,e("div",nt,n(i(ue)(r.value.state,$)),1)]),e("div",dt,[it,e("div",rt,n(r.value.settlementTotal),1)]),e("div",ut,[ct,e("div",vt,n(r.value.orderTotal),1)]),e("div",mt,[_t,e("div",pt,n(r.value.createdAt),1)]),e("div",ht,[bt,e("div",ft,n(r.value.orderCount),1)]),e("div",gt,[xt,e("div",Vt,n(r.value.accountName),1)]),e("div",wt,[yt,e("div",Ct,n(r.value.accountName),1)]),e("div",kt,[St,e("div",Ut,n(i(E)(r.value.createdAt)),1)]),Ft,e("div",Nt,[Tt,e("div",It,n(r.value.accountName),1)]),e("div",null,[t(F,{"label-position":"top","label-width":"auto",model:u.value},{default:s(()=>[t(p,{label:"结算收款账户"},{default:s(()=>[t(C,{modelValue:u.value.account,"onUpdate:modelValue":a[17]||(a[17]=l=>u.value.account=l)},null,8,["modelValue"])]),_:1}),t(p,{label:"谷歌验证码"},{default:s(()=>[t(C,{modelValue:u.value.code,"onUpdate:modelValue":a[18]||(a[18]=l=>u.value.code=l)},null,8,["modelValue"])]),_:1}),e("div",At,[t(x,{type:"primary",onClick:te},{default:s(()=>[h("确认并申请结算")]),_:1})])]),_:1},8,["model"])])])]),_:1},8,["modelValue"])])])}}}),Ht=$e(Rt,[["__scopeId","data-v-974883f5"]]);export{Ht as default};
