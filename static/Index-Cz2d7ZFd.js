import{u as xe,b as Ue,_ as Re,g as Ce}from"./index-Dqw4PlPF.js";import{u as De}from"./useTable-Br0VH9YA.js";import{Z as A,r as i,l as Ne,d as Q,ah as g,ap as Fe,m as y,p as w,U as l,O as o,q as e,T as _,u,S as v,B as H,F as qe,a7 as Te,M as J,P as Ie,aF as Pe,aG as Ge}from"./vue-BtEXIrqH.js";import{F as Z}from"./Index-BgrOBixy.js";import{e as Oe,j as ze,k as $e,_ as Be}from"./index-bEAPwbJM.js";import{V as Le}from"./index-BauZgp7a.js";import{g as je,c as E,d as Me}from"./index-Cuh9gsAM.js";import{b as Qe,u as He}from"./index-COelV0l7.js";import{_ as Je}from"./Index.vue_vue_type_script_setup_true_lang-CAnY41O0.js";import{c as K}from"./commonFn-DSVr4W-5.js";import{n as Ze,E as V}from"./element-BbMnn7tA.js";import"./index-B3sZ9j6O.js";import"./validate-riIxJwdE.js";import"./LIKU-logo-BbnHVERV.js";import"//at.alicdn.com/t/c/font_4557022_266y8yxi6v9.js";import"./vxe-EK889JN8.js";const Ee=A({tradeState:"",payWay:"",channel:"",username:""}),Ke=A({currency:"",region:"",bankName:"",bankAddress:"",bankNoName:"",bankNo:"",companyAddress:"",code:""}),We=A({name:[{required:!0,message:"Please input Activity name",trigger:"blur"}]}),Xe=i(),W=i(),X=i(!1),Ye=i(!1),{paginationData:et,handleCurrentChange:tt,tableData:lt,queryTableData:at,loadingRef:ot,handSearch:st}=De({url:"/settings/settlementaccount/list",method:"post"});function nt(){console.log("submit!")}const ct=U=>{W.value=U,X.value=!0};function ut(){return{toDetail:ct,queryForm:Ee,onSubmit:nt,paginationData:et,handleCurrentChange:tt,tableData:lt,queryTableData:at,loadingRef:ot,handSearch:st,detailVisible:X,row:W,addForm:Ke,addVisible:Ye,addRules:We,addFormRef:Xe}}const d=U=>(Pe("data-v-46cb63ee"),U=U(),Ge(),U),dt={class:"order base-box p-36 ml-40 mr-40 mt-20"},rt={class:"mx-640"},it=d(()=>e("div",{class:"item-desc mt-14"},"如需修改登录邮箱，请联系客服",-1)),mt={class:"create-at mb-60"},pt=d(()=>e("div",{class:"item-label"},"加入时间",-1)),gt={class:"item-desc"},_t={class:"w-full flex"},vt={class:"flex justify-end w-full mb-40"},ft={class:"table-wrapper"},bt={class:"pager-wrapper mt-32 flex justify-end"},ht={class:"base-box detail-box"},yt=d(()=>e("div",{class:"flex-center w-full mt-30 settlement-account-detail-title"},"结算账户详情",-1)),Vt={key:0},At={class:"settlement-account-detail-line"},kt=d(()=>e("span",{class:"settlement-account-field"},"结算币种：",-1)),wt={class:"settlement-account-value"},St={class:"settlement-account-detail-line"},xt=d(()=>e("span",{class:"settlement-account-field"},"银行国家/地区：",-1)),Ut={class:"settlement-account-value"},Rt={class:"settlement-account-detail-line"},Ct=d(()=>e("span",{class:"settlement-account-field"},"银行名称：",-1)),Dt={class:"settlement-account-value"},Nt={class:"settlement-account-detail-line"},Ft=d(()=>e("span",{class:"settlement-account-field"},"银行地址：",-1)),qt={class:"settlement-account-value"},Tt={class:"settlement-account-detail-line"},It=d(()=>e("span",{class:"settlement-account-field"}," 账号名：",-1)),Pt={class:"settlement-account-value"},Gt={class:"settlement-account-detail-line"},Ot=d(()=>e("span",{class:"settlement-account-field"},"银行账号：",-1)),zt={class:"settlement-account-value"},$t={class:"settlement-account-detail-line"},Bt=d(()=>e("span",{class:"settlement-account-field"},"公司地址：",-1)),Lt={class:"settlement-account-value"},jt={key:1},Mt={class:"settlement-account-detail-line"},Qt=d(()=>e("span",{class:"settlement-account-field"},"结算币种：",-1)),Ht={class:"settlement-account-value"},Jt={class:"settlement-account-detail-line"},Zt=d(()=>e("span",{class:"settlement-account-field"},"USDT 钱包地址：",-1)),Et={class:"settlement-account-value"},Kt={class:"settlement-account-detail-line"},Wt=d(()=>e("span",{class:"settlement-account-field"},"钱包名称/备注：",-1)),Xt={class:"settlement-account-value"},Yt={class:"flex-center w-full mt-30 settlement-account-return-btn"},el={class:"detail-box"},tl=d(()=>e("div",{class:"detail-title mb-50"},"新增结算收款账户",-1)),ll=d(()=>e("div",{class:"select-currency"},[e("span",{class:"select-currency-flag"},"*"),e("span",{class:"select-currency-title"},"选择结算币种")],-1)),al={class:"flex-center w-full mt-30"},ol={class:"flex-center w-full mt-30"},sl=d(()=>e("div",{class:"item-desc mt-14"},"如需修改登录邮箱，请联系客服",-1)),nl={class:"w-full flex"},cl={key:0},ul=d(()=>e("div",{class:"bound-google mt-80"},[e("img",{src:Re,class:"bound-google-img"}),e("div",{class:"bound-google-text ml-28"},[e("div",{class:"bound-google-title"}," 已绑定谷歌验证器 "),e("div",{class:"bound-google-tips mt-8 mb-50"}," 使用谷歌验证器 (Google Authenticator) 获取谷歌验证码 ")])],-1)),dl={class:"google-download flex ml-92"},rl={key:1},il=d(()=>e("div",{class:"google-title mt-40"},"开启谷歌安全验证，将极大的保障您的账户安全",-1)),ml=d(()=>e("div",{class:"google-text mt-30 mb-14"},"使用谷歌验证器 (Google Authenticator) 扫描二维码进行绑定",-1)),pl={class:"google-download flex"},gl={key:0,class:"auth-img mt-40 mb-50 ml-5"},_l=["src"],vl={key:1,class:"auth-img mt-40 mb-50 ml-5 flex-center"},fl={class:"google-qrcode-loading"},bl={class:"w-full mb-60"},hl=d(()=>e("div",{class:"google-input-label mb-12 flex-1"},"谷歌验证码",-1)),yl={class:""},Vl={class:"flex"},Al=d(()=>e("div",{class:"delete-confirm-warning"}," 确定删除结算账户吗？ ",-1)),kl=d(()=>e("div",{class:"delete-google-title"}," 谷歌验证码 ",-1)),wl={class:"delete-google-otp"},Sl={class:"dialog-footer delete-confirm-footer"},xl=Ne({__name:"Index",setup(U){const S=JSON.parse(Oe("user-info")||"{}"),N=i(S["otp.enabled"]==="1"),k=i({otp:"",totpID:""}),Y=[{value:"USD",label:"USD"},{value:"USDT",label:"USDT"}],r=A({id:"",role:"",currency:"USD",type:"10",region:"",bankName:"",bankAddress:"",account:"",accountName:"",companyAddress:"",remark:"",challengeResult:""}),f=A({id:"",role:"",currency:"USDT",type:"20",currency:"",account:"",accountName:"",challengeResult:""}),ee=A({account:[{required:!0,message:"请输入USDT(TRC20)钱包地址",trigger:"blur"}],accountName:[{required:!0,message:"请输入钱包名称/备注",trigger:"blur"}],challengeResult:[{required:!0,message:"请输入谷歌验证码",trigger:"blur"}]}),te=A({region:[{required:!0,message:"请选择银行账户开户国家",trigger:"change"}],bankName:[{required:!0,message:"请输入银行名称",trigger:"blur"}],bankAddress:[{required:!0,message:"请输入银行地址",trigger:"blur"}],account:[{required:!0,message:"请输入完整的银行账号",trigger:"blur"}],accountName:[{required:!0,message:"请输入账号名",trigger:"blur"}],companyAddress:[{required:!0,message:"请输入公司所在地址",trigger:"blur"}],challengeResult:[{required:!0,message:"请输入谷歌验证码",trigger:"blur"}]}),z=i(),$=i(),B=i();ze();const F=i("info"),x=i("USD"),G=i(""),m=i({}),O=i(null),q=i(!1),p=A({id:"",name:"",email:"",createdAt:""}),le=A({name:[{required:!0,message:"请输入代理名称",trigger:"blur"}]}),{toDetail:Ul,queryForm:Rl,onSubmit:Cl,paginationData:R,handleCurrentChange:ae,tableData:Dl,queryTableData:oe,loadingRef:Nl,handSearch:Fl,row:ql,detailVisible:C,addForm:Tl,addVisible:T,addRules:Il,addFormRef:Pl}=ut(),{passFormRef:L,passForm:b,passRules:se,submitPass:ne,passLoading:ce}=xe(),ue=async()=>{if(!k.value.otp){V.error("请输入谷歌验证码");return}try{await Ue(k.value),V.success("绑定成功"),$e(JSON.stringify({...S,"otp.enabled":"1"}),"user-info"),N.value=S["otp.enabled"]==="1"}catch(c){console.log("getOtpQr",c)}};Q(()=>{oe(),N.value=S["otp.enabled"]==="1"});const de=async()=>{try{const c=await Ce({id:S.agent});k.value.totpID=c.data.totpId,k.value.qrcode=c.data.qrcode}catch(c){console.log("getOtpQr",c)}},re=(c,t)=>{F.value==="settlementAccount"&&!O.value&&ie(),F.value==="google"&&!N.value&&de()},ie=()=>{const c=[];c.push({columnName:"luAgent",value:p.id}),je({searchItems:c}).then(s=>{O.value=s.data.rows}).catch(s=>{console.error(s)})},me=async c=>{c&&await c.validate((t,s)=>{if(t)try{r.currency=x,r.role="agent",r.id=S.agent,E(r).then(()=>{V.success("保存成功"),setTimeout(()=>{window.location.reload()},1e3)}).catch(n=>{V.error("操作失败"),console.error(n)})}catch(n){console.error(n)}else console.error("error submit!",s)})},pe=async c=>{c&&await c.validate((t,s)=>{if(t)try{f.currency=x,f.role="agent",f.id=S.agent,E(f).then(()=>{V.success("保存成功"),setTimeout(()=>{window.location.reload()},1e3)}).catch(n=>{V.error("操作失败"),console.error(n)})}catch(n){console.error(n)}else console.error("error submit!",s)})},ge=c=>{x.value=c.currency.value,m.value=c,C.value=!0},_e=c=>{C.value=!1},ve=()=>{q.value=!0},fe=async()=>{const c={id:m.value.id.value,challengeResult:G.value};Me(c).then(t=>{V.success("删除成功"),setTimeout(()=>{window.location.reload()},1e3)}).catch(t=>{V.error("操作失败"),console.log(t)})},be=async()=>{const c={id:"",account:"yes"},t=new URLSearchParams(Object.entries(c)).toString();Qe(t).then(s=>{p.id=s.data.id,p.email=s.data.email,p.name=s.data.agentName,p.createdAt=s.data.createdAt}).catch(s=>{console.log(s)})},j=()=>{window.open("https://docs.liku.io/google-authenticator","_blank")},he=async c=>{c&&await c.validate((t,s)=>{if(t)try{He(p).then(()=>{V.success("保存成功")}).catch(n=>{V.error("操作失败"),console.error(n)})}catch(n){console.error(n)}else console.error("error submit!",s)})};return Q(()=>{be()}),(c,t)=>{const s=g("el-input"),n=g("el-form-item"),h=g("el-button"),I=g("el-form"),P=g("el-tab-pane"),D=g("el-table-column"),ye=g("el-pagination"),Ve=g("el-option"),Ae=g("el-select"),M=g("SvgIcon"),ke=g("el-tabs"),we=g("el-dialog"),Se=Fe("loading");return y(),w("div",dt,[l(ke,{modelValue:F.value,"onUpdate:modelValue":t[26]||(t[26]=a=>F.value=a),class:"page-tabs",onTabChange:re},{default:o(()=>[l(P,{label:"账户信息",name:"info"},{default:o(()=>[e("div",rt,[l(I,{ref_key:"agentFormRef",ref:B,"label-position":"top",model:p,rules:le,"label-width":"auto",class:"demo-ruleForm mt-40"},{default:o(()=>[l(n,{label:"登录邮箱",prop:"email"},{default:o(()=>[l(s,{modelValue:p.email,"onUpdate:modelValue":t[0]||(t[0]=a=>p.email=a),disabled:""},null,8,["modelValue"]),it]),_:1}),l(n,{label:"代理名称",prop:"agentName"},{default:o(()=>[l(s,{modelValue:p.name,"onUpdate:modelValue":t[1]||(t[1]=a=>p.name=a),placeholder:"请输入代理名称",minlength:"1",maxlength:"30"},null,8,["modelValue"])]),_:1}),e("div",mt,[pt,e("div",gt,_(u(K)(p.createdAt)),1)]),l(n,null,{default:o(()=>[e("div",_t,[l(h,{type:"primary",onClick:t[2]||(t[2]=a=>he(B.value))},{default:o(()=>[v("保存")]),_:1})])]),_:1})]),_:1},8,["model","rules"])])]),_:1}),l(P,{label:"结算账户",name:"settlementAccount"},{default:o(()=>[e("div",vt,[l(h,{type:"primary",onClick:t[3]||(t[3]=a=>T.value=!0)},{default:o(()=>[v("新增结算账户")]),_:1})]),e("div",ft,[l(u(Ze),{data:O.value,style:{width:"100%"}},{default:o(()=>[l(D,{prop:"accountName.value",label:"结算账户名称",width:"200"}),l(D,{prop:"currency.value",label:"账户币种",width:"200"}),l(D,{prop:"account.value",label:"收款账户",width:"260"}),l(D,{prop:"createdAt.value",label:"创建时间",width:"260"},{default:o(a=>[e("div",null,_(u(K)(a.row.createdAt.value)),1)]),_:1}),l(D,{label:"操作",width:"120"},{default:o(a=>[l(h,{link:"",type:"primary",size:"default",onClick:Gl=>ge(a.row)},{default:o(()=>[v(" 管理结算账户 ")]),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"])]),e("div",bt,[l(ye,{background:"",layout:u(R).layout,"page-sizes":u(R).pageSizes,total:u(R).total,"page-size":u(R).pageSize,currentPage:u(R).currentPage,onCurrentChange:u(ae)},null,8,["layout","page-sizes","total","page-size","currentPage","onCurrentChange"])]),l(Z,{modelValue:u(C),"onUpdate:modelValue":t[4]||(t[4]=a=>H(C)?C.value=a:null)},{default:o(()=>[e("div",ht,[yt,x.value=="USD"?(y(),w("div",Vt,[e("div",At,[kt,e("span",wt,_(m.value.currency.value),1)]),e("div",St,[xt,e("span",Ut,_(m.value.region.value),1)]),e("div",Rt,[Ct,e("span",Dt,_(m.value.bankName.value),1)]),e("div",Nt,[Ft,e("span",qt,_(m.value.bankAddress.value),1)]),e("div",Tt,[It,e("span",Pt,_(m.value.accountName.value),1)]),e("div",Gt,[Ot,e("span",zt,_(m.value.account.value),1)]),e("div",$t,[Bt,e("span",Lt,_(m.value.companyAddress.value),1)])])):(y(),w("div",jt,[e("div",Mt,[Qt,e("span",Ht,_(m.value.currency.value),1)]),e("div",Jt,[Zt,e("span",Et,_(m.value.account.value),1)]),e("div",Kt,[Wt,e("span",Xt,_(m.value.accountName.value),1)])])),e("div",Yt,[l(h,{onClick:_e},{default:o(()=>[v("返回")]),_:1})]),e("div",{class:"flex-center w-full del-btn cursor-pointer",onClick:ve},"删除结算账户 ")])]),_:1},8,["modelValue"]),l(Z,{modelValue:u(T),"onUpdate:modelValue":t[18]||(t[18]=a=>H(T)?T.value=a:null)},{default:o(()=>[e("div",el,[tl,ll,l(Ae,{class:"select-currency-input",modelValue:x.value,"onUpdate:modelValue":t[5]||(t[5]=a=>x.value=a)},{default:o(()=>[(y(),w(qe,null,Te(Y,a=>l(Ve,{key:a.value,label:a.label,value:a.value},null,8,["label","value"])),64))]),_:1},8,["modelValue"]),x.value=="USD"?(y(),J(I,{key:0,ref_key:"settlementAccountFormRef",ref:z,"label-position":"top",rules:te,"label-width":"auto",model:r},{default:o(()=>[l(n,{prop:"region",label:"银行国家/地区"},{default:o(()=>[l(Je,{modelValue:r.region,"onUpdate:modelValue":t[6]||(t[6]=a=>r.region=a),type:"region",placeholder:"请选择银行账户开户国家"},null,8,["modelValue"])]),_:1}),l(n,{prop:"bankName",label:"银行名称"},{default:o(()=>[l(s,{modelValue:r.bankName,"onUpdate:modelValue":t[7]||(t[7]=a=>r.bankName=a),placeholder:"请输入银行名称",maxlength:"50"},null,8,["modelValue"])]),_:1}),l(n,{prop:"bankAddress",label:"银行地址"},{default:o(()=>[l(s,{modelValue:r.bankAddress,"onUpdate:modelValue":t[8]||(t[8]=a=>r.bankAddress=a),placeholder:"请输入银行地址",maxlength:"50"},null,8,["modelValue"])]),_:1}),l(n,{prop:"accountName",label:"账号名"},{default:o(()=>[l(s,{modelValue:r.accountName,"onUpdate:modelValue":t[9]||(t[9]=a=>r.accountName=a),placeholder:"请输入账号名",maxlength:"50"},null,8,["modelValue"])]),_:1}),l(n,{prop:"account",label:"银行账号"},{default:o(()=>[l(s,{modelValue:r.account,"onUpdate:modelValue":t[10]||(t[10]=a=>r.account=a),placeholder:"请输入完整的银行账号",maxlength:"64"},null,8,["modelValue"])]),_:1}),l(n,{prop:"companyAddress",label:"公司地址"},{default:o(()=>[l(s,{modelValue:r.companyAddress,"onUpdate:modelValue":t[11]||(t[11]=a=>r.companyAddress=a),placeholder:"请输入公司所在地址",maxlength:"50"},null,8,["modelValue"])]),_:1}),l(n,{prop:"challengeResult",label:"谷歌验证码"},{default:o(()=>[l(s,{modelValue:r.challengeResult,"onUpdate:modelValue":t[12]||(t[12]=a=>r.challengeResult=a),placeholder:"请输入谷歌验证码",minlength:"6",maxlength:"6"},null,8,["modelValue"])]),_:1}),l(n,null,{default:o(()=>[e("div",al,[l(h,{type:"primary",onClick:t[13]||(t[13]=a=>me(z.value))},{default:o(()=>[v("保存 ")]),_:1})])]),_:1})]),_:1},8,["rules","model"])):(y(),J(I,{key:1,ref_key:"trcSettlementAccountFormRef",ref:$,"label-position":"top",rules:ee,"label-width":"auto",model:f},{default:o(()=>[l(n,{prop:"account",label:"USDT钱包地址"},{default:o(()=>[l(s,{modelValue:f.account,"onUpdate:modelValue":t[14]||(t[14]=a=>f.account=a),placeholder:"请输入USDT(TRC20)钱包地址",maxlength:"64"},null,8,["modelValue"])]),_:1}),l(n,{prop:"accountName",label:"钱包名称/备注"},{default:o(()=>[l(s,{modelValue:f.accountName,"onUpdate:modelValue":t[15]||(t[15]=a=>f.accountName=a),placeholder:"请输入钱包名称备注",maxlength:"30"},null,8,["modelValue"])]),_:1}),l(n,{prop:"challengeResult",label:"谷歌验证码"},{default:o(()=>[l(s,{modelValue:f.challengeResult,"onUpdate:modelValue":t[16]||(t[16]=a=>f.challengeResult=a),placeholder:"请输入谷歌验证码",minlength:"6",maxlength:"6"},null,8,["modelValue"])]),_:1}),l(n,null,{default:o(()=>[e("div",ol,[l(h,{type:"primary",onClick:t[17]||(t[17]=a=>pe($.value))},{default:o(()=>[v("保存 ")]),_:1})])]),_:1})]),_:1},8,["rules","model"]))])]),_:1},8,["modelValue"])]),_:1}),l(P,{label:"修改密码",name:"pass"},{default:o(()=>[l(I,{ref_key:"passFormRef",ref:L,"label-position":"top",model:u(b),rules:u(se),"label-width":"auto",class:"demo-ruleForm mt-40"},{default:o(()=>[l(n,{label:"登录邮箱",prop:"email"},{default:o(()=>[l(s,{modelValue:u(b).name,"onUpdate:modelValue":t[19]||(t[19]=a=>u(b).name=a),disabled:""},null,8,["modelValue"]),sl]),_:1}),l(n,{label:"新密码",prop:"password"},{default:o(()=>[l(s,{modelValue:u(b).password,"onUpdate:modelValue":t[20]||(t[20]=a=>u(b).password=a),type:"password",placeholder:"请输入新密码"},null,8,["modelValue"])]),_:1}),l(n,{label:"确认新密码",prop:"rePass"},{default:o(()=>[l(s,{modelValue:u(b).rePass,"onUpdate:modelValue":t[21]||(t[21]=a=>u(b).rePass=a),type:"password",placeholder:"请输入确认密码"},null,8,["modelValue"])]),_:1}),l(Le,{modelValue:u(b).challengeResult,"onUpdate:modelValue":t[22]||(t[22]=a=>u(b).challengeResult=a),onGetChallengeId:t[23]||(t[23]=a=>u(b).challengeId=a)},null,8,["modelValue"]),l(n,null,{default:o(()=>[e("div",nl,[l(h,{type:"primary",loading:u(ce),onClick:t[24]||(t[24]=a=>u(ne)(u(L)))},{default:o(()=>[v("保存")]),_:1},8,["loading"])])]),_:1})]),_:1},8,["model","rules"])]),_:1}),l(P,{label:"谷歌验证器",name:"google"},{default:o(()=>[N.value?(y(),w("div",cl,[ul,e("div",dl,[e("div",{class:"cursor-pointer",onClick:j},[v(" 下载 Google Authenticator "),l(M,{name:"icon-xiazai",class:"ml-5"})])])])):(y(),w("div",rl,[il,ml,e("div",pl,[e("div",{class:"cursor-pointer",onClick:j},[v(" 下载 Google Authenticator "),l(M,{name:"icon-xiazai",class:"ml-5"})])]),k.value.qrcode?(y(),w("div",gl,[e("img",{src:"data:image/png;base64,"+k.value.qrcode,class:"google-auth-img"},null,8,_l)])):(y(),w("div",vl,[Ie(e("span",fl,null,512),[[Se,!0]])])),e("div",bl,[hl,e("div",yl,[l(s,{modelValue:k.value.otp,"onUpdate:modelValue":t[25]||(t[25]=a=>k.value.otp=a),placeholder:"请输入谷歌验证码"},null,8,["modelValue"])])]),e("div",Vl,[l(h,{type:"primary",onClick:ue},{default:o(()=>[v("绑定")]),_:1})])]))]),_:1})]),_:1},8,["modelValue"]),l(we,{modelValue:q.value,"onUpdate:modelValue":t[29]||(t[29]=a=>q.value=a),center:"",style:{width:"480px"}},{footer:o(()=>[e("div",Sl,[l(h,{type:"primary",onClick:fe},{default:o(()=>[v(" 确定删除 ")]),_:1}),l(h,{onClick:t[28]||(t[28]=a=>q.value=!1)},{default:o(()=>[v("取消")]),_:1})])]),default:o(()=>[Al,kl,e("div",wl,[l(s,{modelValue:G.value,"onUpdate:modelValue":t[27]||(t[27]=a=>G.value=a),minlength:"6",maxlength:"6"},null,8,["modelValue"])])]),_:1},8,["modelValue"])])}}}),ea=Be(xl,[["__scopeId","data-v-46cb63ee"]]);export{ea as default};
