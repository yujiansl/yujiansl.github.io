import{l as ie,r as m,d as pe,ah as i,ap as O,m as _,p as x,q as t,U as l,O as s,F as me,a7 as _e,a8 as fe,S as h,P as S,u as c,M as N,I as H,T as d,R as M,aF as ve,aG as he}from"./vue-C87Wc4A0.js";import{_ as T}from"./empty-BiNgvBdS.js";import{u as be}from"./useTable-CVQ-UVVt.js";import{q as g,v as ge,w as C,e as ye,i as we,x as xe,y as Se,k as P,z as Ne,A as Ae,_ as De}from"./index-c78MVIZI.js";import{F as ke}from"./Index-BU8kA-XB.js";import"./element-CD5rsoqi.js";import"//at.alicdn.com/t/c/font_4557022_0o7l3b0t8egq.js";import"./vxe-sm_XFqm0.js";import"./LIKU-logo-CHqxCLOK.js";const u=A=>(ve("data-v-3e8cf994"),A=A(),he(),A),Ce={class:"order base-box mt-20"},Te={class:"top-search"},Ve={class:"table-wrapper"},Ie=u(()=>t("div",{class:"flex-center flex-col h-full",style:{height:"300px"}},[t("span",null,[t("img",{src:T,alt:""})]),t("span",{class:"custom-empty-text"},"暂无数据")],-1)),Le={key:0},ze=["onClick"],Re={class:"pager-wrapper mt-32 flex justify-end"},Me={class:"base-box detail-box"},Pe=u(()=>t("div",{class:"order-title mb-30"},"订单信息",-1)),qe={class:"mb-24 flex"},Ye=u(()=>t("div",{class:"order-text"},"订单金额",-1)),Fe={class:"order-value"},Ue={class:"mb-24 flex"},Be=u(()=>t("div",{class:"order-text"},"下单用户",-1)),Oe={class:"order-value"},He={class:"mb-24 flex"},Ke=u(()=>t("div",{class:"order-text"},"商户订单号",-1)),We={class:"order-value"},Ze={class:"mb-24 flex"},je=u(()=>t("div",{class:"order-text"},"下单时间（香港）",-1)),Ee={class:"order-value"},Ge=u(()=>t("div",{class:"order-line mt-42 mb-40"},null,-1)),Je=u(()=>t("div",{class:"order-title mb-30"},"商品信息",-1)),$e=u(()=>t("div",{class:"flex-center flex-col h-full",style:{height:"300px"}},[t("span",null,[t("img",{src:T,alt:""})]),t("span",{class:"custom-empty-text"},"暂无数据")],-1)),Qe={key:0,class:"mt-30"},Xe=u(()=>t("div",{class:"order-title mb-30"},"退款信息",-1)),et=u(()=>t("div",{class:"flex-center flex-col h-full",style:{height:"300px"}},[t("span",null,[t("img",{src:T,alt:""})]),t("span",{class:"custom-empty-text"},"暂无数据")],-1)),tt={key:1,class:"mt-30"},at=u(()=>t("div",{class:"order-title mb-30"},"拒付信息",-1)),lt=u(()=>t("div",{class:"flex-center flex-col h-full",style:{height:"300px"}},[t("span",null,[t("img",{src:T,alt:""})]),t("span",{class:"custom-empty-text"},"暂无数据")],-1)),ot=ie({__name:"Index",setup(A){const p=m({tradeState:"",payWay:"",channel:"",username:""}),q=m([]),V=m([]),I=m([]),v=m(!1),K=m([]);m([]);const Y=[{label:"等待支付",value:"10"},{label:"支付成功",value:"20"},{label:"支付失败",value:"30"},{label:"取消支付",value:"40"},{label:"全额退款",value:"60"},{label:"部分退款",value:"61"}],L=m(!1),f=m({accountName:"",price:"",currency:"",bizNo:"",payWay:"",createdAt:""}),F=m("first"),{paginationData:y,handleCurrentChange:W,handSearch:Z,tableData:j,queryTableData:st,loadingRef:E}=be({searchData:p,url:"/traderecord/list",method:"post"}),G=()=>{p.value={}};function z(){const o=JSON.parse(ye("user-info")||"{}"),a=[];for(const n in p.value){let b=p.value[n];Array.isArray(b)&&(b=b.map(R=>we.utc(new Date(R)).format("YYYY-MM-DD HH:mm:ss")).toString()),b&&a.push({columnName:n,value:b})}a.push({columnName:"merchantId",value:o.mer}),Z(a)}const J=[{text:"Last week",value:()=>{const o=new Date,a=new Date;return a.setTime(a.getTime()-3600*1e3*24*7),[a,o]}},{text:"Last month",value:()=>{const o=new Date,a=new Date;return a.setTime(a.getTime()-3600*1e3*24*30),[a,o]}},{text:"Last 3 months",value:()=>{const o=new Date,a=new Date;return a.setTime(a.getTime()-3600*1e3*24*90),[a,o]}}],$=async()=>{try{const o=await xe();K.value=o.data.map(a=>({name:a.code+"站点",value:a.code}))}catch(o){console.log(o,"e")}},Q=o=>{var a;return(a=Y.filter(n=>n.value===o)[0])==null?void 0:a.label},U=o=>{if(o==="10")return"order-wait";if(o==="20")return"order-success";if(o==="30")return"order-fail";if(o==="40")return"order-cancel";if(o==="60"||o==="61")return"order-refund";console.log(o,"value")},X=o=>{const a={searchItems:[{columnName:"luTradeRecord",value:o}]};v.value=!0,Se(a).then(n=>{q.value=P(n.data.rows)||[],v.value=!1}).catch(n=>{v.value=!1,console.log(n,"getProductApi")})},ee={10:"待退款",20:"退款成功",30:"退款失败",40:"取消退款"},te={100:"收到预拒付",110:"预拒付已处理",200:"收到拒付",210:"拒付已回复",220:"已驳回",230:"已接受拒付",240:"争议败诉",250:"争议胜诉",300:"收到调单",310:"调单已回复",400:"收到仲裁",500:"仲裁已提交到卡组织"},ae=o=>{const a={searchItems:[{columnName:"luTradeRecord",value:o}]};v.value=!0,Ne(a).then(n=>{V.value=P(n.data.rows)||[],console.log(n,"getRefundList")}).catch(n=>{console.log(n,"getProductApi")})},le=o=>{const a={searchItems:[{columnName:"luTradeRecord",value:o}]};v.value=!0,Ae(a).then(n=>{I.value=P(n.data.rows)||[],console.log(n,"getRefuseList")}).catch(n=>{console.log(n,"getProductApi")})},oe=o=>{X(o.id),ae(o.id),le(o.id),f.value=o,L.value=!0};return pe(()=>{z(),$()}),(o,a)=>{const n=i("el-option"),b=i("el-select"),w=i("el-form-item"),R=i("el-date-picker"),se=i("el-input"),B=i("el-button"),re=i("el-form"),r=i("el-table-column"),D=i("el-table"),ne=i("el-pagination"),ce=i("el-tab-pane"),de=i("el-tabs"),ue=O("permission"),k=O("loading");return _(),x("div",Ce,[t("div",Te,[l(re,{inline:!0,model:p.value,class:"demo-form-inline"},{default:s(()=>[l(w,null,{default:s(()=>[l(b,{modelValue:p.value.tradeState,"onUpdate:modelValue":a[0]||(a[0]=e=>p.value.tradeState=e),placeholder:"全部状态",clearable:""},{default:s(()=>[(_(),x(me,null,_e(Y,e=>l(n,{key:e.value,label:e.label,value:e.value},null,8,["label","value"])),64))]),_:1},8,["modelValue"])]),_:1}),l(w,null,{default:s(()=>[l(R,{modelValue:p.value.createdAt,"onUpdate:modelValue":a[1]||(a[1]=e=>p.value.createdAt=e),type:"daterange","unlink-panels":"","range-separator":"-","start-placeholder":"开始时间","end-placeholder":"结束时间",format:"YYYY-MM-DD",shortcuts:J,size:"default"},null,8,["modelValue"])]),_:1}),l(w,null,{default:s(()=>[l(se,{modelValue:p.value.orderNo,"onUpdate:modelValue":a[2]||(a[2]=e=>p.value.orderNo=e),placeholder:"请输入订单号搜寻",onKeyup:fe(z,["enter"]),clearable:""},null,8,["modelValue"])]),_:1}),l(w,null,{default:s(()=>[l(B,{onClick:G},{default:s(()=>[h("重置")]),_:1}),l(B,{type:"primary",onClick:z},{default:s(()=>[h("查询")]),_:1})]),_:1})]),_:1},8,["model"])]),t("div",Ve,[S((_(),N(D,{data:c(j),style:{width:"100%"}},{empty:s(()=>[Ie]),default:s(()=>[l(r,{prop:"merchant~merchantName",label:"站点名称","min-width":"150"}),l(r,{prop:"orderNo",label:"订单号","min-width":"280"}),l(r,{prop:"bizNo",label:"商户订单号","min-width":"280"}),l(r,{prop:"tradeState",label:"订单状态","min-width":"160"},{default:s(e=>[t("div",{class:H(U(e.row.tradeState))},d(Q(e.row.tradeState)),3)]),_:1}),l(r,{prop:"price",label:"订单金额","min-width":"180"},{default:s(e=>[c(g)(e.row.price,e.row.currencyMultiply)?(_(),x("span",Le,d(c(g)(e.row.price,e.row.currencyMultiply)+" "+e.row.currency),1)):M("",!0)]),_:1}),l(r,{prop:"accountName",label:"下单用户","min-width":"220"}),l(r,{prop:"createdAt",label:"下单时间(当地)","min-width":"240"},{default:s(e=>[t("div",null,d(c(ge)(e.row.createdAt,e.row.timezone))+" ("+d(e.row.timezone)+")",1)]),_:1}),l(r,{prop:"createdAt",label:"下单时间(香港)","min-width":"180"},{default:s(e=>[t("div",null,d(c(C)(e.row.createdAt)),1)]),_:1}),S((_(),N(r,{prop:"action",label:"操作",fixed:"right"},{default:s(e=>[t("div",{class:"action-btn cursor-pointer",onClick:rt=>oe(e.row)},"查看详情",8,ze)]),_:1})),[[ue,["merchant","admin"]]])]),_:1},8,["data"])),[[k,c(E)]])]),t("div",Re,[l(ne,{background:"",layout:c(y).layout,"page-sizes":c(y).pageSizes,total:c(y).total,"page-size":c(y).pageSize,currentPage:c(y).currentPage,onCurrentChange:c(W)},null,8,["layout","page-sizes","total","page-size","currentPage","onCurrentChange"])]),l(ke,{modelValue:L.value,"onUpdate:modelValue":a[4]||(a[4]=e=>L.value=e)},{default:s(()=>[t("div",Me,[l(de,{modelValue:F.value,"onUpdate:modelValue":a[3]||(a[3]=e=>F.value=e),class:"modal-tabs"},{default:s(()=>[l(ce,{label:"订单详情",name:"first"},{default:s(()=>[Pe,t("div",qe,[Ye,t("div",Fe,d(c(g)(f.value.price,f.value.currencyMultiply)+" "+f.value.currency),1)]),t("div",Ue,[Be,t("div",Oe,d(f.value.accountName),1)]),t("div",He,[Ke,t("div",We,d(f.value.bizNo),1)]),t("div",Ze,[je,t("div",Ee,d(c(C)(f.value.createdAt)),1)]),Ge,Je,S((_(),N(D,{data:q.value,style:{width:"100%"}},{empty:s(()=>[$e]),default:s(()=>[l(r,{prop:"name",label:"商品名称"}),l(r,{prop:"quantity",label:"商品数量"}),l(r,{prop:"price",label:"商品价格"},{default:s(e=>[h(d(c(g)(f.value.price,f.value.currencyMultiply)+" "+e.row.currency),1)]),_:1})]),_:1},8,["data"])),[[k,v.value]]),V.value.length?(_(),x("div",Qe,[Xe,S((_(),N(D,{data:V.value,style:{width:"100%"}},{empty:s(()=>[et]),default:s(()=>[l(r,{prop:"price",label:"退款金额"},{default:s(e=>[h(d(c(g)(e.row.price,e.row.currencyMultiply)+" "+e.row.currency),1)]),_:1}),l(r,{prop:"refundState",label:"退款状态"},{default:s(e=>[t("div",{class:H(U(e.row.refundState))},d(ee[e.row.refundState]),3)]),_:1}),l(r,{prop:"refundNo",label:"退款单号"}),l(r,{prop:"updatedAt",label:"退款时间"},{default:s(e=>[h(d(c(C)(e.row.updatedAt)),1)]),_:1})]),_:1},8,["data"])),[[k,v.value]])])):M("",!0),I.value.length?(_(),x("div",tt,[at,S((_(),N(D,{data:I.value,style:{width:"100%"}},{empty:s(()=>[lt]),default:s(()=>[l(r,{prop:"amount",label:"拒付金额"},{default:s(e=>[h(d(c(g)(e.row.amount,e.row.currencyMultiply)+" "+e.row.currency),1)]),_:1}),l(r,{prop:"disputeState",label:"拒付状态"},{default:s(e=>[h(d(te[e.row.disputeState]),1)]),_:1}),l(r,{prop:"disputeNo",label:"拒付编码"}),l(r,{prop:"cardScheme",label:"卡组织"}),l(r,{prop:"createdAt",label:"发起时间"},{default:s(e=>[h(d(c(C)(e.row.createdAt)),1)]),_:1})]),_:1},8,["data"])),[[k,v.value]])])):M("",!0)]),_:1})]),_:1},8,["modelValue"])])]),_:1},8,["modelValue"])])}}}),vt=De(ot,[["__scopeId","data-v-3e8cf994"]]);export{vt as default};
